/*! For license information please see main.b9120668.js.LICENSE.txt */
(()=>{var t={89:t=>{"use strict";function e(t,e,o){o=o||2;var a,s,l,h,p,f,g,m=e&&e.length,y=m?e[0]*o:t.length,v=n(t,0,y,o,!0),_=[];if(!v||v.next===v.prev)return _;if(m&&(v=function(t,e,r,o){var a,s,l,h=[];for(a=0,s=e.length;a<s;a++)(l=n(t,e[a]*o,a<s-1?e[a+1]*o:t.length,o,!1))===l.next&&(l.steiner=!0),h.push(d(l));for(h.sort(c),a=0;a<h.length;a++)r=i(r=u(h[a],r),r.next);return r}(t,e,v,o)),t.length>80*o){a=l=t[0],s=h=t[1];for(var b=o;b<y;b+=o)(p=t[b])<a&&(a=p),(f=t[b+1])<s&&(s=f),p>l&&(l=p),f>h&&(h=f);g=0!==(g=Math.max(l-a,h-s))?1/g:0}return r(v,_,o,a,s,g),_}function n(t,e,n,i,r){var o,a;if(r===T(t,e,n,i)>0)for(o=e;o<n;o+=i)a=S(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=S(o,t[o],t[o+1],a);return a&&y(a,a.next)&&(P(a),a=a.next),a}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(P(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,c,u,h,d){if(t){!d&&h&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=p(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,l,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<c&&(s++,i=i.nextZ);e++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1)}(r)}(t,c,u,h);for(var f,g,m=t;t.prev!==t.next;)if(f=t.prev,g=t.next,h?a(t,c,u,h):o(t))e.push(f.i/n),e.push(t.i/n),e.push(g.i/n),P(t),t=g.next,m=g.next;else if((t=g)===m){d?1===d?r(t=s(i(t),e,n),e,n,c,u,h,2):2===d&&l(t,e,n,c,u,h):r(i(t),e,n,c,u,h,1);break}}}function o(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(f(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&m(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function a(t,e,n,i){var r=t.prev,o=t,a=t.next;if(m(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,u=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=p(s,l,e,n,i),d=p(c,u,e,n,i),g=t.prevZ,y=t.nextZ;g&&g.z>=h&&y&&y.z<=d;){if(g!==t.prev&&g!==t.next&&f(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,y!==t.prev&&y!==t.next&&f(r.x,r.y,o.x,o.y,a.x,a.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;g&&g.z>=h;){if(g!==t.prev&&g!==t.next&&f(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;y&&y.z<=d;){if(y!==t.prev&&y!==t.next&&f(r.x,r.y,o.x,o.y,a.x,a.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function s(t,e,n){var r=t;do{var o=r.prev,a=r.next.next;!y(o,a)&&v(o,r,r.next,a)&&x(o,a)&&x(a,o)&&(e.push(o.i/n),e.push(r.i/n),e.push(a.i/n),P(r),P(r.next),r=t=a),r=r.next}while(r!==t);return i(r)}function l(t,e,n,o,a,s){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&g(l,c)){var u=w(l,c);return l=i(l,l.next),u=i(u,u.next),r(l,e,n,o,a,s),void r(u,e,n,o,a,s)}c=c.next}l=l.next}while(l!==t)}function c(t,e){return t.x-e.x}function u(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n;var l,c=n,u=n.x,p=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&f(o<p?r:a,o,u,p,o<p?a:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),x(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&h(n,i)))&&(n=i,d=l)),i=i.next}while(i!==c);return n}(t,e);if(!n)return e;var r=w(n,t),o=i(n,n.next);return i(r,r.next),e===n?o:e}function h(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function p(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function f(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(x(t,e)&&x(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,n,i){var r=b(m(t,e,n)),o=b(m(t,e,i)),a=b(m(n,i,t)),s=b(m(n,i,e));return r!==o&&a!==s||(!(0!==r||!_(t,n,e))||(!(0!==o||!_(t,i,e))||(!(0!==a||!_(n,t,i))||!(0!==s||!_(n,e,i)))))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function b(t){return t>0?1:t<0?-1:0}function x(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function w(t,e){var n=new E(t.i,t.x,t.y),i=new E(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function S(t,e,n,i){var r=new E(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(T(t,0,o,n));if(r)for(var s=0,l=e.length;s<l;s++){var c=e[s]*n,u=s<l-1?e[s+1]*n:t.length;a-=Math.abs(T(t,c,u,n))}var h=0;for(s=0;s<i.length;s+=3){var p=i[s]*n,d=i[s+1]*n,f=i[s+2]*n;h+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},97:(t,e,n)=>{var i;!function(r,o,a,s){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=o.createElement("div"),h=Math.round,p=Math.abs,d=Date.now;function f(t,e,n){return setTimeout(x(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function y(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}l="function"!==typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==s&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var v=y((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===s)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),_=y((function(t,e){return v(t,e,!0)}),"merge","Use `assign`.");function b(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&l(i,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return"function"==typeof t?t.apply(e&&e[0]||s,e):t}function S(t,e){return t===s?e:t}function P(t,e,n){m(A(e),(function(e){t.addEventListener(e,n,!1)}))}function E(t,e,n){m(A(e),(function(e){t.removeEventListener(e,n,!1)}))}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function k(t,e){return t.indexOf(e)>-1}function A(t){return t.trim().split(/\s+/g)}function C(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function M(t){return Array.prototype.slice.call(t,0)}function I(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];C(r,a)<0&&i.push(t[o]),r[o]=a,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function L(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((i=(n=c[o])?n+r:e)in t)return i;o++}return s}var O=1;function z(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var R="ontouchstart"in r,D=L(r,"PointerEvent")!==s,F=R&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",j="mouse",N=24,V=["x","y"],U=["clientX","clientY"];function W(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function G(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=1&e&&i-r===0,a=12&e&&i-r===0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=q(e));r>1&&!n.firstMultiple?n.firstMultiple=q(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,l=a?a.center:o.center,c=e.center=Z(i);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=K(l,c),e.distance=Y(l,c),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y});e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=X(e.deltaX,e.deltaY);var u=H(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=p(u.x)>p(u.y)?u.x:u.y,e.scale=a?(h=a.pointers,f=i,Y(f[0],f[1],U)/Y(h[0],h[1],U)):1,e.rotation=a?function(t,e){return K(e[1],e[0],U)+K(t[1],t[0],U)}(a.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(l>25||a.velocity===s)){var c=e.deltaX-a.deltaX,u=e.deltaY-a.deltaY,h=H(l,c,u);i=h.x,r=h.y,n=p(h.x)>p(h.y)?h.x:h.y,o=X(c,u),t.lastInterval=e}else n=a.velocity,i=a.velocityX,r=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var h,f;var g=t.element;T(e.srcEvent.target,g)&&(g=e.srcEvent.target);e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function q(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:Z(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Z(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:h(n/e),y:h(i/e)}}function H(t,e,n){return{x:e/t||0,y:n/t||0}}function X(t,e){return t===e?1:p(t)>=p(e)?t<0?2:4:e<0?8:16}function Y(t,e,n){n||(n=V);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function K(t,e,n){n||(n=V);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(z(this.element),this.evWin,this.domHandler)}};var J={mousedown:1,mousemove:2,mouseup:4},Q="mousedown",$="mousemove mouseup";function tt(){this.evEl=Q,this.evWin=$,this.pressed=!1,W.apply(this,arguments)}b(tt,W,{handler:function(t){var e=J[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:j,srcEvent:t}))}});var et={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},nt={2:B,3:"pen",4:j,5:"kinect"},it="pointerdown",rt="pointermove pointerup pointercancel";function ot(){this.evEl=it,this.evWin=rt,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(it="MSPointerDown",rt="MSPointerMove MSPointerUp MSPointerCancel"),b(ot,W,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=et[i],o=nt[t.pointerType]||t.pointerType,a=o==B,s=C(e,t.pointerId,"pointerId");1&r&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):12&r&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var at={touchstart:1,touchmove:2,touchend:4,touchcancel:8},st="touchstart",lt="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=st,this.evWin=lt,this.started=!1,W.apply(this,arguments)}function ut(t,e){var n=M(t.touches),i=M(t.changedTouches);return 12&e&&(n=I(n.concat(i),"identifier",!0)),[n,i]}b(ct,W,{handler:function(t){var e=at[t.type];if(1===e&&(this.started=!0),this.started){var n=ut.call(this,t,e);12&e&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}});var ht={touchstart:1,touchmove:2,touchend:4,touchcancel:8},pt="touchstart touchmove touchend touchcancel";function dt(){this.evTarget=pt,this.targetIds={},W.apply(this,arguments)}function ft(t,e){var n=M(t.touches),i=this.targetIds;if(3&e&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,a=M(t.changedTouches),s=[],l=this.target;if(o=n.filter((function(t){return T(t.target,l)})),1===e)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<a.length;)i[a[r].identifier]&&s.push(a[r]),12&e&&delete i[a[r].identifier],r++;return s.length?[I(o.concat(s),"identifier",!0),s]:void 0}b(dt,W,{handler:function(t){var e=ht[t.type],n=ft.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}});function gt(){W.apply(this,arguments);var t=x(this.handler,this);this.touch=new dt(this.manager,t),this.mouse=new tt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function mt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,yt.call(this,e)):12&t&&yt.call(this,e)}function yt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),2500)}}function vt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),a=Math.abs(n-r.y);if(o<=25&&a<=25)return!0}return!1}b(gt,W,{handler:function(t,e,n){var i=n.pointerType==B,r=n.pointerType==j;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)mt.call(this,e,n);else if(r&&vt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _t=L(u.style,"touchAction"),bt=_t!==s,xt="compute",wt="auto",St="manipulation",Pt="none",Et="pan-x",Tt="pan-y",kt=function(){if(!bt)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function At(t,e){this.manager=t,this.set(e)}At.prototype={set:function(t){t==xt&&(t=this.compute()),bt&&this.manager.element.style&&kt[t]&&(this.manager.element.style[_t]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(k(t,Pt))return Pt;var e=k(t,Et),n=k(t,Tt);if(e&&n)return Pt;if(e||n)return e?Et:Tt;if(k(t,St))return St;return wt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=k(i,Pt)&&!kt.none,o=k(i,Tt)&&!kt["pan-y"],a=k(i,Et)&&!kt["pan-x"];if(r){var s=1===t.pointers.length,l=t.distance<2,c=t.deltaTime<250;if(s&&l&&c)return}if(!a||!o)return r||o&&6&n||a&&n&N?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ct=32;function Mt(t){this.options=l({},this.defaults,t||{}),this.id=O++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function It(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Lt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Ot(t,e){var n=e.manager;return n?n.get(t):t}function zt(){Mt.apply(this,arguments)}function Rt(){zt.apply(this,arguments),this.pX=null,this.pY=null}function Dt(){zt.apply(this,arguments)}function Ft(){Mt.apply(this,arguments),this._timer=null,this._input=null}function Bt(){zt.apply(this,arguments)}function jt(){zt.apply(this,arguments)}function Nt(){Mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Vt(t,e){return(e=e||{}).recognizers=S(e.recognizers,Vt.defaults.preset),new Ut(t,e)}Mt.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Ot(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=Ot(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===C(e,t=Ot(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Ot(t,this);var e=C(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<8&&i(e.options.event+It(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=8&&i(e.options.event+It(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ct},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=Ct);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},b(zt,Mt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=6&e,r=this.attrTest(t);return i&&(8&n||!r)?16|e:i||r?4&n?8|e:2&e?4|e:2:Ct}}),b(Rt,zt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(Tt),t&N&&e.push(Et),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,a=t.deltaY;return r&e.direction||(6&e.direction?(r=0===o?1:o<0?2:4,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===a?1:a<0?8:16,n=a!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return zt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Lt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),b(Dt,zt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Pt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),b(Ft,Mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=f((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Ct},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),b(Bt,zt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Pt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),b(jt,zt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Rt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:n&N&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&p(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Lt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),b(Nt,Mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[St]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(i&&r&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||Y(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=f((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ct},failTimeout:function(){return this._timer=f((function(){this.state=Ct}),this.options.interval,this),Ct},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Vt.VERSION="2.0.7",Vt.defaults={domEvents:!1,touchAction:xt,enable:!0,inputTarget:null,inputClass:null,preset:[[Bt,{enable:!1}],[Dt,{enable:!1},["rotate"]],[jt,{direction:6}],[Rt,{direction:6},["swipe"]],[Nt],[Nt,{event:"doubletap",taps:2},["tap"]],[Ft]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ut(t,e){var n;this.options=l({},Vt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(D?ot:F?dt:R?gt:tt))(n,G),this.touchAction=new At(this,this.options.touchAction),Wt(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Wt(t,e){var n,i=t.element;i.style&&(m(t.options.cssProps,(function(r,o){n=L(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Ut.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&8&r.state)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&14&n.state&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Mt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=C(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return m(A(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==s){var n=this.handlers;return m(A(t),(function(t){e?n[t]&&n[t].splice(C(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&Wt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Vt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ct,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:N,DIRECTION_ALL:30,Manager:Ut,Input:W,TouchAction:At,TouchInput:dt,MouseInput:tt,PointerEventInput:ot,TouchMouseInput:gt,SingleTouchInput:ct,Recognizer:Mt,AttrRecognizer:zt,Tap:Nt,Pan:Rt,Swipe:jt,Pinch:Dt,Rotate:Bt,Press:Ft,on:P,off:E,each:m,merge:_,extend:v,assign:l,inherit:b,bindFn:x,prefixed:L}),("undefined"!==typeof r?r:"undefined"!==typeof self?self:{}).Hammer=Vt,(i=function(){return Vt}.call(e,n,e,t))===s||(t.exports=i)}(window,document)},888:(t,e,n)=>{"use strict";var i=n(47);function r(){}function o(){}o.resetWarningCache=r,t.exports=function(){function t(t,e,n,r,o,a){if(a!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:r};return n.PropTypes=n,n}},7:(t,e,n)=>{t.exports=n(888)()},47:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},463:(t,e,n)=>{"use strict";var i=n(791),r=n(296);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(s[t]=e,t=0;t<e.length;t++)a.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function g(t,e,n,i,r,o,a){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function _(t,e,n,i){var r=m.hasOwnProperty(e)?m[e]:null;(null!==r?0!==r.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null===e||"undefined"===typeof e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!h.call(f,t)||!h.call(d,t)&&(p.test(t)?f[t]=!0:(d[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),k=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var z=Symbol.iterator;function R(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=z&&t[z]||t["@@iterator"])?t:null}var D,F=Object.assign;function B(t){if(void 0===D)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);D=e&&e[1]||""}return"\n"+D+t}var j=!1;function N(t,e){if(!t||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),o=i.stack.split("\n"),a=r.length-1,s=o.length-1;1<=a&&0<=s&&r[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||r[a]!==o[s]){var l="\n"+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=a&&0<=s);break}}}finally{j=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?B(t):""}function V(t){switch(t.tag){case 5:return B(t.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return t=N(t.type,!1);case 11:return t=N(t.type.render,!1);case 1:return t=N(t.type,!0);default:return""}}function U(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case S:return"Fragment";case w:return"Portal";case E:return"Profiler";case P:return"StrictMode";case C:return"Suspense";case M:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case k:return(t.displayName||"Context")+".Consumer";case T:return(t._context.displayName||"Context")+".Provider";case A:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case I:return null!==(e=t.displayName||null)?e:U(t.type)||"Memo";case L:e=t._payload,t=t._init;try{return U(t(e))}catch(n){}}return null}function W(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(e);case 8:return e===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function G(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function q(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function Z(t){t._valueTracker||(t._valueTracker=function(t){var e=q(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function H(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=q(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function X(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Y(t,e){var n=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function K(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=G(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function J(t,e){null!=(e=e.checked)&&_(t,"checked",e,!1)}function Q(t,e){J(t,e);var n=G(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,G(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function $(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&X(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+G(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(et(n)){if(1<n.length)throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:G(n)}}function ot(t,e){var n=G(e.value),i=G(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function at(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function pt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];function gt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||dt.hasOwnProperty(t)&&dt[t]?(""+e).trim():e+"px"}function mt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=gt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(dt).forEach((function(t){ft.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dt[e]=dt[t]}))}));var yt=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function _t(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bt=null;function xt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var wt=null,St=null,Pt=null;function Et(t){if(t=_r(t)){if("function"!==typeof wt)throw Error(o(280));var e=t.stateNode;e&&(e=xr(e),wt(t.stateNode,t.type,e))}}function Tt(t){St?Pt?Pt.push(t):Pt=[t]:St=t}function kt(){if(St){var t=St,e=Pt;if(Pt=St=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function At(t,e){return t(e)}function Ct(){}var Mt=!1;function It(t,e,n){if(Mt)return t(e,n);Mt=!0;try{return At(t,e,n)}finally{Mt=!1,(null!==St||null!==Pt)&&(Ct(),kt())}}function Lt(t,e){var n=t.stateNode;if(null===n)return null;var i=xr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(o(231,e,typeof n));return n}var Ot=!1;if(u)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){Ot=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch(ut){Ot=!1}function Rt(t,e,n,i,r,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Dt=!1,Ft=null,Bt=!1,jt=null,Nt={onError:function(t){Dt=!0,Ft=t}};function Vt(t,e,n,i,r,o,a,s,l){Dt=!1,Ft=null,Rt.apply(Nt,arguments)}function Ut(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Wt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Gt(t){if(Ut(t)!==t)throw Error(o(188))}function qt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Ut(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return Gt(r),t;if(a===i)return Gt(r),e;a=a.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=a;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=a;break}if(l===i){s=!0,i=r,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,i=r;break}if(l===i){s=!0,i=a,n=r;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t))?Zt(t):null}function Zt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Zt(t);if(null!==e)return e;t=t.sibling}return null}var Ht=r.unstable_scheduleCallback,Xt=r.unstable_cancelCallback,Yt=r.unstable_shouldYield,Kt=r.unstable_requestPaint,Jt=r.unstable_now,Qt=r.unstable_getCurrentPriorityLevel,$t=r.unstable_ImmediatePriority,te=r.unstable_UserBlockingPriority,ee=r.unstable_NormalPriority,ne=r.unstable_LowPriority,ie=r.unstable_IdlePriority,re=null,oe=null;var ae=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(se(t)/le|0)|0},se=Math.log,le=Math.LN2;var ce=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pe(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,r=t.suspendedLanes,o=t.pingedLanes,a=268435455&n;if(0!==a){var s=a&~r;0!==s?i=he(s):0!==(o&=a)&&(i=he(o))}else 0!==(a=n&~r)?i=he(a):0!==o&&(i=he(o));if(0===i)return 0;if(0!==e&&e!==i&&0===(e&r)&&((r=i&-i)>=(o=e&-e)||16===r&&0!==(4194240&o)))return e;if(0!==(4&i)&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-ae(e)),i|=t[n],e&=~r;return i}function de(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function fe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ge(){var t=ce;return 0===(4194240&(ce<<=1))&&(ce=64),t}function me(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ye(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-ae(e)]=n}function ve(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-ae(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var _e=0;function be(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var xe,we,Se,Pe,Ee,Te=!1,ke=[],Ae=null,Ce=null,Me=null,Ie=new Map,Le=new Map,Oe=[],ze="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Re(t,e){switch(t){case"focusin":case"focusout":Ae=null;break;case"dragenter":case"dragleave":Ce=null;break;case"mouseover":case"mouseout":Me=null;break;case"pointerover":case"pointerout":Ie.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Le.delete(e.pointerId)}}function De(t,e,n,i,r,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==e&&(null!==(e=_r(e))&&we(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function Fe(t){var e=vr(t.target);if(null!==e){var n=Ut(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Wt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){Se(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Be(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ye(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=_r(n))&&we(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);bt=i,n.target.dispatchEvent(i),bt=null,e.shift()}return!0}function je(t,e,n){Be(t)&&n.delete(e)}function Ne(){Te=!1,null!==Ae&&Be(Ae)&&(Ae=null),null!==Ce&&Be(Ce)&&(Ce=null),null!==Me&&Be(Me)&&(Me=null),Ie.forEach(je),Le.forEach(je)}function Ve(t,e){t.blockedOn===e&&(t.blockedOn=null,Te||(Te=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ne)))}function Ue(t){function e(e){return Ve(e,t)}if(0<ke.length){Ve(ke[0],t);for(var n=1;n<ke.length;n++){var i=ke[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Ae&&Ve(Ae,t),null!==Ce&&Ve(Ce,t),null!==Me&&Ve(Me,t),Ie.forEach(e),Le.forEach(e),n=0;n<Oe.length;n++)(i=Oe[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Oe.length&&null===(n=Oe[0]).blockedOn;)Fe(n),null===n.blockedOn&&Oe.shift()}var We=b.ReactCurrentBatchConfig,Ge=!0;function qe(t,e,n,i){var r=_e,o=We.transition;We.transition=null;try{_e=1,He(t,e,n,i)}finally{_e=r,We.transition=o}}function Ze(t,e,n,i){var r=_e,o=We.transition;We.transition=null;try{_e=4,He(t,e,n,i)}finally{_e=r,We.transition=o}}function He(t,e,n,i){if(Ge){var r=Ye(t,e,n,i);if(null===r)Gi(t,e,i,Xe,n),Re(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return Ae=De(Ae,t,e,n,i,r),!0;case"dragenter":return Ce=De(Ce,t,e,n,i,r),!0;case"mouseover":return Me=De(Me,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return Ie.set(o,De(Ie.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Le.set(o,De(Le.get(o)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(Re(t,i),4&e&&-1<ze.indexOf(t)){for(;null!==r;){var o=_r(r);if(null!==o&&xe(o),null===(o=Ye(t,e,n,i))&&Gi(t,e,i,Xe,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else Gi(t,e,i,null,n)}}var Xe=null;function Ye(t,e,n,i){if(Xe=null,null!==(t=vr(t=xt(i))))if(null===(e=Ut(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Wt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xe=t,null}function Ke(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case $t:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Je=null,Qe=null,$e=null;function tn(){if($e)return $e;var t,e,n=Qe,i=n.length,r="value"in Je?Je.value:Je.textContent,o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var a=i-t;for(e=1;e<=a&&n[i-e]===r[o-e];e++);return $e=r.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function on(t){function e(e,n,i,r,o){for(var a in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(a)&&(e=t[a],this[a]=e?e(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var an,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),hn=F({},cn,{view:0,detail:0}),pn=on(hn),dn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(an=t.screenX-ln.screenX,sn=t.screenY-ln.screenY):sn=an=0,ln=t),an)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),fn=on(dn),gn=on(F({},dn,{dataTransfer:0})),mn=on(F({},hn,{relatedTarget:0})),yn=on(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_n=on(vn),bn=on(F({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Sn[t])&&!!e[t]}function En(){return Pn}var Tn=F({},hn,{key:function(t){if(t.key){var e=xn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),kn=on(Tn),An=on(F({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=on(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Mn=on(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=F({},dn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=on(In),On=[9,13,27,32],zn=u&&"CompositionEvent"in window,Rn=null;u&&"documentMode"in document&&(Rn=document.documentMode);var Dn=u&&"TextEvent"in window&&!Rn,Fn=u&&(!zn||Rn&&8<Rn&&11>=Rn),Bn=String.fromCharCode(32),jn=!1;function Nn(t,e){switch(t){case"keyup":return-1!==On.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Un=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function qn(t,e,n,i){Tt(i),0<(e=Zi(e,"onChange")).length&&(n=new un("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Zn=null,Hn=null;function Xn(t){Bi(t,0)}function Yn(t){if(H(br(t)))return t}function Kn(t,e){if("change"===t)return e}var Jn=!1;if(u){var Qn;if(u){var $n="oninput"in document;if(!$n){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),$n="function"===typeof ti.oninput}Qn=$n}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function ei(){Zn&&(Zn.detachEvent("onpropertychange",ni),Hn=Zn=null)}function ni(t){if("value"===t.propertyName&&Yn(Hn)){var e=[];qn(e,Hn,t,xt(t)),It(Xn,e)}}function ii(t,e,n){"focusin"===t?(ei(),Hn=n,(Zn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Yn(Hn)}function oi(t,e){if("click"===t)return Yn(e)}function ai(t,e){if("input"===t||"change"===t)return Yn(e)}var si="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function li(t,e){if(si(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(e,r)||!si(t[r],e[r]))return!1}return!0}function ci(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ui(t,e){var n,i=ci(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ci(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function pi(){for(var t=window,e=X();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=X((t=e.contentWindow).document)}return e}function di(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function fi(t){var e=pi(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&di(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!t.extend&&o>i&&(r=i,i=o,o=r),r=ui(n,o);var a=ui(n,i);r&&a&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gi=u&&"documentMode"in document&&11>=document.documentMode,mi=null,yi=null,vi=null,_i=!1;function bi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==mi||mi!==X(i)||("selectionStart"in(i=mi)&&di(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=Zi(yi,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=mi)))}function xi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wi={animationend:xi("Animation","AnimationEnd"),animationiteration:xi("Animation","AnimationIteration"),animationstart:xi("Animation","AnimationStart"),transitionend:xi("Transition","TransitionEnd")},Si={},Pi={};function Ei(t){if(Si[t])return Si[t];if(!wi[t])return t;var e,n=wi[t];for(e in n)if(n.hasOwnProperty(e)&&e in Pi)return Si[t]=n[e];return t}u&&(Pi=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Ti=Ei("animationend"),ki=Ei("animationiteration"),Ai=Ei("animationstart"),Ci=Ei("transitionend"),Mi=new Map,Ii="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Li(t,e){Mi.set(t,e),l(e,[t])}for(var Oi=0;Oi<Ii.length;Oi++){var zi=Ii[Oi];Li(zi.toLowerCase(),"on"+(zi[0].toUpperCase()+zi.slice(1)))}Li(Ti,"onAnimationEnd"),Li(ki,"onAnimationIteration"),Li(Ai,"onAnimationStart"),Li("dblclick","onDoubleClick"),Li("focusin","onFocus"),Li("focusout","onBlur"),Li(Ci,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function Fi(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,a,s,l,c){if(Vt.apply(this,arguments),Dt){if(!Dt)throw Error(o(198));var u=Ft;Dt=!1,Ft=null,Bt||(Bt=!0,jt=u)}}(i,e,void 0,t),t.currentTarget=null}function Bi(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var o=void 0;if(e)for(var a=i.length-1;0<=a;a--){var s=i[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&r.isPropagationStopped())break t;Fi(r,s,c),o=l}else for(a=0;a<i.length;a++){if(l=(s=i[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&r.isPropagationStopped())break t;Fi(r,s,c),o=l}}}if(Bt)throw t=jt,Bt=!1,jt=null,t}function ji(t,e){var n=e[gr];void 0===n&&(n=e[gr]=new Set);var i=t+"__bubble";n.has(i)||(Wi(e,t,2,!1),n.add(i))}function Ni(t,e,n){var i=0;e&&(i|=4),Wi(n,t,i,e)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function Ui(t){if(!t[Vi]){t[Vi]=!0,a.forEach((function(e){"selectionchange"!==e&&(Di.has(e)||Ni(e,!1,t),Ni(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Vi]||(e[Vi]=!0,Ni("selectionchange",!1,e))}}function Wi(t,e,n,i){switch(Ke(e)){case 1:var r=qe;break;case 4:r=Ze;break;default:r=He}n=r.bind(null,e,n,t),r=void 0,!Ot||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Gi(t,e,n,i,r){var o=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var s=i.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;a=a.return}for(;null!==s;){if(null===(a=vr(s)))return;if(5===(l=a.tag)||6===l){i=o=a;continue t}s=s.parentNode}}i=i.return}It((function(){var i=o,r=xt(n),a=[];t:{var s=Mi.get(t);if(void 0!==s){var l=un,c=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=kn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case Ti:case ki:case Ai:l=yn;break;case Ci:l=Mn;break;case"scroll":l=pn;break;case"wheel":l=Ln;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&e),h=!u&&"scroll"===t,p=u?null!==s?s+"Capture":null:s;u=[];for(var d,f=i;null!==f;){var g=(d=f).stateNode;if(5===d.tag&&null!==g&&(d=g,null!==p&&(null!=(g=Lt(f,p))&&u.push(qi(f,g,d)))),h)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,r),a.push({event:s,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===bt||!(c=n.relatedTarget||n.fromElement)||!vr(c)&&!c[fr])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?vr(c):null)&&(c!==(h=Ut(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fn,g="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==t&&"pointerover"!==t||(u=An,g="onPointerLeave",p="onPointerEnter",f="pointer"),h=null==l?s:br(l),d=null==c?s:br(c),(s=new u(g,f+"leave",l,n,r)).target=h,s.relatedTarget=d,g=null,vr(r)===i&&((u=new u(p,f+"enter",c,n,r)).target=d,u.relatedTarget=h,g=u),h=g,l&&c)t:{for(p=c,f=0,d=u=l;d;d=Hi(d))f++;for(d=0,g=p;g;g=Hi(g))d++;for(;0<f-d;)u=Hi(u),f--;for(;0<d-f;)p=Hi(p),d--;for(;f--;){if(u===p||null!==p&&u===p.alternate)break t;u=Hi(u),p=Hi(p)}u=null}else u=null;null!==l&&Xi(a,s,l,u,!1),null!==c&&null!==h&&Xi(a,h,c,u,!0)}if("select"===(l=(s=i?br(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Kn;else if(Gn(s))if(Jn)m=ai;else{m=ri;var y=ii}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=oi);switch(m&&(m=m(t,i))?qn(a,m,n,r):(y&&y(t,s,i),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&tt(s,"number",s.value)),y=i?br(i):window,t){case"focusin":(Gn(y)||"true"===y.contentEditable)&&(mi=y,yi=i,vi=null);break;case"focusout":vi=yi=mi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,bi(a,n,r);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":bi(a,n,r)}var v;if(zn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Un?Nn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==_?"onCompositionEnd"===_&&Un&&(v=tn()):(Qe="value"in(Je=r)?Je.value:Je.textContent,Un=!0)),0<(y=Zi(i,_)).length&&(_=new bn(_,t,null,n,r),a.push({event:_,listeners:y}),v?_.data=v:null!==(v=Vn(n))&&(_.data=v))),(v=Dn?function(t,e){switch(t){case"compositionend":return Vn(e);case"keypress":return 32!==e.which?null:(jn=!0,Bn);case"textInput":return(t=e.data)===Bn&&jn?null:t;default:return null}}(t,n):function(t,e){if(Un)return"compositionend"===t||!zn&&Nn(t,e)?(t=tn(),$e=Qe=Je=null,Un=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(i=Zi(i,"onBeforeInput")).length&&(r=new bn("onBeforeInput","beforeinput",null,n,r),a.push({event:r,listeners:i}),r.data=v))}Bi(a,e)}))}function qi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Lt(t,n))&&i.unshift(qi(t,o,r)),null!=(o=Lt(t,e))&&i.push(qi(t,o,r))),t=t.return}return i}function Hi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Xi(t,e,n,i,r){for(var o=e._reactName,a=[];null!==n&&n!==i;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===i)break;5===s.tag&&null!==c&&(s=c,r?null!=(l=Lt(n,o))&&a.unshift(qi(n,l,s)):r||null!=(l=Lt(n,o))&&a.push(qi(n,l,s))),n=n.return}0!==a.length&&t.push({event:e,listeners:a})}var Yi=/\r\n?/g,Ki=/\u0000|\uFFFD/g;function Ji(t){return("string"===typeof t?t:""+t).replace(Yi,"\n").replace(Ki,"")}function Qi(t,e,n){if(e=Ji(e),Ji(t)!==e&&n)throw Error(o(425))}function $i(){}var tr=null,er=null;function nr(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,or="function"===typeof Promise?Promise:void 0,ar="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof or?function(t){return or.resolve(null).then(t).catch(sr)}:ir;function sr(t){setTimeout((function(){throw t}))}function lr(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return t.removeChild(r),void Ue(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ue(e)}function cr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ur(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hr=Math.random().toString(36).slice(2),pr="__reactFiber$"+hr,dr="__reactProps$"+hr,fr="__reactContainer$"+hr,gr="__reactEvents$"+hr,mr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function vr(t){var e=t[pr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fr]||n[pr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ur(t);null!==t;){if(n=t[pr])return n;t=ur(t)}return e}n=(t=n).parentNode}return null}function _r(t){return!(t=t[pr]||t[fr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function br(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function xr(t){return t[dr]||null}var wr=[],Sr=-1;function Pr(t){return{current:t}}function Er(t){0>Sr||(t.current=wr[Sr],wr[Sr]=null,Sr--)}function Tr(t,e){Sr++,wr[Sr]=t.current,t.current=e}var kr={},Ar=Pr(kr),Cr=Pr(!1),Mr=kr;function Ir(t,e){var n=t.type.contextTypes;if(!n)return kr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Lr(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Or(){Er(Cr),Er(Ar)}function zr(t,e,n){if(Ar.current!==kr)throw Error(o(168));Tr(Ar,e),Tr(Cr,n)}function Rr(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in e))throw Error(o(108,W(t)||"Unknown",r));return F({},n,i)}function Dr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||kr,Mr=Ar.current,Tr(Ar,t),Tr(Cr,Cr.current),!0}function Fr(t,e,n){var i=t.stateNode;if(!i)throw Error(o(169));n?(t=Rr(t,e,Mr),i.__reactInternalMemoizedMergedChildContext=t,Er(Cr),Er(Ar),Tr(Ar,t)):Er(Cr),Tr(Cr,n)}var Br=null,jr=!1,Nr=!1;function Vr(t){null===Br?Br=[t]:Br.push(t)}function Ur(){if(!Nr&&null!==Br){Nr=!0;var t=0,e=_e;try{var n=Br;for(_e=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Br=null,jr=!1}catch(r){throw null!==Br&&(Br=Br.slice(t+1)),Ht($t,Ur),r}finally{_e=e,Nr=!1}}return null}var Wr=b.ReactCurrentBatchConfig;function Gr(t,e){if(t&&t.defaultProps){for(var n in e=F({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var qr=Pr(null),Zr=null,Hr=null,Xr=null;function Yr(){Xr=Hr=Zr=null}function Kr(t){var e=qr.current;Er(qr),t._currentValue=e}function Jr(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Qr(t,e){Zr=t,Xr=Hr=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(xs=!0),t.firstContext=null)}function $r(t){var e=t._currentValue;if(Xr!==t)if(t={context:t,memoizedValue:e,next:null},null===Hr){if(null===Zr)throw Error(o(308));Hr=t,Zr.dependencies={lanes:0,firstContext:t}}else Hr=Hr.next=t;return e}var to=null,eo=!1;function no(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function io(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ro(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function oo(t,e){var n=t.updateQueue;null!==n&&(n=n.shared,ec(t)?(null===(t=n.interleaved)?(e.next=e,null===to?to=[n]:to.push(n)):(e.next=t.next,t.next=e),n.interleaved=e):(null===(t=n.pending)?e.next=e:(e.next=t.next,t.next=e),n.pending=e))}function ao(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ve(t,n)}}function so(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=e:o=o.next=e}else r=o=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function lo(t,e,n,i){var r=t.updateQueue;eo=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=t.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=r.baseState;for(a=0,u=c=l=null,s=o;;){var p=s.lane,d=s.eventTime;if((i&p)===p){null!==u&&(u=u.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var f=t,g=s;switch(p=e,d=n,g.tag){case 1:if("function"===typeof(f=g.payload)){h=f.call(d,h,p);break t}h=f;break t;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=g.payload)?f.call(d,h,p):f)||void 0===p)break t;h=F({},h,p);break t;case 2:eo=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(p=r.effects)?r.effects=[s]:p.push(s))}else d={eventTime:d,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=d,l=h):u=u.next=d,a|=p;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(p=s).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(e=r.shared.interleaved)){r=e;do{a|=r.lane,r=r.next}while(r!==e)}else null===o&&(r.shared.lanes=0);Ol|=a,t.lanes=a,t.memoizedState=h}}function co(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var uo=(new i.Component).refs;function ho(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:F({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var po={isMounted:function(t){return!!(t=t._reactInternals)&&Ut(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Jl(),r=Ql(t),o=ro(i,r);o.payload=e,void 0!==n&&null!==n&&(o.callback=n),oo(t,o),null!==(e=$l(t,r,i))&&ao(e,t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Jl(),r=Ql(t),o=ro(i,r);o.tag=1,o.payload=e,void 0!==n&&null!==n&&(o.callback=n),oo(t,o),null!==(e=$l(t,r,i))&&ao(e,t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Jl(),i=Ql(t),r=ro(n,i);r.tag=2,void 0!==e&&null!==e&&(r.callback=e),oo(t,r),null!==(e=$l(t,i,n))&&ao(e,t,i)}};function fo(t,e,n,i,r,o,a){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!li(n,i)||!li(r,o))}function go(t,e,n){var i=!1,r=kr,o=e.contextType;return"object"===typeof o&&null!==o?o=$r(o):(r=Lr(e)?Mr:Ar.current,o=(i=null!==(i=e.contextTypes)&&void 0!==i)?Ir(t,r):kr),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=po,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function mo(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&po.enqueueReplaceState(e,e.state,null)}function yo(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=uo,no(t);var o=e.contextType;"object"===typeof o&&null!==o?r.context=$r(o):(o=Lr(e)?Mr:Ar.current,r.context=Ir(t,o)),r.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(ho(t,e,o,n),r.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(e=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&po.enqueueReplaceState(r,r.state,null),lo(t,n,r,i),r.state=t.memoizedState),"function"===typeof r.componentDidMount&&(t.flags|=4194308)}var vo=[],_o=0,bo=null,xo=0,wo=[],So=0,Po=null,Eo=1,To="";function ko(t,e){vo[_o++]=xo,vo[_o++]=bo,bo=t,xo=e}function Ao(t,e,n){wo[So++]=Eo,wo[So++]=To,wo[So++]=Po,Po=t;var i=Eo;t=To;var r=32-ae(i)-1;i&=~(1<<r),n+=1;var o=32-ae(e)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Eo=1<<32-ae(e)+r|n<<r|i,To=o+t}else Eo=1<<o|n<<r|i,To=t}function Co(t){null!==t.return&&(ko(t,1),Ao(t,1,0))}function Mo(t){for(;t===bo;)bo=vo[--_o],vo[_o]=null,xo=vo[--_o],vo[_o]=null;for(;t===Po;)Po=wo[--So],wo[So]=null,To=wo[--So],wo[So]=null,Eo=wo[--So],wo[So]=null}var Io=null,Lo=null,Oo=!1,zo=null;function Ro(t,e){var n=Mc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function Do(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,Io=t,Lo=cr(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,Io=t,Lo=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Po?{id:Eo,overflow:To}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Mc(18,null,null,0)).stateNode=e,n.return=t,t.child=n,Io=t,Lo=null,!0);default:return!1}}function Fo(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function Bo(t){if(Oo){var e=Lo;if(e){var n=e;if(!Do(t,e)){if(Fo(t))throw Error(o(418));e=cr(n.nextSibling);var i=Io;e&&Do(t,e)?Ro(i,n):(t.flags=-4097&t.flags|2,Oo=!1,Io=t)}}else{if(Fo(t))throw Error(o(418));t.flags=-4097&t.flags|2,Oo=!1,Io=t}}}function jo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Io=t}function No(t){if(t!==Io)return!1;if(!Oo)return jo(t),Oo=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!nr(t.type,t.memoizedProps)),e&&(e=Lo)){if(Fo(t)){for(t=Lo;t;)t=cr(t.nextSibling);throw Error(o(418))}for(;e;)Ro(t,e),e=cr(e.nextSibling)}if(jo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){Lo=cr(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}Lo=null}}else Lo=Io?cr(t.stateNode.nextSibling):null;return!0}function Vo(){Lo=Io=null,Oo=!1}function Uo(t){null===zo?zo=[t]:zo.push(t)}function Wo(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,t));var r=i,a=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===a?e.ref:(e=function(t){var e=r.refs;e===uo&&(e=r.refs={}),null===t?delete e[a]:e[a]=t},e._stringRef=a,e)}if("string"!==typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function Go(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qo(t){return(0,t._init)(t._payload)}function Zo(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Lc(t,e)).index=0,t.sibling=null,t}function a(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Dc(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function c(t,e,n,i){var o=n.type;return o===S?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===L&&qo(o)===e.type)?((i=r(e,n.props)).ref=Wo(t,e,n),i.return=t,i):((i=Oc(n.type,n.key,n.props,null,t.mode,i)).ref=Wo(t,e,n),i.return=t,i)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Fc(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,o){return null===e||7!==e.tag?((e=zc(n,t.mode,i,o)).return=t,e):((e=r(e,n)).return=t,e)}function p(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Dc(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Oc(e.type,e.key,e.props,null,t.mode,n)).ref=Wo(t,null,e),n.return=t,n;case w:return(e=Fc(e,t.mode,n)).return=t,e;case L:return p(t,(0,e._init)(e._payload),n)}if(et(e)||R(e))return(e=zc(e,t.mode,n,null)).return=t,e;Go(t,e)}return null}function d(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?c(t,e,n,i):null;case w:return n.key===r?u(t,e,n,i):null;case L:return d(t,e,(r=n._init)(n._payload),i)}if(et(n)||R(n))return null!==r?null:h(t,e,n,i,null);Go(t,n)}return null}function f(t,e,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case x:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r);case w:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case L:return f(t,e,n,(0,i._init)(i._payload),r)}if(et(i)||R(i))return h(e,t=t.get(n)||null,i,r,null);Go(e,i)}return null}function g(r,o,s,l){for(var c=null,u=null,h=o,g=o=0,m=null;null!==h&&g<s.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var y=d(r,h,s[g],l);if(null===y){null===h&&(h=m);break}t&&h&&null===y.alternate&&e(r,h),o=a(y,o,g),null===u?c=y:u.sibling=y,u=y,h=m}if(g===s.length)return n(r,h),Oo&&ko(r,g),c;if(null===h){for(;g<s.length;g++)null!==(h=p(r,s[g],l))&&(o=a(h,o,g),null===u?c=h:u.sibling=h,u=h);return Oo&&ko(r,g),c}for(h=i(r,h);g<s.length;g++)null!==(m=f(h,r,g,s[g],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),o=a(m,o,g),null===u?c=m:u.sibling=m,u=m);return t&&h.forEach((function(t){return e(r,t)})),Oo&&ko(r,g),c}function m(r,s,l,c){var u=R(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,g=s,m=s=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var _=d(r,g,v.value,c);if(null===_){null===g&&(g=y);break}t&&g&&null===_.alternate&&e(r,g),s=a(_,s,m),null===h?u=_:h.sibling=_,h=_,g=y}if(v.done)return n(r,g),Oo&&ko(r,m),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=p(r,v.value,c))&&(s=a(v,s,m),null===h?u=v:h.sibling=v,h=v);return Oo&&ko(r,m),u}for(g=i(r,g);!v.done;m++,v=l.next())null!==(v=f(g,r,m,v.value,c))&&(t&&null!==v.alternate&&g.delete(null===v.key?m:v.key),s=a(v,s,m),null===h?u=v:h.sibling=v,h=v);return t&&g.forEach((function(t){return e(r,t)})),Oo&&ko(r,m),u}return function t(i,o,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:t:{for(var c=a.key,u=o;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(i,u.sibling),(o=r(u,a.props.children)).return=i,i=o;break t}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===L&&qo(c)===u.type){n(i,u.sibling),(o=r(u,a.props)).ref=Wo(i,u,a),o.return=i,i=o;break t}n(i,u);break}e(i,u),u=u.sibling}a.type===S?((o=zc(a.props.children,i.mode,l,a.key)).return=i,i=o):((l=Oc(a.type,a.key,a.props,null,i.mode,l)).ref=Wo(i,o,a),l.return=i,i=l)}return s(i);case w:t:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(i,o.sibling),(o=r(o,a.children||[])).return=i,i=o;break t}n(i,o);break}e(i,o),o=o.sibling}(o=Fc(a,i.mode,l)).return=i,i=o}return s(i);case L:return t(i,o,(u=a._init)(a._payload),l)}if(et(a))return g(i,o,a,l);if(R(a))return m(i,o,a,l);Go(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,a)).return=i,i=o):(n(i,o),(o=Dc(a,i.mode,l)).return=i,i=o),s(i)):n(i,o)}}var Ho=Zo(!0),Xo=Zo(!1),Yo={},Ko=Pr(Yo),Jo=Pr(Yo),Qo=Pr(Yo);function $o(t){if(t===Yo)throw Error(o(174));return t}function ta(t,e){switch(Tr(Qo,e),Tr(Jo,t),Tr(Ko,Yo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Er(Ko),Tr(Ko,e)}function ea(){Er(Ko),Er(Jo),Er(Qo)}function na(t){$o(Qo.current);var e=$o(Ko.current),n=lt(e,t.type);e!==n&&(Tr(Jo,t),Tr(Ko,n))}function ia(t){Jo.current===t&&(Er(Ko),Er(Jo))}var ra=Pr(0);function oa(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var aa=[];function sa(){for(var t=0;t<aa.length;t++)aa[t]._workInProgressVersionPrimary=null;aa.length=0}var la=b.ReactCurrentDispatcher,ca=b.ReactCurrentBatchConfig,ua=0,ha=null,pa=null,da=null,fa=!1,ga=!1,ma=0,ya=0;function va(){throw Error(o(321))}function _a(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!si(t[n],e[n]))return!1;return!0}function ba(t,e,n,i,r,a){if(ua=a,ha=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,la.current=null===t||null===t.memoizedState?is:rs,t=n(i,r),ga){a=0;do{if(ga=!1,ma=0,25<=a)throw Error(o(301));a+=1,da=pa=null,e.updateQueue=null,la.current=os,t=n(i,r)}while(ga)}if(la.current=ns,e=null!==pa&&null!==pa.next,ua=0,da=pa=ha=null,fa=!1,e)throw Error(o(300));return t}function xa(){var t=0!==ma;return ma=0,t}function wa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===da?ha.memoizedState=da=t:da=da.next=t,da}function Sa(){if(null===pa){var t=ha.alternate;t=null!==t?t.memoizedState:null}else t=pa.next;var e=null===da?ha.memoizedState:da.next;if(null!==e)da=e,pa=t;else{if(null===t)throw Error(o(310));t={memoizedState:(pa=t).memoizedState,baseState:pa.baseState,baseQueue:pa.baseQueue,queue:pa.queue,next:null},null===da?ha.memoizedState=da=t:da=da.next=t}return da}function Pa(t,e){return"function"===typeof e?e(t):e}function Ea(t){var e=Sa(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=pa,r=i.baseQueue,a=n.pending;if(null!==a){if(null!==r){var s=r.next;r.next=a.next,a.next=s}i.baseQueue=r=a,n.pending=null}if(null!==r){a=r.next,i=i.baseState;var l=s=null,c=null,u=a;do{var h=u.lane;if((ua&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=p,s=i):c=c.next=p,ha.lanes|=h,Ol|=h}u=u.next}while(null!==u&&u!==a);null===c?s=i:c.next=l,si(i,e.memoizedState)||(xs=!0),e.memoizedState=i,e.baseState=s,e.baseQueue=c,n.lastRenderedState=i}if(null!==(t=n.interleaved)){r=t;do{a=r.lane,ha.lanes|=a,Ol|=a,r=r.next}while(r!==t)}else null===r&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ta(t){var e=Sa(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{a=t(a,s.action),s=s.next}while(s!==r);si(a,e.memoizedState)||(xs=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function ka(){}function Aa(t,e){var n=ha,i=Sa(),r=e(),a=!si(i.memoizedState,r);if(a&&(i.memoizedState=r,xs=!0),i=i.queue,ja(Ia.bind(null,n,i,t),[t]),i.getSnapshot!==e||a||null!==da&&1&da.memoizedState.tag){if(n.flags|=2048,za(9,Ma.bind(null,n,i,r,e),void 0,null),null===Tl)throw Error(o(349));0!==(30&ua)||Ca(n,e,r)}return r}function Ca(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=ha.updateQueue)?(e={lastEffect:null,stores:null},ha.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Ma(t,e,n,i){e.value=n,e.getSnapshot=i,La(e)&&$l(t,1,-1)}function Ia(t,e,n){return n((function(){La(e)&&$l(t,1,-1)}))}function La(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!si(t,n)}catch(i){return!0}}function Oa(t){var e=wa();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:t},e.queue=t,t=t.dispatch=Ja.bind(null,ha,t),[e.memoizedState,t]}function za(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=ha.updateQueue)?(e={lastEffect:null,stores:null},ha.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function Ra(){return Sa().memoizedState}function Da(t,e,n,i){var r=wa();ha.flags|=t,r.memoizedState=za(1|e,n,void 0,void 0===i?null:i)}function Fa(t,e,n,i){var r=Sa();i=void 0===i?null:i;var o=void 0;if(null!==pa){var a=pa.memoizedState;if(o=a.destroy,null!==i&&_a(i,a.deps))return void(r.memoizedState=za(e,n,o,i))}ha.flags|=t,r.memoizedState=za(1|e,n,o,i)}function Ba(t,e){return Da(8390656,8,t,e)}function ja(t,e){return Fa(2048,8,t,e)}function Na(t,e){return Fa(4,2,t,e)}function Va(t,e){return Fa(4,4,t,e)}function Ua(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Wa(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Fa(4,4,Ua.bind(null,e,t),n)}function Ga(){}function qa(t,e){var n=Sa();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&_a(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Za(t,e){var n=Sa();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&_a(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Ha(t,e,n){return 0===(21&ua)?(t.baseState&&(t.baseState=!1,xs=!0),t.memoizedState=n):(si(n,e)||(n=ge(),ha.lanes|=n,Ol|=n,t.baseState=!0),e)}function Xa(t,e){var n=_e;_e=0!==n&&4>n?n:4,t(!0);var i=ca.transition;ca.transition={};try{t(!1),e()}finally{_e=n,ca.transition=i}}function Ya(){return Sa().memoizedState}function Ka(t,e,n){var i=Ql(t);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(t)?$a(e,n):(ts(t,e,n),null!==(t=$l(t,i,n=Jl()))&&es(t,e,i))}function Ja(t,e,n){var i=Ql(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(t))$a(e,r);else{ts(t,e,r);var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var a=e.lastRenderedState,s=o(a,n);if(r.hasEagerState=!0,r.eagerState=s,si(s,a))return}catch(l){}null!==(t=$l(t,i,n=Jl()))&&es(t,e,i)}}function Qa(t){var e=t.alternate;return t===ha||null!==e&&e===ha}function $a(t,e){ga=fa=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ts(t,e,n){ec(t)?(null===(t=e.interleaved)?(n.next=n,null===to?to=[e]:to.push(e)):(n.next=t.next,t.next=n),e.interleaved=n):(null===(t=e.pending)?n.next=n:(n.next=t.next,t.next=n),e.pending=n)}function es(t,e,n){if(0!==(4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ve(t,n)}}var ns={readContext:$r,useCallback:va,useContext:va,useEffect:va,useImperativeHandle:va,useInsertionEffect:va,useLayoutEffect:va,useMemo:va,useReducer:va,useRef:va,useState:va,useDebugValue:va,useDeferredValue:va,useTransition:va,useMutableSource:va,useSyncExternalStore:va,useId:va,unstable_isNewReconciler:!1},is={readContext:$r,useCallback:function(t,e){return wa().memoizedState=[t,void 0===e?null:e],t},useContext:$r,useEffect:Ba,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Da(4194308,4,Ua.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Da(4194308,4,t,e)},useInsertionEffect:function(t,e){return Da(4,2,t,e)},useMemo:function(t,e){var n=wa();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=wa();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Ka.bind(null,ha,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},wa().memoizedState=t},useState:Oa,useDebugValue:Ga,useDeferredValue:function(t){return wa().memoizedState=t},useTransition:function(){var t=Oa(!1),e=t[0];return t=Xa.bind(null,t[1]),wa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=ha,r=wa();if(Oo){if(void 0===n)throw Error(o(407));n=n()}else{if(n=e(),null===Tl)throw Error(o(349));0!==(30&ua)||Ca(i,e,n)}r.memoizedState=n;var a={value:n,getSnapshot:e};return r.queue=a,Ba(Ia.bind(null,i,a,t),[t]),i.flags|=2048,za(9,Ma.bind(null,i,a,n,e),void 0,null),n},useId:function(){var t=wa(),e=Tl.identifierPrefix;if(Oo){var n=To;e=":"+e+"R"+(n=(Eo&~(1<<32-ae(Eo)-1)).toString(32)+n),0<(n=ma++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=ya++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rs={readContext:$r,useCallback:qa,useContext:$r,useEffect:ja,useImperativeHandle:Wa,useInsertionEffect:Na,useLayoutEffect:Va,useMemo:Za,useReducer:Ea,useRef:Ra,useState:function(){return Ea(Pa)},useDebugValue:Ga,useDeferredValue:function(t){return Ha(Sa(),pa.memoizedState,t)},useTransition:function(){return[Ea(Pa)[0],Sa().memoizedState]},useMutableSource:ka,useSyncExternalStore:Aa,useId:Ya,unstable_isNewReconciler:!1},os={readContext:$r,useCallback:qa,useContext:$r,useEffect:ja,useImperativeHandle:Wa,useInsertionEffect:Na,useLayoutEffect:Va,useMemo:Za,useReducer:Ta,useRef:Ra,useState:function(){return Ta(Pa)},useDebugValue:Ga,useDeferredValue:function(t){var e=Sa();return null===pa?e.memoizedState=t:Ha(e,pa.memoizedState,t)},useTransition:function(){return[Ta(Pa)[0],Sa().memoizedState]},useMutableSource:ka,useSyncExternalStore:Aa,useId:Ya,unstable_isNewReconciler:!1};function as(t,e){try{var n="",i=e;do{n+=V(i),i=i.return}while(i);var r=n}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:r}}function ss(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var ls,cs,us,hs="function"===typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=ro(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Vl||(Vl=!0,Ul=i),ss(0,e)},n}function ds(t,e,n){(n=ro(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"===typeof i){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){ss(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ss(0,e),"function"!==typeof i&&(null===Wl?Wl=new Set([this]):Wl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function fs(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new hs;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Pc.bind(null,t,e,n),e.then(t,t))}function gs(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ms(t,e,n,i,r){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=ro(-1,1)).tag=2,oo(n,e))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}function ys(t,e){if(!Oo)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function vs(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function _s(t,e,n){var i=e.pendingProps;switch(Mo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vs(e),null;case 1:case 17:return Lr(e.type)&&Or(),vs(e),null;case 3:return i=e.stateNode,ea(),Er(Cr),Er(Ar),sa(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(No(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==zo&&(oc(zo),zo=null))),vs(e),null;case 5:ia(e);var r=$o(Qo.current);if(n=e.type,null!==t&&null!=e.stateNode)cs(t,e,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(o(166));return vs(e),null}if(t=$o(Ko.current),No(e)){i=e.stateNode,n=e.type;var a=e.memoizedProps;switch(i[pr]=e,i[dr]=a,t=0!==(1&e.mode),n){case"dialog":ji("cancel",i),ji("close",i);break;case"iframe":case"object":case"embed":ji("load",i);break;case"video":case"audio":for(r=0;r<Ri.length;r++)ji(Ri[r],i);break;case"source":ji("error",i);break;case"img":case"image":case"link":ji("error",i),ji("load",i);break;case"details":ji("toggle",i);break;case"input":K(i,a),ji("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},ji("invalid",i);break;case"textarea":rt(i,a),ji("invalid",i)}for(var l in vt(n,a),r=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qi(i.textContent,c,t),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qi(i.textContent,c,t),r=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&ji("scroll",i)}switch(n){case"input":Z(i),$(i,a,!0);break;case"textarea":Z(i),at(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=$i)}i=r,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[pr]=e,t[dr]=i,ls(t,e),e.stateNode=t;t:{switch(l=_t(n,i),n){case"dialog":ji("cancel",t),ji("close",t),r=i;break;case"iframe":case"object":case"embed":ji("load",t),r=i;break;case"video":case"audio":for(r=0;r<Ri.length;r++)ji(Ri[r],t);r=i;break;case"source":ji("error",t),r=i;break;case"img":case"image":case"link":ji("error",t),ji("load",t),r=i;break;case"details":ji("toggle",t),r=i;break;case"input":K(t,i),r=Y(t,i),ji("invalid",t);break;case"option":default:r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=F({},i,{value:void 0}),ji("invalid",t);break;case"textarea":rt(t,i),r=it(t,i),ji("invalid",t)}for(a in vt(n,r),c=r)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?mt(t,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&pt(t,u):"number"===typeof u&&pt(t,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&ji("scroll",t):null!=u&&_(t,a,u,l))}switch(n){case"input":Z(t),$(t,i,!1);break;case"textarea":Z(t),at(t);break;case"option":null!=i.value&&t.setAttribute("value",""+G(i.value));break;case"select":t.multiple=!!i.multiple,null!=(a=i.value)?nt(t,!!i.multiple,a,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(t.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return vs(e),null;case 6:if(t&&null!=e.stateNode)us(0,e,t.memoizedProps,i);else{if("string"!==typeof i&&null===e.stateNode)throw Error(o(166));if(n=$o(Qo.current),$o(Ko.current),No(e)){if(i=e.stateNode,n=e.memoizedProps,i[pr]=e,(a=i.nodeValue!==n)&&null!==(t=Io))switch(t.tag){case 3:Qi(i.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qi(i.nodeValue,n,0!==(1&t.mode))}a&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[pr]=e,e.stateNode=i}return vs(e),null;case 13:if(Er(ra),i=e.memoizedState,Oo&&null!==Lo&&0!==(1&e.mode)&&0===(128&e.flags)){for(i=Lo;i;)i=cr(i.nextSibling);return Vo(),e.flags|=98560,e}if(null!==i&&null!==i.dehydrated){if(i=No(e),null===t){if(!i)throw Error(o(318));if(!(i=null!==(i=e.memoizedState)?i.dehydrated:null))throw Error(o(317));i[pr]=e}else Vo(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;return vs(e),null}return null!==zo&&(oc(zo),zo=null),0!==(128&e.flags)?(e.lanes=n,e):(i=null!==i,n=!1,null===t?No(e):n=null!==t.memoizedState,i!==n&&i&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&ra.current)?0===Il&&(Il=3):fc())),null!==e.updateQueue&&(e.flags|=4),vs(e),null);case 4:return ea(),null===t&&Ui(e.stateNode.containerInfo),vs(e),null;case 10:return Kr(e.type._context),vs(e),null;case 19:if(Er(ra),null===(a=e.memoizedState))return vs(e),null;if(i=0!==(128&e.flags),null===(l=a.rendering))if(i)ys(a,!1);else{if(0!==Il||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=oa(t))){for(e.flags|=128,ys(a,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,t=l.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Tr(ra,1&ra.current|2),e.child}t=t.sibling}null!==a.tail&&Jt()>jl&&(e.flags|=128,i=!0,ys(a,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=oa(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),ys(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!Oo)return vs(e),null}else 2*Jt()-a.renderingStartTime>jl&&1073741824!==n&&(e.flags|=128,i=!0,ys(a,!1),e.lanes=4194304);a.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=a.last)?n.sibling=l:e.child=l,a.last=l)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Jt(),e.sibling=null,n=ra.current,Tr(ra,i?1&n|2:1&n),e):(vs(e),null);case 22:case 23:return uc(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&0!==(1&e.mode)?0!==(1073741824&Cl)&&(vs(e),6&e.subtreeFlags&&(e.flags|=8192)):vs(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}ls=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},cs=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,$o(Ko.current);var o,a=null;switch(n){case"input":r=Y(t,r),i=Y(t,i),a=[];break;case"select":r=F({},r,{value:void 0}),i=F({},i,{value:void 0}),a=[];break;case"textarea":r=it(t,r),i=it(t,i),a=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(t.onclick=$i)}for(u in vt(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&ji("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(e.updateQueue=u)&&(e.flags|=4)}},us=function(t,e,n,i){n!==i&&(e.flags|=4)};var bs=b.ReactCurrentOwner,xs=!1;function ws(t,e,n,i){e.child=null===t?Xo(e,null,n,i):Ho(e,t.child,n,i)}function Ss(t,e,n,i,r){n=n.render;var o=e.ref;return Qr(e,r),i=ba(t,e,n,i,o,r),n=xa(),null===t||xs?(Oo&&n&&Co(e),e.flags|=1,ws(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Gs(t,e,r))}function Ps(t,e,n,i,r){if(null===t){var o=n.type;return"function"!==typeof o||Ic(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Oc(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Es(t,e,o,i,r))}if(o=t.child,0===(t.lanes&r)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:li)(a,i)&&t.ref===e.ref)return Gs(t,e,r)}return e.flags|=1,(t=Lc(o,i)).ref=e.ref,t.return=e,e.child=t}function Es(t,e,n,i,r){if(null!==t){var o=t.memoizedProps;if(li(o,i)&&t.ref===e.ref){if(xs=!1,e.pendingProps=i=o,0===(t.lanes&r))return e.lanes=t.lanes,Gs(t,e,r);0!==(131072&t.flags)&&(xs=!0)}}return As(t,e,n,i,r)}function Ts(t,e,n){var i=e.pendingProps,r=i.children,o=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(Ml,Cl),Cl|=n;else{if(0===(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tr(Ml,Cl),Cl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Tr(Ml,Cl),Cl|=i}else null!==o?(i=o.baseLanes|n,e.memoizedState=null):i=n,Tr(Ml,Cl),Cl|=i;return ws(t,e,r,n),e.child}function ks(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function As(t,e,n,i,r){var o=Lr(n)?Mr:Ar.current;return o=Ir(e,o),Qr(e,r),n=ba(t,e,n,i,o,r),i=xa(),null===t||xs?(Oo&&i&&Co(e),e.flags|=1,ws(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Gs(t,e,r))}function Cs(t,e,n,i,r){if(Lr(n)){var o=!0;Dr(e)}else o=!1;if(Qr(e,r),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),go(e,n,i),yo(e,n,i,r),i=!0;else if(null===t){var a=e.stateNode,s=e.memoizedProps;a.props=s;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=$r(c):c=Ir(e,c=Lr(n)?Mr:Ar.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==i||l!==c)&&mo(e,a,i,c),eo=!1;var p=e.memoizedState;a.state=p,lo(e,i,a,r),l=e.memoizedState,s!==i||p!==l||Cr.current||eo?("function"===typeof u&&(ho(e,n,u,i),l=e.memoizedState),(s=eo||fo(e,n,s,i,p,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=c,i=s):("function"===typeof a.componentDidMount&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,io(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:Gr(e.type,s),a.props=c,h=e.pendingProps,p=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=$r(l):l=Ir(e,l=Lr(n)?Mr:Ar.current);var d=n.getDerivedStateFromProps;(u="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||p!==l)&&mo(e,a,i,l),eo=!1,p=e.memoizedState,a.state=p,lo(e,i,a,r);var f=e.memoizedState;s!==h||p!==f||Cr.current||eo?("function"===typeof d&&(ho(e,n,d,i),f=e.memoizedState),(c=eo||fo(e,n,c,i,p,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),i=!1)}return Ms(t,e,n,i,o,r)}function Ms(t,e,n,i,r,o){ks(t,e);var a=0!==(128&e.flags);if(!i&&!a)return r&&Fr(e,n,!1),Gs(t,e,o);i=e.stateNode,bs.current=e;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&a?(e.child=Ho(e,t.child,null,o),e.child=Ho(e,null,s,o)):ws(t,e,s,o),e.memoizedState=i.state,r&&Fr(e,n,!0),e.child}function Is(t){var e=t.stateNode;e.pendingContext?zr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&zr(0,e.context,!1),ta(t,e.containerInfo)}function Ls(t,e,n,i,r){return Vo(),Uo(r),e.flags|=256,ws(t,e,n,i),e.child}var Os={dehydrated:null,treeContext:null,retryLane:0};function zs(t){return{baseLanes:t,cachePool:null,transitions:null}}function Rs(t,e){return{baseLanes:t.baseLanes|e,cachePool:null,transitions:t.transitions}}function Ds(t,e,n){var i,r=e.pendingProps,a=ra.current,s=!1,l=0!==(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&0!==(2&a)),i?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(a|=1),Tr(ra,1&a),null===t)return Bo(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},0===(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=a):s=Rc(a,r,0,null),t=zc(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=zs(n),e.memoizedState=Os,t):Fs(e,a));if(null!==(a=t.memoizedState)){if(null!==(i=a.dehydrated)){if(l)return 256&e.flags?(e.flags&=-257,Ns(t,e,n,Error(o(422)))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(s=r.fallback,a=e.mode,r=Rc({mode:"visible",children:r.children},a,0,null),(s=zc(s,a,n,null)).flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,0!==(1&e.mode)&&Ho(e,t.child,null,n),e.child.memoizedState=zs(n),e.memoizedState=Os,s);if(0===(1&e.mode))e=Ns(t,e,n,null);else if("$!"===i.data)e=Ns(t,e,n,Error(o(419)));else if(r=0!==(n&t.childLanes),xs||r){if(null!==(r=Tl)){switch(n&-n){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(r=0!==(s&(r.suspendedLanes|n))?0:s)&&r!==a.retryLane&&(a.retryLane=r,$l(t,r,-1))}fc(),e=Ns(t,e,n,Error(o(421)))}else"$?"===i.data?(e.flags|=128,e.child=t.child,e=Tc.bind(null,t),i._reactRetry=e,e=null):(n=a.treeContext,Lo=cr(i.nextSibling),Io=e,Oo=!0,zo=null,null!==n&&(wo[So++]=Eo,wo[So++]=To,wo[So++]=Po,Eo=n.id,To=n.overflow,Po=e),(e=Fs(e,e.pendingProps.children)).flags|=4096);return e}return s?(r=js(t,e,r.children,r.fallback,n),s=e.child,a=t.child.memoizedState,s.memoizedState=null===a?zs(n):Rs(a,n),s.childLanes=t.childLanes&~n,e.memoizedState=Os,r):(n=Bs(t,e,r.children,n),e.memoizedState=null,n)}return s?(r=js(t,e,r.children,r.fallback,n),s=e.child,a=t.child.memoizedState,s.memoizedState=null===a?zs(n):Rs(a,n),s.childLanes=t.childLanes&~n,e.memoizedState=Os,r):(n=Bs(t,e,r.children,n),e.memoizedState=null,n)}function Fs(t,e){return(e=Rc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Bs(t,e,n,i){var r=t.child;return t=r.sibling,n=Lc(r,{mode:"visible",children:n}),0===(1&e.mode)&&(n.lanes=i),n.return=e,n.sibling=null,null!==t&&(null===(i=e.deletions)?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=n}function js(t,e,n,i,r){var o=e.mode,a=(t=t.child).sibling,s={mode:"hidden",children:n};return 0===(1&o)&&e.child!==t?((n=e.child).childLanes=0,n.pendingProps=s,e.deletions=null):(n=Lc(t,s)).subtreeFlags=14680064&t.subtreeFlags,null!==a?i=Lc(a,i):(i=zc(i,o,r,null)).flags|=2,i.return=e,n.return=e,n.sibling=i,e.child=n,i}function Ns(t,e,n,i){return null!==i&&Uo(i),Ho(e,t.child,null,n),(t=Fs(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Vs(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),Jr(t.return,e,n)}function Us(t,e,n,i,r){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Ws(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(ws(t,e,i.children,n),0!==(2&(i=ra.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Vs(t,n,e);else if(19===t.tag)Vs(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Tr(ra,i),0===(1&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===oa(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Us(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===oa(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Us(e,!0,n,null,o);break;case"together":Us(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Ol|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Lc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Lc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function qs(t,e){switch(Mo(e),e.tag){case 1:return Lr(e.type)&&Or(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return ea(),Er(Cr),Er(Ar),sa(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return ia(e),null;case 13:if(Er(ra),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));Vo()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Er(ra),null;case 4:return ea(),null;case 10:return Kr(e.type._context),null;case 22:case 23:return uc(),null;default:return null}}var Zs=!1,Hs=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Ys=null;function Ks(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Sc(t,e,i)}else n.current=null}function Js(t,e,n){try{n()}catch(i){Sc(t,e,i)}}var Qs=!1;function $s(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,void 0!==o&&Js(e,n,o)}r=r.next}while(r!==i)}}function tl(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function el(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function nl(t){var e=t.alternate;null!==e&&(t.alternate=null,nl(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[pr],delete e[dr],delete e[gr],delete e[mr],delete e[yr])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function il(t){return 5===t.tag||3===t.tag||4===t.tag}function rl(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||il(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ol(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=$i));else if(4!==i&&null!==(t=t.child))for(ol(t,e,n),t=t.sibling;null!==t;)ol(t,e,n),t=t.sibling}function al(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(al(t,e,n),t=t.sibling;null!==t;)al(t,e,n),t=t.sibling}var sl=null,ll=!1;function cl(t,e,n){for(n=n.child;null!==n;)ul(t,e,n),n=n.sibling}function ul(t,e,n){if(oe&&"function"===typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(re,n)}catch(s){}switch(n.tag){case 5:Hs||Ks(n,e);case 6:var i=sl,r=ll;sl=null,cl(t,e,n),ll=r,null!==(sl=i)&&(ll?(t=sl,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):sl.removeChild(n.stateNode));break;case 18:null!==sl&&(ll?(t=sl,n=n.stateNode,8===t.nodeType?lr(t.parentNode,n):1===t.nodeType&&lr(t,n),Ue(t)):lr(sl,n.stateNode));break;case 4:i=sl,r=ll,sl=n.stateNode.containerInfo,ll=!0,cl(t,e,n),sl=i,ll=r;break;case 0:case 11:case 14:case 15:if(!Hs&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var o=r,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&Js(n,e,a),r=r.next}while(r!==i)}cl(t,e,n);break;case 1:if(!Hs&&(Ks(n,e),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(s){Sc(n,e,s)}cl(t,e,n);break;case 21:cl(t,e,n);break;case 22:1&n.mode?(Hs=(i=Hs)||null!==n.memoizedState,cl(t,e,n),Hs=i):cl(t,e,n);break;default:cl(t,e,n)}}function hl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Xs),e.forEach((function(e){var i=kc.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function pl(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var a=t,s=e,l=s;t:for(;null!==l;){switch(l.tag){case 5:sl=l.stateNode,ll=!1;break t;case 3:case 4:sl=l.stateNode.containerInfo,ll=!0;break t}l=l.return}if(null===sl)throw Error(o(160));ul(a,s,r),sl=null,ll=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Sc(r,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)dl(e,t),e=e.sibling}function dl(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pl(e,t),fl(t),4&i){try{$s(3,t,t.return),tl(3,t)}catch(g){Sc(t,t.return,g)}try{$s(5,t,t.return)}catch(g){Sc(t,t.return,g)}}break;case 1:pl(e,t),fl(t),512&i&&null!==n&&Ks(n,n.return);break;case 5:if(pl(e,t),fl(t),512&i&&null!==n&&Ks(n,n.return),32&t.flags){var r=t.stateNode;try{pt(r,"")}catch(g){Sc(t,t.return,g)}}if(4&i&&null!=(r=t.stateNode)){var a=t.memoizedProps,s=null!==n?n.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(r,a),_t(l,s);var u=_t(l,a);for(s=0;s<c.length;s+=2){var h=c[s],p=c[s+1];"style"===h?mt(r,p):"dangerouslySetInnerHTML"===h?ht(r,p):"children"===h?pt(r,p):_(r,h,p,u)}switch(l){case"input":Q(r,a);break;case"textarea":ot(r,a);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?nt(r,!!a.multiple,f,!1):d!==!!a.multiple&&(null!=a.defaultValue?nt(r,!!a.multiple,a.defaultValue,!0):nt(r,!!a.multiple,a.multiple?[]:"",!1))}r[dr]=a}catch(g){Sc(t,t.return,g)}}break;case 6:if(pl(e,t),fl(t),4&i){if(null===t.stateNode)throw Error(o(162));u=t.stateNode,h=t.memoizedProps;try{u.nodeValue=h}catch(g){Sc(t,t.return,g)}}break;case 3:if(pl(e,t),fl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ue(e.containerInfo)}catch(g){Sc(t,t.return,g)}break;case 4:default:pl(e,t),fl(t);break;case 13:pl(e,t),fl(t),8192&(u=t.child).flags&&null!==u.memoizedState&&(null===u.alternate||null===u.alternate.memoizedState)&&(Bl=Jt()),4&i&&hl(t);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&t.mode?(Hs=(h=Hs)||u,pl(e,t),Hs=h):pl(e,t),fl(t),8192&i){h=null!==t.memoizedState;t:for(p=null,d=t;;){if(5===d.tag){if(null===p){p=d;try{r=d.stateNode,h?"function"===typeof(a=r.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=gt("display",s))}catch(g){Sc(t,t.return,g)}}}else if(6===d.tag){if(null===p)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(g){Sc(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;p===d&&(p=null),d=d.return}p===d&&(p=null),d.sibling.return=d.return,d=d.sibling}if(h&&!u&&0!==(1&t.mode))for(Ys=t,t=t.child;null!==t;){for(u=Ys=t;null!==Ys;){switch(p=(h=Ys).child,h.tag){case 0:case 11:case 14:case 15:$s(4,h,h.return);break;case 1:if(Ks(h,h.return),"function"===typeof(a=h.stateNode).componentWillUnmount){d=h,f=h.return;try{r=d,a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(g){Sc(d,f,g)}}break;case 5:Ks(h,h.return);break;case 22:if(null!==h.memoizedState){vl(u);continue}}null!==p?(p.return=h,Ys=p):vl(u)}t=t.sibling}}break;case 19:pl(e,t),fl(t),4&i&&hl(t);case 21:}}function fl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(il(n)){var i=n;break t}n=n.return}throw Error(o(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(pt(r,""),i.flags&=-33),al(t,rl(t),r);break;case 3:case 4:var a=i.stateNode.containerInfo;ol(t,rl(t),a);break;default:throw Error(o(161))}}catch(s){Sc(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function gl(t,e,n){Ys=t,ml(t,e,n)}function ml(t,e,n){for(var i=0!==(1&t.mode);null!==Ys;){var r=Ys,o=r.child;if(22===r.tag&&i){var a=null!==r.memoizedState||Zs;if(!a){var s=r.alternate,l=null!==s&&null!==s.memoizedState||Hs;s=Zs;var c=Hs;if(Zs=a,(Hs=l)&&!c)for(Ys=r;null!==Ys;)l=(a=Ys).child,22===a.tag&&null!==a.memoizedState?_l(r):null!==l?(l.return=a,Ys=l):_l(r);for(;null!==o;)Ys=o,ml(o,e,n),o=o.sibling;Ys=r,Zs=s,Hs=c}yl(t)}else 0!==(8772&r.subtreeFlags)&&null!==o?(o.return=r,Ys=o):yl(t)}}function yl(t){for(;null!==Ys;){var e=Ys;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Hs||tl(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Hs)if(null===n)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Gr(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;null!==a&&co(e,a,i);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}co(e,s,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var p=h.dehydrated;null!==p&&Ue(p)}}}break;default:throw Error(o(163))}Hs||512&e.flags&&el(e)}catch(d){Sc(e,e.return,d)}}if(e===t){Ys=null;break}if(null!==(n=e.sibling)){n.return=e.return,Ys=n;break}Ys=e.return}}function vl(t){for(;null!==Ys;){var e=Ys;if(e===t){Ys=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Ys=n;break}Ys=e.return}}function _l(t){for(;null!==Ys;){var e=Ys;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{tl(4,e)}catch(l){Sc(e,n,l)}break;case 1:var i=e.stateNode;if("function"===typeof i.componentDidMount){var r=e.return;try{i.componentDidMount()}catch(l){Sc(e,r,l)}}var o=e.return;try{el(e)}catch(l){Sc(e,o,l)}break;case 5:var a=e.return;try{el(e)}catch(l){Sc(e,a,l)}}}catch(l){Sc(e,e.return,l)}if(e===t){Ys=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Ys=s;break}Ys=e.return}}var bl,xl=Math.ceil,wl=b.ReactCurrentDispatcher,Sl=b.ReactCurrentOwner,Pl=b.ReactCurrentBatchConfig,El=0,Tl=null,kl=null,Al=0,Cl=0,Ml=Pr(0),Il=0,Ll=null,Ol=0,zl=0,Rl=0,Dl=null,Fl=null,Bl=0,jl=1/0,Nl=null,Vl=!1,Ul=null,Wl=null,Gl=!1,ql=null,Zl=0,Hl=0,Xl=null,Yl=-1,Kl=0;function Jl(){return 0!==(6&El)?Jt():-1!==Yl?Yl:Yl=Jt()}function Ql(t){return 0===(1&t.mode)?1:0!==(2&El)&&0!==Al?Al&-Al:null!==Wr.transition?(0===Kl&&(Kl=ge()),Kl):0!==(t=_e)?t:t=void 0===(t=window.event)?16:Ke(t.type)}function $l(t,e,n){if(50<Hl)throw Hl=0,Xl=null,Error(o(185));var i=tc(t,e);return null===i?null:(ye(i,e,n),0!==(2&El)&&i===Tl||(i===Tl&&(0===(2&El)&&(zl|=e),4===Il&&ac(i,Al)),nc(i,n),1===e&&0===El&&0===(1&t.mode)&&(jl=Jt()+500,jr&&Ur())),i)}function tc(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function ec(t){return(null!==Tl||null!==to)&&0!==(1&t.mode)&&0===(2&El)}function nc(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-ae(o),s=1<<a,l=r[a];-1===l?0!==(s&n)&&0===(s&i)||(r[a]=de(s,e)):l<=e&&(t.expiredLanes|=s),o&=~s}}(t,e);var i=pe(t,t===Tl?Al:0);if(0===i)null!==n&&Xt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&Xt(n),1===e)0===t.tag?function(t){jr=!0,Vr(t)}(sc.bind(null,t)):Vr(sc.bind(null,t)),ar((function(){0===El&&Ur()})),n=null;else{switch(be(i)){case 1:n=$t;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=Ac(n,ic.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ic(t,e){if(Yl=-1,Kl=0,0!==(6&El))throw Error(o(327));var n=t.callbackNode;if(xc()&&t.callbackNode!==n)return null;var i=pe(t,t===Tl?Al:0);if(0===i)return null;if(0!==(30&i)||0!==(i&t.expiredLanes)||e)e=gc(t,i);else{e=i;var r=El;El|=2;var a=dc();for(Tl===t&&Al===e||(Nl=null,jl=Jt()+500,hc(t,e));;)try{yc();break}catch(l){pc(t,l)}Yr(),wl.current=a,El=r,null!==kl?e=0:(Tl=null,Al=0,e=Il)}if(0!==e){if(2===e&&(0!==(r=fe(t))&&(i=r,e=rc(t,r))),1===e)throw n=Ll,hc(t,0),ac(t,i),nc(t,Jt()),n;if(6===e)ac(t,i);else{if(r=t.current.alternate,0===(30&i)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!si(o(),r))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)&&(2===(e=gc(t,i))&&(0!==(a=fe(t))&&(i=a,e=rc(t,a))),1===e))throw n=Ll,hc(t,0),ac(t,i),nc(t,Jt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(o(345));case 2:case 5:bc(t,Fl,Nl);break;case 3:if(ac(t,i),(130023424&i)===i&&10<(e=Bl+500-Jt())){if(0!==pe(t,0))break;if(((r=t.suspendedLanes)&i)!==i){Jl(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(bc.bind(null,t,Fl,Nl),e);break}bc(t,Fl,Nl);break;case 4:if(ac(t,i),(4194240&i)===i)break;for(e=t.eventTimes,r=-1;0<i;){var s=31-ae(i);a=1<<s,(s=e[s])>r&&(r=s),i&=~a}if(i=r,10<(i=(120>(i=Jt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*xl(i/1960))-i)){t.timeoutHandle=ir(bc.bind(null,t,Fl,Nl),i);break}bc(t,Fl,Nl);break;default:throw Error(o(329))}}}return nc(t,Jt()),t.callbackNode===n?ic.bind(null,t):null}function rc(t,e){var n=Dl;return t.current.memoizedState.isDehydrated&&(hc(t,e).flags|=256),2!==(t=gc(t,e))&&(e=Fl,Fl=n,null!==e&&oc(e)),t}function oc(t){null===Fl?Fl=t:Fl.push.apply(Fl,t)}function ac(t,e){for(e&=~Rl,e&=~zl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ae(e),i=1<<n;t[n]=-1,e&=~i}}function sc(t){if(0!==(6&El))throw Error(o(327));xc();var e=pe(t,0);if(0===(1&e))return nc(t,Jt()),null;var n=gc(t,e);if(0!==t.tag&&2===n){var i=fe(t);0!==i&&(e=i,n=rc(t,i))}if(1===n)throw n=Ll,hc(t,0),ac(t,e),nc(t,Jt()),n;if(6===n)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bc(t,Fl,Nl),nc(t,Jt()),null}function lc(t,e){var n=El;El|=1;try{return t(e)}finally{0===(El=n)&&(jl=Jt()+500,jr&&Ur())}}function cc(t){null!==ql&&0===ql.tag&&0===(6&El)&&xc();var e=El;El|=1;var n=Pl.transition,i=_e;try{if(Pl.transition=null,_e=1,t)return t()}finally{_e=i,Pl.transition=n,0===(6&(El=e))&&Ur()}}function uc(){Cl=Ml.current,Er(Ml)}function hc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,rr(n)),null!==kl)for(n=kl.return;null!==n;){var i=n;switch(Mo(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Or();break;case 3:ea(),Er(Cr),Er(Ar),sa();break;case 5:ia(i);break;case 4:ea();break;case 13:case 19:Er(ra);break;case 10:Kr(i.type._context);break;case 22:case 23:uc()}n=n.return}if(Tl=t,kl=t=Lc(t.current,null),Al=Cl=e,Il=0,Ll=null,Rl=zl=Ol=0,Fl=Dl=null,null!==to){for(e=0;e<to.length;e++)if(null!==(i=(n=to[e]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var a=o.next;o.next=r,i.next=a}n.pending=i}to=null}return t}function pc(t,e){for(;;){var n=kl;try{if(Yr(),la.current=ns,fa){for(var i=ha.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}fa=!1}if(ua=0,da=pa=ha=null,ga=!1,ma=0,Sl.current=null,null===n||null===n.return){Il=1,Ll=e,kl=null;break}t:{var a=t,s=n.return,l=n,c=e;if(e=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,p=h.tag;if(0===(1&h.mode)&&(0===p||11===p||15===p)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,ms(f,s,l,0,e),1&f.mode&&fs(a,u,e),c=u;var g=(e=f).updateQueue;if(null===g){var m=new Set;m.add(c),e.updateQueue=m}else g.add(c);break t}if(0===(1&e)){fs(a,u,e),fc();break t}c=Error(o(426))}else if(Oo&&1&l.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ms(y,s,l,0,e),Uo(c);break t}}a=c,4!==Il&&(Il=2),null===Dl?Dl=[a]:Dl.push(a),c=as(c,l),l=s;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e,so(l,ps(0,c,e));break t;case 1:a=c;var v=l.type,_=l.stateNode;if(0===(128&l.flags)&&("function"===typeof v.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Wl||!Wl.has(_)))){l.flags|=65536,e&=-e,l.lanes|=e,so(l,ds(l,a,e));break t}}l=l.return}while(null!==l)}_c(n)}catch(b){e=b,kl===n&&null!==n&&(kl=n=n.return);continue}break}}function dc(){var t=wl.current;return wl.current=ns,null===t?ns:t}function fc(){0!==Il&&3!==Il&&2!==Il||(Il=4),null===Tl||0===(268435455&Ol)&&0===(268435455&zl)||ac(Tl,Al)}function gc(t,e){var n=El;El|=2;var i=dc();for(Tl===t&&Al===e||(Nl=null,hc(t,e));;)try{mc();break}catch(r){pc(t,r)}if(Yr(),El=n,wl.current=i,null!==kl)throw Error(o(261));return Tl=null,Al=0,Il}function mc(){for(;null!==kl;)vc(kl)}function yc(){for(;null!==kl&&!Yt();)vc(kl)}function vc(t){var e=bl(t.alternate,t,Cl);t.memoizedProps=t.pendingProps,null===e?_c(t):kl=e,Sl.current=null}function _c(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=_s(n,e,Cl)))return void(kl=n)}else{if(null!==(n=qs(n,e)))return n.flags&=32767,void(kl=n);if(null===t)return Il=6,void(kl=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(kl=e);kl=e=t}while(null!==e);0===Il&&(Il=5)}function bc(t,e,n){var i=_e,r=Pl.transition;try{Pl.transition=null,_e=1,function(t,e,n,i){do{xc()}while(null!==ql);if(0!==(6&El))throw Error(o(327));n=t.finishedWork;var r=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-ae(n),o=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~o}}(t,a),t===Tl&&(kl=Tl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Ac(ee,(function(){return xc(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Pl.transition,Pl.transition=null;var s=_e;_e=1;var l=El;El|=4,Sl.current=null,function(t,e){if(tr=Ge,di(t=pi())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break t}var s=0,l=-1,c=-1,u=0,h=0,p=t,d=null;e:for(;;){for(var f;p!==n||0!==r&&3!==p.nodeType||(l=s+r),p!==a||0!==i&&3!==p.nodeType||(c=s+i),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)d=p,p=f;for(;;){if(p===t)break e;if(d===n&&++u===r&&(l=s),d===a&&++h===i&&(c=s),null!==(f=p.nextSibling))break;d=(p=d).parentNode}p=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:t,selectionRange:n},Ge=!1,Ys=e;null!==Ys;)if(t=(e=Ys).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Ys=t;else for(;null!==Ys;){e=Ys;try{var g=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:Gr(e.type,m),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=e.stateNode.containerInfo;if(1===b.nodeType)b.textContent="";else if(9===b.nodeType){var x=b.body;null!=x&&(x.textContent="")}break;default:throw Error(o(163))}}catch(w){Sc(e,e.return,w)}if(null!==(t=e.sibling)){t.return=e.return,Ys=t;break}Ys=e.return}g=Qs,Qs=!1}(t,n),dl(n,t),fi(er),Ge=!!tr,er=tr=null,t.current=n,gl(n,t,r),Kt(),El=l,_e=s,Pl.transition=a}else t.current=n;if(Gl&&(Gl=!1,ql=t,Zl=r),0===(a=t.pendingLanes)&&(Wl=null),function(t){if(oe&&"function"===typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(re,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),nc(t,Jt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)i(e[n]);if(Vl)throw Vl=!1,t=Ul,Ul=null,t;0!==(1&Zl)&&0!==t.tag&&xc(),0!==(1&(a=t.pendingLanes))?t===Xl?Hl++:(Hl=0,Xl=t):Hl=0,Ur()}(t,e,n,i)}finally{Pl.transition=r,_e=i}return null}function xc(){if(null!==ql){var t=be(Zl),e=Pl.transition,n=_e;try{if(Pl.transition=null,_e=16>t?16:t,null===ql)var i=!1;else{if(t=ql,ql=null,Zl=0,0!==(6&El))throw Error(o(331));var r=El;for(El|=4,Ys=t.current;null!==Ys;){var a=Ys,s=a.child;if(0!==(16&Ys.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Ys=u;null!==Ys;){var h=Ys;switch(h.tag){case 0:case 11:case 15:$s(8,h,a)}var p=h.child;if(null!==p)p.return=h,Ys=p;else for(;null!==Ys;){var d=(h=Ys).sibling,f=h.return;if(nl(h),h===u){Ys=null;break}if(null!==d){d.return=f,Ys=d;break}Ys=f}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Ys=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Ys=s;else t:for(;null!==Ys;){if(0!==(2048&(a=Ys).flags))switch(a.tag){case 0:case 11:case 15:$s(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Ys=v;break t}Ys=a.return}}var _=t.current;for(Ys=_;null!==Ys;){var b=(s=Ys).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Ys=b;else t:for(s=_;null!==Ys;){if(0!==(2048&(l=Ys).flags))try{switch(l.tag){case 0:case 11:case 15:tl(9,l)}}catch(w){Sc(l,l.return,w)}if(l===s){Ys=null;break t}var x=l.sibling;if(null!==x){x.return=l.return,Ys=x;break t}Ys=l.return}}if(El=r,Ur(),oe&&"function"===typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(re,t)}catch(w){}i=!0}return i}finally{_e=n,Pl.transition=e}}return!1}function wc(t,e,n){oo(t,e=ps(0,e=as(n,e),1)),e=Jl(),null!==(t=tc(t,1))&&(ye(t,1,e),nc(t,e))}function Sc(t,e,n){if(3===t.tag)wc(t,t,n);else for(;null!==e;){if(3===e.tag){wc(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Wl||!Wl.has(i))){oo(e,t=ds(e,t=as(n,t),1)),t=Jl(),null!==(e=tc(e,1))&&(ye(e,1,t),nc(e,t));break}}e=e.return}}function Pc(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=Jl(),t.pingedLanes|=t.suspendedLanes&n,Tl===t&&(Al&n)===n&&(4===Il||3===Il&&(130023424&Al)===Al&&500>Jt()-Bl?hc(t,0):Rl|=n),nc(t,e)}function Ec(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var n=Jl();null!==(t=tc(t,e))&&(ye(t,e,n),nc(t,n))}function Tc(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Ec(t,n)}function kc(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(e),Ec(t,n)}function Ac(t,e){return Ht(t,e)}function Cc(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(t,e,n,i){return new Cc(t,e,n,i)}function Ic(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Lc(t,e){var n=t.alternate;return null===n?((n=Mc(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Oc(t,e,n,i,r,a){var s=2;if(i=t,"function"===typeof t)Ic(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case S:return zc(n.children,r,a,e);case P:s=8,r|=8;break;case E:return(t=Mc(12,n,e,2|r)).elementType=E,t.lanes=a,t;case C:return(t=Mc(13,n,e,r)).elementType=C,t.lanes=a,t;case M:return(t=Mc(19,n,e,r)).elementType=M,t.lanes=a,t;case O:return Rc(n,r,a,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case T:s=10;break t;case k:s=9;break t;case A:s=11;break t;case I:s=14;break t;case L:s=16,i=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Mc(s,n,e,r)).elementType=t,e.type=i,e.lanes=a,e}function zc(t,e,n,i){return(t=Mc(7,t,i,e)).lanes=n,t}function Rc(t,e,n,i){return(t=Mc(22,t,i,e)).elementType=O,t.lanes=n,t.stateNode={},t}function Dc(t,e,n){return(t=Mc(6,t,null,e)).lanes=n,t}function Fc(t,e,n){return(e=Mc(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Bc(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function jc(t,e,n,i,r,o,a,s,l){return t=new Bc(t,e,n,s,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Mc(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},no(o),t}function Nc(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}function Vc(t){if(!t)return kr;t:{if(Ut(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Lr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var n=t.type;if(Lr(n))return Rr(t,n,e)}return e}function Uc(t,e,n,i,r,o,a,s,l){return(t=jc(n,i,!0,t,0,o,0,s,l)).context=Vc(null),n=t.current,(o=ro(i=Jl(),r=Ql(n))).callback=void 0!==e&&null!==e?e:null,oo(n,o),t.current.lanes=r,ye(t,r,i),nc(t,i),t}function Wc(t,e,n,i){var r=e.current,o=Jl(),a=Ql(r);return n=Vc(n),null===e.context?e.context=n:e.pendingContext=n,(e=ro(o,a)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),oo(r,e),null!==(t=$l(r,a,o))&&ao(t,r,a),a}function Gc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function qc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Zc(t,e){qc(t,e),(t=t.alternate)&&qc(t,e)}bl=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Cr.current)xs=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return xs=!1,function(t,e,n){switch(e.tag){case 3:Is(e),Vo();break;case 5:na(e);break;case 1:Lr(e.type)&&Dr(e);break;case 4:ta(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Tr(qr,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Tr(ra,1&ra.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Ds(t,e,n):(Tr(ra,1&ra.current),null!==(t=Gs(t,e,n))?t.sibling:null);Tr(ra,1&ra.current);break;case 19:if(i=0!==(n&e.childLanes),0!==(128&t.flags)){if(i)return Ws(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Tr(ra,ra.current),i)break;return null;case 22:case 23:return e.lanes=0,Ts(t,e,n)}return Gs(t,e,n)}(t,e,n);xs=0!==(131072&t.flags)}else xs=!1,Oo&&0!==(1048576&e.flags)&&Ao(e,xo,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps;var r=Ir(e,Ar.current);Qr(e,n),r=ba(null,e,i,t,r,n);var a=xa();return e.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Lr(i)?(a=!0,Dr(e)):a=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,no(e),r.updater=po,e.stateNode=r,r._reactInternals=e,yo(e,i,t,n),e=Ms(null,e,i,!0,a,n)):(e.tag=0,Oo&&a&&Co(e),ws(null,e,r,n),e=e.child),e;case 16:i=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,i=(r=i._init)(i._payload),e.type=i,r=e.tag=function(t){if("function"===typeof t)return Ic(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===A)return 11;if(t===I)return 14}return 2}(i),t=Gr(i,t),r){case 0:e=As(null,e,i,t,n);break t;case 1:e=Cs(null,e,i,t,n);break t;case 11:e=Ss(null,e,i,t,n);break t;case 14:e=Ps(null,e,i,Gr(i.type,t),n);break t}throw Error(o(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,As(t,e,i,r=e.elementType===i?r:Gr(i,r),n);case 1:return i=e.type,r=e.pendingProps,Cs(t,e,i,r=e.elementType===i?r:Gr(i,r),n);case 3:t:{if(Is(e),null===t)throw Error(o(387));i=e.pendingProps,r=(a=e.memoizedState).element,io(t,e),lo(e,i,null,n);var s=e.memoizedState;if(i=s.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=Ls(t,e,i,n,r=Error(o(423)));break t}if(i!==r){e=Ls(t,e,i,n,r=Error(o(424)));break t}for(Lo=cr(e.stateNode.containerInfo.firstChild),Io=e,Oo=!0,zo=null,n=Xo(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Vo(),i===r){e=Gs(t,e,n);break t}ws(t,e,i,n)}e=e.child}return e;case 5:return na(e),null===t&&Bo(e),i=e.type,r=e.pendingProps,a=null!==t?t.memoizedProps:null,s=r.children,nr(i,r)?s=null:null!==a&&nr(i,a)&&(e.flags|=32),ks(t,e),ws(t,e,s,n),e.child;case 6:return null===t&&Bo(e),null;case 13:return Ds(t,e,n);case 4:return ta(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=Ho(e,null,i,n):ws(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,Ss(t,e,i,r=e.elementType===i?r:Gr(i,r),n);case 7:return ws(t,e,e.pendingProps,n),e.child;case 8:case 12:return ws(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,r=e.pendingProps,a=e.memoizedProps,s=r.value,Tr(qr,i._currentValue),i._currentValue=s,null!==a)if(si(a.value,s)){if(a.children===r.children&&!Cr.current){e=Gs(t,e,n);break t}}else for(null!==(a=e.child)&&(a.return=e);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===a.tag){(c=ro(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Jr(a.return,n,e),l.lanes|=n;break}c=c.next}}else if(10===a.tag)s=a.type===e.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Jr(s,n,e),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}ws(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Qr(e,n),i=i(r=$r(r)),e.flags|=1,ws(t,e,i,n),e.child;case 14:return r=Gr(i=e.type,e.pendingProps),Ps(t,e,i,r=Gr(i.type,r),n);case 15:return Es(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Gr(i,r),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,Lr(i)?(t=!0,Dr(e)):t=!1,Qr(e,n),go(e,i,r),yo(e,i,r,n),Ms(null,e,i,!0,t,n);case 19:return Ws(t,e,n);case 22:return Ts(t,e,n)}throw Error(o(156,e.tag))};var Hc="function"===typeof reportError?reportError:function(t){console.error(t)};function Xc(t){this._internalRoot=t}function Yc(t){this._internalRoot=t}function Kc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Jc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Qc(){}function $c(t,e,n,i,r){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof r){var s=r;r=function(){var t=Gc(a);s.call(t)}}Wc(e,a,t,r)}else a=function(t,e,n,i,r){if(r){if("function"===typeof i){var o=i;i=function(){var t=Gc(a);o.call(t)}}var a=Uc(e,i,t,0,null,!1,0,"",Qc);return t._reactRootContainer=a,t[fr]=a.current,Ui(8===t.nodeType?t.parentNode:t),cc(),a}for(;r=t.lastChild;)t.removeChild(r);if("function"===typeof i){var s=i;i=function(){var t=Gc(l);s.call(t)}}var l=jc(t,0,!1,null,0,!1,0,"",Qc);return t._reactRootContainer=l,t[fr]=l.current,Ui(8===t.nodeType?t.parentNode:t),cc((function(){Wc(e,l,n,i)})),l}(n,e,t,r,i);return Gc(a)}Yc.prototype.render=Xc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));Wc(t,e,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;cc((function(){Wc(null,t,null,null)})),e[fr]=null}},Yc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Pe();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oe.length&&0!==e&&e<Oe[n].priority;n++);Oe.splice(n,0,t),0===n&&Fe(t)}},xe=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ve(e,1|n),nc(e,Jt()),0===(6&El)&&(jl=Jt()+500,Ur()))}break;case 13:var i=Jl();cc((function(){return $l(t,1,i)})),Zc(t,1)}},we=function(t){13===t.tag&&($l(t,134217728,Jl()),Zc(t,134217728))},Se=function(t){if(13===t.tag){var e=Jl(),n=Ql(t);$l(t,n,e),Zc(t,n)}},Pe=function(){return _e},Ee=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}},wt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=xr(i);if(!r)throw Error(o(90));H(i),Q(i,r)}}}break;case"textarea":ot(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},At=lc,Ct=cc;var tu={usingClientEntryPoint:!1,Events:[_r,br,xr,Tt,kt,lc]},eu={findFiberByHostInstance:vr,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},nu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=qt(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{re=iu.inject(nu),oe=iu}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(e))throw Error(o(200));return Nc(t,e,null,n)},e.createRoot=function(t,e){if(!Kc(t))throw Error(o(299));var n=!1,i="",r=Hc;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(r=e.onRecoverableError)),e=jc(t,1,!1,null,0,n,0,i,r),t[fr]=e.current,Ui(8===t.nodeType?t.parentNode:t),new Xc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return t=null===(t=qt(e))?null:t.stateNode},e.flushSync=function(t){return cc(t)},e.hydrate=function(t,e,n){if(!Jc(e))throw Error(o(200));return $c(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Kc(t))throw Error(o(405));var i=null!=n&&n.hydratedSources||null,r=!1,a="",s=Hc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Uc(e,null,t,1,null!=n?n:null,r,0,a,s),t[fr]=e.current,Ui(t),i)for(t=0;t<i.length;t++)r=(r=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Yc(e)},e.render=function(t,e,n){if(!Jc(e))throw Error(o(200));return $c(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Jc(t))throw Error(o(40));return!!t._reactRootContainer&&(cc((function(){$c(null,null,t,!1,(function(){t._reactRootContainer=null,t[fr]=null}))})),!0)},e.unstable_batchedUpdates=lc,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Jc(n))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return $c(t,e,n,!1,i)},e.version="18.1.0-next-22edb9f77-20220426"},250:(t,e,n)=>{"use strict";var i=n(164);e.createRoot=i.createRoot,e.hydrateRoot=i.hydrateRoot},164:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(463)},302:function(t){t.exports=function(){"use strict";var t,e,n;function i(i,r){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),n=r(a),"undefined"!==typeof window&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=r;else t=r}return i(["exports"],(function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=i;function i(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}i.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},i.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},i.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},i.prototype.solveCurveX=function(t,e){var n,i,r,o,a;for(void 0===e&&(e=1e-6),r=t,a=0;a<8;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=o/s}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},i.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var r=o;function o(t,e){this.x=t,this.y=e}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var a="undefined"!=typeof self?self:{},s=Math.pow(2,53)-1;function l(t,e,i,r){var o=new n(t,e,i,r);return function(t){return o.solve(t)}}var c=l(.25,.1,.25,1);function u(t,e,n){return Math.min(n,Math.max(e,t))}function h(t,e,n){var i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r}function p(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}var d=1;function f(){return d++}function g(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function m(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function y(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function v(t,e){return-1!==t.indexOf(e,t.length-e.length)}function _(t,e,n){var i={};for(var r in t)i[r]=e.call(n||this,t[r],r,t);return i}function b(t,e,n){var i={};for(var r in t)e.call(n||this,t[r],r,t)&&(i[r]=t[r]);return i}function x(t){return Array.isArray(t)?t.map(x):"object"==typeof t&&t?_(t,x):t}var w={};function S(t){w[t]||("undefined"!=typeof console&&console.warn(t),w[t]=!0)}function P(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function E(t){for(var e=0,n=0,i=t.length,r=i-1,o=void 0,a=void 0;n<i;r=n++)e+=((a=t[r]).x-(o=t[n]).x)*(o.y+a.y);return e}function T(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function k(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,n,i,r){var o=i||r;return e[n]=!o||o.toLowerCase(),""})),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}var A=null;function C(t){if(null==A){var e=t.navigator?t.navigator.userAgent:null;A=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return A}function M(t){try{var e=a[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var I,L,O,z,R=a.performance&&a.performance.now?a.performance.now.bind(a.performance):Date.now.bind(Date),D=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,F=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.msCancelAnimationFrame,B={now:R,frame:function(t){var e=D(t);return{cancel:function(){return F(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var n=a.document.createElement("canvas"),i=n.getContext("2d");if(!i)throw new Error("failed to create canvas 2d context");return n.width=t.width,n.height=t.height,i.drawImage(t,0,0,t.width,t.height),i.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return I||(I=a.document.createElement("a")),I.href=t,I.href},hardwareConcurrency:a.navigator&&a.navigator.hardwareConcurrency||4,get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return!!a.matchMedia&&(null==L&&(L=a.matchMedia("(prefers-reduced-motion: reduce)")),L.matches)}},j={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},N={supported:!1,testSupport:function(t){!V&&z&&(U?W(t):O=t)}},V=!1,U=!1;function W(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,z),t.isContextLost())return;N.supported=!0}catch(t){}t.deleteTexture(e),V=!0}a.document&&((z=a.document.createElement("img")).onload=function(){O&&W(O),O=null,U=!0},z.onerror=function(){V=!0,O=null},z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var G="01",q=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function Z(t){return 0===t.indexOf("mapbox:")}q.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",G,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},q.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},q.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},q.prototype.normalizeStyleURL=function(t,e){if(!Z(t))return t;var n=K(t);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},q.prototype.normalizeGlyphsURL=function(t,e){if(!Z(t))return t;var n=K(t);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||e)},q.prototype.normalizeSourceURL=function(t,e){if(!Z(t))return t;var n=K(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||e)},q.prototype.normalizeSpriteURL=function(t,e,n,i){var r=K(t);return Z(t)?(r.path="/styles/v1"+r.path+"/sprite"+e+n,this._makeAPIURL(r,this._customAccessToken||i)):(r.path+=""+e+n,J(r))},q.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Z(t))return t;var n=K(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,(B.devicePixelRatio>=2||512===e?"@2x":"")+(N.supported?".webp":"$1")),n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/v4"+n.path;var i=this._customAccessToken||function(t){for(var e=0,n=t;e<n.length;e+=1){var i=n[e].match(/^access_token=(.*)$/);if(i)return i[1]}return null}(n.params)||j.ACCESS_TOKEN;return j.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&n.params.push("sku="+this._skuToken),this._makeAPIURL(n,i)},q.prototype.canonicalizeTileURL=function(t,e){var n=K(t);if(!n.path.match(/(^\/v4\/)/)||!n.path.match(/\.[\w]+$/))return t;var i="mapbox://tiles/";i+=n.path.replace("/v4/","");var r=n.params;return e&&(r=r.filter((function(t){return!t.match(/^access_token=/)}))),r.length&&(i+="?"+r.join("&")),i},q.prototype.canonicalizeTileset=function(t,e){for(var n=!!e&&Z(e),i=[],r=0,o=t.tiles||[];r<o.length;r+=1){var a=o[r];X(a)?i.push(this.canonicalizeTileURL(a,n)):i.push(a)}return i},q.prototype._makeAPIURL=function(t,e){var n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",i=K(j.API_URL);if(t.protocol=i.protocol,t.authority=i.authority,"http"===t.protocol){var r=t.params.indexOf("secure");r>=0&&t.params.splice(r,1)}if("/"!==i.path&&(t.path=""+i.path+t.path),!j.REQUIRE_ACCESS_TOKEN)return J(t);if(!(e=e||j.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n);return t.params=t.params.filter((function(t){return-1===t.indexOf("access_token")})),t.params.push("access_token="+e),J(t)};var H=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function X(t){return H.test(t)}var Y=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function K(t){var e=t.match(Y);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function J(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function Q(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(e[1]).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(t){return null}}var $=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(t){var e,n=Q(j.ACCESS_TOKEN);return e=n&&n.u?a.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))}))):j.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},$.prototype.fetchEventData=function(){var t=M("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{var i=a.localStorage.getItem(e);i&&(this.eventData=JSON.parse(i));var r=a.localStorage.getItem(n);r&&(this.anonId=r)}catch(t){S("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var t=M("localStorage"),e=this.getStorageKey(),n=this.getStorageKey("uuid");if(t)try{a.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&a.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){S("Unable to write to LocalStorage")}},$.prototype.processRequests=function(t){},$.prototype.postEvent=function(t,e,n,i){var r=this;if(j.EVENTS_URL){var o=K(j.EVENTS_URL);o.params.push("access_token="+(i||j.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:G,userId:this.anonId},s=e?p(a,e):a,l={url:J(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=xt(l,(function(t){r.pendingRequest=null,n(t),r.saveEventData(),r.processRequests(i)}))}},$.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var tt,et,nt=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(t,e,n,i){this.skuToken=n,(j.EVENTS_URL&&i||j.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||X(t)})))&&this.queueRequest({id:e,timestamp:Date.now()},i)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),i=n.id,r=n.timestamp;i&&this.success[i]||(this.anonId||this.fetchEventData(),m(this.anonId)||(this.anonId=g()),this.postEvent(r,{skuToken:this.skuToken},(function(t){t||i&&(e.success[i]=!0)}),t))}},e}($),it=new(function(t){function e(e){t.call(this,"appUserTurnstile"),this._customAccessToken=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(t,e){j.EVENTS_URL&&j.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||X(t)}))&&this.queueRequest(Date.now(),e)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var n=Q(j.ACCESS_TOKEN),i=n?n.u:j.ACCESS_TOKEN,r=i!==this.eventData.tokenU;m(this.anonId)||(this.anonId=g(),r=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),l=(o-this.eventData.lastSuccess)/864e5;r=r||l>=1||l<-1||a.getDate()!==s.getDate()}else r=!0;if(!r)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},(function(t){t||(e.eventData.lastSuccess=o,e.eventData.tokenU=i)}),t)}},e}($)),rt=it.postTurnstileEvent.bind(it),ot=new nt,at=ot.postMapLoadEvent.bind(ot),st=500,lt=50;function ct(){a.caches&&!tt&&(tt=a.caches.open("mapbox-tiles"))}function ut(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var ht,pt=1/0;function dt(){return null==ht&&(ht=a.OffscreenCanvas&&new a.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.createImageBitmap),ht}var ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ft);var gt,mt,yt=function(t){function e(e,n,i){401===n&&X(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,e),this.status=n,this.url=i,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),vt=T()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===a.location.protocol?a.parent:a).location.href},_t=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(vt())&&!/^\w+:/.test(n))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(t,e){var n,i=new a.AbortController,r=new a.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:vt(),signal:i.signal}),o=!1,s=!1,l=(n=r.url).indexOf("sku=")>0&&X(n);"json"===t.type&&r.headers.set("Accept","application/json");var c=function(n,i,o){if(!s){if(n&&"SecurityError"!==n.message&&S(n),i&&o)return u(i);var c=Date.now();a.fetch(r).then((function(n){if(n.ok){var i=l?n.clone():null;return u(n,i,c)}return e(new yt(n.statusText,n.status,t.url))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}},u=function(n,i,l){("arrayBuffer"===t.type?n.arrayBuffer():"json"===t.type?n.json():n.text()).then((function(t){s||(i&&l&&function(t,e,n){if(ct(),tt){var i={status:e.status,statusText:e.statusText,headers:new a.Headers};e.headers.forEach((function(t,e){return i.headers.set(e,t)}));var r=k(e.headers.get("Cache-Control")||"");r["no-store"]||(r["max-age"]&&i.headers.set("Expires",new Date(n+1e3*r["max-age"]).toUTCString()),new Date(i.headers.get("Expires")).getTime()-n<42e4||function(t,e){if(void 0===et)try{new Response(new ReadableStream),et=!0}catch(t){et=!1}et?e(t.body):t.blob().then(e)}(e,(function(e){var n=new a.Response(e,i);ct(),tt&&tt.then((function(e){return e.put(ut(t.url),n)})).catch((function(t){return S(t.message)}))})))}}(r,i,l),o=!0,e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(t){s||e(new Error(t.message))}))};return l?function(t,e){if(ct(),!tt)return e(null);var n=ut(t.url);tt.then((function(t){t.match(n).then((function(i){var r=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),n=k(t.headers.get("Cache-Control")||"");return e>Date.now()&&!n["no-cache"]}(i);t.delete(n),r&&t.put(n,i.clone()),e(null,i,r)})).catch(e)})).catch(e)}(r,c):c(null,null),{cancel:function(){s=!0,o||i.abort()}}}(t,e);if(T()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(t,e){var n=new a.XMLHttpRequest;for(var i in n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)n.setRequestHeader(i,t.headers[i]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var i=n.response;if("json"===t.type)try{i=JSON.parse(n.response)}catch(t){return e(t)}e(null,i,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new yt(n.statusText,n.status,t.url))},n.send(t.body),{cancel:function(){return n.abort()}}}(t,e)},bt=function(t,e){return _t(p(t,{type:"arrayBuffer"}),e)},xt=function(t,e){return _t(p(t,{method:"POST"}),e)},wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";gt=[],mt=0;var St=function(t,e){if(N.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),mt>=j.MAX_PARALLEL_IMAGE_REQUESTS){var n={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return gt.push(n),n}mt++;var i=!1,r=function(){if(!i)for(i=!0,mt--;gt.length&&mt<j.MAX_PARALLEL_IMAGE_REQUESTS;){var t=gt.shift();t.cancelled||(t.cancel=St(t.requestParameters,t.callback).cancel)}},o=bt(t,(function(t,n,i,o){r(),t?e(t):n&&(dt()?function(t,e){var n=new a.Blob([new Uint8Array(t)],{type:"image/png"});a.createImageBitmap(n).then((function(t){e(null,t)})).catch((function(t){e(new Error("Could not load image because of "+t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(n,e):function(t,e,n,i){var r=new a.Image,o=a.URL;r.onload=function(){e(null,r),o.revokeObjectURL(r.src),r.onload=null,a.requestAnimationFrame((function(){r.src=wt}))},r.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new a.Blob([new Uint8Array(t)],{type:"image/png"});r.cacheControl=n,r.expires=i,r.src=t.byteLength?o.createObjectURL(s):wt}(n,e,i,o))}));return{cancel:function(){o.cancel(),r()}}};function Pt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Et(t,e,n){if(n&&n[t]){var i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}var Tt=function(t,e){void 0===e&&(e={}),p(this,e),this.type=t},kt=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",p({error:e},n))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Tt),At=function(){};At.prototype.on=function(t,e){return this._listeners=this._listeners||{},Pt(t,e,this._listeners),this},At.prototype.off=function(t,e){return Et(t,e,this._listeners),Et(t,e,this._oneTimeListeners),this},At.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},Pt(t,e,this._oneTimeListeners),this},At.prototype.fire=function(t,e){"string"==typeof t&&(t=new Tt(t,e||{}));var n=t.type;if(this.listens(n)){t.target=this;for(var i=0,r=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];i<r.length;i+=1)r[i].call(this,t);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];o<a.length;o+=1){var s=a[o];Et(n,s,this._oneTimeListeners),s.call(this,t)}var l=this._eventedParent;l&&(p(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),l.fire(t))}else t instanceof kt&&console.error(t.error);return this},At.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},At.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var Ct={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Mt=function(t,e,n,i){this.message=(t?t+": ":"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)};function It(t){var e=t.value;return e?[new Mt(t.key,e,"constants have been deprecated as of v8")]:[]}function Lt(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];for(var a in o)t[a]=o[a]}return t}function Ot(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function zt(t){if(Array.isArray(t))return t.map(zt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var n in t)e[n]=zt(t[n]);return e}return Ot(t)}var Rt=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),Dt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,i=e;n<i.length;n+=1){var r=i[n];this.bindings[r[0]]=r[1]}};Dt.prototype.concat=function(t){return new Dt(this,t)},Dt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Dt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Ft={kind:"null"},Bt={kind:"number"},jt={kind:"string"},Nt={kind:"boolean"},Vt={kind:"color"},Ut={kind:"object"},Wt={kind:"value"},Gt={kind:"collator"},qt={kind:"formatted"},Zt={kind:"resolvedImage"};function Ht(t,e){return{kind:"array",itemType:t,N:e}}function Xt(t){if("array"===t.kind){var e=Xt(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Yt=[Ft,Bt,jt,Nt,Vt,qt,Ut,Ht(Wt),Zt];function Kt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Kt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,i=Yt;n<i.length;n+=1)if(!Kt(i[n],e))return null}return"Expected "+Xt(t)+" but found "+Xt(e)+" instead."}function Jt(t,e){return e.some((function(e){return e.kind===t.kind}))}function Qt(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var $t=e((function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(t){return(t=Math.round(t))<0?0:t>255?255:t}function r(t){return i("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function a(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,s=t.replace(/ /g,"").toLowerCase();if(s in n)return n[s].slice();if("#"===s[0])return 4===s.length?(e=parseInt(s.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===s.length&&(e=parseInt(s.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=s.indexOf("("),c=s.indexOf(")");if(-1!==l&&c+1===s.length){var u=s.substr(0,l),h=s.substr(l+1,c-(l+1)).split(","),p=1;switch(u){case"rgba":if(4!==h.length)return null;p=o(h.pop());case"rgb":return 3!==h.length?null:[r(h[0]),r(h[1]),r(h[2]),p];case"hsla":if(4!==h.length)return null;p=o(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,f=o(h[1]),g=o(h[2]),m=g<=.5?g*(f+1):g+f-g*f,y=2*g-m;return[i(255*a(y,m,d+1/3)),i(255*a(y,m,d)),i(255*a(y,m,d-1/3)),p];default:return null}}return null}}catch(t){}})).parseCSSColor,te=function(t,e,n,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=n,this.a=i};te.parse=function(t){if(t){if(t instanceof te)return t;if("string"==typeof t){var e=$t(t);if(e)return new te(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},te.prototype.toString=function(){var t=this.toArray(),e=t[1],n=t[2],i=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(n)+","+i+")"},te.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},te.black=new te(0,0,0,1),te.white=new te(1,1,1,1),te.transparent=new te(0,0,0,0),te.red=new te(1,0,0,1);var ee=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ee.prototype.compare=function(t,e){return this.collator.compare(t,e)},ee.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ne=function(t,e,n,i,r){this.text=t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r},ie=function(t){this.sections=t};ie.fromString=function(t){return new ie([new ne(t,null,null,null,null)])},ie.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},ie.factory=function(t){return t instanceof ie?t:ie.fromString(t)},ie.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},ie.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];if(i.image)t.push(["image",i.image.name]);else{t.push(i.text);var r={};i.fontStack&&(r["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(r["font-scale"]=i.scale),i.textColor&&(r["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(r)}}return t};var re=function(t){this.name=t.name,this.available=t.available};function oe(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value ["+[t,e,n,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ae(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof te)return!0;if(t instanceof ee)return!0;if(t instanceof ie)return!0;if(t instanceof re)return!0;if(Array.isArray(t)){for(var e=0,n=t;e<n.length;e+=1)if(!ae(n[e]))return!1;return!0}if("object"==typeof t){for(var i in t)if(!ae(t[i]))return!1;return!0}return!1}function se(t){if(null===t)return Ft;if("string"==typeof t)return jt;if("boolean"==typeof t)return Nt;if("number"==typeof t)return Bt;if(t instanceof te)return Vt;if(t instanceof ee)return Gt;if(t instanceof ie)return qt;if(t instanceof re)return Zt;if(Array.isArray(t)){for(var e,n=t.length,i=0,r=t;i<r.length;i+=1){var o=se(r[i]);if(e){if(e===o)continue;e=Wt;break}e=o}return Ht(e||Wt,n)}return Ut}function le(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof te||t instanceof ie||t instanceof re?t.toString():JSON.stringify(t)}re.prototype.toString=function(){return this.name},re.fromString=function(t){return t?new re({name:t,available:!1}):null},re.prototype.serialize=function(){return["image",this.name]};var ce=function(t,e){this.type=t,this.value=e};ce.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!ae(t[1]))return e.error("invalid value");var n=t[1],i=se(n),r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new ce(i,n)},ce.prototype.evaluate=function(){return this.value},ce.prototype.eachChild=function(){},ce.prototype.outputDefined=function(){return!0},ce.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof te?["rgba"].concat(this.value.toArray()):this.value instanceof ie?this.value.serialize():this.value};var ue=function(t){this.name="ExpressionEvaluationError",this.message=t};ue.prototype.toJSON=function(){return this.message};var he={string:jt,number:Bt,boolean:Nt,object:Ut},pe=function(t,e){this.type=t,this.args=e};pe.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,i=1,r=t[0];if("array"===r){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in he)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=he[s],i++}else o=Wt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],i++}n=Ht(o,a)}else n=he[r];for(var l=[];i<t.length;i++){var c=e.parse(t[i],i,Wt);if(!c)return null;l.push(c)}return new pe(n,l)},pe.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Kt(this.type,se(n)))return n;if(e===this.args.length-1)throw new ue("Expected value to be of type "+Xt(this.type)+", but found "+Xt(se(n))+" instead.")}return null},pe.prototype.eachChild=function(t){this.args.forEach(t)},pe.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},pe.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var de=function(t){this.type=qt,this.sections=t};de.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");for(var i=[],r=!1,o=1;o<=t.length-1;++o){var a=t[o];if(r&&"object"==typeof a&&!Array.isArray(a)){r=!1;var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,Bt)))return null;var l=null;if(a["text-font"]&&!(l=e.parse(a["text-font"],1,Ht(jt))))return null;var c=null;if(a["text-color"]&&!(c=e.parse(a["text-color"],1,Vt)))return null;var u=i[i.length-1];u.scale=s,u.font=l,u.textColor=c}else{var h=e.parse(t[o],1,Wt);if(!h)return null;var p=h.type.kind;if("string"!==p&&"value"!==p&&"null"!==p&&"resolvedImage"!==p)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:h,scale:null,font:null,textColor:null})}}return new de(i)},de.prototype.evaluate=function(t){return new ie(this.sections.map((function(e){var n=e.content.evaluate(t);return se(n)===Zt?new ne("",n,null,null,null):new ne(le(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},de.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}},de.prototype.outputDefined=function(){return!1},de.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t.push(i.content.serialize());var r={};i.scale&&(r["font-scale"]=i.scale.serialize()),i.font&&(r["text-font"]=i.font.serialize()),i.textColor&&(r["text-color"]=i.textColor.serialize()),t.push(r)}return t};var fe=function(t){this.type=Zt,this.input=t};fe.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,jt);return n?new fe(n):e.error("No image name provided.")},fe.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=re.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n},fe.prototype.eachChild=function(t){t(this.input)},fe.prototype.outputDefined=function(){return!1},fe.prototype.serialize=function(){return["image",this.input.serialize()]};var ge={"to-boolean":Nt,"to-color":Vt,"to-number":Bt,"to-string":jt},me=function(t,e){this.type=t,this.args=e};me.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var i=ge[n],r=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,Wt);if(!a)return null;r.push(a)}return new me(i,r)},me.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,i=0,r=this.args;i<r.length;i+=1){if(n=null,(e=r[i].evaluate(t))instanceof te)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":oe(e[0],e[1],e[2],e[3])))return new te(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ue(n||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,l=this.args;s<l.length;s+=1){if(null===(a=l[s].evaluate(t)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new ue("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?ie.fromString(le(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?re.fromString(le(this.args[0].evaluate(t))):le(this.args[0].evaluate(t))},me.prototype.eachChild=function(t){this.args.forEach(t)},me.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},me.prototype.serialize=function(){if("formatted"===this.type.kind)return new de([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new fe(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var ye=["Unknown","Point","LineString","Polygon"],ve=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ve.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ve.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ye[this.feature.type]:this.feature.type:null},ve.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ve.prototype.canonicalID=function(){return this.canonical},ve.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ve.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=te.parse(t)),e};var _e=function(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i};_e.prototype.evaluate=function(t){return this._evaluate(t,this.args)},_e.prototype.eachChild=function(t){this.args.forEach(t)},_e.prototype.outputDefined=function(){return!1},_e.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},_e.parse=function(t,e){var n,i=t[0],r=_e.definitions[i];if(!r)return e.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(r)?r[0]:r.type,a=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,s=a.filter((function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1})),l=null,c=0,u=s;c<u.length;c+=1){var h=u[c],p=h[0],d=h[1];l=new Ve(e.registry,e.path,null,e.scope);for(var f=[],g=!1,m=1;m<t.length;m++){var y=t[m],v=Array.isArray(p)?p[m-1]:p.type,_=l.parse(y,1+f.length,v);if(!_){g=!0;break}f.push(_)}if(!g)if(Array.isArray(p)&&p.length!==f.length)l.error("Expected "+p.length+" arguments, but found "+f.length+" instead.");else{for(var b=0;b<f.length;b++){var x=Array.isArray(p)?p[b]:p.type,w=f[b];l.concat(b+1).checkSubtype(x,w.type)}if(0===l.errors.length)return new _e(i,o,d,f)}}if(1===s.length)(n=e.errors).push.apply(n,l.errors);else{for(var S=(s.length?s:a).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(Xt).join(", ")+")":"("+Xt(e.type)+"...)"})).join(" | "),P=[],E=1;E<t.length;E++){var T=e.parse(t[E],1+P.length);if(!T)return null;P.push(Xt(T.type))}e.error("Expected arguments of type "+S+", but found ("+P.join(", ")+") instead.")}return null},_e.register=function(t,e){for(var n in _e.definitions=e,e)t[n]=_e};var be=function(t,e,n){this.type=Gt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function xe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function we(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Se(t,e){var n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(n*r*8192),Math.round(i*r*8192)]}function Pe(t,e,n){return e[1]>t[1]!=n[1]>t[1]&&t[0]<(n[0]-e[0])*(t[1]-e[1])/(n[1]-e[1])+e[0]}function Ee(t,e){for(var n,i,r,o,a,s,l,c=!1,u=0,h=e.length;u<h;u++)for(var p=e[u],d=0,f=p.length;d<f-1;d++){if((o=(n=t)[0]-(i=p[d])[0])*(l=n[1]-(r=p[d+1])[1])-(s=n[0]-r[0])*(a=n[1]-i[1])==0&&o*s<=0&&a*l<=0)return!1;Pe(t,p[d],p[d+1])&&(c=!c)}return c}function Te(t,e){for(var n=0;n<e.length;n++)if(Ee(t,e[n]))return!0;return!1}function ke(t,e,n,i){var r=i[0]-n[0],o=i[1]-n[1],a=(t[0]-n[0])*o-r*(t[1]-n[1]),s=(e[0]-n[0])*o-r*(e[1]-n[1]);return a>0&&s<0||a<0&&s>0}function Ae(t,e,n){for(var i=0,r=n;i<r.length;i+=1)for(var o=r[i],a=0;a<o.length-1;++a)if(0!=(h=[(u=o[a+1])[0]-(c=o[a])[0],u[1]-c[1]])[0]*(p=[(l=e)[0]-(s=t)[0],l[1]-s[1]])[1]-h[1]*p[0]&&ke(s,l,c,u)&&ke(c,u,s,l))return!0;var s,l,c,u,h,p;return!1}function Ce(t,e){for(var n=0;n<t.length;++n)if(!Ee(t[n],e))return!1;for(var i=0;i<t.length-1;++i)if(Ae(t[i],t[i+1],e))return!1;return!0}function Me(t,e){for(var n=0;n<e.length;n++)if(Ce(t,e[n]))return!0;return!1}function Ie(t,e,n){for(var i=[],r=0;r<t.length;r++){for(var o=[],a=0;a<t[r].length;a++){var s=Se(t[r][a],n);xe(e,s),o.push(s)}i.push(o)}return i}function Le(t,e,n){for(var i=[],r=0;r<t.length;r++){var o=Ie(t[r],e,n);i.push(o)}return i}function Oe(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){var r=.5*i,o=t[0]-n[0]>r?-i:n[0]-t[0]>r?i:0;0===o&&(o=t[0]-n[2]>r?-i:n[2]-t[0]>r?i:0),t[0]+=o}xe(e,t)}function ze(t,e,n,i){for(var r=8192*Math.pow(2,i.z),o=[8192*i.x,8192*i.y],a=[],s=0,l=t;s<l.length;s+=1)for(var c=0,u=l[s];c<u.length;c+=1){var h=u[c],p=[h.x+o[0],h.y+o[1]];Oe(p,e,n,r),a.push(p)}return a}function Re(t,e,n,i){for(var r,o=8192*Math.pow(2,i.z),a=[8192*i.x,8192*i.y],s=[],l=0,c=t;l<c.length;l+=1){for(var u=[],h=0,p=c[l];h<p.length;h+=1){var d=p[h],f=[d.x+a[0],d.y+a[1]];xe(e,f),u.push(f)}s.push(u)}if(e[2]-e[0]<=o/2){(r=e)[0]=r[1]=1/0,r[2]=r[3]=-1/0;for(var g=0,m=s;g<m.length;g+=1)for(var y=0,v=m[g];y<v.length;y+=1)Oe(v[y],e,n,o)}return s}be.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Nt);if(!i)return null;var r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Nt);if(!r)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,jt))?null:new be(i,r,o)},be.prototype.evaluate=function(t){return new ee(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},be.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},be.prototype.outputDefined=function(){return!1},be.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var De=function(t,e){this.type=Nt,this.geojson=t,this.geometries=e};function Fe(t){if(t instanceof _e){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof De)return!1;var e=!0;return t.eachChild((function(t){e&&!Fe(t)&&(e=!1)})),e}function Be(t){if(t instanceof _e&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Be(t)&&(e=!1)})),e}function je(t,e){if(t instanceof _e&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild((function(t){n&&!je(t,e)&&(n=!1)})),n}De.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(ae(t[1])){var n=t[1];if("FeatureCollection"===n.type)for(var i=0;i<n.features.length;++i){var r=n.features[i].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new De(n,n.features[i].geometry)}else if("Feature"===n.type){var o=n.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new De(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new De(n,n)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},De.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){var o=Ie(e.coordinates,i,r),a=ze(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Ee(l[s],o))return!1}if("MultiPolygon"===e.type){var c=Le(e.coordinates,i,r),u=ze(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var h=0,p=u;h<p.length;h+=1)if(!Te(p[h],c))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){var o=Ie(e.coordinates,i,r),a=Re(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var s=0,l=a;s<l.length;s+=1)if(!Ce(l[s],o))return!1}if("MultiPolygon"===e.type){var c=Le(e.coordinates,i,r),u=Re(t.geometry(),n,i,r);if(!we(n,i))return!1;for(var h=0,p=u;h<p.length;h+=1)if(!Me(p[h],c))return!1}return!0}(t,this.geometries)}return!1},De.prototype.eachChild=function(){},De.prototype.outputDefined=function(){return!0},De.prototype.serialize=function(){return["within",this.geojson]};var Ne=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Ne.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Ne(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Ne.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Ne.prototype.eachChild=function(){},Ne.prototype.outputDefined=function(){return!1},Ne.prototype.serialize=function(){return["var",this.name]};var Ve=function(t,e,n,i,r){void 0===e&&(e=[]),void 0===i&&(i=new Dt),void 0===r&&(r=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=i,this.errors=r,this.expectedType=n};function Ue(t,e){for(var n,i=t.length-1,r=0,o=i,a=0;r<=o;)if((n=t[a=Math.floor((r+o)/2)])<=e){if(a===i||e<t[a+1])return a;r=a+1}else{if(!(n>e))throw new ue("Input is not a number.");o=a-1}return 0}Ve.prototype.parse=function(t,e,n,i,r){return void 0===r&&(r={}),e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)},Ve.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new pe(e,[t]):"coerce"===n?new me(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=t[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var r=this.registry[i];if(r){var o=r.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"assert")}if(!(o instanceof ce)&&"resolvedImage"!==o.type.kind&&function t(e){if(e instanceof Ne)return t(e.boundExpression);if(e instanceof _e&&"error"===e.name)return!1;if(e instanceof be)return!1;if(e instanceof De)return!1;var n=e instanceof me||e instanceof pe,i=!0;return e.eachChild((function(e){i=n?i&&t(e):i&&e instanceof ce})),!!i&&Fe(e)&&je(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var l=new ve;try{o=new ce(o.type,o.evaluate(l))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},Ve.prototype.concat=function(t,e,n){var i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new Ve(this.registry,i,e||null,r,this.errors)},Ve.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var i=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new Rt(i,t))},Ve.prototype.checkSubtype=function(t,e){var n=Kt(t,e);return n&&this.error(n),n};var We=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,r=n;i<r.length;i+=1){var o=r[i],a=o[1];this.labels.push(o[0]),this.outputs.push(a)}};function Ge(t,e,n){return t*(1-n)+e*n}We.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var n=e.parse(t[1],1,Bt);if(!n)return null;var i=[],r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var o=1;o<t.length;o+=2){var a=1===o?-1/0:t[o],s=t[o+1],l=o,c=o+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(i.length&&i[i.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var u=e.parse(s,c,r);if(!u)return null;r=r||u.type,i.push([a,u])}return new We(r,n,i)},We.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[Ue(e,i)].evaluate(t)},We.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},We.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},We.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var qe=Object.freeze({__proto__:null,number:Ge,color:function(t,e,n){return new te(Ge(t.r,e.r,n),Ge(t.g,e.g,n),Ge(t.b,e.b,n),Ge(t.a,e.a,n))},array:function(t,e,n){return t.map((function(t,i){return Ge(t,e[i],n)}))}}),Ze=6/29*3*(6/29),He=Math.PI/180,Xe=180/Math.PI;function Ye(t){return t>.008856451679035631?Math.pow(t,1/3):t/Ze+4/29}function Ke(t){return t>6/29?t*t*t:Ze*(t-4/29)}function Je(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Qe(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function $e(t){var e=Qe(t.r),n=Qe(t.g),i=Qe(t.b),r=Ye((.4124564*e+.3575761*n+.1804375*i)/.95047),o=Ye((.2126729*e+.7151522*n+.072175*i)/1);return{l:116*o-16,a:500*(r-o),b:200*(o-Ye((.0193339*e+.119192*n+.9503041*i)/1.08883)),alpha:t.a}}function tn(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*Ke(e),n=.95047*Ke(n),i=1.08883*Ke(i),new te(Je(3.2404542*n-1.5371385*e-.4985314*i),Je(-.969266*n+1.8760108*e+.041556*i),Je(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function en(t,e,n){var i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}var nn={forward:$e,reverse:tn,interpolate:function(t,e,n){return{l:Ge(t.l,e.l,n),a:Ge(t.a,e.a,n),b:Ge(t.b,e.b,n),alpha:Ge(t.alpha,e.alpha,n)}}},rn={forward:function(t){var e=$e(t),n=e.l,i=e.a,r=e.b,o=Math.atan2(r,i)*Xe;return{h:o<0?o+360:o,c:Math.sqrt(i*i+r*r),l:n,alpha:t.a}},reverse:function(t){var e=t.h*He,n=t.c;return tn({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:en(t.h,e.h,n),c:Ge(t.c,e.c,n),l:Ge(t.l,e.l,n),alpha:Ge(t.alpha,e.alpha,n)}}},on=Object.freeze({__proto__:null,lab:nn,hcl:rn}),an=function(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(var o=0,a=r;o<a.length;o+=1){var s=a[o],l=s[1];this.labels.push(s[0]),this.outputs.push(l)}};function sn(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}an.interpolationFactor=function(t,e,i,r){var o=0;if("exponential"===t.name)o=sn(e,t.base,i,r);else if("linear"===t.name)o=sn(e,1,i,r);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new n(a[0],a[1],a[2],a[3]).solve(sn(e,1,i,r))}return o},an.parse=function(t,e){var n=t[0],i=t[1],r=t[2],o=t.slice(3);if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var a=i[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:a}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type "+String(i[0]),1,0);var s=i.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,2,Bt)))return null;var l=[],c=null;"interpolate-hcl"===n||"interpolate-lab"===n?c=Vt:e.expectedType&&"value"!==e.expectedType.kind&&(c=e.expectedType);for(var u=0;u<o.length;u+=2){var h=o[u],p=o[u+1],d=u+3,f=u+4;if("number"!=typeof h)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(l.length&&l[l.length-1][0]>=h)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var g=e.parse(p,f,c);if(!g)return null;c=c||g.type,l.push([h,g])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new an(c,n,i,r,l):e.error("Type "+Xt(c)+" is not interpolatable.")},an.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);var o=Ue(e,i),a=an.interpolationFactor(this.interpolation,i,e[o],e[o+1]),s=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?qe[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?rn.reverse(rn.interpolate(rn.forward(s),rn.forward(l),a)):nn.reverse(nn.interpolate(nn.forward(s),nn.forward(l),a))},an.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},an.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},an.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var ln=function(t,e){this.type=t,this.args=e};ln.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,i=e.expectedType;i&&"value"!==i.kind&&(n=i);for(var r=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=e.parse(a[o],1+r.length,n,void 0,{typeAnnotation:"omit"});if(!s)return null;n=n||s.type,r.push(s)}var l=i&&r.some((function(t){return Kt(i,t.type)}));return new ln(l?Wt:n,r)},ln.prototype.evaluate=function(t){for(var e,n=null,i=0,r=0,o=this.args;r<o.length&&(i++,(n=o[r].evaluate(t))&&n instanceof re&&!n.available&&(e||(e=n.name),n=null,i===this.args.length&&(n=e)),null===n);r+=1);return n},ln.prototype.eachChild=function(t){this.args.forEach(t)},ln.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},ln.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var cn=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};cn.prototype.evaluate=function(t){return this.result.evaluate(t)},cn.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},cn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],i=1;i<t.length-1;i+=2){var r=t[i];if("string"!=typeof r)return e.error("Expected string, but found "+typeof r+" instead.",i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=e.parse(t[i+1],i+1);if(!o)return null;n.push([r,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return a?new cn(n,a):null},cn.prototype.outputDefined=function(){return this.result.outputDefined()},cn.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var i=n[e];t.push(i[0],i[1].serialize())}return t.push(this.result.serialize()),t};var un=function(t,e,n){this.type=t,this.index=e,this.input=n};un.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Bt),i=e.parse(t[2],2,Ht(e.expectedType||Wt));return n&&i?new un(i.type.itemType,n,i):null},un.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new ue("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new ue("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new ue("Array index must be an integer, but found "+e+" instead.");return n[e]},un.prototype.eachChild=function(t){t(this.index),t(this.input)},un.prototype.outputDefined=function(){return!1},un.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var hn=function(t,e){this.type=Nt,this.needle=t,this.haystack=e};hn.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Wt),i=e.parse(t[2],2,Wt);return n&&i?Jt(n.type,[Nt,jt,Bt,Ft,Wt])?new hn(n,i):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(n.type)+" instead"):null},hn.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!Qt(e,["boolean","string","number","null"]))throw new ue("Expected first argument to be of type boolean, string, number or null, but found "+Xt(se(e))+" instead.");if(!Qt(n,["string","array"]))throw new ue("Expected second argument to be of type array or string, but found "+Xt(se(n))+" instead.");return n.indexOf(e)>=0},hn.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},hn.prototype.outputDefined=function(){return!0},hn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var pn=function(t,e,n){this.type=Bt,this.needle=t,this.haystack=e,this.fromIndex=n};pn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Wt),i=e.parse(t[2],2,Wt);if(!n||!i)return null;if(!Jt(n.type,[Nt,jt,Bt,Ft,Wt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(n.type)+" instead");if(4===t.length){var r=e.parse(t[3],3,Bt);return r?new pn(n,i,r):null}return new pn(n,i)},pn.prototype.evaluate=function(t){var e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Qt(e,["boolean","string","number","null"]))throw new ue("Expected first argument to be of type boolean, string, number or null, but found "+Xt(se(e))+" instead.");if(!Qt(n,["string","array"]))throw new ue("Expected second argument to be of type array or string, but found "+Xt(se(n))+" instead.");if(this.fromIndex){var i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)},pn.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},pn.prototype.outputDefined=function(){return!1},pn.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var dn=function(t,e,n,i,r,o){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o};dn.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var r={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],l=t[a+1];Array.isArray(s)||(s=[s]);var c=e.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var u=0,h=s;u<h.length;u+=1){var p=h[u];if("number"!=typeof p&&"string"!=typeof p)return c.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,se(p)))return null}else n=se(p);if(void 0!==r[String(p)])return c.error("Branch labels must be unique.");r[String(p)]=o.length}var d=e.parse(l,a,i);if(!d)return null;i=i||d.type,o.push(d)}var f=e.parse(t[1],1,Wt);if(!f)return null;var g=e.parse(t[t.length-1],t.length-1,i);return g?"value"!==f.type.kind&&e.concat(1).checkSubtype(n,f.type)?null:new dn(n,i,f,r,o,g):null},dn.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(se(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},dn.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},dn.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},dn.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],i={},r=0,o=Object.keys(this.cases).sort();r<o.length;r+=1){var a=o[r];void 0===(h=i[this.cases[a]])?(i[this.cases[a]]=n.length,n.push([this.cases[a],[a]])):n[h][1].push(a)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},l=0,c=n;l<c.length;l+=1){var u=c[l],h=u[0],p=u[1];e.push(1===p.length?s(p[0]):p.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var fn=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};fn.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i=[],r=1;r<t.length-1;r+=2){var o=e.parse(t[r],r,Nt);if(!o)return null;var a=e.parse(t[r+1],r+1,n);if(!a)return null;i.push([o,a]),n=n||a.type}var s=e.parse(t[t.length-1],t.length-1,n);return s?new fn(n,i,s):null},fn.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[1];if(i[0].evaluate(t))return r.evaluate(t)}return this.otherwise.evaluate(t)},fn.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[1];t(i[0]),t(r)}t(this.otherwise)},fn.prototype.outputDefined=function(){return this.branches.every((function(t){return t[1].outputDefined()}))&&this.otherwise.outputDefined()},fn.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var gn=function(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i};function mn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function yn(t,e,n,i){return 0===i.compare(e,n)}function vn(t,e,n){var i="=="!==t&&"!="!==t;return function(){function r(t,e,n){this.type=Nt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return r.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],o=e.parse(t[1],1,Wt);if(!o)return null;if(!mn(n,o.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+Xt(o.type)+"'.");var a=e.parse(t[2],2,Wt);if(!a)return null;if(!mn(n,a.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+Xt(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+Xt(o.type)+"' and '"+Xt(a.type)+"'.");i&&("value"===o.type.kind&&"value"!==a.type.kind?o=new pe(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new pe(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Gt)))return null}return new r(o,a,s)},r.prototype.evaluate=function(r){var o=this.lhs.evaluate(r),a=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){var s=se(o),l=se(a);if(s.kind!==l.kind||"string"!==s.kind&&"number"!==s.kind)throw new ue('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+l.kind+") instead.")}if(this.collator&&!i&&this.hasUntypedArgument){var c=se(o),u=se(a);if("string"!==c.kind||"string"!==u.kind)return e(r,o,a)}return this.collator?n(r,o,a,this.collator.evaluate(r)):e(r,o,a)},r.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},r.prototype.outputDefined=function(){return!0},r.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},r}()}gn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Wt),i=e.parse(t[2],2,Bt);if(!n||!i)return null;if(!Jt(n.type,[Ht(Wt),jt,Wt]))return e.error("Expected first argument to be of type array or string, but found "+Xt(n.type)+" instead");if(4===t.length){var r=e.parse(t[3],3,Bt);return r?new gn(n.type,n,i,r):null}return new gn(n.type,n,i)},gn.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Qt(e,["string","array"]))throw new ue("Expected first argument to be of type array or string, but found "+Xt(se(e))+" instead.");if(this.endIndex){var i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)},gn.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},gn.prototype.outputDefined=function(){return!1},gn.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var _n=vn("==",(function(t,e,n){return e===n}),yn),bn=vn("!=",(function(t,e,n){return e!==n}),(function(t,e,n,i){return!yn(0,e,n,i)})),xn=vn("<",(function(t,e,n){return e<n}),(function(t,e,n,i){return i.compare(e,n)<0})),wn=vn(">",(function(t,e,n){return e>n}),(function(t,e,n,i){return i.compare(e,n)>0})),Sn=vn("<=",(function(t,e,n){return e<=n}),(function(t,e,n,i){return i.compare(e,n)<=0})),Pn=vn(">=",(function(t,e,n){return e>=n}),(function(t,e,n,i){return i.compare(e,n)>=0})),En=function(t,e,n,i,r){this.type=jt,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r};En.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,Bt);if(!n)return null;var i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");var r=null;if(i.locale&&!(r=e.parse(i.locale,1,jt)))return null;var o=null;if(i.currency&&!(o=e.parse(i.currency,1,jt)))return null;var a=null;if(i["min-fraction-digits"]&&!(a=e.parse(i["min-fraction-digits"],1,Bt)))return null;var s=null;return i["max-fraction-digits"]&&!(s=e.parse(i["max-fraction-digits"],1,Bt))?null:new En(n,r,o,a,s)},En.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},En.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},En.prototype.outputDefined=function(){return!1},En.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Tn=function(t){this.type=Bt,this.input=t};Tn.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+Xt(n.type)+" instead."):new Tn(n):null},Tn.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ue("Expected value to be of type string or array, but found "+Xt(se(e))+" instead.")},Tn.prototype.eachChild=function(t){t(this.input)},Tn.prototype.outputDefined=function(){return!1},Tn.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var kn={"==":_n,"!=":bn,">":wn,"<":xn,">=":Pn,"<=":Sn,array:pe,at:un,boolean:pe,case:fn,coalesce:ln,collator:be,format:de,image:fe,in:hn,"index-of":pn,interpolate:an,"interpolate-hcl":an,"interpolate-lab":an,length:Tn,let:cn,literal:ce,match:dn,number:pe,"number-format":En,object:pe,slice:gn,step:We,string:pe,"to-boolean":me,"to-color":me,"to-number":me,"to-string":me,var:Ne,within:De};function An(t,e){var n=e[0],i=e[1],r=e[2],o=e[3];n=n.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);var a=o?o.evaluate(t):1,s=oe(n,i,r,a);if(s)throw new ue(s);return new te(n/255*a,i/255*a,r/255*a,a)}function Cn(t,e){return t in e}function Mn(t,e){var n=e[t];return void 0===n?null:n}function In(t){return{type:t}}function Ln(t){return{result:"success",value:t}}function On(t){return{result:"error",value:t}}function zn(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Rn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Dn(t){return!!t.expression&&t.expression.interpolated}function Fn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Bn(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function jn(t){return t}function Nn(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Vn(t,e,n,i,r){return Nn(typeof n===r?i[n]:void 0,t.default,e.default)}function Un(t,e,n){if("number"!==Fn(n))return Nn(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var r=Ue(t.stops.map((function(t){return t[0]})),n);return t.stops[r][1]}function Wn(t,e,n){var i=void 0!==t.base?t.base:1;if("number"!==Fn(n))return Nn(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var o=Ue(t.stops.map((function(t){return t[0]})),n),a=function(t,e,n,i){var r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}(n,i,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1],c=qe[e.type]||jn;if(t.colorSpace&&"rgb"!==t.colorSpace){var u=on[t.colorSpace];c=function(t,e){return u.reverse(u.interpolate(u.forward(t),u.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=s.evaluate.apply(void 0,t),i=l.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==i)return c(n,i,a)}}:c(s,l,a)}function Gn(t,e,n){return"color"===e.type?n=te.parse(n):"formatted"===e.type?n=ie.fromString(n.toString()):"resolvedImage"===e.type?n=re.fromString(n.toString()):Fn(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Nn(n,t.default,e.default)}_e.register(kn,{error:[{kind:"error"},[jt],function(t,e){throw new ue(e[0].evaluate(t))}],typeof:[jt,[Wt],function(t,e){return Xt(se(e[0].evaluate(t)))}],"to-rgba":[Ht(Bt,4),[Vt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Vt,[Bt,Bt,Bt],An],rgba:[Vt,[Bt,Bt,Bt,Bt],An],has:{type:Nt,overloads:[[[jt],function(t,e){return Cn(e[0].evaluate(t),t.properties())}],[[jt,Ut],function(t,e){var n=e[1];return Cn(e[0].evaluate(t),n.evaluate(t))}]]},get:{type:Wt,overloads:[[[jt],function(t,e){return Mn(e[0].evaluate(t),t.properties())}],[[jt,Ut],function(t,e){var n=e[1];return Mn(e[0].evaluate(t),n.evaluate(t))}]]},"feature-state":[Wt,[jt],function(t,e){return Mn(e[0].evaluate(t),t.featureState||{})}],properties:[Ut,[],function(t){return t.properties()}],"geometry-type":[jt,[],function(t){return t.geometryType()}],id:[Wt,[],function(t){return t.id()}],zoom:[Bt,[],function(t){return t.globals.zoom}],"heatmap-density":[Bt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Bt,[],function(t){return t.globals.lineProgress||0}],accumulated:[Wt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Bt,In(Bt),function(t,e){for(var n=0,i=0,r=e;i<r.length;i+=1)n+=r[i].evaluate(t);return n}],"*":[Bt,In(Bt),function(t,e){for(var n=1,i=0,r=e;i<r.length;i+=1)n*=r[i].evaluate(t);return n}],"-":{type:Bt,overloads:[[[Bt,Bt],function(t,e){var n=e[1];return e[0].evaluate(t)-n.evaluate(t)}],[[Bt],function(t,e){return-e[0].evaluate(t)}]]},"/":[Bt,[Bt,Bt],function(t,e){var n=e[1];return e[0].evaluate(t)/n.evaluate(t)}],"%":[Bt,[Bt,Bt],function(t,e){var n=e[1];return e[0].evaluate(t)%n.evaluate(t)}],ln2:[Bt,[],function(){return Math.LN2}],pi:[Bt,[],function(){return Math.PI}],e:[Bt,[],function(){return Math.E}],"^":[Bt,[Bt,Bt],function(t,e){var n=e[1];return Math.pow(e[0].evaluate(t),n.evaluate(t))}],sqrt:[Bt,[Bt],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Bt,[Bt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Bt,[Bt],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Bt,[Bt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Bt,[Bt],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Bt,[Bt],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Bt,[Bt],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Bt,[Bt],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Bt,[Bt],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Bt,[Bt],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Bt,In(Bt),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[Bt,In(Bt),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[Bt,[Bt],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Bt,[Bt],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Bt,[Bt],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Bt,[Bt],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Nt,[jt,Wt],function(t,e){var n=e[0],i=e[1];return t.properties()[n.value]===i.value}],"filter-id-==":[Nt,[Wt],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[Nt,[jt],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[Nt,[jt,Wt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<o}],"filter-id-<":[Nt,[Wt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[Nt,[jt,Wt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>o}],"filter-id->":[Nt,[Wt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[Nt,[jt,Wt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<=o}],"filter-id-<=":[Nt,[Wt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[Nt,[jt,Wt],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r>=o}],"filter-id->=":[Nt,[Wt],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[Nt,[Wt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Nt,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Nt,[Ht(jt)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Nt,[Ht(Wt)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Nt,[jt,Ht(Wt)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[Nt,[jt,Ht(Wt)],function(t,e){var n=e[0],i=e[1];return function(t,e,n,i){for(;n<=i;){var r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[n.value],i.value,0,i.value.length-1)}],all:{type:Nt,overloads:[[[Nt,Nt],function(t,e){var n=e[1];return e[0].evaluate(t)&&n.evaluate(t)}],[In(Nt),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(!i[n].evaluate(t))return!1;return!0}]]},any:{type:Nt,overloads:[[[Nt,Nt],function(t,e){var n=e[1];return e[0].evaluate(t)||n.evaluate(t)}],[In(Nt),function(t,e){for(var n=0,i=e;n<i.length;n+=1)if(i[n].evaluate(t))return!0;return!1}]]},"!":[Nt,[Nt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Nt,[jt],function(t,e){var n=t.globals&&t.globals.isSupportedScript;return!n||n(e[0].evaluate(t))}],upcase:[jt,[jt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[jt,[jt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[jt,In(Wt),function(t,e){return e.map((function(e){return le(e.evaluate(t))})).join("")}],"resolved-locale":[jt,[Gt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var qn=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new ve,this._defaultValue=e?function(t){return"color"===t.type&&Bn(t.default)?new te(0,0,0,0):"color"===t.type?te.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null};function Zn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in kn}function Hn(t,e){var n=new Ve(kn,[],e?function(t){var e={color:Vt,string:jt,number:Bt,enum:jt,boolean:Nt,formatted:qt,resolvedImage:Zt};return"array"===t.type?Ht(e[t.value]||Wt,t.length):e[t.type]}(e):void 0),i=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return i?Ln(new qn(i,e)):On(n.errors)}qn.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},qn.prototype.evaluate=function(t,e,n,i,r,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ue("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Xn=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Be(e.expression)};Xn.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)},Xn.prototype.evaluate=function(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)};var Yn=function(t,e,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Be(e.expression),this.interpolationType=i};function Kn(t,e){if("error"===(t=Hn(t,e)).result)return t;var n=t.value.expression,i=Fe(n);if(!i&&!zn(e))return On([new Rt("","data expressions not supported")]);var r=je(n,["zoom"]);if(!r&&!Rn(e))return On([new Rt("","zoom expressions not supported")]);var o=function t(e){var n=null;if(e instanceof cn)n=t(e.result);else if(e instanceof ln)for(var i=0,r=e.args;i<r.length&&!(n=t(r[i]));i+=1);else(e instanceof We||e instanceof an)&&e.input instanceof _e&&"zoom"===e.input.name&&(n=e);return n instanceof Rt||e.eachChild((function(e){var i=t(e);i instanceof Rt?n=i:!n&&i?n=new Rt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&i&&n!==i&&(n=new Rt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}(n);return o||r?o instanceof Rt?On([o]):o instanceof an&&!Dn(e)?On([new Rt("",'"interpolate" expressions cannot be used with this property')]):Ln(o?new Yn(i?"camera":"composite",t.value,o.labels,o instanceof an?o.interpolation:void 0):new Xn(i?"constant":"source",t.value)):On([new Rt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Yn.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)},Yn.prototype.evaluate=function(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)},Yn.prototype.interpolationFactor=function(t,e,n){return this.interpolationType?an.interpolationFactor(this.interpolationType,t,e,n):0};var Jn=function(t,e){this._parameters=t,this._specification=e,Lt(this,function t(e,n){var i,r,o,a="color"===n.type,s=e.stops&&"object"==typeof e.stops[0][0],l=s||!(s||void 0!==e.property),c=e.type||(Dn(n)?"exponential":"interval");if(a&&((e=Lt({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],te.parse(t[1])]}))),e.default=te.parse(e.default?e.default:n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!on[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===c)i=Wn;else if("interval"===c)i=Un;else if("categorical"===c){i=Vn,r=Object.create(null);for(var u=0,h=e.stops;u<h.length;u+=1){var p=h[u];r[p[0]]=p[1]}o=typeof e.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');i=Gn}if(s){for(var d={},f=[],g=0;g<e.stops.length;g++){var m=e.stops[g],y=m[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},f.push(y)),d[y].stops.push([m[0].value,m[1]])}for(var v=[],_=0,b=f;_<b.length;_+=1){var x=b[_];v.push([d[x].zoom,t(d[x],n)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:an.interpolationFactor.bind(void 0,w),zoomStops:v.map((function(t){return t[0]})),evaluate:function(t,i){var r=t.zoom;return Wn({stops:v,base:e.base},n,r).evaluate(r,i)}}}if(l){var S="exponential"===c?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:an.interpolationFactor.bind(void 0,S),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){return i(e,n,t.zoom,r,o)}}}return{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?Nn(e.default,n.default):i(e,n,s,r,o)}}}(this._parameters,this._specification))};function Qn(t){var e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],l=Fn(n);if("object"!==l)return[new Mt(e,n,"object expected, "+l+" found")];for(var c in n){var u=c.split(".")[0],h=i[u]||i["*"],p=void 0;if(r[u])p=r[u];else if(i[u])p=Si;else if(r["*"])p=r["*"];else{if(!i["*"]){s.push(new Mt(e,n[c],'unknown property "'+c+'"'));continue}p=Si}s=s.concat(p({key:(e?e+".":e)+c,value:n[c],valueSpec:h,style:o,styleSpec:a,object:n,objectKey:c},n))}for(var d in i)r[d]||i[d].required&&void 0===i[d].default&&void 0===n[d]&&s.push(new Mt(e,n,'missing required property "'+d+'"'));return s}function $n(t){var e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,o=t.key,a=t.arrayElementValidator||Si;if("array"!==Fn(e))return[new Mt(o,e,"array expected, "+Fn(e)+" found")];if(n.length&&e.length!==n.length)return[new Mt(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new Mt(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var s={type:n.value,values:n.values};r.$version<7&&(s.function=n.function),"object"===Fn(n.value)&&(s=n.value);for(var l=[],c=0;c<e.length;c++)l=l.concat(a({array:e,arrayIndex:c,value:e[c],valueSpec:s,style:i,styleSpec:r,key:o+"["+c+"]"}));return l}function ti(t){var e=t.key,n=t.value,i=t.valueSpec,r=Fn(n);return"number"===r&&n!=n&&(r="NaN"),"number"!==r?[new Mt(e,n,"number expected, "+r+" found")]:"minimum"in i&&n<i.minimum?[new Mt(e,n,n+" is less than the minimum value "+i.minimum)]:"maximum"in i&&n>i.maximum?[new Mt(e,n,n+" is greater than the maximum value "+i.maximum)]:[]}function ei(t){var e,n,i,r=t.valueSpec,o=Ot(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,l=!s,c="array"===Fn(t.value.stops)&&"array"===Fn(t.value.stops[0])&&"object"===Fn(t.value.stops[0][0]),u=Qn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new Mt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat($n({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Fn(n)&&0===n.length&&e.push(new Mt(t.key,n,"array must have at least one stop")),e},default:function(t){return Si({key:t.key,value:t.value,valueSpec:r,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&u.push(new Mt(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||u.push(new Mt(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!Dn(t.valueSpec)&&u.push(new Mt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!zn(t.valueSpec)?u.push(new Mt(t.key,t.value,"property functions not supported")):s&&!Rn(t.valueSpec)&&u.push(new Mt(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!c||void 0!==t.value.property||u.push(new Mt(t.key,t.value,'"property" property is required')),u;function h(t){var e=[],o=t.value,s=t.key;if("array"!==Fn(o))return[new Mt(s,o,"array expected, "+Fn(o)+" found")];if(2!==o.length)return[new Mt(s,o,"array length 2 expected, length "+o.length+" found")];if(c){if("object"!==Fn(o[0]))return[new Mt(s,o,"object expected, "+Fn(o[0])+" found")];if(void 0===o[0].zoom)return[new Mt(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new Mt(s,o,"object stop key must have value")];if(i&&i>Ot(o[0].zoom))return[new Mt(s,o[0].zoom,"stop zoom values must appear in ascending order")];Ot(o[0].zoom)!==i&&(i=Ot(o[0].zoom),n=void 0,a={}),e=e.concat(Qn({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:ti,value:p}}))}else e=e.concat(p({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return Zn(zt(o[1]))?e.concat([new Mt(s+"[1]",o[1],"expressions are not allowed in function stops.")]):e.concat(Si({key:s+"[1]",value:o[1],valueSpec:r,style:t.style,styleSpec:t.styleSpec}))}function p(t,i){var s=Fn(t.value),l=Ot(t.value),c=null!==t.value?t.value:i;if(e){if(s!==e)return[new Mt(t.key,c,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Mt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var u="number expected, "+s+" found";return zn(r)&&void 0===o&&(u+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Mt(t.key,c,u)]}return"categorical"!==o||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==o&&"number"===s&&void 0!==n&&l<n?[new Mt(t.key,c,"stop domain values must appear in ascending order")]:(n=l,"categorical"===o&&l in a?[new Mt(t.key,c,"stop domain values must be unique")]:(a[l]=!0,[])):[new Mt(t.key,c,"integer expected, found "+l)]}}function ni(t){var e=("property"===t.expressionContext?Kn:Hn)(zt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new Mt(""+t.key+e.key,t.value,e.message)}));var n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new Mt(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Be(n))return[new Mt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Be(n))return[new Mt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!je(n,["zoom","feature-state"]))return[new Mt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Fe(n))return[new Mt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ii(t){var e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(Ot(n))&&r.push(new Mt(e,n,"expected one of ["+i.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(i.values).indexOf(Ot(n))&&r.push(new Mt(e,n,"expected one of ["+Object.keys(i.values).join(", ")+"], "+JSON.stringify(n)+" found")),r}function ri(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var i=n[e];if(!ri(i)&&"boolean"!=typeof i)return!1}return!0;default:return!0}}Jn.deserialize=function(t){return new Jn(t._parameters,t._specification)},Jn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var oi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ai(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};ri(t)||(t=li(t));var e=Hn(t,oi);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return{filter:function(t,n,i){return e.value.evaluate(t,n,{},i)},needGeometry:function t(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var n=1;n<e.length;n++)if(t(e[n]))return!0;return!1}(t)}}function si(t,e){return t<e?-1:t>e?1:0}function li(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?ci(t[1],t[2],"=="):"!="===n?pi(ci(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?ci(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(li))):"all"===n?["all"].concat(t.slice(1).map(li)):"none"===n?["all"].concat(t.slice(1).map(li).map(pi)):"in"===n?ui(t[1],t.slice(2)):"!in"===n?pi(ui(t[1],t.slice(2))):"has"===n?hi(t[1]):"!has"===n?pi(hi(t[1])):"within"!==n||t}function ci(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function ui(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(si)]]:["filter-in-small",t,["literal",e]]}}function hi(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function pi(t){return["!",t]}function di(t){return ri(zt(t.value))?ni(Lt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,i=e.key;if("array"!==Fn(n))return[new Mt(i,n,"array expected, "+Fn(n)+" found")];var r,o=e.styleSpec,a=[];if(n.length<1)return[new Mt(i,n,"filter array must have at least 1 element")];switch(a=a.concat(ii({key:i+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),Ot(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===Ot(n[1])&&a.push(new Mt(i,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new Mt(i,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(r=Fn(n[1]))&&a.push(new Mt(i+"[1]",n[1],"string expected, "+r+" found"));for(var s=2;s<n.length;s++)r=Fn(n[s]),"$type"===Ot(n[1])?a=a.concat(ii({key:i+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new Mt(i+"["+s+"]",n[s],"string, number, or boolean expected, "+r+" found"));break;case"any":case"all":case"none":for(var l=1;l<n.length;l++)a=a.concat(t({key:i+"["+l+"]",value:n[l],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=Fn(n[1]),2!==n.length?a.push(new Mt(i,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==r&&a.push(new Mt(i+"[1]",n[1],"string expected, "+r+" found"));break;case"within":r=Fn(n[1]),2!==n.length?a.push(new Mt(i,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"object"!==r&&a.push(new Mt(i+"[1]",n[1],"object expected, "+r+" found"))}return a}(t)}function fi(t,e){var n=t.key,i=t.style,r=t.styleSpec,o=t.value,a=t.objectKey,s=r[e+"_"+t.layerType];if(!s)return[];var l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Si({key:n,value:o,valueSpec:r.transition,style:i,styleSpec:r});var c,u=t.valueSpec||s[a];if(!u)return[new Mt(n,o,'unknown property "'+a+'"')];if("string"===Fn(o)&&zn(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new Mt(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var h=[];return"symbol"===t.layerType&&("text-field"===a&&i&&!i.glyphs&&h.push(new Mt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Bn(zt(o))&&"identity"===Ot(o.type)&&h.push(new Mt(n,o,'"text-font" does not support identity functions'))),h.concat(Si({key:t.key,value:o,valueSpec:u,style:i,styleSpec:r,expressionContext:"property",propertyType:e,propertyKey:a}))}function gi(t){return fi(t,"paint")}function mi(t){return fi(t,"layout")}function yi(t){var e=[],n=t.value,i=t.key,r=t.style,o=t.styleSpec;n.type||n.ref||e.push(new Mt(i,n,'either "type" or "ref" is required'));var a,s=Ot(n.type),l=Ot(n.ref);if(n.id)for(var c=Ot(n.id),u=0;u<t.arrayIndex;u++){var h=r.layers[u];Ot(h.id)===c&&e.push(new Mt(i,n.id,'duplicate layer id "'+n.id+'", previously used at line '+h.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(t){t in n&&e.push(new Mt(i,n[t],'"'+t+'" is prohibited for ref layers'))})),r.layers.forEach((function(t){Ot(t.id)===l&&(a=t)})),a?a.ref?e.push(new Mt(i,n.ref,"ref cannot reference another ref layer")):s=Ot(a.type):e.push(new Mt(i,n.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(n.source){var p=r.sources&&r.sources[n.source],d=p&&Ot(p.type);p?"vector"===d&&"raster"===s?e.push(new Mt(i,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===d&&"raster"!==s?e.push(new Mt(i,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==d||n["source-layer"]?"raster-dem"===d&&"hillshade"!==s?e.push(new Mt(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===d&&p.lineMetrics||e.push(new Mt(i,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new Mt(i,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new Mt(i,n.source,'source "'+n.source+'" not found'))}else e.push(new Mt(i,n,'missing required property "source"'));return e=e.concat(Qn({key:i,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Si({key:i+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:di,layout:function(t){return Qn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return mi(Lt({layerType:s},t))}}})},paint:function(t){return Qn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return gi(Lt({layerType:s},t))}}})}}}))}function vi(t){var e=t.value,n=t.key,i=Fn(e);return"string"!==i?[new Mt(n,e,"string expected, "+i+" found")]:[]}var _i={promoteId:function(t){var e=t.key,n=t.value;if("string"===Fn(n))return vi({key:e,value:n});var i=[];for(var r in n)i.push.apply(i,vi({key:e+"."+r,value:n[r]}));return i}};function bi(t){var e=t.value,n=t.key,i=t.styleSpec,r=t.style;if(!e.type)return[new Mt(n,e,'"type" is required')];var o,a=Ot(e.type);switch(a){case"vector":case"raster":case"raster-dem":return Qn({key:n,value:e,valueSpec:i["source_"+a.replace("-","_")],style:t.style,styleSpec:i,objectElementValidators:_i});case"geojson":if(o=Qn({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i,objectElementValidators:_i}),e.cluster)for(var s in e.clusterProperties){var l=e.clusterProperties[s],c=l[0],u="string"==typeof c?[c,["accumulated"],["get",s]]:c;o.push.apply(o,ni({key:n+"."+s+".map",value:l[1],expressionContext:"cluster-map"})),o.push.apply(o,ni({key:n+"."+s+".reduce",value:u,expressionContext:"cluster-reduce"}))}return o;case"video":return Qn({key:n,value:e,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return Qn({key:n,value:e,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return[new Mt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ii({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:i})}}function xi(t){var e=t.value,n=t.styleSpec,i=n.light,r=t.style,o=[],a=Fn(e);if(void 0===e)return o;if("object"!==a)return o.concat([new Mt("light",e,"object expected, "+a+" found")]);for(var s in e){var l=s.match(/^(.*)-transition$/);o=o.concat(l&&i[l[1]]&&i[l[1]].transition?Si({key:s,value:e[s],valueSpec:n.transition,style:r,styleSpec:n}):i[s]?Si({key:s,value:e[s],valueSpec:i[s],style:r,styleSpec:n}):[new Mt(s,e[s],'unknown property "'+s+'"')])}return o}var wi={"*":function(){return[]},array:$n,boolean:function(t){var e=t.value,n=t.key,i=Fn(e);return"boolean"!==i?[new Mt(n,e,"boolean expected, "+i+" found")]:[]},number:ti,color:function(t){var e=t.key,n=t.value,i=Fn(n);return"string"!==i?[new Mt(e,n,"color expected, "+i+" found")]:null===$t(n)?[new Mt(e,n,'color expected, "'+n+'" found')]:[]},constants:It,enum:ii,filter:di,function:ei,layer:yi,object:Qn,source:bi,light:xi,string:vi,formatted:function(t){return 0===vi(t).length?[]:ni(t)},resolvedImage:function(t){return 0===vi(t).length?[]:ni(t)}};function Si(t){var e=t.value,n=t.valueSpec,i=t.styleSpec;return n.expression&&Bn(Ot(e))?ei(t):n.expression&&Zn(zt(e))?ni(t):n.type&&wi[n.type]?wi[n.type](t):Qn(Lt({},t,{valueSpec:n.type?i[n.type]:n}))}function Pi(t){var e=t.value,n=t.key,i=vi(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new Mt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new Mt(n,e,'"glyphs" url must include a "{range}" token'))),i}function Ei(t,e){void 0===e&&(e=Ct);var n=[];return n=n.concat(Si({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Pi,"*":function(){return[]}}})),t.constants&&(n=n.concat(It({key:"constants",value:t.constants,style:t,styleSpec:e}))),Ti(n)}function Ti(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function ki(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return Ti(t.apply(this,e))}}Ei.source=ki(bi),Ei.light=ki(xi),Ei.layer=ki(yi),Ei.filter=ki(di),Ei.paintProperty=ki(gi),Ei.layoutProperty=ki(mi);var Ai=Ei,Ci=Ai.light,Mi=Ai.paintProperty,Ii=Ai.layoutProperty;function Li(t,e){var n=!1;if(e&&e.length)for(var i=0,r=e;i<r.length;i+=1)t.fire(new kt(new Error(r[i].message))),n=!0;return n}var Oi=zi;function zi(t,e,n){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(n=r[2]);for(var o=0;o<this.d*this.d;o++){var a=r[3+o],s=r[3+o+1];i.push(a===s?null:r.subarray(a,s))}var l=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var u=n/e*t;this.min=-u,this.max=t+u}zi.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},zi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},zi.prototype._insertCell=function(t,e,n,i,r,o){this.cells[r].push(o)},zi.prototype.query=function(t,e,n,i,r){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=n&&a<=i&&!r)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,n,i,this._queryCell,s,{},r),s},zi.prototype._queryCell=function(t,e,n,i,r,o,a,s){var l=this.cells[r];if(null!==l)for(var c=this.keys,u=this.bboxes,h=0;h<l.length;h++){var p=l[h];if(void 0===a[p]){var d=4*p;(s?s(u[d+0],u[d+1],u[d+2],u[d+3]):t<=u[d+2]&&e<=u[d+3]&&n>=u[d+0]&&i>=u[d+1])?(a[p]=!0,o.push(c[p])):a[p]=!1}}},zi.prototype._forEachCell=function(t,e,n,i,r,o,a,s){for(var l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(n),h=this._convertToCellCoord(i),p=l;p<=u;p++)for(var d=c;d<=h;d++){var f=this.d*d+p;if((!s||s(this._convertFromCellCoord(p),this._convertFromCellCoord(d),this._convertFromCellCoord(p+1),this._convertFromCellCoord(d+1)))&&r.call(this,t,e,n,i,f,o,a,s))return}},zi.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},zi.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},zi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(e+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];r[3+a]=o,r.set(s,o),o+=s.length}return r[3+t.length]=o,r.set(this.keys,o),r[3+t.length+1]=o+=this.keys.length,r.set(this.bboxes,o),o+=this.bboxes.length,r.buffer};var Ri=a.ImageData,Di=a.ImageBitmap,Fi={};function Bi(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Fi[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var ji in Bi("Object",Object),Oi.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Oi.deserialize=function(t){return new Oi(t.buffer)},Bi("Grid",Oi),Bi("Color",te),Bi("Error",Error),Bi("ResolvedImage",re),Bi("StylePropertyFunction",Jn),Bi("StyleExpression",qn,{omit:["_evaluator"]}),Bi("ZoomDependentExpression",Yn),Bi("ZoomConstantExpression",Xn),Bi("CompoundExpression",_e,{omit:["_evaluate"]}),kn)kn[ji]._classRegistryKey||Bi("Expression_"+ji,kn[ji]);function Ni(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Vi(t){return Di&&t instanceof Di}function Ui(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ni(t)||Vi(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof Ri)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var i=[],r=0,o=t;r<o.length;r+=1)i.push(Ui(o[r],e));return i}if("object"==typeof t){var a=t.constructor,s=a._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var l=a.serialize?a.serialize(t,e):{};if(!a.serialize){for(var c in t)if(t.hasOwnProperty(c)&&!(Fi[s].omit.indexOf(c)>=0)){var u=t[c];l[c]=Fi[s].shallow.indexOf(c)>=0?u:Ui(u,e)}t instanceof Error&&(l.message=t.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(l.$name=s),l}throw new Error("can't serialize object of type "+typeof t)}function Wi(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ni(t)||Vi(t)||ArrayBuffer.isView(t)||t instanceof Ri)return t;if(Array.isArray(t))return t.map(Wi);if("object"==typeof t){var e=t.$name||"Object",n=Fi[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var i=Object.create(n.prototype),r=0,o=Object.keys(t);r<o.length;r+=1){var a=o[r];if("$name"!==a){var s=t[a];i[a]=Fi[e].shallow.indexOf(a)>=0?s:Wi(s)}}return i}throw new Error("can't deserialize object of type "+typeof t)}var Gi=function(){this.first=!0};Gi.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var qi={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Zi(t){for(var e=0,n=t;e<n.length;e+=1)if(Hi(n[e].charCodeAt(0)))return!0;return!1}function Hi(t){return!(746!==t&&747!==t&&(t<4352||!(qi["Bopomofo Extended"](t)||qi.Bopomofo(t)||qi["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||qi["CJK Compatibility Ideographs"](t)||qi["CJK Compatibility"](t)||qi["CJK Radicals Supplement"](t)||qi["CJK Strokes"](t)||!(!qi["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||qi["CJK Unified Ideographs Extension A"](t)||qi["CJK Unified Ideographs"](t)||qi["Enclosed CJK Letters and Months"](t)||qi["Hangul Compatibility Jamo"](t)||qi["Hangul Jamo Extended-A"](t)||qi["Hangul Jamo Extended-B"](t)||qi["Hangul Jamo"](t)||qi["Hangul Syllables"](t)||qi.Hiragana(t)||qi["Ideographic Description Characters"](t)||qi.Kanbun(t)||qi["Kangxi Radicals"](t)||qi["Katakana Phonetic Extensions"](t)||qi.Katakana(t)&&12540!==t||!(!qi["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!qi["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||qi["Unified Canadian Aboriginal Syllabics"](t)||qi["Unified Canadian Aboriginal Syllabics Extended"](t)||qi["Vertical Forms"](t)||qi["Yijing Hexagram Symbols"](t)||qi["Yi Syllables"](t)||qi["Yi Radicals"](t))))}function Xi(t){return!(Hi(t)||function(t){return!!(qi["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||qi["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||qi["Letterlike Symbols"](t)||qi["Number Forms"](t)||qi["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||qi["Control Pictures"](t)&&9251!==t||qi["Optical Character Recognition"](t)||qi["Enclosed Alphanumerics"](t)||qi["Geometric Shapes"](t)||qi["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qi["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qi["CJK Symbols and Punctuation"](t)||qi.Katakana(t)||qi["Private Use Area"](t)||qi["CJK Compatibility Forms"](t)||qi["Small Form Variants"](t)||qi["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Yi(t){return t>=1424&&t<=2303||qi["Arabic Presentation Forms-A"](t)||qi["Arabic Presentation Forms-B"](t)}function Ki(t,e){return!(!e&&Yi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||qi.Khmer(t))}function Ji(t){for(var e=0,n=t;e<n.length;e+=1)if(Yi(n[e].charCodeAt(0)))return!0;return!1}var Qi=null,$i="unavailable",tr=null,er=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&($i="error"),Qi&&Qi(t)};function nr(){ir.fire(new Tt("pluginStateChange",{pluginStatus:$i,pluginURL:tr}))}var ir=new At,rr=function(){return $i},or=function(){if("deferred"!==$i||!tr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");$i="loading",nr(),tr&&bt({url:tr},(function(t){t?er(t):($i="loaded",nr())}))},ar={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===$i||null!=ar.applyArabicShaping},isLoading:function(){return"loading"===$i},setState:function(t){$i=t.pluginStatus,tr=t.pluginURL},isParsed:function(){return null!=ar.applyArabicShaping&&null!=ar.processBidirectionalText&&null!=ar.processStyledBidirectionalText},getPluginURL:function(){return tr}},sr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gi,this.transition={})};sr.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,i=t;n<i.length;n+=1)if(!Ki(i[n].charCodeAt(0),e))return!1;return!0}(t,ar.isLoaded())},sr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},sr.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}};var lr=function(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Bn(t))return new Jn(t,e);if(Zn(t)){var n=Kn(t,e);if("error"===n.result)throw new Error(n.value.map((function(t){return t.key+": "+t.message})).join(", "));return n.value}var i=t;return"string"==typeof t&&"color"===e.type&&(i=te.parse(t)),{kind:"constant",evaluate:function(){return i}}}(void 0===e?t.specification.default:e,t.specification)};lr.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},lr.prototype.possiblyEvaluate=function(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)};var cr=function(t){this.property=t,this.value=new lr(t,void 0)};cr.prototype.transitioned=function(t,e){return new hr(this.property,this.value,e,p({},t.transition,this.transition),t.now)},cr.prototype.untransitioned=function(){return new hr(this.property,this.value,null,{},0)};var ur=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};ur.prototype.getValue=function(t){return x(this._values[t].value.value)},ur.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new cr(this._values[t].property)),this._values[t].value=new lr(this._values[t].property,null===e?void 0:x(e))},ur.prototype.getTransition=function(t){return x(this._values[t].transition)},ur.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new cr(this._values[t].property)),this._values[t].transition=x(e)||void 0},ur.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r);var o=this.getTransition(i);void 0!==o&&(t[i+"-transition"]=o)}return t},ur.prototype.transitioned=function(t,e){for(var n=new pr(this._properties),i=0,r=Object.keys(this._values);i<r.length;i+=1){var o=r[i];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},ur.prototype.untransitioned=function(){for(var t=new pr(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e];t._values[i]=this._values[i].untransitioned()}return t};var hr=function(t,e,n,i,r){this.property=t,this.value=e,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)};hr.prototype.possiblyEvaluate=function(t,e,n){var i=t.now||0,r=this.value.possiblyEvaluate(t,e,n),o=this.prior;if(o){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return o.possiblyEvaluate(t,e,n);var a=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,n),r,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(a))}return r};var pr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};pr.prototype.possiblyEvaluate=function(t,e,n){for(var i=new gr(this._properties),r=0,o=Object.keys(this._values);r<o.length;r+=1){var a=o[r];i._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return i},pr.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var dr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};dr.prototype.getValue=function(t){return x(this._values[t].value)},dr.prototype.setValue=function(t,e){this._values[t]=new lr(this._values[t].property,null===e?void 0:x(e))},dr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var i=n[e],r=this.getValue(i);void 0!==r&&(t[i]=r)}return t},dr.prototype.possiblyEvaluate=function(t,e,n){for(var i=new gr(this._properties),r=0,o=Object.keys(this._values);r<o.length;r+=1){var a=o[r];i._values[a]=this._values[a].possiblyEvaluate(t,e,n)}return i};var fr=function(t,e,n){this.property=t,this.value=e,this.parameters=n};fr.prototype.isConstant=function(){return"constant"===this.value.kind},fr.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},fr.prototype.evaluate=function(t,e,n,i){return this.property.evaluate(this.value,this.parameters,t,e,n,i)};var gr=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};gr.prototype.get=function(t){return this._values[t]};var mr=function(t){this.specification=t};mr.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},mr.prototype.interpolate=function(t,e,n){var i=qe[this.specification.type];return i?i(t,e,n):t};var yr=function(t,e){this.specification=t,this.overrides=e};yr.prototype.possiblyEvaluate=function(t,e,n,i){return new fr(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,i)}:t.expression,e)},yr.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new fr(this,{kind:"constant",value:void 0},t.parameters);var i=qe[this.specification.type];return i?new fr(this,{kind:"constant",value:i(t.value.value,e.value.value,n)},t.parameters):t},yr.prototype.evaluate=function(t,e,n,i,r,o){return"constant"===t.kind?t.value:t.evaluate(e,n,i,r,o)};var vr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(t,e,n,i){if(void 0===t.value)return new fr(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var r=t.expression.evaluate(e,null,{},n,i),o="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,a=this._calculate(o,o,o,e);return new fr(this,{kind:"constant",value:a},e)}if("camera"===t.expression.kind){var s=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new fr(this,{kind:"constant",value:s},e)}return new fr(this,t.expression,e)},e.prototype.evaluate=function(t,e,n,i,r,o){if("source"===t.kind){var a=t.evaluate(e,n,i,r,o);return this._calculate(a,a,a,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,i),t.evaluate({zoom:Math.floor(e.zoom)},n,i),t.evaluate({zoom:Math.floor(e.zoom)+1},n,i),e):t.value},e.prototype._calculate=function(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},e.prototype.interpolate=function(t){return t},e}(yr),_r=function(t){this.specification=t};_r.prototype.possiblyEvaluate=function(t,e,n,i){if(void 0!==t.value){if("constant"===t.expression.kind){var r=t.expression.evaluate(e,null,{},n,i);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new sr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new sr(Math.floor(e.zoom),e)),t.expression.evaluate(new sr(Math.floor(e.zoom+1),e)),e)}},_r.prototype._calculate=function(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},_r.prototype.interpolate=function(t){return t};var br=function(t){this.specification=t};br.prototype.possiblyEvaluate=function(t,e,n,i){return!!t.expression.evaluate(e,null,{},n,i)},br.prototype.interpolate=function(){return!1};var xr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var n=t[e];n.specification.overridable&&this.overridableProperties.push(e);var i=this.defaultPropertyValues[e]=new lr(n,void 0),r=this.defaultTransitionablePropertyValues[e]=new cr(n);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}};Bi("DataDrivenProperty",yr),Bi("DataConstantProperty",mr),Bi("CrossFadedDataDrivenProperty",vr),Bi("CrossFadedProperty",_r),Bi("ColorRampProperty",br);var wr=function(t){function e(e,n){if(t.call(this),this.id=e.id,this.type=e.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new dr(n.layout)),n.paint)){for(var i in this._transitionablePaint=new ur(n.paint),e.paint)this.setPaintProperty(i,e.paint[i],{validate:!1});for(var r in e.layout)this.setLayoutProperty(r,e.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gr(n.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){void 0===n&&(n={}),null!=e&&this._validate(Ii,"layers."+this.id+".layout."+t,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)},e.prototype.getPaintProperty=function(t){return v(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(void 0===n&&(n={}),null!=e&&this._validate(Mi,"layers."+this.id+".paint."+t,t,e,n))return!1;if(v(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],r="cross-faded-data-driven"===i.property.specification["property-type"],o=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var s=this._transitionablePaint._values[t].value;return s.isDataDriven()||o||r||this._handleOverridablePaintPropertyUpdate(t,a,s)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype._handleOverridablePaintPropertyUpdate=function(t,e,n){return!1},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),b(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},e.prototype._validate=function(t,e,n,i,r){return void 0===r&&(r={}),(!r||!1!==r.validate)&&Li(this,t.call(Ai,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:Ct,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof fr&&zn(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(At),Sr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Pr=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Er=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Tr(t,e){void 0===e&&(e=1);var n=0,i=0;return{members:t.map((function(t){var r=Sr[t.type].BYTES_PER_ELEMENT,o=n=kr(n,Math.max(e,r)),a=t.components||1;return i=Math.max(i,r),n+=r*a,{name:t.name,type:t.type,components:a,offset:o}})),size:kr(n,Math.max(i,e)),alignment:e}}function kr(t,e){return Math.ceil(t/e)*e}Er.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Er.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Er.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Er.prototype.clear=function(){this.length=0},Er.prototype.resize=function(t){this.reserve(t),this.length=t},Er.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Er.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ar=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t},e}(Er);Ar.prototype.bytesPerElement=4,Bi("StructArrayLayout2i4",Ar);var Cr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)},e.prototype.emplace=function(t,e,n,i,r){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=r,t},e}(Er);Cr.prototype.bytesPerElement=8,Bi("StructArrayLayout4i8",Cr);var Mr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,o)},e.prototype.emplace=function(t,e,n,i,r,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(Er);Mr.prototype.bytesPerElement=12,Bi("StructArrayLayout2i4i12",Mr);var Ir=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,o)},e.prototype.emplace=function(t,e,n,i,r,o,a){var s=4*t,l=8*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.uint8[l+4]=i,this.uint8[l+5]=r,this.uint8[l+6]=o,this.uint8[l+7]=a,t},e}(Er);Ir.prototype.bytesPerElement=8,Bi("StructArrayLayout2i4ub8",Ir);var Lr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t},e}(Er);Lr.prototype.bytesPerElement=8,Bi("StructArrayLayout2f8",Lr);var Or=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,c){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,o,a,s,l,c)},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l,c,u){var h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=i,this.uint16[h+3]=r,this.uint16[h+4]=o,this.uint16[h+5]=a,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,t},e}(Er);Or.prototype.bytesPerElement=20,Bi("StructArrayLayout10ui20",Or);var zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,c,u,h){var p=this.length;return this.resize(p+1),this.emplace(p,t,e,n,i,r,o,a,s,l,c,u,h)},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l,c,u,h,p){var d=12*t;return this.int16[d+0]=e,this.int16[d+1]=n,this.int16[d+2]=i,this.int16[d+3]=r,this.uint16[d+4]=o,this.uint16[d+5]=a,this.uint16[d+6]=s,this.uint16[d+7]=l,this.int16[d+8]=c,this.int16[d+9]=u,this.int16[d+10]=h,this.int16[d+11]=p,t},e}(Er);zr.prototype.bytesPerElement=24,Bi("StructArrayLayout4i4ui4i24",zr);var Rr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t},e}(Er);Rr.prototype.bytesPerElement=12,Bi("StructArrayLayout3f12",Rr);var Dr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint32[1*t+0]=e,t},e}(Er);Dr.prototype.bytesPerElement=4,Bi("StructArrayLayout1ul4",Dr);var Fr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l){var c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,i,r,o,a,s,l)},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l,c){var u=10*t,h=5*t;return this.int16[u+0]=e,this.int16[u+1]=n,this.int16[u+2]=i,this.int16[u+3]=r,this.int16[u+4]=o,this.int16[u+5]=a,this.uint32[h+3]=s,this.uint16[u+8]=l,this.uint16[u+9]=c,t},e}(Er);Fr.prototype.bytesPerElement=20,Bi("StructArrayLayout6i1ul2ui20",Fr);var Br=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r,o)},e.prototype.emplace=function(t,e,n,i,r,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(Er);Br.prototype.bytesPerElement=12,Bi("StructArrayLayout2i2i2i12",Br);var jr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r)},e.prototype.emplace=function(t,e,n,i,r,o){var a=4*t,s=8*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=i,this.int16[s+6]=r,this.int16[s+7]=o,t},e}(Er);jr.prototype.bytesPerElement=16,Bi("StructArrayLayout2f1f2i16",jr);var Nr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)},e.prototype.emplace=function(t,e,n,i,r){var o=12*t,a=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[a+1]=i,this.float32[a+2]=r,t},e}(Er);Nr.prototype.bytesPerElement=12,Bi("StructArrayLayout2ub2f12",Nr);var Vr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,t},e}(Er);Vr.prototype.bytesPerElement=6,Bi("StructArrayLayout3ui6",Vr);var Ur=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g,m){var y=this.length;return this.resize(y+1),this.emplace(y,t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g,m)},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g,m,y){var v=24*t,_=12*t,b=48*t;return this.int16[v+0]=e,this.int16[v+1]=n,this.uint16[v+2]=i,this.uint16[v+3]=r,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[v+10]=l,this.uint16[v+11]=c,this.uint16[v+12]=u,this.float32[_+7]=h,this.float32[_+8]=p,this.uint8[b+36]=d,this.uint8[b+37]=f,this.uint8[b+38]=g,this.uint32[_+10]=m,this.int16[v+22]=y,t},e}(Er);Ur.prototype.bytesPerElement=48,Bi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ur);var Wr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g,m,y,v,_,b,x,w,S,P,E,T,k){var A=this.length;return this.resize(A+1),this.emplace(A,t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g,m,y,v,_,b,x,w,S,P,E,T,k)},e.prototype.emplace=function(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g,m,y,v,_,b,x,w,S,P,E,T,k,A){var C=34*t,M=17*t;return this.int16[C+0]=e,this.int16[C+1]=n,this.int16[C+2]=i,this.int16[C+3]=r,this.int16[C+4]=o,this.int16[C+5]=a,this.int16[C+6]=s,this.int16[C+7]=l,this.uint16[C+8]=c,this.uint16[C+9]=u,this.uint16[C+10]=h,this.uint16[C+11]=p,this.uint16[C+12]=d,this.uint16[C+13]=f,this.uint16[C+14]=g,this.uint16[C+15]=m,this.uint16[C+16]=y,this.uint16[C+17]=v,this.uint16[C+18]=_,this.uint16[C+19]=b,this.uint16[C+20]=x,this.uint16[C+21]=w,this.uint16[C+22]=S,this.uint32[M+12]=P,this.float32[M+13]=E,this.float32[M+14]=T,this.float32[M+15]=k,this.float32[M+16]=A,t},e}(Er);Wr.prototype.bytesPerElement=68,Bi("StructArrayLayout8i15ui1ul4f68",Wr);var Gr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.float32[1*t+0]=e,t},e}(Er);Gr.prototype.bytesPerElement=4,Bi("StructArrayLayout1f4",Gr);var qr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,t},e}(Er);qr.prototype.bytesPerElement=6,Bi("StructArrayLayout3i6",qr);var Zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)},e.prototype.emplace=function(t,e,n,i){var r=4*t;return this.uint32[2*t+0]=e,this.uint16[r+2]=n,this.uint16[r+3]=i,t},e}(Er);Zr.prototype.bytesPerElement=8,Bi("StructArrayLayout1ul2ui8",Zr);var Hr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t},e}(Er);Hr.prototype.bytesPerElement=4,Bi("StructArrayLayout2ui4",Hr);var Xr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint16[1*t+0]=e,t},e}(Er);Xr.prototype.bytesPerElement=2,Bi("StructArrayLayout1ui2",Xr);var Yr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,i){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)},e.prototype.emplace=function(t,e,n,i,r){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=r,t},e}(Er);Yr.prototype.bytesPerElement=16,Bi("StructArrayLayout4f16",Yr);var Kr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.anchorPoint.get=function(){return new r(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(Pr);Kr.prototype.size=20;var Jr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Kr(this,t)},e}(Fr);Bi("CollisionBoxArray",Jr);var Qr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},n.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},n.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,n),e}(Pr);Qr.prototype.size=48;var $r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Qr(this,t)},e}(Ur);Bi("PlacedSymbolArray",$r);var to=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},n.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},n.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},n.key.get=function(){return this._structArray.uint16[this._pos2+8]},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},n.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},n.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},n.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},n.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},n.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},n.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},n.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+12]=t},n.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},n.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},n.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},n.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,n),e}(Pr);to.prototype.size=68;var eo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new to(this,t)},e}(Wr);Bi("SymbolInstanceArray",eo);var no=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e}(Gr);Bi("GlyphOffsetArray",no);var io=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e}(qr);Bi("SymbolLineVertexArray",io);var ro=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,n),e}(Pr);ro.prototype.size=8;var oo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new ro(this,t)},e}(Zr);Bi("FeatureIndexArray",oo);var ao=Tr([{name:"a_pos",components:2,type:"Int16"}],4).members,so=function(t){void 0===t&&(t=[]),this.segments=t};function lo(t,e){return 256*(t=u(Math.floor(t),0,255))+u(Math.floor(e),0,255)}so.prototype.prepareSegment=function(t,e,n,i){var r=this.segments[this.segments.length-1];return t>so.MAX_VERTEX_ARRAY_LENGTH&&S("Max vertices per segment is "+so.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!r||r.vertexLength+t>so.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(r.sortKey=i),this.segments.push(r)),r},so.prototype.get=function(){return this.segments},so.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var i in n.vaos)n.vaos[i].destroy()}},so.simpleSegment=function(t,e,n,i){return new so([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])},so.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bi("SegmentVector",so);var co=Tr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),uo=e((function(t){t.exports=function(t,e){var n,i,r,o,a,s,l,c;for(i=t.length-(n=3&t.length),r=e,a=3432918353,s=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,r=27492+(65535&(o=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}})),ho=e((function(t){t.exports=function(t,e){for(var n,i=t.length,r=e^i,o=0;i>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:r^=(255&t.charCodeAt(o+2))<<16;case 2:r^=(255&t.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}})),po=uo,fo=ho;po.murmur3=uo,po.murmur2=fo;var go=function(){this.ids=[],this.positions=[],this.indexed=!1};go.prototype.add=function(t,e,n,i){this.ids.push(yo(t)),this.positions.push(e,n,i)},go.prototype.getPositions=function(t){for(var e=yo(t),n=0,i=this.ids.length-1;n<i;){var r=n+i>>1;this.ids[r]>=e?i=r:n=r+1}for(var o=[];this.ids[n]===e;)o.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return o},go.serialize=function(t,e){var n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return function t(e,n,i,r){for(;i<r;){for(var o=e[i+r>>1],a=i-1,s=r+1;;){do{a++}while(e[a]<o);do{s--}while(e[s]>o);if(a>=s)break;vo(e,a,s),vo(n,3*a,3*s),vo(n,3*a+1,3*s+1),vo(n,3*a+2,3*s+2)}s-i<r-s?(t(e,n,i,s),i=s+1):(t(e,n,s+1,r),r=s)}}(n,i,0,n.length-1),e&&e.push(n.buffer,i.buffer),{ids:n,positions:i}},go.deserialize=function(t){var e=new go;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var mo=Math.pow(2,53)-1;function yo(t){var e=+t;return!isNaN(e)&&e<=mo?e:po(String(t))}function vo(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}Bi("FeaturePositionMap",go);var _o=function(t,e){this.gl=t.gl,this.location=e},bo=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(_o),xo=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(_o),wo=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(_o),So=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(_o),Po=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(_o),Eo=function(t){function e(e,n){t.call(this,e,n),this.current=te.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(_o),To=new Float32Array(16),ko=function(t){function e(e,n){t.call(this,e,n),this.current=To}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(_o);function Ao(t){return[lo(255*t.r,255*t.g),lo(255*t.b,255*t.a)]}var Co=function(t,e,n){this.value=t,this.uniformNames=e.map((function(t){return"u_"+t})),this.type=n};Co.prototype.setUniform=function(t,e,n){t.set(n.constantOr(this.value))},Co.prototype.getBinding=function(t,e,n){return"color"===this.type?new Eo(t,e):new xo(t,e)};var Mo=function(t,e){this.uniformNames=e.map((function(t){return"u_"+t})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Mo.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},Mo.prototype.setUniform=function(t,e,n,i){var r="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;r&&t.set(r)},Mo.prototype.getBinding=function(t,e,n){return"u_pattern"===n.substr(0,9)?new Po(t,e):new xo(t,e)};var Io=function(t,e,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new i};Io.prototype.populatePaintArray=function(t,e,n,i,r){var o=this.paintVertexArray.length,a=this.expression.evaluate(new sr(0),e,{},i,[],r);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)},Io.prototype.updatePaintArray=function(t,e,n,i){var r=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(t,e,r)},Io.prototype._setPaintValue=function(t,e,n){if("color"===this.type)for(var i=Ao(n),r=t;r<e;r++)this.paintVertexArray.emplace(r,i[0],i[1]);else{for(var o=t;o<e;o++)this.paintVertexArray.emplace(o,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}},Io.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Io.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Lo=function(t,e,n,i,r,o){this.expression=t,this.uniformNames=e.map((function(t){return"u_"+t+"_t"})),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new o};Lo.prototype.populatePaintArray=function(t,e,n,i,r){var o=this.expression.evaluate(new sr(this.zoom),e,{},i,[],r),a=this.expression.evaluate(new sr(this.zoom+1),e,{},i,[],r),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,o,a)},Lo.prototype.updatePaintArray=function(t,e,n,i){var r=this.expression.evaluate({zoom:this.zoom},n,i),o=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(t,e,r,o)},Lo.prototype._setPaintValue=function(t,e,n,i){if("color"===this.type)for(var r=Ao(n),o=Ao(i),a=t;a<e;a++)this.paintVertexArray.emplace(a,r[0],r[1],o[0],o[1]);else{for(var s=t;s<e;s++)this.paintVertexArray.emplace(s,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}},Lo.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Lo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Lo.prototype.setUniform=function(t,e){var n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,i=u(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)},Lo.prototype.getBinding=function(t,e,n){return new xo(t,e)};var Oo=function(t,e,n,i,r,o){this.expression=t,this.type=e,this.useIntegerZoom=n,this.zoom=i,this.layerId=o,this.zoomInPaintVertexArray=new r,this.zoomOutPaintVertexArray=new r};Oo.prototype.populatePaintArray=function(t,e,n){var i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,e.patterns&&e.patterns[this.layerId],n)},Oo.prototype.updatePaintArray=function(t,e,n,i,r){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],r)},Oo.prototype._setPaintValues=function(t,e,n,i){if(i&&n){var r=i[n.min],o=i[n.mid],a=i[n.max];if(r&&o&&a)for(var s=t;s<e;s++)this.zoomInPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],r.tl[0],r.tl[1],r.br[0],r.br[1],o.pixelRatio,r.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],o.pixelRatio,a.pixelRatio)}},Oo.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,co.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,co.members,this.expression.isStateDependent))},Oo.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var zo=function(t,e,n){this.binders={},this._buffers=[];var i=[];for(var r in t.paint._values)if(n(r)){var o=t.paint.get(r);if(o instanceof fr&&zn(o.property.specification)){var a=Do(r,t.type),s=o.value,l=o.property.specification.type,c=o.property.useIntegerZoom,u=o.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===s.kind)this.binders[r]=h?new Mo(s.value,a):new Co(s.value,a,l),i.push("/u_"+r);else if("source"===s.kind||h){var p=Fo(r,l,"source");this.binders[r]=h?new Oo(s,l,c,e,p,t.id):new Io(s,a,l,p),i.push("/a_"+r)}else{var d=Fo(r,l,"composite");this.binders[r]=new Lo(s,a,l,c,e,d),i.push("/z_"+r)}}}this.cacheKey=i.sort().join("")};zo.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof Io||e instanceof Lo?e.maxValue:0},zo.prototype.populatePaintArrays=function(t,e,n,i,r){for(var o in this.binders){var a=this.binders[o];(a instanceof Io||a instanceof Lo||a instanceof Oo)&&a.populatePaintArray(t,e,n,i,r)}},zo.prototype.setConstantPatternPositions=function(t,e){for(var n in this.binders){var i=this.binders[n];i instanceof Mo&&i.setConstantPatternPositions(t,e)}},zo.prototype.updatePaintArrays=function(t,e,n,i,r){var o=!1;for(var a in t)for(var s=0,l=e.getPositions(a);s<l.length;s+=1){var c=l[s],u=n.feature(c.index);for(var h in this.binders){var p=this.binders[h];if((p instanceof Io||p instanceof Lo||p instanceof Oo)&&!0===p.expression.isStateDependent){var d=i.paint.get(h);p.expression=d.value,p.updatePaintArray(c.start,c.end,u,t[a],r),o=!0}}}return o},zo.prototype.defines=function(){var t=[];for(var e in this.binders){var n=this.binders[e];(n instanceof Co||n instanceof Mo)&&t.push.apply(t,n.uniformNames.map((function(t){return"#define HAS_UNIFORM_"+t})))}return t},zo.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof Io||n instanceof Lo)for(var i=0;i<n.paintVertexAttributes.length;i++)t.push(n.paintVertexAttributes[i].name);else if(n instanceof Oo)for(var r=0;r<co.members.length;r++)t.push(co.members[r].name)}return t},zo.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var n=this.binders[e];if(n instanceof Co||n instanceof Mo||n instanceof Lo)for(var i=0,r=n.uniformNames;i<r.length;i+=1)t.push(r[i])}return t},zo.prototype.getPaintVertexBuffers=function(){return this._buffers},zo.prototype.getUniforms=function(t,e){var n=[];for(var i in this.binders){var r=this.binders[i];if(r instanceof Co||r instanceof Mo||r instanceof Lo)for(var o=0,a=r.uniformNames;o<a.length;o+=1){var s=a[o];if(e[s]){var l=r.getBinding(t,e[s],s);n.push({name:s,property:i,binding:l})}}}return n},zo.prototype.setUniforms=function(t,e,n,i){for(var r=0,o=e;r<o.length;r+=1){var a=o[r],s=a.name,l=a.property;this.binders[l].setUniform(a.binding,i,n.get(l),s)}},zo.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var n=this.binders[e];if(t&&n instanceof Oo){var i=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof Io||n instanceof Lo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}},zo.prototype.upload=function(t){for(var e in this.binders){var n=this.binders[e];(n instanceof Io||n instanceof Lo||n instanceof Oo)&&n.upload(t)}this.updatePaintBuffers()},zo.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof Io||e instanceof Lo||e instanceof Oo)&&e.destroy()}};var Ro=function(t,e,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var i=0,r=t;i<r.length;i+=1){var o=r[i];this.programConfigurations[o.id]=new zo(o,e,n)}this.needsUpload=!1,this._featureMap=new go,this._bufferOffset=0};function Do(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Fo(t,e,n){var i={color:{source:Lr,composite:Yr},number:{source:Gr,composite:Lr}},r=function(t){return{"line-pattern":{source:Or,composite:Or},"fill-pattern":{source:Or,composite:Or},"fill-extrusion-pattern":{source:Or,composite:Or}}[t]}(t);return r&&r[n]||i[e][n]}Ro.prototype.populatePaintArrays=function(t,e,n,i,r,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(t,e,i,r,o);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Ro.prototype.updatePaintArrays=function(t,e,n,i){for(var r=0,o=n;r<o.length;r+=1){var a=o[r];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,this._featureMap,e,a,i)||this.needsUpload}},Ro.prototype.get=function(t){return this.programConfigurations[t]},Ro.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Ro.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Bi("ConstantBinder",Co),Bi("CrossFadedConstantBinder",Mo),Bi("SourceExpressionBinder",Io),Bi("CrossFadedCompositeBinder",Oo),Bi("CompositeExpressionBinder",Lo),Bi("ProgramConfiguration",zo,{omit:["_buffers"]}),Bi("ProgramConfigurationSet",Ro);var Bo=Math.pow(2,14)-1,jo=-Bo-1;function No(t){for(var e=8192/t.extent,n=t.loadGeometry(),i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.length;o++){var a=r[o],s=Math.round(a.x*e),l=Math.round(a.y*e);a.x=u(s,jo,Bo),a.y=u(l,jo,Bo),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&S("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function Vo(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?No(t):[]}}function Uo(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}var Wo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ar,this.indexArray=new Vr,this.segments=new so,this.programConfigurations=new Ro(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function Go(t,e){for(var n=0;n<t.length;n++)if($o(e,t[n]))return!0;for(var i=0;i<e.length;i++)if($o(t,e[i]))return!0;return!!Xo(t,e)}function qo(t,e,n){return!!$o(t,e)||!!Ko(e,t,n)}function Zo(t,e){if(1===t.length)return Qo(e,t[0]);for(var n=0;n<e.length;n++)for(var i=e[n],r=0;r<i.length;r++)if($o(t,i[r]))return!0;for(var o=0;o<t.length;o++)if(Qo(e,t[o]))return!0;for(var a=0;a<e.length;a++)if(Xo(t,e[a]))return!0;return!1}function Ho(t,e,n){if(t.length>1){if(Xo(t,e))return!0;for(var i=0;i<e.length;i++)if(Ko(e[i],t,n))return!0}for(var r=0;r<t.length;r++)if(Ko(t[r],e,n))return!0;return!1}function Xo(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var i=t[n],r=t[n+1],o=0;o<e.length-1;o++)if(Yo(i,r,e[o],e[o+1]))return!0;return!1}function Yo(t,e,n,i){return P(t,n,i)!==P(e,n,i)&&P(t,e,n)!==P(t,e,i)}function Ko(t,e,n){var i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(var r=1;r<e.length;r++)if(Jo(t,e[r-1],e[r])<i)return!0;return!1}function Jo(t,e,n){var i=e.distSqr(n);if(0===i)return t.distSqr(e);var r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(r<0?e:r>1?n:n.sub(e)._mult(r)._add(e))}function Qo(t,e){for(var n,i,r,o=!1,a=0;a<t.length;a++)for(var s=0,l=(n=t[a]).length-1;s<n.length;l=s++)(i=n[s]).y>e.y!=(r=n[l]).y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o);return o}function $o(t,e){for(var n=!1,i=0,r=t.length-1;i<t.length;r=i++){var o=t[i],a=t[r];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function ta(t,e,n){var i=n[0],r=n[2];if(t.x<i.x&&e.x<i.x||t.x>r.x&&e.x>r.x||t.y<i.y&&e.y<i.y||t.y>r.y&&e.y>r.y)return!1;var o=P(t,e,n[0]);return o!==P(t,e,n[1])||o!==P(t,e,n[2])||o!==P(t,e,n[3])}function ea(t,e,n){var i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function na(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ia(t,e,n,i,o){if(!e[0]&&!e[1])return t;var a=r.convert(e)._mult(o);"viewport"===n&&a._rotate(-i);for(var s=[],l=0;l<t.length;l++)s.push(t[l].sub(a));return s}Wo.prototype.populate=function(t,e,n){var i=this.layers[0],r=[],o=null;"circle"===i.type&&(o=i.layout.get("circle-sort-key"));for(var a=0,s=t;a<s.length;a+=1){var l=s[a],c=l.feature,u=l.id,h=l.index,p=l.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,f=Vo(c,d);if(this.layers[0]._featureFilter.filter(new sr(this.zoom),f,n)){var g=o?o.evaluate(f,{},n):void 0,m={id:u,properties:c.properties,type:c.type,sourceLayerIndex:p,index:h,geometry:d?f.geometry:No(c),patterns:{},sortKey:g};r.push(m)}}o&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var y=0,v=r;y<v.length;y+=1){var _=v[y],b=_.geometry,x=_.index,w=_.sourceLayerIndex,S=t[x].feature;this.addFeature(_,b,x,n),e.featureIndex.insert(S,b,x,w,this.index)}},Wo.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Wo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Wo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Wo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ao),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Wo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Wo.prototype.addFeature=function(t,e,n,i){for(var r=0,o=e;r<o.length;r+=1)for(var a=0,s=o[r];a<s.length;a+=1){var l=s[a],c=l.x,u=l.y;if(!(c<0||c>=8192||u<0||u>=8192)){var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),p=h.vertexLength;Uo(this.layoutVertexArray,c,u,-1,-1),Uo(this.layoutVertexArray,c,u,1,-1),Uo(this.layoutVertexArray,c,u,1,1),Uo(this.layoutVertexArray,c,u,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),h.vertexLength+=4,h.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i)},Bi("CircleBucket",Wo,{omit:["layers"]});var ra=new xr({"circle-sort-key":new yr(Ct.layout_circle["circle-sort-key"])}),oa={paint:new xr({"circle-radius":new yr(Ct.paint_circle["circle-radius"]),"circle-color":new yr(Ct.paint_circle["circle-color"]),"circle-blur":new yr(Ct.paint_circle["circle-blur"]),"circle-opacity":new yr(Ct.paint_circle["circle-opacity"]),"circle-translate":new mr(Ct.paint_circle["circle-translate"]),"circle-translate-anchor":new mr(Ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new mr(Ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new mr(Ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yr(Ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yr(Ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yr(Ct.paint_circle["circle-stroke-opacity"])}),layout:ra},aa="undefined"!=typeof Float32Array?Float32Array:Array;function sa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function la(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*i+b*s+x*h+w*g,t[1]=_*r+b*l+x*p+w*m,t[2]=_*o+b*c+x*d+w*y,t[3]=_*a+b*u+x*f+w*v,t[4]=(_=n[4])*i+(b=n[5])*s+(x=n[6])*h+(w=n[7])*g,t[5]=_*r+b*l+x*p+w*m,t[6]=_*o+b*c+x*d+w*y,t[7]=_*a+b*u+x*f+w*v,t[8]=(_=n[8])*i+(b=n[9])*s+(x=n[10])*h+(w=n[11])*g,t[9]=_*r+b*l+x*p+w*m,t[10]=_*o+b*c+x*d+w*y,t[11]=_*a+b*u+x*f+w*v,t[12]=(_=n[12])*i+(b=n[13])*s+(x=n[14])*h+(w=n[15])*g,t[13]=_*r+b*l+x*p+w*m,t[14]=_*o+b*c+x*d+w*y,t[15]=_*a+b*u+x*f+w*v,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,n=arguments.length;n--;)e+=t[n]*t[n];return Math.sqrt(e)});var ca,ua=la;function ha(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}ca=new aa(3),aa!=Float32Array&&(ca[0]=0,ca[1]=0,ca[2]=0),function(){var t=new aa(4);aa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var pa=(function(){var t=new aa(2);aa!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(e){t.call(this,e,oa)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new Wo(t)},e.prototype.queryRadius=function(t){var e=t;return ea("circle-radius",this,e)+ea("circle-stroke-width",this,e)+na(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a,s){for(var l=ia(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),u="map"===this.paint.get("circle-pitch-alignment"),h=u?l:function(t,e){return t.map((function(t){return da(t,e)}))}(l,s),p=u?c*a:c,d=0,f=i;d<f.length;d+=1)for(var g=0,m=f[d];g<m.length;g+=1){var y=m[g],v=u?y:da(y,s),_=p,b=ha([],[y.x,y.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),qo(h,v,_))return!0}return!1},e}(wr));function da(t,e){var n=ha([],[t.x,t.y,0,1],e);return new r(n[0]/n[3],n[1]/n[3])}var fa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Wo);function ga(t,e,n,i){var r=e.width,o=e.height;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==r*o*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(r*o*n);return t.width=r,t.height=o,t.data=i,t}function ma(t,e,n){var i=e.width,r=e.height;if(i!==t.width||r!==t.height){var o=ga({},{width:i,height:r},n);ya(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,r)},n),t.width=i,t.height=r,t.data=o.data}}function ya(t,e,n,i,r,o){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,l=0;l<r.height;l++)for(var c=((n.y+l)*t.width+n.x)*o,u=((i.y+l)*e.width+i.x)*o,h=0;h<r.width*o;h++)s[u+h]=a[c+h];return e}Bi("HeatmapBucket",fa,{omit:["layers"]});var va=function(t,e){ga(this,t,1,e)};va.prototype.resize=function(t){ma(this,t,1)},va.prototype.clone=function(){return new va({width:this.width,height:this.height},new Uint8Array(this.data))},va.copy=function(t,e,n,i,r){ya(t,e,n,i,r,1)};var _a=function(t,e){ga(this,t,4,e)};_a.prototype.resize=function(t){ma(this,t,4)},_a.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},_a.prototype.clone=function(){return new _a({width:this.width,height:this.height},new Uint8Array(this.data))},_a.copy=function(t,e,n,i,r){ya(t,e,n,i,r,4)},Bi("AlphaImage",va),Bi("RGBAImage",_a);var ba={paint:new xr({"heatmap-radius":new yr(Ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yr(Ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new mr(Ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new br(Ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new mr(Ct.paint_heatmap["heatmap-opacity"])})};function xa(t){var e={},n=t.resolution||256,i=t.clips?t.clips.length:1,r=t.image||new _a({width:n,height:i}),o=function(n,i,o){e[t.evaluationKey]=o;var a=t.expression.evaluate(e);r.data[n+i+0]=Math.floor(255*a.r/a.a),r.data[n+i+1]=Math.floor(255*a.g/a.a),r.data[n+i+2]=Math.floor(255*a.b/a.a),r.data[n+i+3]=Math.floor(255*a.a)};if(t.clips)for(var a=0,s=0;a<i;++a,s+=4*n)for(var l=0,c=0;l<n;l++,c+=4){var u=l/(n-1),h=t.clips[a];o(s,c,h.start*(1-u)+h.end*u)}else for(var p=0,d=0;p<n;p++,d+=4)o(0,d,p/(n-1));return r}var wa=function(t){function e(e){t.call(this,e,ba),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new fa(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=xa({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(wr),Sa={paint:new xr({"hillshade-illumination-direction":new mr(Ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new mr(Ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new mr(Ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new mr(Ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new mr(Ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new mr(Ct.paint_hillshade["hillshade-accent-color"])})},Pa=function(t){function e(e){t.call(this,e,Sa)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(wr),Ea=Tr([{name:"a_pos",components:2,type:"Int16"}],4).members,Ta=Aa,ka=Aa;function Aa(t,e,n){n=n||2;var i,r,o,a,s,l,c,u=e&&e.length,h=u?e[0]*n:t.length,p=Ca(t,0,h,n,!0),d=[];if(!p||p.next===p.prev)return d;if(u&&(p=function(t,e,n,i){var r,o,a,s=[];for(r=0,o=e.length;r<o;r++)(a=Ca(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===a.next&&(a.steiner=!0),s.push(Na(a));for(s.sort(Da),r=0;r<s.length;r++)Fa(s[r],n),n=Ma(n,n.next);return n}(t,e,p,n)),t.length>80*n){i=o=t[0],r=a=t[1];for(var f=n;f<h;f+=n)(s=t[f])<i&&(i=s),(l=t[f+1])<r&&(r=l),s>o&&(o=s),l>a&&(a=l);c=0!==(c=Math.max(o-i,a-r))?1/c:0}return Ia(p,d,n,i,r,c),d}function Ca(t,e,n,i,r){var o,a;if(r===$a(t,e,n,i)>0)for(o=e;o<n;o+=i)a=Ka(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=Ka(o,t[o],t[o+1],a);return a&&Ga(a,a.next)&&(Ja(a),a=a.next),a}function Ma(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Ga(i,i.next)&&0!==Wa(i.prev,i,i.next))i=i.next;else{if(Ja(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Ia(t,e,n,i,r,o,a){if(t){!a&&o&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=ja(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,l,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<c&&(s++,i=i.nextZ);e++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1)}(r)}(t,i,r,o);for(var s,l,c=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Oa(t,i,r,o):La(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),Ja(t),t=l.next,c=l.next;else if((t=l)===c){a?1===a?Ia(t=za(Ma(t),e,n),e,n,i,r,o,2):2===a&&Ra(t,e,n,i,r,o):Ia(Ma(t),e,n,i,r,o,1);break}}}function La(t){var e=t.prev,n=t,i=t.next;if(Wa(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(Va(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Wa(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Oa(t,e,n,i){var r=t.prev,o=t,a=t.next;if(Wa(r,o,a)>=0)return!1;for(var s=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,l=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,c=ja(r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,e,n,i),u=ja(s,l,e,n,i),h=t.prevZ,p=t.nextZ;h&&h.z>=c&&p&&p.z<=u;){if(h!==t.prev&&h!==t.next&&Va(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Wa(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,p!==t.prev&&p!==t.next&&Va(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Wa(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;h&&h.z>=c;){if(h!==t.prev&&h!==t.next&&Va(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&Wa(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;p&&p.z<=u;){if(p!==t.prev&&p!==t.next&&Va(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Wa(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function za(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Ga(r,o)&&qa(r,i,i.next,o)&&Xa(r,o)&&Xa(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Ja(i),Ja(i.next),i=t=o),i=i.next}while(i!==t);return Ma(i)}function Ra(t,e,n,i,r,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Ua(a,s)){var l=Ya(a,s);return a=Ma(a,a.next),l=Ma(l,l.next),Ia(a,e,n,i,r,o),void Ia(l,e,n,i,r,o)}s=s.next}a=a.next}while(a!==t)}function Da(t,e){return t.x-e.x}function Fa(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n;var l,c=n,u=n.x,h=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&Va(o<h?r:a,o,u,h,o<h?a:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),Xa(i,t)&&(l<p||l===p&&(i.x>n.x||i.x===n.x&&Ba(n,i)))&&(n=i,p=l)),i=i.next}while(i!==c);return n}(t,e)){var n=Ya(e,t);Ma(e,e.next),Ma(n,n.next)}}function Ba(t,e){return Wa(t.prev,t,e.prev)<0&&Wa(e.next,t,t.next)<0}function ja(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Na(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Va(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function Ua(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&qa(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Xa(t,e)&&Xa(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Wa(t.prev,t,e.prev)||Wa(t,e.prev,e))||Ga(t,e)&&Wa(t.prev,t,t.next)>0&&Wa(e.prev,e,e.next)>0)}function Wa(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ga(t,e){return t.x===e.x&&t.y===e.y}function qa(t,e,n,i){var r=Ha(Wa(t,e,n)),o=Ha(Wa(t,e,i)),a=Ha(Wa(n,i,t)),s=Ha(Wa(n,i,e));return r!==o&&a!==s||!(0!==r||!Za(t,n,e))||!(0!==o||!Za(t,i,e))||!(0!==a||!Za(n,t,i))||!(0!==s||!Za(n,e,i))}function Za(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ha(t){return t>0?1:t<0?-1:0}function Xa(t,e){return Wa(t.prev,t,t.next)<0?Wa(t,e,t.next)>=0&&Wa(t,t.prev,e)>=0:Wa(t,e,t.prev)<0||Wa(t,t.next,e)<0}function Ya(t,e){var n=new Qa(t.i,t.x,t.y),i=new Qa(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Ka(t,e,n,i){var r=new Qa(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ja(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Qa(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $a(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}function ts(t,e,n,i,r){!function t(e,n,i,r,o){for(;r>i;){if(r-i>600){var a=r-i+1,s=n-i+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(i,Math.floor(n-s*c/a+u)),Math.min(r,Math.floor(n+(a-s)*c/a+u)),o)}var h=e[n],p=i,d=r;for(es(e,i,n),o(e[r],h)>0&&es(e,i,r);p<d;){for(es(e,p,d),p++,d--;o(e[p],h)<0;)p++;for(;o(e[d],h)>0;)d--}0===o(e[i],h)?es(e,i,d):es(e,++d,r),d<=n&&(i=d+1),n<=d&&(r=d-1)}}(t,e,n||0,i||t.length-1,r||ns)}function es(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function ns(t,e){return t<e?-1:t>e?1:0}function is(t,e){var n=t.length;if(n<=1)return[t];for(var i,r,o=[],a=0;a<n;a++){var s=E(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===r&&(r=s<0),r===s<0?(i&&o.push(i),i=[t[a]]):i.push(t[a]))}if(i&&o.push(i),e>1)for(var l=0;l<o.length;l++)o[l].length<=e||(ts(o[l],e,1,o[l].length-1,rs),o[l]=o[l].slice(0,e));return o}function rs(t,e){return e.area-t.area}function os(t,e,n){for(var i=n.patternDependencies,r=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(r=!0);var l=s.constantOr(null);l&&(r=!0,i[l.to]=!0,i[l.from]=!0)}return r}function as(t,e,n,i,r){for(var o=r.patternDependencies,a=0,s=e;a<s.length;a+=1){var l=s[a],c=l.paint.get(t+"-pattern").value;if("constant"!==c.kind){var u=c.evaluate({zoom:i-1},n,{},r.availableImages),h=c.evaluate({zoom:i},n,{},r.availableImages),p=c.evaluate({zoom:i+1},n,{},r.availableImages);h=h&&h.name?h.name:h,p=p&&p.name?p.name:p,o[u=u&&u.name?u.name:u]=!0,o[h]=!0,o[p]=!0,n.patterns[l.id]={min:u,mid:h,max:p}}}return n}Aa.deviation=function(t,e,n,i){var r=e&&e.length,o=Math.abs($a(t,0,r?e[0]*n:t.length,n));if(r)for(var a=0,s=e.length;a<s;a++)o-=Math.abs($a(t,e[a]*n,a<s-1?e[a+1]*n:t.length,n));var l=0;for(a=0;a<i.length;a+=3){var c=i[a]*n,u=i[a+1]*n,h=i[a+2]*n;l+=Math.abs((t[c]-t[h])*(t[u+1]-t[c+1])-(t[c]-t[u])*(t[h+1]-t[c+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},Aa.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&n.holes.push(i+=t[r-1].length)}return n},Ta.default=ka;var ss=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ar,this.indexArray=new Vr,this.indexArray2=new Hr,this.programConfigurations=new Ro(t.layers,t.zoom),this.segments=new so,this.segments2=new so,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};ss.prototype.populate=function(t,e,n){this.hasPattern=os("fill",this.layers,e);for(var i=this.layers[0].layout.get("fill-sort-key"),r=[],o=0,a=t;o<a.length;o+=1){var s=a[o],l=s.feature,c=s.id,u=s.index,h=s.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,d=Vo(l,p);if(this.layers[0]._featureFilter.filter(new sr(this.zoom),d,n)){var f=i?i.evaluate(d,{},n,e.availableImages):void 0,g={id:c,properties:l.properties,type:l.type,sourceLayerIndex:h,index:u,geometry:p?d.geometry:No(l),patterns:{},sortKey:f};r.push(g)}}i&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,y=r;m<y.length;m+=1){var v=y[m],_=v.geometry,b=v.index,x=v.sourceLayerIndex;if(this.hasPattern){var w=as("fill",this.layers,v,this.zoom,e);this.patternFeatures.push(w)}else this.addFeature(v,_,b,n,{});e.featureIndex.insert(t[b].feature,_,b,x,this.index)}},ss.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},ss.prototype.addFeatures=function(t,e,n){for(var i=0,r=this.patternFeatures;i<r.length;i+=1){var o=r[i];this.addFeature(o,o.geometry,o.index,e,n)}},ss.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ss.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ss.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ea),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},ss.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ss.prototype.addFeature=function(t,e,n,i,r){for(var o=0,a=is(e,500);o<a.length;o+=1){for(var s=a[o],l=0,c=0,u=s;c<u.length;c+=1)l+=u[c].length;for(var h=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),p=h.vertexLength,d=[],f=[],g=0,m=s;g<m.length;g+=1){var y=m[g];if(0!==y.length){y!==s[0]&&f.push(d.length/2);var v=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),_=v.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(_+y.length-1,_),d.push(y[0].x),d.push(y[0].y);for(var b=1;b<y.length;b++)this.layoutVertexArray.emplaceBack(y[b].x,y[b].y),this.indexArray2.emplaceBack(_+b-1,_+b),d.push(y[b].x),d.push(y[b].y);v.vertexLength+=y.length,v.primitiveLength+=y.length}}for(var x=Ta(d,f),w=0;w<x.length;w+=3)this.indexArray.emplaceBack(p+x[w],p+x[w+1],p+x[w+2]);h.vertexLength+=l,h.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)},Bi("FillBucket",ss,{omit:["layers","patternFeatures"]});var ls=new xr({"fill-sort-key":new yr(Ct.layout_fill["fill-sort-key"])}),cs={paint:new xr({"fill-antialias":new mr(Ct.paint_fill["fill-antialias"]),"fill-opacity":new yr(Ct.paint_fill["fill-opacity"]),"fill-color":new yr(Ct.paint_fill["fill-color"]),"fill-outline-color":new yr(Ct.paint_fill["fill-outline-color"]),"fill-translate":new mr(Ct.paint_fill["fill-translate"]),"fill-translate-anchor":new mr(Ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new vr(Ct.paint_fill["fill-pattern"])}),layout:ls},us=function(t){function e(e){t.call(this,e,cs)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n);var i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new ss(t)},e.prototype.queryRadius=function(){return na(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,r,o,a){return Zo(ia(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),i)},e.prototype.isTileClipped=function(){return!0},e}(wr),hs=Tr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ps=ds;function ds(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(fs,this,e)}function fs(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function gs(t){for(var e,n,i=0,r=0,o=t.length,a=o-1;r<o;a=r++)i+=((n=t[a]).x-(e=t[r]).x)*(e.y+n.y);return i}ds.types=["Unknown","Point","LineString","Polygon"],ds.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,o=0,a=0,s=0,l=[];t.pos<n;){if(o<=0){var c=t.readVarint();i=7&c,o=c>>3}if(o--,1===i||2===i)a+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&l.push(e),e=[]),e.push(new r(a,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&l.push(e),l},ds.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,o=0,a=1/0,s=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)(r+=t.readSVarint())<a&&(a=r),r>s&&(s=r),(o+=t.readSVarint())<l&&(l=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,l,s,c]},ds.prototype.toGeoJSON=function(t,e,n){var i,r,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),c=ds.types[this.type];function u(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];u(l=h);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],o=0;o<e;o++){var a=gs(t[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(n&&r.push(n),n=[t[o]]):n.push(t[o]))}return n&&r.push(n),r}(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)u(l[i][r])}1===l.length?l=l[0]:c="Multi"+c;var p={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var ms=ys;function ys(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(vs,this,e),this.length=this._features.length}function vs(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}function _s(t,e,n){if(3===t){var i=new ms(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}ys.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new ps(this._pbf,e,this.extent,this._keys,this._values)};var bs={VectorTile:function(t,e){this.layers=t.readFields(_s,{},e)},VectorTileFeature:ps,VectorTileLayer:ms},xs=bs.VectorTileFeature.types,ws=Math.pow(2,13);function Ss(t,e,n,i,r,o,a,s){t.emplaceBack(e,n,2*Math.floor(i*ws)+a,r*ws*2,o*ws*2,Math.round(s))}var Ps=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Mr,this.indexArray=new Vr,this.programConfigurations=new Ro(t.layers,t.zoom),this.segments=new so,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function Es(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}Ps.prototype.populate=function(t,e,n){this.features=[],this.hasPattern=os("fill-extrusion",this.layers,e);for(var i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.feature,s=o.id,l=o.index,c=o.sourceLayerIndex,u=this.layers[0]._featureFilter.needGeometry,h=Vo(a,u);if(this.layers[0]._featureFilter.filter(new sr(this.zoom),h,n)){var p={id:s,sourceLayerIndex:c,index:l,geometry:u?h.geometry:No(a),properties:a.properties,type:a.type,patterns:{}};this.hasPattern?this.features.push(as("fill-extrusion",this.layers,p,this.zoom,e)):this.addFeature(p,p.geometry,l,n,{}),e.featureIndex.insert(a,p.geometry,l,c,this.index,!0)}}},Ps.prototype.addFeatures=function(t,e,n){for(var i=0,r=this.features;i<r.length;i+=1){var o=r[i];this.addFeature(o,o.geometry,o.index,e,n)}},Ps.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ps.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hs),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ps.prototype.addFeature=function(t,e,n,i,r){for(var o=0,a=is(e,500);o<a.length;o+=1){for(var s=a[o],l=0,c=0,u=s;c<u.length;c+=1)l+=u[c].length;for(var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),p=0,d=s;p<d.length;p+=1){var f=d[p];if(0!==f.length&&!((L=f).every((function(t){return t.x<0}))||L.every((function(t){return t.x>8192}))||L.every((function(t){return t.y<0}))||L.every((function(t){return t.y>8192}))))for(var g=0,m=0;m<f.length;m++){var y=f[m];if(m>=1){var v=f[m-1];if(!Es(y,v)){h.vertexLength+4>so.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=y.sub(v)._perp()._unit(),b=v.dist(y);g+b>32768&&(g=0),Ss(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,0,g),Ss(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,1,g),Ss(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,g+=b),Ss(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,g);var x=h.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),h.vertexLength+=4,h.primitiveLength+=2}}}}if(h.vertexLength+l>so.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===xs[t.type]){for(var w=[],S=[],P=h.vertexLength,E=0,T=s;E<T.length;E+=1){var k=T[E];if(0!==k.length){k!==s[0]&&S.push(w.length/2);for(var A=0;A<k.length;A++){var C=k[A];Ss(this.layoutVertexArray,C.x,C.y,0,0,1,1,0),w.push(C.x),w.push(C.y)}}}for(var M=Ta(w,S),I=0;I<M.length;I+=3)this.indexArray.emplaceBack(P+M[I],P+M[I+2],P+M[I+1]);h.primitiveLength+=M.length/3,h.vertexLength+=l}}var L;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)},Bi("FillExtrusionBucket",Ps,{omit:["layers","features"]});var Ts={paint:new xr({"fill-extrusion-opacity":new mr(Ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yr(Ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new mr(Ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new mr(Ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vr(Ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yr(Ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yr(Ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new mr(Ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ks=function(t){function e(e){t.call(this,e,Ts)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new Ps(t)},e.prototype.queryRadius=function(){return na(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(t,e,n,i,o,a,s,l){var c=ia(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),u=this.paint.get("fill-extrusion-height").evaluate(e,n),h=this.paint.get("fill-extrusion-base").evaluate(e,n),p=function(t,e,n,i){for(var o=[],a=0,s=t;a<s.length;a+=1){var l=s[a],c=[l.x,l.y,0,1];ha(c,c,e),o.push(new r(c[0]/c[3],c[1]/c[3]))}return o}(c,l),d=function(t,e,n,i){for(var o=[],a=[],s=i[8]*e,l=i[9]*e,c=i[10]*e,u=i[11]*e,h=i[8]*n,p=i[9]*n,d=i[10]*n,f=i[11]*n,g=0,m=t;g<m.length;g+=1){for(var y=[],v=[],_=0,b=m[g];_<b.length;_+=1){var x=b[_],w=x.x,S=x.y,P=i[0]*w+i[4]*S+i[12],E=i[1]*w+i[5]*S+i[13],T=i[2]*w+i[6]*S+i[14],k=i[3]*w+i[7]*S+i[15],A=T+c,C=k+u,M=P+h,I=E+p,L=T+d,O=k+f,z=new r((P+s)/C,(E+l)/C);z.z=A/C,y.push(z);var R=new r(M/O,I/O);R.z=L/O,v.push(R)}o.push(y),a.push(v)}return[o,a]}(i,h,u,l);return function(t,e,n){var i=1/0;Zo(n,e)&&(i=Cs(n,e[0]));for(var r=0;r<e.length;r++)for(var o=e[r],a=t[r],s=0;s<o.length-1;s++){var l=o[s],c=[l,o[s+1],a[s+1],a[s],l];Go(n,c)&&(i=Math.min(i,Cs(n,c)))}return i!==1/0&&i}(d[0],d[1],p)},e}(wr);function As(t,e){return t.x*e.x+t.y*e.y}function Cs(t,e){if(1===t.length){for(var n,i=0,r=e[i++];!n||r.equals(n);)if(!(n=e[i++]))return 1/0;for(;i<e.length;i++){var o=e[i],a=t[0],s=n.sub(r),l=o.sub(r),c=a.sub(r),u=As(s,s),h=As(s,l),p=As(l,l),d=As(c,s),f=As(c,l),g=u*p-h*h,m=(p*d-h*f)/g,y=(u*f-h*d)/g,v=r.z*(1-m-y)+n.z*m+o.z*y;if(isFinite(v))return v}return 1/0}for(var _=1/0,b=0,x=e;b<x.length;b+=1)_=Math.min(_,x[b].z);return _}var Ms=Tr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Is=Tr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Ls=bs.VectorTileFeature.types,Os=Math.cos(Math.PI/180*37.5),zs=Math.pow(2,14)/.5,Rs=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((function(t){e.gradients[t.id]={}})),this.layoutVertexArray=new Ir,this.layoutVertexArray2=new Lr,this.indexArray=new Vr,this.programConfigurations=new Ro(t.layers,t.zoom),this.segments=new so,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};Rs.prototype.populate=function(t,e,n){this.hasPattern=os("line",this.layers,e);for(var i=this.layers[0].layout.get("line-sort-key"),r=[],o=0,a=t;o<a.length;o+=1){var s=a[o],l=s.feature,c=s.id,u=s.index,h=s.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,d=Vo(l,p);if(this.layers[0]._featureFilter.filter(new sr(this.zoom),d,n)){var f=i?i.evaluate(d,{},n):void 0,g={id:c,properties:l.properties,type:l.type,sourceLayerIndex:h,index:u,geometry:p?d.geometry:No(l),patterns:{},sortKey:f};r.push(g)}}i&&r.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,y=r;m<y.length;m+=1){var v=y[m],_=v.geometry,b=v.index,x=v.sourceLayerIndex;if(this.hasPattern){var w=as("line",this.layers,v,this.zoom,e);this.patternFeatures.push(w)}else this.addFeature(v,_,b,n,{});e.featureIndex.insert(t[b].feature,_,b,x,this.index)}},Rs.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Rs.prototype.addFeatures=function(t,e,n){for(var i=0,r=this.patternFeatures;i<r.length;i+=1){var o=r[i];this.addFeature(o,o.geometry,o.index,e,n)}},Rs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Rs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Rs.prototype.upload=function(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Is)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ms),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Rs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Rs.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},Rs.prototype.addFeature=function(t,e,n,i,r){var o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),s=o.get("line-cap"),l=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var u=0,h=e;u<h.length;u+=1)this.addLine(h[u],t,a,s,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)},Rs.prototype.addLine=function(t,e,n,i,r,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var a=0;a<t.length-1;a++)this.totalDistance+=t[a].dist(t[a+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var s="Polygon"===Ls[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var c=0;c<l-1&&t[c].equals(t[c+1]);)c++;if(!(l<(s?3:2))){"bevel"===n&&(r=1.05);var u,h=this.overscaling<=16?122880/(512*this.overscaling):0,p=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray),d=void 0,f=void 0,g=void 0,m=void 0;this.e1=this.e2=-1,s&&(m=t[c].sub(u=t[l-2])._unit()._perp());for(var y=c;y<l;y++)if(!(f=y===l-1?s?t[c+1]:void 0:t[y+1])||!t[y].equals(f)){m&&(g=m),u&&(d=u),u=t[y],m=f?f.sub(u)._unit()._perp():g;var v=(g=g||m).add(m);0===v.x&&0===v.y||v._unit();var _=g.x*m.x+g.y*m.y,b=v.x*m.x+v.y*m.y,x=0!==b?1/b:1/0,w=2*Math.sqrt(2-2*b),S=b<Os&&d&&f,P=g.x*m.y-g.y*m.x>0;if(S&&y>c){var E=u.dist(d);if(E>2*h){var T=u.sub(u.sub(d)._mult(h/E)._round());this.updateDistance(d,T),this.addCurrentVertex(T,g,0,0,p),d=T}}var k=d&&f,A=k?n:s?"butt":i;if(k&&"round"===A&&(x<o?A="miter":x<=2&&(A="fakeround")),"miter"===A&&x>r&&(A="bevel"),"bevel"===A&&(x>2&&(A="flipbevel"),x<r&&(A="miter")),d&&this.updateDistance(d,u),"miter"===A)v._mult(x),this.addCurrentVertex(u,v,0,0,p);else if("flipbevel"===A){if(x>100)v=m.mult(-1);else{var C=x*g.add(m).mag()/g.sub(m).mag();v._perp()._mult(C*(P?-1:1))}this.addCurrentVertex(u,v,0,0,p),this.addCurrentVertex(u,v.mult(-1),0,0,p)}else if("bevel"===A||"fakeround"===A){var M=-Math.sqrt(x*x-1),I=P?M:0,L=P?0:M;if(d&&this.addCurrentVertex(u,g,I,L,p),"fakeround"===A)for(var O=Math.round(180*w/Math.PI/20),z=1;z<O;z++){var R=z/O;if(.5!==R){var D=R-.5;R+=R*D*(R-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*D*D+(.848013+_*(.215638*_-1.06021)))}var F=m.sub(g)._mult(R)._add(g)._unit()._mult(P?-1:1);this.addHalfVertex(u,F.x,F.y,!1,P,0,p)}f&&this.addCurrentVertex(u,m,-I,-L,p)}else if("butt"===A)this.addCurrentVertex(u,v,0,0,p);else if("square"===A){var B=d?1:-1;this.addCurrentVertex(u,v,B,B,p)}else"round"===A&&(d&&(this.addCurrentVertex(u,g,0,0,p),this.addCurrentVertex(u,g,1,1,p,!0)),f&&(this.addCurrentVertex(u,m,-1,-1,p,!0),this.addCurrentVertex(u,m,0,0,p)));if(S&&y<l-1){var j=u.dist(f);if(j>2*h){var N=u.add(f.sub(u)._mult(h/j)._round());this.updateDistance(u,N),this.addCurrentVertex(N,m,0,0,p),u=N}}}}},Rs.prototype.addCurrentVertex=function(t,e,n,i,r,o){void 0===o&&(o=!1);var a=e.y*i-e.x,s=-e.y-e.x*i;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,o,!1,n,r),this.addHalfVertex(t,a,s,o,!0,-i,r),this.distance>zs/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,n,i,r,o))},Rs.prototype.addHalfVertex=function(t,e,n,i,r,o,a){var s=.5*(this.lineClips?this.scaledDistance*(zs-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(i?1:0),(t.y<<1)+(r?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&s)<<2,s>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),r?this.e2=l:this.e1=l},Rs.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Rs.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},Bi("LineBucket",Rs,{omit:["layers","patternFeatures"]});var Ds=new xr({"line-cap":new mr(Ct.layout_line["line-cap"]),"line-join":new yr(Ct.layout_line["line-join"]),"line-miter-limit":new mr(Ct.layout_line["line-miter-limit"]),"line-round-limit":new mr(Ct.layout_line["line-round-limit"]),"line-sort-key":new yr(Ct.layout_line["line-sort-key"])}),Fs={paint:new xr({"line-opacity":new yr(Ct.paint_line["line-opacity"]),"line-color":new yr(Ct.paint_line["line-color"]),"line-translate":new mr(Ct.paint_line["line-translate"]),"line-translate-anchor":new mr(Ct.paint_line["line-translate-anchor"]),"line-width":new yr(Ct.paint_line["line-width"]),"line-gap-width":new yr(Ct.paint_line["line-gap-width"]),"line-offset":new yr(Ct.paint_line["line-offset"]),"line-blur":new yr(Ct.paint_line["line-blur"]),"line-dasharray":new _r(Ct.paint_line["line-dasharray"]),"line-pattern":new vr(Ct.paint_line["line-pattern"]),"line-gradient":new br(Ct.paint_line["line-gradient"])}),layout:Ds},Bs=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new sr(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,i,r){return n=p({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,i,r)},e}(yr))(Fs.paint.properties["line-width"].specification);Bs.useIntegerZoom=!0;var js=function(t){function e(e){t.call(this,e,Fs),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof We,this.gradientVersion=(this.gradientVersion+1)%s)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(e,n){t.prototype.recalculate.call(this,e,n),this.paint._values["line-floorwidth"]=Bs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new Rs(t)},e.prototype.queryRadius=function(t){var e=t,n=Ns(ea("line-width",this,e),ea("line-gap-width",this,e)),i=ea("line-offset",this,e);return n/2+Math.abs(i)+na(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,i,o,a,s){var l=ia(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*Ns(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),u=this.paint.get("line-offset").evaluate(e,n);return u&&(i=function(t,e){for(var n=[],i=new r(0,0),o=0;o<t.length;o++){for(var a=t[o],s=[],l=0;l<a.length;l++){var c=a[l],u=a[l+1],h=0===l?i:c.sub(a[l-1])._unit()._perp(),p=l===a.length-1?i:u.sub(c)._unit()._perp(),d=h._add(p)._unit();d._mult(1/(d.x*p.x+d.y*p.y)),s.push(d._mult(e)._add(c))}n.push(s)}return n}(i,u*s)),function(t,e,n){for(var i=0;i<e.length;i++){var r=e[i];if(t.length>=3)for(var o=0;o<r.length;o++)if($o(t,r[o]))return!0;if(Ho(t,r,n))return!0}return!1}(l,i,c)},e.prototype.isTileClipped=function(){return!0},e}(wr);function Ns(t,e){return e>0?e+2*t:t}var Vs=Tr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Us=Tr([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ws=(Tr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Tr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Gs=(Tr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Tr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),qs=Tr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Zs(t,e,n){return t.sections.forEach((function(t){t.text=function(t,e,n){var i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),ar.applyArabicShaping&&(t=ar.applyArabicShaping(t)),t}(t.text,e,n)})),t}Tr([{name:"triangle",components:3,type:"Uint16"}]),Tr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Tr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Tr([{type:"Float32",name:"offsetX"}]),Tr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Hs={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Xs=function(t,e,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?r-1:0,p=n?-1:1,d=t[e+h];for(h+=p,o=d&(1<<-u)-1,d>>=-u,u+=s;u>0;o=256*o+t[e+h],h+=p,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;u>0;a=256*a+t[e+h],h+=p,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,i),o-=c}return(d?-1:1)*a*Math.pow(2,o-i)},Ys=function(t,e,n,i,r,o){var a,s,l,c=8*o-r-1,u=(1<<c)-1,h=u>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,f=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(e*l-1)*Math.pow(2,r),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+d]=255&s,d+=f,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;t[n+d]=255&a,d+=f,a/=256,c-=8);t[n+d-f]|=128*g},Ks=Js;function Js(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Js.Varint=0,Js.Fixed64=1,Js.Bytes=2,Js.Fixed32=5;var Qs="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function $s(t){return t.type===Js.Bytes?t.readVarint()+t.pos:t.pos+1}function tl(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function el(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function nl(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function il(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function rl(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function ol(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function al(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function sl(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function ll(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function cl(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function ul(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function hl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function pl(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function dl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function fl(t,e,n){1===t&&n.readMessage(gl,e)}function gl(t,e,n){if(3===t){var i=n.readMessage(ml,{}),r=i.width,o=i.height,a=i.left,s=i.top,l=i.advance;e.push({id:i.id,bitmap:new va({width:r+6,height:o+6},i.bitmap),metrics:{width:r,height:o,left:a,top:s,advance:l}})}}function ml(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function yl(t){for(var e=0,n=0,i=0,r=t;i<r.length;i+=1){var o=r[i];e+=o.w*o.h,n=Math.max(n,o.w)}t.sort((function(t,e){return e.h-t.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],s=0,l=0,c=0,u=t;c<u.length;c+=1)for(var h=u[c],p=a.length-1;p>=0;p--){var d=a[p];if(!(h.w>d.w||h.h>d.h)){if(h.x=d.x,h.y=d.y,l=Math.max(l,h.y+h.h),s=Math.max(s,h.x+h.w),h.w===d.w&&h.h===d.h){var f=a.pop();p<a.length&&(a[p]=f)}else h.h===d.h?(d.x+=h.w,d.w-=h.w):h.w===d.w?(d.y+=h.h,d.h-=h.h):(a.push({x:d.x+h.w,y:d.y,w:d.w-h.w,h:h.h}),d.y+=h.h,d.h-=h.h);break}}return{w:s,h:l,fill:e/(s*l)||0}}Js.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=hl(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=dl(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=hl(this.buf,this.pos)+4294967296*hl(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=hl(this.buf,this.pos)+4294967296*dl(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Xs(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Xs(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,o=n.buf;if(i=(112&(r=o[n.pos++]))>>4,r<128)return tl(t,i,e);if(i|=(127&(r=o[n.pos++]))<<3,r<128)return tl(t,i,e);if(i|=(127&(r=o[n.pos++]))<<10,r<128)return tl(t,i,e);if(i|=(127&(r=o[n.pos++]))<<17,r<128)return tl(t,i,e);if(i|=(127&(r=o[n.pos++]))<<24,r<128)return tl(t,i,e);if(i|=(1&(r=o[n.pos++]))<<31,r<128)return tl(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Qs?function(t,e,n){return Qs.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",r=e;r<n;){var o,a,s,l=t[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(o=t[r+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(a=t[r+2],128==(192&(o=t[r+1]))&&128==(192&a)&&((c=(15&l)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(a=t[r+2],s=t[r+3],128==(192&(o=t[r+1]))&&128==(192&a)&&128==(192&s)&&((c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Js.Bytes)return t.push(this.readVarint(e));var n=$s(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Js.Bytes)return t.push(this.readSVarint());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Js.Bytes)return t.push(this.readBoolean());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Js.Bytes)return t.push(this.readFloat());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Js.Bytes)return t.push(this.readDouble());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Js.Bytes)return t.push(this.readFixed32());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Js.Bytes)return t.push(this.readSFixed32());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Js.Bytes)return t.push(this.readFixed64());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Js.Bytes)return t.push(this.readSFixed64());var e=$s(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Js.Varint)for(;this.buf[this.pos++]>127;);else if(e===Js.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Js.Fixed32)this.pos+=4;else{if(e!==Js.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),pl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),pl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),pl(this.buf,-1&t,this.pos),pl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),pl(this.buf,-1&t,this.pos),pl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&el(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Ys(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Ys(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&el(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,Js.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,nl,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,il,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,al,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,rl,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,ol,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,sl,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ll,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,cl,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,ul,e)},writeBytesField:function(t,e){this.writeTag(t,Js.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Js.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Js.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Js.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Js.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Js.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Js.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Js.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Js.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Js.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var vl=function(t,e){var n=e.pixelRatio,i=e.version,r=e.stretchX,o=e.stretchY,a=e.content;this.paddedRect=t,this.pixelRatio=n,this.stretchX=r,this.stretchY=o,this.content=a,this.version=i},_l={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};_l.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},_l.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},_l.tlbr.get=function(){return this.tl.concat(this.br)},_l.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(vl.prototype,_l);var bl=function(t,e){var n={},i={};this.haveRenderCallbacks=[];var r=[];this.addImages(t,n,r),this.addImages(e,i,r);var o=yl(r),a=new _a({width:o.w||1,height:o.h||1});for(var s in t){var l=t[s],c=n[s].paddedRect;_a.copy(l.data,a,{x:0,y:0},{x:c.x+1,y:c.y+1},l.data)}for(var u in e){var h=e[u],p=i[u].paddedRect,d=p.x+1,f=p.y+1,g=h.data.width,m=h.data.height;_a.copy(h.data,a,{x:0,y:0},{x:d,y:f},h.data),_a.copy(h.data,a,{x:0,y:m-1},{x:d,y:f-1},{width:g,height:1}),_a.copy(h.data,a,{x:0,y:0},{x:d,y:f+m},{width:g,height:1}),_a.copy(h.data,a,{x:g-1,y:0},{x:d-1,y:f},{width:1,height:m}),_a.copy(h.data,a,{x:0,y:0},{x:d+g,y:f},{width:1,height:m})}this.image=a,this.iconPositions=n,this.patternPositions=i};bl.prototype.addImages=function(t,e,n){for(var i in t){var r=t[i],o={x:0,y:0,w:r.data.width+2,h:r.data.height+2};n.push(o),e[i]=new vl(o,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}},bl.prototype.patchUpdatedImages=function(t,e){for(var n in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)},bl.prototype.patchUpdatedImage=function(t,e,n){if(t&&e&&t.version!==e.version){t.version=e.version;var i=t.tl;n.update(e.data,void 0,{x:i[0],y:i[1]})}},Bi("ImagePosition",vl),Bi("ImageAtlas",bl);var xl={horizontal:1,vertical:2,horizontalOnly:3},wl=function(){this.scale=1,this.fontStack="",this.imageName=null};wl.forText=function(t,e){var n=new wl;return n.scale=t||1,n.fontStack=e,n},wl.forImage=function(t){var e=new wl;return e.imageName=t,e};var Sl=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Pl(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g){var m,y=Sl.fromFeature(t,r);h===xl.vertical&&y.verticalizePunctuation();var v=ar.processBidirectionalText,_=ar.processStyledBidirectionalText;if(v&&1===y.sections.length){m=[];for(var b=0,x=v(y.toString(),Il(y,c,o,e,i,d,f));b<x.length;b+=1){var w=x[b],S=new Sl;S.text=w,S.sections=y.sections;for(var P=0;P<w.length;P++)S.sectionIndex.push(0);m.push(S)}}else if(_){m=[];for(var E=0,T=_(y.text,y.sectionIndex,Il(y,c,o,e,i,d,f));E<T.length;E+=1){var k=T[E],A=new Sl;A.text=k[0],A.sectionIndex=k[1],A.sections=y.sections,m.push(A)}}else m=function(t,e){for(var n=[],i=t.text,r=0,o=0,a=e;o<a.length;o+=1){var s=a[o];n.push(t.substring(r,s)),r=s}return r<i.length&&n.push(t.substring(r,i.length)),n}(y,Il(y,c,o,e,i,d,f));var C=[],M={positionedLines:C,text:y.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,e,n,i,r,o,a,s,l,c,u,h){for(var p=0,d=-17,f=0,g=0,m="right"===s?1:"left"===s?0:.5,y=0,v=0,_=r;v<_.length;v+=1){var b=_[v];b.trim();var x=b.getMaxScale(),w=24*(x-1),S={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=S;var P=S.positionedGlyphs,E=0;if(b.length()){for(var T=0;T<b.length();T++){var k=b.getSection(T),A=b.getSectionIndex(T),C=b.getCharCode(T),M=0,I=null,L=null,O=null,z=24,R=!(l===xl.horizontal||!u&&!Hi(C)||u&&(El[C]||(G=C,qi.Arabic(G)||qi["Arabic Supplement"](G)||qi["Arabic Extended-A"](G)||qi["Arabic Presentation Forms-A"](G)||qi["Arabic Presentation Forms-B"](G))));if(k.imageName){var D=i[k.imageName];if(!D)continue;O=k.imageName,t.iconsInText=t.iconsInText||!0,L=D.paddedRect;var F=D.displaySize;k.scale=24*k.scale/h,M=w+(24-F[1]*k.scale),z=(I={width:F[0],height:F[1],left:1,top:-3,advance:R?F[1]:F[0]}).advance;var B=R?F[0]*k.scale-24*x:F[1]*k.scale-24*x;B>0&&B>E&&(E=B)}else{var j=n[k.fontStack],N=j&&j[C];if(N&&N.rect)L=N.rect,I=N.metrics;else{var V=e[k.fontStack],U=V&&V[C];if(!U)continue;I=U.metrics}M=24*(x-k.scale)}R?(t.verticalizable=!0,P.push({glyph:C,imageName:O,x:p,y:d+M,vertical:R,scale:k.scale,fontStack:k.fontStack,sectionIndex:A,metrics:I,rect:L}),p+=z*k.scale+c):(P.push({glyph:C,imageName:O,x:p,y:d+M,vertical:R,scale:k.scale,fontStack:k.fontStack,sectionIndex:A,metrics:I,rect:L}),p+=I.advance*k.scale+c)}0!==P.length&&(f=Math.max(p-c,f),Ol(P,0,P.length-1,m,E)),p=0;var W=o*x+E;S.lineOffset=Math.max(E,w),d+=W,g=Math.max(W,g),++y}else d+=o,++y}var G,q=d- -17,Z=Ll(a),H=Z.horizontalAlign,X=Z.verticalAlign;(function(t,e,n,i,r,o,a,s,l){var c,u=(e-n)*r;c=o!==a?-s*i- -17:(-i*l+.5)*a;for(var h=0,p=t;h<p.length;h+=1)for(var d=0,f=p[h].positionedGlyphs;d<f.length;d+=1){var g=f[d];g.x+=u,g.y+=c}})(t.positionedLines,m,H,X,f,g,o,q,r.length),t.top+=-X*q,t.bottom=t.top+q,t.left+=-H*f,t.right=t.left+f}(M,e,n,i,m,a,s,l,h,c,p,g),!function(t){for(var e=0,n=t;e<n.length;e+=1)if(0!==n[e].positionedGlyphs.length)return!1;return!0}(C)&&M}Sl.fromFeature=function(t,e){for(var n=new Sl,i=0;i<t.sections.length;i++){var r=t.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,e)}return n},Sl.prototype.length=function(){return this.text.length},Sl.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Sl.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},Sl.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Sl.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;e+=i&&Xi(i)&&!Hs[t[n+1]]||r&&Xi(r)&&!Hs[t[n-1]]||!Hs[t[n]]?t[n]:Hs[t[n]]}return e}(this.text)},Sl.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&El[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,i=this.text.length-1;i>=0&&i>=t&&El[this.text.charCodeAt(i)];i--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)},Sl.prototype.substring=function(t,e){var n=new Sl;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n},Sl.prototype.toString=function(){return this.text},Sl.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce((function(e,n){return Math.max(e,t.sections[n].scale)}),0)},Sl.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(wl.forText(t.scale,t.fontStack||e));for(var n=this.sections.length-1,i=0;i<t.text.length;++i)this.sectionIndex.push(n)},Sl.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(wl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):S("Reached maximum number of images 6401")}else S("Can't add FormattedSection with an empty image.")},Sl.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var El={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Tl={};function kl(t,e,n,i,r,o){if(e.imageName){var a=i[e.imageName];return a?a.displaySize[0]*e.scale*24/o+r:0}var s=n[e.fontStack],l=s&&s[t];return l?l.metrics.advance*e.scale+r:0}function Al(t,e,n,i){var r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function Cl(t,e,n){var i=0;return 10===t&&(i-=1e4),n&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function Ml(t,e,n,i,r,o){for(var a=null,s=Al(e,n,r,o),l=0,c=i;l<c.length;l+=1){var u=c[l],h=Al(e-u.x,n,r,o)+u.badness;h<=s&&(a=u,s=h)}return{index:t,x:e,priorBreak:a,badness:s}}function Il(t,e,n,i,r,o,a){if("point"!==o)return[];if(!t)return[];for(var s,l=[],c=function(t,e,n,i,r,o){for(var a=0,s=0;s<t.length();s++){var l=t.getSection(s);a+=kl(t.getCharCode(s),l,i,r,e,o)}return a/Math.max(1,Math.ceil(a/n))}(t,e,n,i,r,a),u=t.text.indexOf("\u200b")>=0,h=0,p=0;p<t.length();p++){var d=t.getSection(p),f=t.getCharCode(p);if(El[f]||(h+=kl(f,d,i,r,e,a)),p<t.length()-1){var g=!((s=f)<11904||!(qi["Bopomofo Extended"](s)||qi.Bopomofo(s)||qi["CJK Compatibility Forms"](s)||qi["CJK Compatibility Ideographs"](s)||qi["CJK Compatibility"](s)||qi["CJK Radicals Supplement"](s)||qi["CJK Strokes"](s)||qi["CJK Symbols and Punctuation"](s)||qi["CJK Unified Ideographs Extension A"](s)||qi["CJK Unified Ideographs"](s)||qi["Enclosed CJK Letters and Months"](s)||qi["Halfwidth and Fullwidth Forms"](s)||qi.Hiragana(s)||qi["Ideographic Description Characters"](s)||qi["Kangxi Radicals"](s)||qi["Katakana Phonetic Extensions"](s)||qi.Katakana(s)||qi["Vertical Forms"](s)||qi["Yi Radicals"](s)||qi["Yi Syllables"](s)));(Tl[f]||g||d.imageName)&&l.push(Ml(p+1,h,c,l,Cl(f,t.getCharCode(p+1),g&&u),!1))}}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Ml(t.length(),h,c,l,0,!0))}function Ll(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Ol(t,e,n,i,r){if(i||r)for(var o=t[n],a=(t[n].x+o.metrics.advance*o.scale)*i,s=e;s<=n;s++)t[s].x-=a,t[s].y+=r}function zl(t,e,n,i,r,o){var a,s=t.image;if(s.content){var l=s.content,c=s.pixelRatio||1;a=[l[0]/c,l[1]/c,s.displaySize[0]-l[2]/c,s.displaySize[1]-l[3]/c]}var u,h,p,d,f=e.left*o,g=e.right*o;"width"===n||"both"===n?(d=r[0]+f-i[3],h=r[0]+g+i[1]):h=(d=r[0]+(f+g-s.displaySize[0])/2)+s.displaySize[0];var m=e.top*o,y=e.bottom*o;return"height"===n||"both"===n?(u=r[1]+m-i[0],p=r[1]+y+i[2]):p=(u=r[1]+(m+y-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:u,right:h,bottom:p,left:d,collisionPadding:a}}Tl[10]=!0,Tl[32]=!0,Tl[38]=!0,Tl[40]=!0,Tl[41]=!0,Tl[43]=!0,Tl[45]=!0,Tl[47]=!0,Tl[173]=!0,Tl[183]=!0,Tl[8203]=!0,Tl[8208]=!0,Tl[8211]=!0,Tl[8231]=!0;var Rl=function(t){function e(e,n,i,r){t.call(this,e,n),this.angle=i,void 0!==r&&(this.segment=r)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(r);function Dl(t,e){var n=e.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new sr(t+1))};if("source"===n.kind)return{kind:"source"};for(var i=n.zoomStops,r=n.interpolationType,o=0;o<i.length&&i[o]<=t;)o++;for(var a=o=Math.max(0,o-1);a<i.length&&i[a]<t+1;)a++;a=Math.min(i.length-1,a);var s=i[o],l=i[a];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:l,interpolationType:r}:{kind:"camera",minZoom:s,maxZoom:l,minSize:n.evaluate(new sr(s)),maxSize:n.evaluate(new sr(l)),interpolationType:r}}function Fl(t,e,n){var i=e.uSize,r=n.lowerSize;return"source"===t.kind?r/128:"composite"===t.kind?Ge(r/128,n.upperSize/128,e.uSizeT):i}function Bl(t,e){var n=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){var r=t.interpolationType,o=r?u(an.interpolationFactor(r,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?i=Ge(t.minSize,t.maxSize,o):n=o}return{uSizeT:n,uSize:i}}Bi("Anchor",Rl);var jl=Object.freeze({__proto__:null,getSizeData:Dl,evaluateSizeForFeature:Fl,evaluateSizeForZoom:Bl,SIZE_PACK_FACTOR:128});function Nl(t,e,n,i,r){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var l=[],c=0;s<n/2;){var u=t[a],h=t[a+1];if(!h)return!1;var p=t[a-1].angleTo(u)-u.angleTo(h);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:p}),c+=p;s-l[0].distance>i;)c-=l.shift().angleDelta;if(c>r)return!1;a++,s+=u.dist(h)}return!0}function Vl(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Ul(t,e,n){return t?.6*e*n:0}function Wl(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Gl(t,e,n,i,r,o){for(var a=Ul(n,r,o),s=Wl(n,i)*o,l=0,c=Vl(t)/2,u=0;u<t.length-1;u++){var h=t[u],p=t[u+1],d=h.dist(p);if(l+d>c){var f=(c-l)/d,g=Ge(h.x,p.x,f),m=Ge(h.y,p.y,f),y=new Rl(g,m,p.angleTo(h),u);return y._round(),!a||Nl(t,y,s,a,e)?y:void 0}l+=d}}function ql(t,e,n,i,r,o,a,s,l){var c=Ul(i,o,a),u=Wl(i,r),h=u*a,p=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),function t(e,n,i,r,o,a,s,l,c){for(var u=a/2,h=Vl(e),p=0,d=n-i,f=[],g=0;g<e.length-1;g++){for(var m=e[g],y=e[g+1],v=m.dist(y),_=y.angleTo(m);d+i<p+v;){var b=((d+=i)-p)/v,x=Ge(m.x,y.x,b),w=Ge(m.y,y.y,b);if(x>=0&&x<c&&w>=0&&w<c&&d-u>=0&&d+u<=h){var S=new Rl(x,w,_,g);S._round(),r&&!Nl(e,S,a,r,o)||f.push(S)}}p+=v}return l||f.length||s||(f=t(e,p/2,i,r,o,a,s,!0,c)),f}(t,p?e/2*s%e:(u/2+2*o)*a*s%e,e,c,n,h,p,!1,l)}function Zl(t,e,n,i,o){for(var a=[],s=0;s<t.length;s++)for(var l=t[s],c=void 0,u=0;u<l.length-1;u++){var h=l[u],p=l[u+1];h.x<e&&p.x<e||(h.x<e?h=new r(e,h.y+(e-h.x)/(p.x-h.x)*(p.y-h.y))._round():p.x<e&&(p=new r(e,h.y+(e-h.x)/(p.x-h.x)*(p.y-h.y))._round()),h.y<n&&p.y<n||(h.y<n?h=new r(h.x+(n-h.y)/(p.y-h.y)*(p.x-h.x),n)._round():p.y<n&&(p=new r(h.x+(n-h.y)/(p.y-h.y)*(p.x-h.x),n)._round()),h.x>=i&&p.x>=i||(h.x>=i?h=new r(i,h.y+(i-h.x)/(p.x-h.x)*(p.y-h.y))._round():p.x>=i&&(p=new r(i,h.y+(i-h.x)/(p.x-h.x)*(p.y-h.y))._round()),h.y>=o&&p.y>=o||(h.y>=o?h=new r(h.x+(o-h.y)/(p.y-h.y)*(p.x-h.x),o)._round():p.y>=o&&(p=new r(h.x+(o-h.y)/(p.y-h.y)*(p.x-h.x),o)._round()),c&&h.equals(c[c.length-1])||a.push(c=[h]),c.push(p)))))}return a}function Hl(t,e,n,i){var o=[],a=t.image,s=a.pixelRatio,l=a.paddedRect.w-2,c=a.paddedRect.h-2,u=t.right-t.left,h=t.bottom-t.top,p=a.stretchX||[[0,l]],d=a.stretchY||[[0,c]],f=function(t,e){return t+e[1]-e[0]},g=p.reduce(f,0),m=d.reduce(f,0),y=l-g,v=c-m,_=0,b=g,x=0,w=m,S=0,P=y,E=0,T=v;if(a.content&&i){var k=a.content;_=Xl(p,0,k[0]),x=Xl(d,0,k[1]),b=Xl(p,k[0],k[2]),w=Xl(d,k[1],k[3]),S=k[0]-_,E=k[1]-x,P=k[2]-k[0]-b,T=k[3]-k[1]-w}var A=function(i,o,l,c){var p=Kl(i.stretch-_,b,u,t.left),d=Jl(i.fixed-S,P,i.stretch,g),f=Kl(o.stretch-x,w,h,t.top),y=Jl(o.fixed-E,T,o.stretch,m),v=Kl(l.stretch-_,b,u,t.left),k=Jl(l.fixed-S,P,l.stretch,g),A=Kl(c.stretch-x,w,h,t.top),C=Jl(c.fixed-E,T,c.stretch,m),M=new r(p,f),I=new r(v,f),L=new r(v,A),O=new r(p,A),z=new r(d/s,y/s),R=new r(k/s,C/s),D=e*Math.PI/180;if(D){var F=Math.sin(D),B=Math.cos(D),j=[B,-F,F,B];M._matMult(j),I._matMult(j),O._matMult(j),L._matMult(j)}var N=i.stretch+i.fixed,V=o.stretch+o.fixed;return{tl:M,tr:I,bl:O,br:L,tex:{x:a.paddedRect.x+1+N,y:a.paddedRect.y+1+V,w:l.stretch+l.fixed-N,h:c.stretch+c.fixed-V},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:z,pixelOffsetBR:R,minFontScaleX:P/s/u,minFontScaleY:T/s/h,isSDF:n}};if(i&&(a.stretchX||a.stretchY))for(var C=Yl(p,y,g),M=Yl(d,v,m),I=0;I<C.length-1;I++)for(var L=C[I],O=C[I+1],z=0;z<M.length-1;z++)o.push(A(L,M[z],O,M[z+1]));else o.push(A({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return o}function Xl(t,e,n){for(var i=0,r=0,o=t;r<o.length;r+=1){var a=o[r];i+=Math.max(e,Math.min(n,a[1]))-Math.max(e,Math.min(n,a[0]))}return i}function Yl(t,e,n){for(var i=[{fixed:-1,stretch:0}],r=0,o=t;r<o.length;r+=1){var a=o[r],s=a[0],l=a[1],c=i[i.length-1];i.push({fixed:s-c.stretch,stretch:c.stretch}),i.push({fixed:s-c.stretch,stretch:c.stretch+(l-s)})}return i.push({fixed:e+1,stretch:n}),i}function Kl(t,e,n,i){return t/e*n+i}function Jl(t,e,n,i){return t-e*n/i}var Ql=function(t,e,n,i,o,a,s,l,c,u){if(this.boxStartIndex=t.length,c){var h=a.top,p=a.bottom,d=a.collisionPadding;d&&(h-=d[1],p+=d[3]);var f=p-h;f>0&&(f=Math.max(10,f),this.circleDiameter=f)}else{var g=a.top*s-l,m=a.bottom*s+l,y=a.left*s-l,v=a.right*s+l,_=a.collisionPadding;if(_&&(y-=_[0]*s,g-=_[1]*s,v+=_[2]*s,m+=_[3]*s),u){var b=new r(y,g),x=new r(v,g),w=new r(y,m),S=new r(v,m),P=u*Math.PI/180;b._rotate(P),x._rotate(P),w._rotate(P),S._rotate(P),y=Math.min(b.x,x.x,w.x,S.x),v=Math.max(b.x,x.x,w.x,S.x),g=Math.min(b.y,x.y,w.y,S.y),m=Math.max(b.y,x.y,w.y,S.y)}t.emplaceBack(e.x,e.y,y,g,v,m,n,i,o)}this.boxEndIndex=t.length},$l=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=tc),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};function tc(t,e){return t<e?-1:t>e?1:0}function ec(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!1);for(var i=1/0,o=1/0,a=-1/0,s=-1/0,l=t[0],c=0;c<l.length;c++){var u=l[c];(!c||u.x<i)&&(i=u.x),(!c||u.y<o)&&(o=u.y),(!c||u.x>a)&&(a=u.x),(!c||u.y>s)&&(s=u.y)}var h=Math.min(a-i,s-o),p=h/2,d=new $l([],nc);if(0===h)return new r(i,o);for(var f=i;f<a;f+=h)for(var g=o;g<s;g+=h)d.push(new ic(f+p,g+p,p,t));for(var m=function(t){for(var e=0,n=0,i=0,r=t[0],o=0,a=r.length,s=a-1;o<a;s=o++){var l=r[o],c=r[s],u=l.x*c.y-c.x*l.y;n+=(l.x+c.x)*u,i+=(l.y+c.y)*u,e+=3*u}return new ic(n/e,i/e,0,t)}(t),y=d.length;d.length;){var v=d.pop();(v.d>m.d||!m.d)&&(m=v,n&&console.log("found best %d after %d probes",Math.round(1e4*v.d)/1e4,y)),v.max-m.d<=e||(d.push(new ic(v.p.x-(p=v.h/2),v.p.y-p,p,t)),d.push(new ic(v.p.x+p,v.p.y-p,p,t)),d.push(new ic(v.p.x-p,v.p.y+p,p,t)),d.push(new ic(v.p.x+p,v.p.y+p,p,t)),y+=4)}return n&&(console.log("num probes: "+y),console.log("best distance: "+m.d)),m.p}function nc(t,e){return e.max-t.max}function ic(t,e,n,i){this.p=new r(t,e),this.h=n,this.d=function(t,e){for(var n=!1,i=1/0,r=0;r<e.length;r++)for(var o=e[r],a=0,s=o.length,l=s-1;a<s;l=a++){var c=o[a],u=o[l];c.y>t.y!=u.y>t.y&&t.x<(u.x-c.x)*(t.y-c.y)/(u.y-c.y)+c.x&&(n=!n),i=Math.min(i,Jo(t,c,u))}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}$l.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},$l.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},$l.prototype.peek=function(){return this.data[0]},$l.prototype._up=function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i},$l.prototype._down=function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&n(e[s],a)<0&&(o=s,a=e[s]),n(a,r)>=0)break;e[t]=a,t=o}e[t]=r};var rc=Number.POSITIVE_INFINITY;function oc(t,e){return e[1]!==rc?function(t,e,n){var i=0,r=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":r=n-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-n}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,r]}(t,e[0],e[1]):function(t,e){var n=0,i=0;e<0&&(e=0);var r=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":i=r-7;break;case"bottom-right":case"bottom-left":i=7-r;break;case"bottom":i=7-e;break;case"top":i=e-7}switch(t){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=e;break;case"right":n=-e}return[n,i]}(t,e[0])}function ac(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function sc(t,e,n,i,o,a,s,l,c,u,h,p,d,f,g){var m=function(t,e,n,i,o,a,s,l){for(var c=i.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,u=[],h=0,p=e.positionedLines;h<p.length;h+=1)for(var d=p[h],f=0,g=d.positionedGlyphs;f<g.length;f+=1){var m=g[f];if(m.rect){var y=m.rect||{},v=4,_=!0,b=1,x=0,w=(o||l)&&m.vertical,S=m.metrics.advance*m.scale/2;if(l&&e.verticalizable&&(x=d.lineOffset/2-(m.imageName?-(24-m.metrics.width*m.scale)/2:24*(m.scale-1))),m.imageName){var P=s[m.imageName];_=P.sdf,v=1/(b=P.pixelRatio)}var E=o?[m.x+S,m.y]:[0,0],T=o?[0,0]:[m.x+S+n[0],m.y+n[1]-x],k=[0,0];w&&(k=T,T=[0,0]);var A=(m.metrics.left-v)*m.scale-S+T[0],C=(-m.metrics.top-v)*m.scale+T[1],M=A+y.w*m.scale/b,I=C+y.h*m.scale/b,L=new r(A,C),O=new r(M,C),z=new r(A,I),R=new r(M,I);if(w){var D=new r(-S,S- -17),F=-Math.PI/2,B=12-S,j=new r(22-B,-(m.imageName?B:0)),N=new(Function.prototype.bind.apply(r,[null].concat(k)));L._rotateAround(F,D)._add(j)._add(N),O._rotateAround(F,D)._add(j)._add(N),z._rotateAround(F,D)._add(j)._add(N),R._rotateAround(F,D)._add(j)._add(N)}if(c){var V=Math.sin(c),U=Math.cos(c),W=[U,-V,V,U];L._matMult(W),O._matMult(W),z._matMult(W),R._matMult(W)}var G=new r(0,0),q=new r(0,0);u.push({tl:L,tr:O,bl:z,br:R,tex:y,writingMode:e.writingMode,glyphOffset:E,sectionIndex:m.sectionIndex,isSDF:_,pixelOffsetTL:G,pixelOffsetBR:q,minFontScaleX:0,minFontScaleY:0})}}return u}(0,n,l,o,a,s,i,t.allowVerticalPlacement),y=t.textSizeData,v=null;"source"===y.kind?(v=[128*o.layout.get("text-size").evaluate(s,{})])[0]>32640&&S(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===y.kind&&((v=[128*f.compositeTextSizes[0].evaluate(s,{},g),128*f.compositeTextSizes[1].evaluate(s,{},g)])[0]>32640||v[1]>32640)&&S(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,m,v,l,a,s,u,e,c.lineStartIndex,c.lineLength,d,g);for(var _=0,b=h;_<b.length;_+=1)p[b[_]]=t.text.placedSymbolArray.length-1;return 4*m.length}function lc(t){for(var e in t)return t[e];return null}function cc(t,e,n,i){var r=t.compareText;if(e in r){for(var o=r[e],a=o.length-1;a>=0;a--)if(i.dist(o[a])<n)return!0}else r[e]=[];return r[e].push(i),!1}var uc=bs.VectorTileFeature.types,hc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function pc(t,e,n,i,r,o,a,s,l,c,u,h,p){var d=s?Math.min(32640,Math.round(s[0])):0,f=s?Math.min(32640,Math.round(s[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),o,a,(d<<1)+(l?1:0),f,16*c,16*u,256*h,256*p)}function dc(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function fc(t){for(var e=0,n=t.sections;e<n.length;e+=1)if(Ji(n[e].text))return!0;return!1}var gc=function(t){this.layoutVertexArray=new zr,this.indexArray=new Vr,this.programConfigurations=t,this.segments=new so,this.dynamicLayoutVertexArray=new Rr,this.opacityVertexArray=new Dr,this.placedSymbolArray=new $r};gc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},gc.prototype.upload=function(t,e,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Vs.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Us.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,hc,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))},gc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Bi("SymbolBuffers",gc);var mc=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new so,this.collisionVertexArray=new Nr};mc.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Ws.members,!0)},mc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Bi("CollisionBuffers",mc);var yc=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=sa([]),this.placementViewportMatrix=sa([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dl(this.zoom,e["text-size"]),this.iconSizeData=Dl(this.zoom,e["icon-size"]);var n=this.layers[0].layout,i=n.get("symbol-sort-key"),r=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((function(t){return xl[t]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=t.sourceID};yc.prototype.createArrays=function(){this.text=new gc(new Ro(this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new gc(new Ro(this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.glyphOffsetArray=new no,this.lineVertexArray=new io,this.symbolInstances=new eo},yc.prototype.calculateGlyphDependencies=function(t,e,n,i,r){for(var o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(n||i)&&r){var a=Hs[t.charAt(o)];a&&(e[a.charCodeAt(0)]=!0)}},yc.prototype.populate=function(t,e,n){var i=this.layers[0],r=i.layout,o=r.get("text-font"),a=r.get("text-field"),s=r.get("icon-image"),l=("constant"!==a.value.kind||a.value.value instanceof ie&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),c="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,u=r.get("symbol-sort-key");if(this.features=[],l||c){for(var h=e.iconDependencies,p=e.glyphDependencies,d=e.availableImages,f=new sr(this.zoom),g=0,m=t;g<m.length;g+=1){var y=m[g],v=y.feature,_=y.id,b=y.index,x=y.sourceLayerIndex,w=i._featureFilter.needGeometry,S=Vo(v,w);if(i._featureFilter.filter(f,S,n)){w||(S.geometry=No(v));var P=void 0;if(l){var E=i.getValueAndResolveTokens("text-field",S,n,d),T=ie.factory(E);fc(T)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===rr()||this.hasRTLText&&ar.isParsed())&&(P=Zs(T,i,S))}var k=void 0;if(c){var A=i.getValueAndResolveTokens("icon-image",S,n,d);k=A instanceof re?A:re.fromString(A)}if(P||k){var C=this.sortFeaturesByKey?u.evaluate(S,{},n):void 0;if(this.features.push({id:_,text:P,icon:k,index:b,sourceLayerIndex:x,geometry:S.geometry,properties:v.properties,type:uc[v.type],sortKey:C}),k&&(h[k.name]=!0),P){var M=o.evaluate(S,{},n).join(","),I="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(xl.vertical)>=0;for(var L=0,O=P.sections;L<O.length;L+=1){var z=O[L];if(z.image)h[z.image.name]=!0;else{var R=Zi(P.toString()),D=z.fontStack||M,F=p[D]=p[D]||{};this.calculateGlyphDependencies(z.text,F,I,this.allowVerticalPlacement,R)}}}}}}"line"===r.get("symbol-placement")&&(this.features=function(t){var e={},n={},i=[],r=0;function o(e){i.push(t[e]),r++}function a(t,e,r){var o=n[t];return delete n[t],n[e]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(r[0]),o}function s(t,n,r){var o=e[n];return delete e[n],e[t]=o,i[o].geometry[0].shift(),i[o].geometry[0]=r[0].concat(i[o].geometry[0]),o}function l(t,e,n){var i=n?e[0][e[0].length-1]:e[0][0];return t+":"+i.x+":"+i.y}for(var c=0;c<t.length;c++){var u=t[c],h=u.geometry,p=u.text?u.text.toString():null;if(p){var d=l(p,h),f=l(p,h,!0);if(d in n&&f in e&&n[d]!==e[f]){var g=s(d,f,h),m=a(d,f,i[g].geometry);delete e[d],delete n[f],n[l(p,i[m].geometry,!0)]=m,i[g].geometry=null}else d in n?a(d,f,h):f in e?s(d,f,h):(o(c),e[d]=r-1,n[f]=r-1)}else o(c)}return i.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}},yc.prototype.update=function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))},yc.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},yc.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},yc.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},yc.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},yc.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},yc.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var i=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:i},a<e.length-1&&(i+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:r},s>0&&(r+=e[s-1].dist(e[s]));for(var l=0;l<e.length;l++){var c=o[l];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},yc.prototype.addSymbols=function(t,e,n,i,r,o,a,s,l,c,u,h){for(var p=t.indexArray,d=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,d,p,this.canOverlap?o.sortKey:void 0),g=this.glyphOffsetArray.length,m=f.vertexLength,y=this.allowVerticalPlacement&&a===xl.vertical?Math.PI/2:0,v=o.text&&o.text.sections,_=0;_<e.length;_++){var b=e[_],x=b.tl,w=b.tr,S=b.bl,P=b.br,E=b.tex,T=b.pixelOffsetTL,k=b.pixelOffsetBR,A=b.minFontScaleX,C=b.minFontScaleY,M=b.glyphOffset,I=b.isSDF,L=b.sectionIndex,O=f.vertexLength,z=M[1];pc(d,s.x,s.y,x.x,z+x.y,E.x,E.y,n,I,T.x,T.y,A,C),pc(d,s.x,s.y,w.x,z+w.y,E.x+E.w,E.y,n,I,k.x,T.y,A,C),pc(d,s.x,s.y,S.x,z+S.y,E.x,E.y+E.h,n,I,T.x,k.y,A,C),pc(d,s.x,s.y,P.x,z+P.y,E.x+E.w,E.y+E.h,n,I,k.x,k.y,A,C),dc(t.dynamicLayoutVertexArray,s,y),p.emplaceBack(O,O+1,O+2),p.emplaceBack(O+1,O+2,O+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(M[0]),_!==e.length-1&&L===e[_+1].sectionIndex||t.programConfigurations.populatePaintArrays(d.length,o,o.index,{},h,v&&v[L])}t.placedSymbolArray.emplaceBack(s.x,s.y,g,this.glyphOffsetArray.length-g,m,l,c,s.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],a,0,!1,0,u)},yc.prototype._addCollisionDebugVertex=function(t,e,n,i,r,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i,r,Math.round(o.x),Math.round(o.y))},yc.prototype.addCollisionDebugVertices=function(t,e,n,i,o,a,s){var l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),c=l.vertexLength,u=o.layoutVertexArray,h=o.collisionVertexArray,p=s.anchorX,d=s.anchorY;this._addCollisionDebugVertex(u,h,a,p,d,new r(t,e)),this._addCollisionDebugVertex(u,h,a,p,d,new r(n,e)),this._addCollisionDebugVertex(u,h,a,p,d,new r(n,i)),this._addCollisionDebugVertex(u,h,a,p,d,new r(t,i)),l.vertexLength+=4;var f=o.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4},yc.prototype.addDebugCollisionBoxes=function(t,e,n,i){for(var r=t;r<e;r++){var o=this.collisionBoxArray.get(r);this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,i?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n)}},yc.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mc(Br,Gs.members,Hr),this.iconCollisionBox=new mc(Br,Gs.members,Hr);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},yc.prototype._deserializeCollisionBoxesForSymbol=function(t,e,n,i,r,o,a,s,l){for(var c={},u=e;u<n;u++){var h=t.get(u);c.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},c.textFeatureIndex=h.featureIndex;break}for(var p=i;p<r;p++){var d=t.get(p);c.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalTextFeatureIndex=d.featureIndex;break}for(var f=o;f<a;f++){var g=t.get(f);c.iconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},c.iconFeatureIndex=g.featureIndex;break}for(var m=s;m<l;m++){var y=t.get(m);c.verticalIconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},c.verticalIconFeatureIndex=y.featureIndex;break}return c},yc.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}},yc.prototype.hasTextData=function(){return this.text.segments.get().length>0},yc.prototype.hasIconData=function(){return this.icon.segments.get().length>0},yc.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},yc.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},yc.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},yc.prototype.addIndicesForPlacedSymbol=function(t,e){for(var n=t.placedSymbolArray.get(e),i=n.vertexStartIndex+4*n.numGlyphs,r=n.vertexStartIndex;r<i;r+=4)t.indexArray.emplaceBack(r,r+1,r+2),t.indexArray.emplaceBack(r+1,r+2,r+3)},yc.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),n=Math.cos(t),i=[],r=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);i.push(0|Math.round(e*s.anchorX+n*s.anchorY)),r.push(s.featureIndex)}return o.sort((function(t,e){return i[t]-i[e]||r[e]-r[t]})),o},yc.prototype.addToSortKeyRanges=function(t,e){var n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},yc.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var n=0,i=this.symbolInstanceIndexes;n<i.length;n+=1){var r=this.symbolInstances.get(i[n]);this.featureSortOrder.push(r.featureIndex),[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((function(t,n,i){t>=0&&i.indexOf(t)===n&&e.addIndicesForPlacedSymbol(e.text,t)})),r.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,r.verticalPlacedTextSymbolIndex),r.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.placedIconSymbolIndex),r.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Bi("SymbolBucket",yc,{omit:["layers","collisionBoxArray","features","compareText"]}),yc.MAX_GLYPHS=65535,yc.addDynamicAttributes=dc;var vc=new xr({"symbol-placement":new mr(Ct.layout_symbol["symbol-placement"]),"symbol-spacing":new mr(Ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new mr(Ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yr(Ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new mr(Ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new mr(Ct.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new mr(Ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new mr(Ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new mr(Ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new yr(Ct.layout_symbol["icon-size"]),"icon-text-fit":new mr(Ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new mr(Ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new yr(Ct.layout_symbol["icon-image"]),"icon-rotate":new yr(Ct.layout_symbol["icon-rotate"]),"icon-padding":new mr(Ct.layout_symbol["icon-padding"]),"icon-keep-upright":new mr(Ct.layout_symbol["icon-keep-upright"]),"icon-offset":new yr(Ct.layout_symbol["icon-offset"]),"icon-anchor":new yr(Ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new mr(Ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new mr(Ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new mr(Ct.layout_symbol["text-rotation-alignment"]),"text-field":new yr(Ct.layout_symbol["text-field"]),"text-font":new yr(Ct.layout_symbol["text-font"]),"text-size":new yr(Ct.layout_symbol["text-size"]),"text-max-width":new yr(Ct.layout_symbol["text-max-width"]),"text-line-height":new mr(Ct.layout_symbol["text-line-height"]),"text-letter-spacing":new yr(Ct.layout_symbol["text-letter-spacing"]),"text-justify":new yr(Ct.layout_symbol["text-justify"]),"text-radial-offset":new yr(Ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new mr(Ct.layout_symbol["text-variable-anchor"]),"text-anchor":new yr(Ct.layout_symbol["text-anchor"]),"text-max-angle":new mr(Ct.layout_symbol["text-max-angle"]),"text-writing-mode":new mr(Ct.layout_symbol["text-writing-mode"]),"text-rotate":new yr(Ct.layout_symbol["text-rotate"]),"text-padding":new mr(Ct.layout_symbol["text-padding"]),"text-keep-upright":new mr(Ct.layout_symbol["text-keep-upright"]),"text-transform":new yr(Ct.layout_symbol["text-transform"]),"text-offset":new yr(Ct.layout_symbol["text-offset"]),"text-allow-overlap":new mr(Ct.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new mr(Ct.layout_symbol["text-ignore-placement"]),"text-optional":new mr(Ct.layout_symbol["text-optional"])}),_c={paint:new xr({"icon-opacity":new yr(Ct.paint_symbol["icon-opacity"]),"icon-color":new yr(Ct.paint_symbol["icon-color"]),"icon-halo-color":new yr(Ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new yr(Ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yr(Ct.paint_symbol["icon-halo-blur"]),"icon-translate":new mr(Ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new mr(Ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new yr(Ct.paint_symbol["text-opacity"]),"text-color":new yr(Ct.paint_symbol["text-color"],{runtimeType:Vt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new yr(Ct.paint_symbol["text-halo-color"]),"text-halo-width":new yr(Ct.paint_symbol["text-halo-width"]),"text-halo-blur":new yr(Ct.paint_symbol["text-halo-blur"]),"text-translate":new mr(Ct.paint_symbol["text-translate"]),"text-translate-anchor":new mr(Ct.paint_symbol["text-translate-anchor"])}),layout:vc},bc=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ft,this.defaultValue=t};bc.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},bc.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},bc.prototype.outputDefined=function(){return!1},bc.prototype.serialize=function(){return null},Bi("FormatSectionOverride",bc,{omit:["defaultValue"]});var xc=function(t){function e(e){t.call(this,e,_c)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,n){if(t.prototype.recalculate.call(this,e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var i=this.layout.get("text-writing-mode");if(i){for(var r=[],o=0,a=i;o<a.length;o+=1){var s=a[o];r.indexOf(s)<0&&r.push(s)}this.layout._values["text-writing-mode"]=r}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(t,e,n,i){var r=this.layout.get(t).evaluate(e,{},n,i),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||Zn(o.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,(function(e,n){return n in t?String(t[n]):""}))}(e.properties,r)},e.prototype.createBucket=function(t){return new yc(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var t=0,n=_c.paint.overridableProperties;t<n.length;t+=1){var i=n[t];if(e.hasPaintOverride(this.layout,i)){var r,o=this.paint.get(i),a=new bc(o),s=new qn(a,o.property.specification);r="constant"===o.value.kind||"source"===o.value.kind?new Xn("source",s):new Yn("composite",s,o.value.zoomStops,o.value._interpolationType),this.paint._values[i]=new fr(o.property,r,o.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(t,n,i){return!(!this.layout||n.isDataDriven()||i.isDataDriven())&&e.hasPaintOverride(this.layout,t)},e.hasPaintOverride=function(t,e){var n=t.get("text-field"),i=_c.paint.properties[e],r=!1,o=function(t){for(var e=0,n=t;e<n.length;e+=1)if(i.overrides&&i.overrides.hasOverride(n[e]))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof ie)o(n.value.value.sections);else if("source"===n.value.kind){var a=function(t){r||(t instanceof ce&&se(t.value)===qt?o(t.value.sections):t instanceof de?o(t.sections):t.eachChild(a))},s=n.value;s._styleExpression&&a(s._styleExpression.expression)}return r},e}(wr),wc={paint:new xr({"background-color":new mr(Ct.paint_background["background-color"]),"background-pattern":new _r(Ct.paint_background["background-pattern"]),"background-opacity":new mr(Ct.paint_background["background-opacity"])})},Sc=function(t){function e(e){t.call(this,e,wc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(wr),Pc={paint:new xr({"raster-opacity":new mr(Ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new mr(Ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new mr(Ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new mr(Ct.paint_raster["raster-brightness-max"]),"raster-saturation":new mr(Ct.paint_raster["raster-saturation"]),"raster-contrast":new mr(Ct.paint_raster["raster-contrast"]),"raster-resampling":new mr(Ct.paint_raster["raster-resampling"]),"raster-fade-duration":new mr(Ct.paint_raster["raster-fade-duration"])})},Ec=function(t){function e(e){t.call(this,e,Pc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(wr),Tc=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},e}(wr),kc={circle:pa,heatmap:wa,hillshade:Pa,fill:us,"fill-extrusion":ks,line:js,symbol:xc,background:Sc,raster:Ec},Ac=a.HTMLImageElement,Cc=a.HTMLCanvasElement,Mc=a.HTMLVideoElement,Ic=a.ImageData,Lc=a.ImageBitmap,Oc=function(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)};Oc.prototype.update=function(t,e,n){var i=t.width,r=t.height,o=!(this.size&&this.size[0]===i&&this.size[1]===r||n),a=this.context,s=a.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[i,r],t instanceof Ac||t instanceof Cc||t instanceof Mc||t instanceof Ic||Lc&&t instanceof Lc?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,i,r,0,this.format,s.UNSIGNED_BYTE,t.data);else{var l=n||{x:0,y:0},c=l.x,u=l.y;t instanceof Ac||t instanceof Cc||t instanceof Mc||t instanceof Ic||Lc&&t instanceof Lc?s.texSubImage2D(s.TEXTURE_2D,0,c,u,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,c,u,i,r,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},Oc.prototype.bind=function(t,e,n){var i=this.context.gl;i.bindTexture(i.TEXTURE_2D,this.texture),n!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=i.LINEAR),t!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e),this.wrap=e)},Oc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Oc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var zc=function(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};zc.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))},zc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Rc=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},y(["receive","process"],this),this.invoker=new zc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=T()?t:a};function Dc(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}Rc.prototype.send=function(t,e,n,i,r){var o=this;void 0===r&&(r=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[a]=n);var s=C(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!n,targetMapId:i,mustQueue:r,sourceMapId:this.mapId,data:Ui(e,s)},s),{cancel:function(){n&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:i,sourceMapId:o.mapId})}}},Rc.prototype.receive=function(t){var e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[n];var i=this.cancelCallbacks[n];delete this.cancelCallbacks[n],i&&i()}else T()||e.mustQueue?(this.tasks[n]=e,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,e)},Rc.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Rc.prototype.processTask=function(t,e){var n=this;if("<response>"===e.type){var i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(Wi(e.error)):i(null,Wi(e.data)))}else{var r=!1,o=C(this.globalScope)?void 0:[],a=e.hasCallback?function(e,i){r=!0,delete n.cancelCallbacks[t],n.target.postMessage({id:t,type:"<response>",sourceMapId:n.mapId,error:e?Ui(e):null,data:Ui(i,o)},o)}:function(t){r=!0},s=null,l=Wi(e.data);if(this.parent[e.type])s=this.parent[e.type](e.sourceMapId,l,a);else if(this.parent.getWorkerSource){var c=e.type.split(".");s=this.parent.getWorkerSource(e.sourceMapId,c[0],l.source)[c[1]](l,a)}else a(new Error("Could not find function "+e.type));!r&&s&&s.cancel&&(this.cancelCallbacks[t]=s.cancel)}},Rc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Fc=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Fc.prototype.setNorthEast=function(t){return this._ne=t instanceof Bc?new Bc(t.lng,t.lat):Bc.convert(t),this},Fc.prototype.setSouthWest=function(t){return this._sw=t instanceof Bc?new Bc(t.lng,t.lat):Bc.convert(t),this},Fc.prototype.extend=function(t){var e,n,i=this._sw,r=this._ne;if(t instanceof Bc)e=t,n=t;else{if(!(t instanceof Fc))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Fc.convert(t)):this.extend(Bc.convert(t)):this;if(n=t._ne,!(e=t._sw)||!n)return this}return i||r?(i.lng=Math.min(e.lng,i.lng),i.lat=Math.min(e.lat,i.lat),r.lng=Math.max(n.lng,r.lng),r.lat=Math.max(n.lat,r.lat)):(this._sw=new Bc(e.lng,e.lat),this._ne=new Bc(n.lng,n.lat)),this},Fc.prototype.getCenter=function(){return new Bc((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Fc.prototype.getSouthWest=function(){return this._sw},Fc.prototype.getNorthEast=function(){return this._ne},Fc.prototype.getNorthWest=function(){return new Bc(this.getWest(),this.getNorth())},Fc.prototype.getSouthEast=function(){return new Bc(this.getEast(),this.getSouth())},Fc.prototype.getWest=function(){return this._sw.lng},Fc.prototype.getSouth=function(){return this._sw.lat},Fc.prototype.getEast=function(){return this._ne.lng},Fc.prototype.getNorth=function(){return this._ne.lat},Fc.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Fc.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Fc.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Fc.prototype.contains=function(t){var e=Bc.convert(t),n=e.lng,i=e.lat,r=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r},Fc.convert=function(t){return!t||t instanceof Fc?t:new Fc(t)};var Bc=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Bc.prototype.wrap=function(){return new Bc(h(this.lng,-180,180),this.lat)},Bc.prototype.toArray=function(){return[this.lng,this.lat]},Bc.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Bc.prototype.distanceTo=function(t){var e=Math.PI/180,n=this.lat*e,i=t.lat*e,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(r,1))},Bc.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new Fc(new Bc(this.lng-n,this.lat-e),new Bc(this.lng+n,this.lat+e))},Bc.convert=function(t){if(t instanceof Bc)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Bc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Bc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var jc=2*Math.PI*6371008.8;function Nc(t){return jc*Math.cos(t*Math.PI/180)}function Vc(t){return(180+t)/360}function Uc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Wc(t,e){return t/Nc(e)}function Gc(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var qc=function(t,e,n){void 0===n&&(n=0),this.x=+t,this.y=+e,this.z=+n};qc.fromLngLat=function(t,e){void 0===e&&(e=0);var n=Bc.convert(t);return new qc(Vc(n.lng),Uc(n.lat),Wc(e,n.lat))},qc.prototype.toLngLat=function(){return new Bc(360*this.x-180,Gc(this.y))},qc.prototype.toAltitude=function(){return this.z*Nc(Gc(this.y))},qc.prototype.meterInMercatorCoordinateUnits=function(){return 1/jc*(t=Gc(this.y),1/Math.cos(t*Math.PI/180));var t};var Zc=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Yc(0,t,t,e,n)};Zc.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Zc.prototype.url=function(t,e){var n,i,r,o,a,s=(i=this.y,r=this.z,o=Dc(256*(n=this.x),256*(i=Math.pow(2,r)-i-1),r),a=Dc(256*(n+1),256*(i+1),r),o[0]+","+o[1]+","+a[0]+","+a[1]),l=function(t,e,n){for(var i,r="",o=t;o>0;o--)r+=(e&(i=1<<o-1)?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",l).replace("{bbox-epsg-3857}",s)},Zc.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new r(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Zc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Hc=function(t,e){this.wrap=t,this.canonical=e,this.key=Yc(t,e.z,e.z,e.x,e.y)},Xc=function(t,e,n,i,r){this.overscaledZ=t,this.wrap=e,this.canonical=new Zc(n,+i,+r),this.key=Yc(e,t,n,i,r)};function Yc(t,e,n,i,r){(t*=2)<0&&(t=-1*t-1);var o=1<<n;return(o*o*t+o*r+i).toString(36)+n.toString(36)+e.toString(36)}Xc.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Xc.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Xc(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xc(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Xc.prototype.calculateScaledKey=function(t,e){var n=this.canonical.z-t;return t>this.canonical.z?Yc(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Yc(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)},Xc.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Xc.prototype.children=function(t){if(this.overscaledZ>=t)return[new Xc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new Xc(e,this.wrap,e,n,i),new Xc(e,this.wrap,e,n+1,i),new Xc(e,this.wrap,e,n,i+1),new Xc(e,this.wrap,e,n+1,i+1)]},Xc.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Xc.prototype.wrapped=function(){return new Xc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Xc.prototype.unwrapTo=function(t){return new Xc(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Xc.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Xc.prototype.toUnwrapped=function(){return new Hc(this.wrap,this.canonical)},Xc.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Xc.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new qc(t.x-this.wrap,t.y))},Bi("CanonicalTileID",Zc),Bi("OverscaledTileID",Xc,{omit:["posMatrix"]});var Kc=function(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return S('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var i=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=n||"mapbox";for(var r=0;r<i;r++)this.data[this._idx(-1,r)]=this.data[this._idx(0,r)],this.data[this._idx(i,r)]=this.data[this._idx(i-1,r)],this.data[this._idx(r,-1)]=this.data[this._idx(r,0)],this.data[this._idx(r,i)]=this.data[this._idx(r,i-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(i,-1)]=this.data[this._idx(i-1,0)],this.data[this._idx(-1,i)]=this.data[this._idx(0,i-1)],this.data[this._idx(i,i)]=this.data[this._idx(i-1,i-1)]};Kc.prototype.get=function(t,e){var n=new Uint8Array(this.data.buffer),i=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[i],n[i+1],n[i+2])},Kc.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Kc.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Kc.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},Kc.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},Kc.prototype.getPixels=function(){return new _a({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Kc.prototype.backfillBorder=function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var i=e*this.dim,r=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var s=-e*this.dim,l=-n*this.dim,c=o;c<a;c++)for(var u=i;u<r;u++)this.data[this._idx(u,c)]=t.data[this._idx(u+s,c+l)]},Bi("DEMData",Kc);var Jc=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};Jc.prototype.encode=function(t){return this._stringToNumber[t]},Jc.prototype.decode=function(t){return this._numberToString[t]};var Qc=function(t,e,n,i,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,this.id=r},$c={geometry:{configurable:!0}};$c.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},$c.geometry.set=function(t){this._geometry=t},Qc.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Qc.prototype,$c);var tu=function(){this.state={},this.stateChanges={},this.deletedStates={}};tu.prototype.updateState=function(t,e,n){var i=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][i]=this.stateChanges[t][i]||{},p(this.stateChanges[t][i],n),null===this.deletedStates[t])for(var r in this.deletedStates[t]={},this.state[t])r!==i&&(this.deletedStates[t][r]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][i])for(var o in this.deletedStates[t][i]={},this.state[t][i])n[o]||(this.deletedStates[t][i][o]=null);else for(var a in n)this.deletedStates[t]&&this.deletedStates[t][i]&&null===this.deletedStates[t][i][a]&&delete this.deletedStates[t][i][a]},tu.prototype.removeFeatureState=function(t,e,n){if(null!==this.deletedStates[t]){var i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(n in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][n]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}},tu.prototype.getState=function(t,e){var n=String(e),i=p({},(this.state[t]||{})[n],(this.stateChanges[t]||{})[n]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var r=this.deletedStates[t][e];if(null===r)return{};for(var o in r)delete i[o]}return i},tu.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},tu.prototype.coalesceChanges=function(t,e){var n={};for(var i in this.stateChanges){this.state[i]=this.state[i]||{};var r={};for(var o in this.stateChanges[i])this.state[i][o]||(this.state[i][o]={}),p(this.state[i][o],this.stateChanges[i][o]),r[o]=this.state[i][o];n[i]=r}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var l in this.state[a])s[l]={},this.state[a][l]={};else for(var c in this.deletedStates[a]){if(null===this.deletedStates[a][c])this.state[a][c]={};else for(var u=0,h=Object.keys(this.deletedStates[a][c]);u<h.length;u+=1)delete this.state[a][c][h[u]];s[c]=this.state[a][c]}n[a]=n[a]||{},p(n[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(var d in t)t[d].setFeatureState(n,e)};var eu=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Oi(8192,16,0),this.grid3D=new Oi(8192,16,0),this.featureIndexArray=new oo,this.promoteId=e};function nu(t,e,n,i,r){return _(t,(function(t,o){var a=e instanceof gr?e.get(o):null;return a&&a.evaluate?a.evaluate(n,i,r):a}))}function iu(t){for(var e=1/0,n=1/0,i=-1/0,r=-1/0,o=0,a=t;o<a.length;o+=1){var s=a[o];e=Math.min(e,s.x),n=Math.min(n,s.y),i=Math.max(i,s.x),r=Math.max(r,s.y)}return{minX:e,minY:n,maxX:i,maxY:r}}function ru(t,e){return e-t}eu.prototype.insert=function(t,e,n,i,r,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);for(var s=o?this.grid3D:this.grid,l=0;l<e.length;l++){for(var c=e[l],u=[1/0,1/0,-1/0,-1/0],h=0;h<c.length;h++){var p=c[h];u[0]=Math.min(u[0],p.x),u[1]=Math.min(u[1],p.y),u[2]=Math.max(u[2],p.x),u[3]=Math.max(u[3],p.y)}u[0]<8192&&u[1]<8192&&u[2]>=0&&u[3]>=0&&s.insert(a,u[0],u[1],u[2],u[3])}},eu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new bs.VectorTile(new Ks(this.rawTileData)).layers,this.sourceLayerCoder=new Jc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},eu.prototype.query=function(t,e,n,i){var o=this;this.loadVTLayers();for(var a=t.params||{},s=8192/t.tileSize/t.scale,l=ai(a.filter),c=t.queryGeometry,u=t.queryPadding*s,h=iu(c),p=this.grid.query(h.minX-u,h.minY-u,h.maxX+u,h.maxY+u),d=iu(t.cameraQueryGeometry),f=this.grid3D.query(d.minX-u,d.minY-u,d.maxX+u,d.maxY+u,(function(e,n,i,o){return function(t,e,n,i,o){for(var a=0,s=t;a<s.length;a+=1){var l=s[a];if(e<=l.x&&n<=l.y&&i>=l.x&&o>=l.y)return!0}var c=[new r(e,n),new r(e,o),new r(i,o),new r(i,n)];if(t.length>2)for(var u=0,h=c;u<h.length;u+=1)if($o(t,h[u]))return!0;for(var p=0;p<t.length-1;p++)if(ta(t[p],t[p+1],c))return!0;return!1}(t.cameraQueryGeometry,e-u,n-u,i+u,o+u)})),g=0,m=f;g<m.length;g+=1)p.push(m[g]);p.sort(ru);for(var y,v={},_=function(r){var u=p[r];if(u!==y){y=u;var h=o.featureIndexArray.get(u),d=null;o.loadMatchingFeature(v,h.bucketIndex,h.sourceLayerIndex,h.featureIndex,l,a.layers,a.availableImages,e,n,i,(function(e,n,i){return d||(d=No(e)),n.queryIntersectsFeature(c,e,i,d,o.z,t.transform,s,t.pixelPosMatrix)}))}},b=0;b<p.length;b++)_(b);return v},eu.prototype.loadMatchingFeature=function(t,e,n,i,r,o,a,s,l,c,u){var h=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,h)){var d=this.sourceLayerCoder.decode(n),f=this.vtLayers[d].feature(i);if(r.needGeometry){var g=Vo(f,!0);if(!r.filter(new sr(this.tileID.overscaledZ),g,this.tileID.canonical))return}else if(!r.filter(new sr(this.tileID.overscaledZ),f))return;for(var m=this.getId(f,d),y=0;y<h.length;y++){var v=h[y];if(!(o&&o.indexOf(v)<0)){var _=s[v];if(_){var b={};void 0!==m&&c&&(b=c.getState(_.sourceLayer||"_geojsonTileLayer",m));var x=p({},l[v]);x.paint=nu(x.paint,_.paint,f,b,a),x.layout=nu(x.layout,_.layout,f,b,a);var w=!u||u(f,_,b);if(w){var S=new Qc(f,this.z,this.x,this.y,m);S.layer=x;var P=t[v];void 0===P&&(P=t[v]=[]),P.push({featureIndex:i,feature:S,intersectionZ:w})}}}}}},eu.prototype.lookupSymbolFeatures=function(t,e,n,i,r,o,a,s){var l={};this.loadVTLayers();for(var c=ai(r),u=0,h=t;u<h.length;u+=1)this.loadMatchingFeature(l,n,i,h[u],c,o,a,s,e);return l},eu.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var i=0,r=n[e];i<r.length;i+=1)if(t===r[i])return!0;return!1},eu.prototype.getId=function(t,e){var n=t.id;return this.promoteId&&"boolean"==typeof(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(n=Number(n)),n},Bi("FeatureIndex",eu,{omit:["rawTileData","sourceLayerCoder"]});var ou=function(t,e){this.tileID=t,this.uid=f(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ou.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<B.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},ou.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},ou.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var i in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var i=function(){var t=o[r],i=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==i.length){t.layers=i,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return i.filter((function(e){return e.id===t}))[0]})));for(var a=0,s=i;a<s.length;a+=1)n[s[a].id]=t}},r=0,o=t;r<o.length;r+=1)i();return n}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var r=this.buckets[i];if(r instanceof yc){if(this.hasSymbolBuckets=!0,!n)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof yc&&a.hasRTLText){this.hasRTLText=!0,ar.isLoading()||ar.isLoaded()||"deferred"!==rr()||or();break}}for(var s in this.queryPadding=0,this.buckets){var l=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(s).queryRadius(l))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Jr},ou.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ou.prototype.getBucket=function(t){return this.buckets[t.id]},ou.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Oc(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Oc(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null)},ou.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},ou.prototype.queryRenderedFeatures=function(t,e,n,i,r,o,a,s,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:r,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:a,queryPadding:this.queryPadding*l},t,e,n):{}},ou.prototype.querySourceFeatures=function(t,e){var n=this.latestFeatureIndex;if(n&&n.rawTileData){var i=n.loadVTLayers(),r=e?e.sourceLayer:"",o=i._geojsonTileLayer||i[r];if(o)for(var a=ai(e&&e.filter),s=this.tileID.canonical,l=s.z,c=s.x,u=s.y,h={z:l,x:c,y:u},p=0;p<o.length;p++){var d=o.feature(p);if(a.needGeometry){var f=Vo(d,!0);if(!a.filter(new sr(this.tileID.overscaledZ),f,this.tileID.canonical))continue}else if(!a.filter(new sr(this.tileID.overscaledZ),d))continue;var g=n.getId(d,r),m=new Qc(d,l,c,u,g);m.tile=h,t.push(m)}}},ou.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},ou.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ou.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=k(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var i=Date.now(),r=!1;if(this.expirationTime>i)r=!1;else if(e)if(this.expirationTime<e)r=!0;else{var o=this.expirationTime-e;o?this.expirationTime=i+Math.max(o,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ou.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},ou.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var i in this.buckets)if(e.style.hasLayer(i)){var r=this.buckets[i],o=r.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];if(a&&s&&0!==Object.keys(s).length){r.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});var l=e&&e.style&&e.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}}},ou.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},ou.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()},ou.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ou.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=B.now()+t},ou.prototype.setDependencies=function(t,e){for(var n={},i=0,r=e;i<r.length;i+=1)n[r[i]]=!0;this.dependencies[t]=n},ou.prototype.hasDependency=function(t,e){for(var n=0,i=t;n<i.length;n+=1){var r=this.dependencies[i[n]];if(r)for(var o=0,a=e;o<a.length;o+=1)if(r[a[o]])return!0}return!1};var au=a.performance,su=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},au.mark(this._marks.start)};su.prototype.finish=function(){au.mark(this._marks.end);var t=au.getEntriesByName(this._marks.measure);return 0===t.length&&(au.measure(this._marks.measure,this._marks.start,this._marks.end),t=au.getEntriesByName(this._marks.measure),au.clearMarks(this._marks.start),au.clearMarks(this._marks.end),au.clearMeasures(this._marks.measure)),t},t.Actor=Rc,t.AlphaImage=va,t.CanonicalTileID=Zc,t.CollisionBoxArray=Jr,t.Color=te,t.DEMData=Kc,t.DataConstantProperty=mr,t.DictionaryCoder=Jc,t.EXTENT=8192,t.ErrorEvent=kt,t.EvaluationParameters=sr,t.Event=Tt,t.Evented=At,t.FeatureIndex=eu,t.FillBucket=ss,t.FillExtrusionBucket=Ps,t.ImageAtlas=bl,t.ImagePosition=vl,t.LineBucket=Rs,t.LngLat=Bc,t.LngLatBounds=Fc,t.MercatorCoordinate=qc,t.ONE_EM=24,t.OverscaledTileID=Xc,t.Point=r,t.Point$1=r,t.Properties=xr,t.Protobuf=Ks,t.RGBAImage=_a,t.RequestManager=q,t.RequestPerformance=su,t.ResourceType=ft,t.SegmentVector=so,t.SourceFeatureState=tu,t.StructArrayLayout1ui2=Xr,t.StructArrayLayout2f1f2i16=jr,t.StructArrayLayout2i4=Ar,t.StructArrayLayout3ui6=Vr,t.StructArrayLayout4i8=Cr,t.SymbolBucket=yc,t.Texture=Oc,t.Tile=ou,t.Transitionable=ur,t.Uniform1f=xo,t.Uniform1i=bo,t.Uniform2f=wo,t.Uniform3f=So,t.Uniform4f=Po,t.UniformColor=Eo,t.UniformMatrix4f=ko,t.UnwrappedTileID=Hc,t.ValidationError=Mt,t.WritingMode=xl,t.ZoomHistory=Gi,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},t.addDynamicAttributes=dc,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var i=t.length,r=new Array(t.length),o=null;t.forEach((function(t,a){e(t,(function(t,e){t&&(o=t),r[a]=e,0==--i&&n(o,r)}))}))},t.bezier=l,t.bindAll=y,t.browser=B,t.cacheEntryPossiblyAdded=function(t){++pt>lt&&(t.getActor().send("enforceCacheSizeLimit",st),pt=0)},t.clamp=u,t.clearTileCache=function(t){var e=a.caches.delete("mapbox-tiles");t&&e.catch(t).then((function(){return t()}))},t.clipLine=Zl,t.clone=function(t){var e=new aa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=x,t.clone$2=function(t){var e=new aa(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=qs,t.config=j,t.create=function(){var t=new aa(16);return aa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new aa(9);return aa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new aa(4);return aa!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Hn,t.createLayout=Tr,t.createStyleLayer=function(t){return"custom"===t.type?new Tc(t):new kc[t.type](t)},t.cross=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],l=n[2];return t[0]=r*l-o*s,t[1]=o*a-i*l,t[2]=i*s-r*a,t},t.deepEqual=function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var r in e)if(!t(e[r],n[r]))return!1;return!0}return e===n},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=c,t.emitValidationErrors=Li,t.endsWith=v,t.enforceCacheSizeLimit=function(t){ct(),tt&&tt.then((function(e){e.keys().then((function(n){for(var i=0;i<n.length-t;i++)e.delete(n[i])}))}))},t.evaluateSizeForFeature=Fl,t.evaluateSizeForZoom=Bl,t.evaluateVariableOffset=oc,t.evented=ir,t.extend=p,t.featureFilter=ai,t.filterObject=b,t.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=Ll,t.getAnchorJustification=ac,t.getArrayBuffer=bt,t.getImage=St,t.getJSON=function(t,e){return _t(p(t,{type:"json"}),e)},t.getRTLTextPluginStatus=rr,t.getReferrer=vt,t.getVideo=function(t,e){var n,i,r=a.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(var o=0;o<t.length;o++){var s=a.document.createElement("source");n=t[o],i=void 0,(i=a.document.createElement("a")).href=n,(i.protocol!==a.document.location.protocol||i.host!==a.document.location.host)&&(r.crossOrigin="Anonymous"),s.src=t[o],r.appendChild(s)}return{cancel:function(){}}},t.identity=sa,t.invert=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],d=e[11],f=e[12],g=e[13],m=e[14],y=e[15],v=n*s-i*a,_=n*l-r*a,b=n*c-o*a,x=i*l-r*s,w=i*c-o*s,S=r*c-o*l,P=u*g-h*f,E=u*m-p*f,T=u*y-d*f,k=h*m-p*g,A=h*y-d*g,C=p*y-d*m,M=v*C-_*A+b*k+x*T-w*E+S*P;return M?(t[0]=(s*C-l*A+c*k)*(M=1/M),t[1]=(r*A-i*C-o*k)*M,t[2]=(g*S-m*w+y*x)*M,t[3]=(p*w-h*S-d*x)*M,t[4]=(l*T-a*C-c*E)*M,t[5]=(n*C-r*T+o*E)*M,t[6]=(m*b-f*S-y*_)*M,t[7]=(u*S-p*b+d*_)*M,t[8]=(a*A-s*T+c*P)*M,t[9]=(i*T-n*A-o*P)*M,t[10]=(f*w-g*b+y*v)*M,t[11]=(h*b-u*w-d*v)*M,t[12]=(s*E-a*k-l*P)*M,t[13]=(n*k-i*E+r*P)*M,t[14]=(g*_-f*x-m*v)*M,t[15]=(u*x-h*_+p*v)*M,t):null},t.isChar=qi,t.isMapboxURL=Z,t.keysDifference=function(t,e){var n=[];for(var i in t)i in e||n.push(i);return n},t.makeRequest=_t,t.mapObject=_,t.mercatorXfromLng=Vc,t.mercatorYfromLat=Uc,t.mercatorZfromAltitude=Wc,t.mul=ua,t.multiply=la,t.mvt=bs,t.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.normalize=function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},t.number=Ge,t.offscreenCanvasSupported=dt,t.ortho=function(t,e,n,i,r,o,a){var s=1/(e-n),l=1/(i-r),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(a+o)*c,t[15]=1,t},t.parseGlyphPBF=function(t){return new Ks(t).readFields(fl,[])},t.pbf=Ks,t.performSymbolLayout=function(t,e,n,i,r,o,a){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var s=t.layers[0].layout,l=t.layers[0]._unevaluatedLayout._values,c={};if("composite"===t.textSizeData.kind){var u=t.textSizeData,h=u.maxZoom;c.compositeTextSizes=[l["text-size"].possiblyEvaluate(new sr(u.minZoom),a),l["text-size"].possiblyEvaluate(new sr(h),a)]}if("composite"===t.iconSizeData.kind){var p=t.iconSizeData,d=p.maxZoom;c.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new sr(p.minZoom),a),l["icon-size"].possiblyEvaluate(new sr(d),a)]}c.layoutTextSize=l["text-size"].possiblyEvaluate(new sr(t.zoom+1),a),c.layoutIconSize=l["icon-size"].possiblyEvaluate(new sr(t.zoom+1),a),c.textMaxSize=l["text-size"].possiblyEvaluate(new sr(18));for(var f=24*s.get("text-line-height"),g="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement"),m=s.get("text-keep-upright"),y=s.get("text-size"),v=function(){var o=b[_],l=s.get("text-font").evaluate(o,{},a).join(","),u=y.evaluate(o,{},a),h=c.layoutTextSize.evaluate(o,{},a),p=c.layoutIconSize.evaluate(o,{},a),d={horizontal:{},vertical:void 0},v=o.text,x=[0,0];if(v){var w=v.toString(),P=24*s.get("text-letter-spacing").evaluate(o,{},a),E=function(t){for(var e=0,n=t;e<n.length;e+=1)if(i=n[e].charCodeAt(0),qi.Arabic(i)||qi["Arabic Supplement"](i)||qi["Arabic Extended-A"](i)||qi["Arabic Presentation Forms-A"](i)||qi["Arabic Presentation Forms-B"](i))return!1;var i;return!0}(w)?P:0,T=s.get("text-anchor").evaluate(o,{},a),k=s.get("text-variable-anchor");if(!k){var A=s.get("text-radial-offset").evaluate(o,{},a);x=A?oc(T,[24*A,rc]):s.get("text-offset").evaluate(o,{},a).map((function(t){return 24*t}))}var C=g?"center":s.get("text-justify").evaluate(o,{},a),M=s.get("symbol-placement"),I="point"===M?24*s.get("text-max-width").evaluate(o,{},a):0,L=function(){t.allowVerticalPlacement&&Zi(w)&&(d.vertical=Pl(v,e,n,r,l,I,f,T,"left",E,x,xl.vertical,!0,M,h,u))};if(!g&&k){for(var O="auto"===C?k.map((function(t){return ac(t)})):[C],z=!1,R=0;R<O.length;R++){var D=O[R];if(!d.horizontal[D])if(z)d.horizontal[D]=d.horizontal[0];else{var F=Pl(v,e,n,r,l,I,f,"center",D,E,x,xl.horizontal,!1,M,h,u);F&&(d.horizontal[D]=F,z=1===F.positionedLines.length)}}L()}else{"auto"===C&&(C=ac(T));var B=Pl(v,e,n,r,l,I,f,T,C,E,x,xl.horizontal,!1,M,h,u);B&&(d.horizontal[C]=B),L(),Zi(w)&&g&&m&&(d.vertical=Pl(v,e,n,r,l,I,f,T,C,E,x,xl.vertical,!1,M,h,u))}}var j=void 0,N=!1;if(o.icon&&o.icon.name){var V=i[o.icon.name];V&&(j=function(t,e,n){var i=Ll(n),r=e[0]-t.displaySize[0]*i.horizontalAlign,o=e[1]-t.displaySize[1]*i.verticalAlign;return{image:t,top:o,bottom:o+t.displaySize[1],left:r,right:r+t.displaySize[0]}}(r[o.icon.name],s.get("icon-offset").evaluate(o,{},a),s.get("icon-anchor").evaluate(o,{},a)),N=V.sdf,void 0===t.sdfIcons?t.sdfIcons=V.sdf:t.sdfIcons!==V.sdf&&S("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(V.pixelRatio!==t.pixelRatio||0!==s.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var U=lc(d.horizontal)||d.vertical;t.iconsInText=!!U&&U.iconsInText,(U||j)&&function(t,e,n,i,r,o,a,s,l,c,u){var h=o.textMaxSize.evaluate(e,{});void 0===h&&(h=a);var p,d=t.layers[0].layout,f=d.get("icon-offset").evaluate(e,{},u),g=lc(n.horizontal),m=a/24,y=t.tilePixelRatio*m,v=t.tilePixelRatio*h/24,_=t.tilePixelRatio*s,b=t.tilePixelRatio*d.get("symbol-spacing"),x=d.get("text-padding")*t.tilePixelRatio,w=d.get("icon-padding")*t.tilePixelRatio,P=d.get("text-max-angle")/180*Math.PI,E="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),T="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),k=d.get("symbol-placement"),A=b/2,C=d.get("icon-text-fit");i&&"none"!==C&&(t.allowVerticalPlacement&&n.vertical&&(p=zl(i,n.vertical,C,d.get("icon-text-fit-padding"),f,m)),g&&(i=zl(i,g,C,d.get("icon-text-fit-padding"),f,m)));var M=function(s,h){h.x<0||h.x>=8192||h.y<0||h.y>=8192||function(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g,m,y,v,_,b,x,w,P,E){var T,k,A,C,M,I=t.addToLineVertexArray(e,n),L=0,O=0,z=0,R=0,D=-1,F=-1,B={},j=po(""),N=0,V=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(N=(T=s.layout.get("text-offset").evaluate(b,{},P).map((function(t){return 24*t})))[0],V=T[1]):(N=24*s.layout.get("text-radial-offset").evaluate(b,{},P),V=rc),t.allowVerticalPlacement&&i.vertical){var U=s.layout.get("text-rotate").evaluate(b,{},P)+90;C=new Ql(l,e,c,u,h,i.vertical,p,d,f,U),a&&(M=new Ql(l,e,c,u,h,a,m,y,f,U))}if(r){var W=s.layout.get("icon-rotate").evaluate(b,{}),G="none"!==s.layout.get("icon-text-fit"),q=Hl(r,W,w,G),Z=a?Hl(a,W,w,G):void 0;A=new Ql(l,e,c,u,h,r,m,y,!1,W),L=4*q.length;var H=t.iconSizeData,X=null;"source"===H.kind?(X=[128*s.layout.get("icon-size").evaluate(b,{})])[0]>32640&&S(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===H.kind&&((X=[128*x.compositeIconSizes[0].evaluate(b,{},P),128*x.compositeIconSizes[1].evaluate(b,{},P)])[0]>32640||X[1]>32640)&&S(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),t.addSymbols(t.icon,q,X,_,v,b,!1,e,I.lineStartIndex,I.lineLength,-1,P),D=t.icon.placedSymbolArray.length-1,Z&&(O=4*Z.length,t.addSymbols(t.icon,Z,X,_,v,b,xl.vertical,e,I.lineStartIndex,I.lineLength,-1,P),F=t.icon.placedSymbolArray.length-1)}for(var Y in i.horizontal){var K=i.horizontal[Y];if(!k){j=po(K.text);var J=s.layout.get("text-rotate").evaluate(b,{},P);k=new Ql(l,e,c,u,h,K,p,d,f,J)}var Q=1===K.positionedLines.length;if(z+=sc(t,e,K,o,s,f,b,g,I,i.vertical?xl.horizontal:xl.horizontalOnly,Q?Object.keys(i.horizontal):[Y],B,D,x,P),Q)break}i.vertical&&(R+=sc(t,e,i.vertical,o,s,f,b,g,I,xl.vertical,["vertical"],B,F,x,P));var $=k?k.boxStartIndex:t.collisionBoxArray.length,tt=k?k.boxEndIndex:t.collisionBoxArray.length,et=C?C.boxStartIndex:t.collisionBoxArray.length,nt=C?C.boxEndIndex:t.collisionBoxArray.length,it=A?A.boxStartIndex:t.collisionBoxArray.length,rt=A?A.boxEndIndex:t.collisionBoxArray.length,ot=M?M.boxStartIndex:t.collisionBoxArray.length,at=M?M.boxEndIndex:t.collisionBoxArray.length,st=-1,lt=function(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e};st=lt(k,st),st=lt(C,st),st=lt(A,st);var ct=(st=lt(M,st))>-1?1:0;ct&&(st*=E/24),t.glyphOffsetArray.length>=yc.MAX_GLYPHS&&S("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,B.right>=0?B.right:-1,B.center>=0?B.center:-1,B.left>=0?B.left:-1,B.vertical||-1,D,F,j,$,tt,et,nt,it,rt,ot,at,c,z,R,L,O,ct,0,p,N,V,st)}(t,h,s,n,i,r,p,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,y,x,E,l,_,w,T,f,e,o,c,u,a)};if("line"===k)for(var I=0,L=Zl(e.geometry,0,0,8192,8192);I<L.length;I+=1)for(var O=L[I],z=0,R=ql(O,b,P,n.vertical||g,i,24,v,t.overscaling,8192);z<R.length;z+=1){var D=R[z];g&&cc(t,g.text,A,D)||M(O,D)}else if("line-center"===k)for(var F=0,B=e.geometry;F<B.length;F+=1){var j=B[F];if(j.length>1){var N=Gl(j,P,n.vertical||g,i,24,v);N&&M(j,N)}}else if("Polygon"===e.type)for(var V=0,U=is(e.geometry,0);V<U.length;V+=1){var W=U[V],G=ec(W,16);M(W[0],new Rl(G.x,G.y,0))}else if("LineString"===e.type)for(var q=0,Z=e.geometry;q<Z.length;q+=1){var H=Z[q];M(H,new Rl(H[0].x,H[0].y,0))}else if("Point"===e.type)for(var X=0,Y=e.geometry;X<Y.length;X+=1)for(var K=0,J=Y[X];K<J.length;K+=1){var Q=J[K];M([Q],new Rl(Q.x,Q.y,0))}}(t,o,d,j,i,c,h,p,x,N,a)},_=0,b=t.features;_<b.length;_+=1)v();o&&t.generateCollisionDebugBuffers()},t.perspective=function(t,e,n,i,r){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+i)*(o=1/(i-r)),t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t},t.pick=function(t,e){for(var n={},i=0;i<e.length;i++){var r=e[i];r in t&&(n[r]=t[r])}return n},t.plugin=ar,t.polygonIntersectsPolygon=Go,t.postMapLoadEvent=at,t.postTurnstileEvent=rt,t.potpack=yl,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=Bi,t.registerForPluginStateChange=function(t){return t({pluginStatus:$i,pluginURL:tr}),ir.on("pluginStateChange",t),t},t.renderColorRamp=xa,t.rotate=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=i*l+o*s,t[1]=r*l+a*s,t[2]=i*-s+o*l,t[3]=r*-s+a*l,t},t.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=a*r+u*i,t[6]=s*r+h*i,t[7]=l*r+p*i,t[8]=c*r-o*i,t[9]=u*r-a*i,t[10]=h*r-s*i,t[11]=p*r-l*i,t},t.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=a*r+u*i,t[2]=s*r+h*i,t[3]=l*r+p*i,t[4]=c*r-o*i,t[5]=u*r-a*i,t[6]=h*r-s*i,t[7]=p*r-l*i,t},t.scale=function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.scale$2=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},t.setCacheLimits=function(t,e){st=t,lt=e},t.setRTLTextPlugin=function(t,e,n){if(void 0===n&&(n=!1),"deferred"===$i||"loading"===$i||"loaded"===$i)throw new Error("setRTLTextPlugin cannot be called multiple times.");tr=B.resolveURL(t),$i="deferred",Qi=e,nr(),n||or()},t.sphericalToCartesian=function(t){var e=t[0],n=t[1],i=t[2];return n+=90,n*=Math.PI/180,i*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(i),y:e*Math.sin(n)*Math.sin(i),z:e*Math.cos(i)}},t.sqrLen=function(t){var e=t[0],n=t[1];return e*e+n*n},t.styleSpec=Ct,t.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},t.symbolSize=jl,t.transformMat3=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t},t.transformMat4=ha,t.translate=function(t,e,n){var i,r,o,a,s,l,c,u,h,p,d,f,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=i=e[0],t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=i*g+s*m+h*y+e[12],t[13]=r*g+l*m+p*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=a*g+u*m+f*y+e[15]),t},t.triggerPluginCompletionEvent=er,t.uniqueId=f,t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers."+n+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+n+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=Ci,t.validateStyle=Ai,t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.vectorTile=bs,t.version="1.13.2",t.warnOnce=S,t.webpSupported=N,t.window=a,t.wrap=h})),i(["./shared"],(function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",r=0,o=t;r<o.length;r+=1)i+=e(o[r])+",";return i+"]"}for(var a=Object.keys(t).sort(),s="{",l=0;l<a.length;l++)s+=JSON.stringify(a[l])+":"+e(t[a[l]])+",";return s+"}"}function n(n){for(var i="",r=0,o=t.refProperties;r<o.length;r+=1)i+="/"+e(n[o[r]]);return i}var i=function(t){this.keyCache={},t&&this.replace(t)};i.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},i.prototype.update=function(e,i){for(var r=this,o=0,a=e;o<a.length;o+=1){var s=a[o];this._layerConfigs[s.id]=s;var l=this._layers[s.id]=t.createStyleLayer(s);l._featureFilter=t.featureFilter(l.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var c=0,u=i;c<u.length;c+=1){var h=u[c];delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h]}this.familiesBySource={};for(var p=0,d=function(t,e){for(var i={},r=0;r<t.length;r++){var o=e&&e[t[r].id]||n(t[r]);e&&(e[t[r].id]=o);var a=i[o];a||(a=i[o]=[]),a.push(t[r])}var s=[];for(var l in i)s.push(i[l]);return s}(t.values(this._layerConfigs),this.keyCache);p<d.length;p+=1){var f=d[p].map((function(t){return r._layers[t.id]})),g=f[0];if("none"!==g.visibility){var m=g.source||"",y=this.familiesBySource[m];y||(y=this.familiesBySource[m]={});var v=g.sourceLayer||"_geojsonTileLayer",_=y[v];_||(_=y[v]=[]),_.push(f)}}};var r=function(e){var n={},i=[];for(var r in e){var o=e[r],a=n[r]={};for(var s in o){var l=o[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var c={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};i.push(c),a[s]={rect:c,metrics:l.metrics}}}}var u=t.potpack(i),h=new t.AlphaImage({width:u.w||1,height:u.h||1});for(var p in e){var d=e[p];for(var f in d){var g=d[+f];if(g&&0!==g.bitmap.width&&0!==g.bitmap.height){var m=n[p][f].rect;t.AlphaImage.copy(g.bitmap,h,{x:0,y:0},{x:m.x+1,y:m.y+1},g.bitmap)}}}this.image=h,this.positions=n};t.register("GlyphAtlas",r);var o=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId};function a(e,n,i){for(var r=new t.EvaluationParameters(n),o=0,a=e;o<a.length;o+=1)a[o].recalculate(r,i)}function s(e,n){var i=t.getArrayBuffer(e.request,(function(e,i,r,o){e?n(e):i&&n(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(i)),rawData:i,cacheControl:r,expires:o})}));return function(){i.cancel(),n()}}o.prototype.parse=function(e,n,i,o,s){var l=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var c=new t.DictionaryCoder(Object.keys(e.layers).sort()),u=new t.FeatureIndex(this.tileID,this.promoteId);u.bucketLayerIDs=[];var h,p,d,f,g={},m={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:i},y=n.familiesBySource[this.source];for(var v in y){var _=e.layers[v];if(_){1===_.version&&t.warnOnce('Vector tile source "'+this.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var b=c.encode(v),x=[],w=0;w<_.length;w++){var S=_.feature(w),P=u.getId(S,v);x.push({feature:S,id:P,index:w,sourceLayerIndex:b})}for(var E=0,T=y[v];E<T.length;E+=1){var k=T[E],A=k[0];A.minzoom&&this.zoom<Math.floor(A.minzoom)||A.maxzoom&&this.zoom>=A.maxzoom||"none"!==A.visibility&&(a(k,this.zoom,i),(g[A.id]=A.createBucket({index:u.bucketLayerIDs.length,layers:k,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(x,m,this.tileID.canonical),u.bucketLayerIDs.push(k.map((function(t){return t.id}))))}}}var C=t.mapObject(m.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(C).length?o.send("getGlyphs",{uid:this.uid,stacks:C},(function(t,e){h||(h=t,p=e,L.call(l))})):p={};var M=Object.keys(m.iconDependencies);M.length?o.send("getImages",{icons:M,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){h||(h=t,d=e,L.call(l))})):d={};var I=Object.keys(m.patternDependencies);function L(){if(h)return s(h);if(p&&d&&f){var e=new r(p),n=new t.ImageAtlas(d,f);for(var o in g){var l=g[o];l instanceof t.SymbolBucket?(a(l.layers,this.zoom,i),t.performSymbolLayout(l,p,e.positions,d,n.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):l.hasPattern&&(l instanceof t.LineBucket||l instanceof t.FillBucket||l instanceof t.FillExtrusionBucket)&&(a(l.layers,this.zoom,i),l.addFeatures(m,this.tileID.canonical,n.patternPositions))}this.status="done",s(null,{buckets:t.values(g).filter((function(t){return!t.isEmpty()})),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?e.positions:null})}}I.length?o.send("getImages",{icons:I,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){h||(h=t,f=e,L.call(l))})):f={},L.call(this)};var l=function(t,e,n,i){this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=i||s,this.loading={},this.loaded={}};l.prototype.loadTile=function(e,n){var i=this,r=e.uid;this.loading||(this.loading={});var a=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),s=this.loading[r]=new o(e);s.abort=this.loadVectorData(e,(function(e,o){if(delete i.loading[r],e||!o)return s.status="done",i.loaded[r]=s,n(e);var l=o.rawData,c={};o.expires&&(c.expires=o.expires),o.cacheControl&&(c.cacheControl=o.cacheControl);var u={};if(a){var h=a.finish();h&&(u.resourceTiming=JSON.parse(JSON.stringify(h)))}s.vectorTile=o.vectorTile,s.parse(o.vectorTile,i.layerIndex,i.availableImages,i.actor,(function(e,i){if(e||!i)return n(e);n(null,t.extend({rawTileData:l.slice(0)},i,c,u))})),i.loaded=i.loaded||{},i.loaded[r]=s}))},l.prototype.reloadTile=function(t,e){var n=this,i=this.loaded,r=t.uid,o=this;if(i&&i[r]){var a=i[r];a.showCollisionBoxes=t.showCollisionBoxes;var s=function(t,i){var r=a.reloadCallback;r&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,r)),e(t,i)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},l.prototype.abortTile=function(t,e){var n=this.loading,i=t.uid;n&&n[i]&&n[i].abort&&(n[i].abort(),delete n[i]),e()},l.prototype.removeTile=function(t,e){var n=this.loaded,i=t.uid;n&&n[i]&&delete n[i],e()};var c=t.window.ImageBitmap,u=function(){this.loaded={}};function h(t,e){if(0!==t.length){p(t[0],e);for(var n=1;n<t.length;n++)p(t[n],!e)}}function p(t,e){for(var n=0,i=0,r=t.length,o=r-1;i<r;o=i++)n+=(t[i][0]-t[o][0])*(t[o][1]+t[i][1]);n>=0!=!!e&&t.reverse()}u.prototype.loadTile=function(e,n){var i=e.uid,r=e.encoding,o=e.rawImageData,a=c&&o instanceof c?this.getImageData(o):o,s=new t.DEMData(i,a,r);this.loaded=this.loaded||{},this.loaded[i]=s,n(null,s)},u.prototype.getImageData=function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var n=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:n.width,height:n.height},n.data)},u.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var d=t.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};f.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,i=this._feature.geometry;n<i.length;n+=1){var r=i[n];e.push([new t.Point$1(r[0],r[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var l=[],c=0,u=s[a];c<u.length;c+=1){var h=u[c];l.push(new t.Point$1(h[0],h[1]))}o.push(l)}return o},f.prototype.toGeoJSON=function(t,e,n){return d.call(this,t,e,n)};var g=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};g.prototype.feature=function(t){return new f(this._features[t])};var m=t.vectorTile.VectorTileFeature,y=v;function v(t,e){this.options=e||{},this.features=t,this.length=t.length}function _(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}v.prototype.feature=function(t){return new _(this.features[t],this.options.extent)},_.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var i=e[n],r=[],o=0;o<i.length;o++)r.push(new t.Point$1(i[o][0],i[o][1]));this.geometry.push(r)}return this.geometry},_.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[e,i,n,r]},_.prototype.toGeoJSON=m.prototype.toGeoJSON;var b=w,x=y;function w(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,S,t.layers[n])}(e,n),n.finish()}function S(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,P,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var o=i.values;for(n=0;n<o.length;n++)e.writeMessage(4,C,o[n])}function P(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,E,t),e.writeVarintField(3,n.type),e.writeMessage(4,A,n)}function E(t,e){var n=t.feature,i=t.keys,r=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var l=o[s];void 0===l&&(i.push(s),o[s]=l=i.length-1),e.writeVarint(l);var c=n.properties[s],u=typeof c;"string"!==u&&"boolean"!==u&&"number"!==u&&(c=JSON.stringify(c));var h=u+":"+c,p=a[h];void 0===p&&(r.push(c),a[h]=p=r.length-1),e.writeVarint(p)}}function T(t,e){return(e<<3)+(7&t)}function k(t){return t<<1^t>>31}function A(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,o=0,a=n.length,s=0;s<a;s++){var l=n[s],c=1;1===i&&(c=l.length),e.writeVarint(T(1,c));for(var u=3===i?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==i&&e.writeVarint(T(2,u-1));var p=l[h].x-r,d=l[h].y-o;e.writeVarint(k(p)),e.writeVarint(k(d)),r+=p,o+=d}3===i&&e.writeVarint(T(7,1))}}function C(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function M(t,e,n,i){I(t,n,i),I(e,2*n,2*i),I(e,2*n+1,2*i+1)}function I(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function L(t,e,n,i){var r=t-n,o=e-i;return r*r+o*o}b.fromVectorTileJs=w,b.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new y(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return w({layers:n})},b.GeoJSONWrapper=x;var O=function(t){return t[0]},z=function(t){return t[1]},R=function(t,e,n,i,r){void 0===e&&(e=O),void 0===n&&(n=z),void 0===i&&(i=64),void 0===r&&(r=Float64Array),this.nodeSize=i,this.points=t;for(var o=t.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new r(2*t.length),l=0;l<t.length;l++)a[l]=l,s[2*l]=e(t[l]),s[2*l+1]=n(t[l]);!function t(e,n,i,r,o,a){if(!(o-r<=i)){var s=r+o>>1;!function t(e,n,i,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=i-r+1,c=Math.log(s),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);t(e,n,i,Math.max(r,Math.floor(i-l*u/s+h)),Math.min(o,Math.floor(i+(s-l)*u/s+h)),a)}var p=n[2*i+a],d=r,f=o;for(M(e,n,r,i),n[2*o+a]>p&&M(e,n,r,o);d<f;){for(M(e,n,d,f),d++,f--;n[2*d+a]<p;)d++;for(;n[2*f+a]>p;)f--}n[2*r+a]===p?M(e,n,r,f):M(e,n,++f,o),f<=i&&(r=f+1),i<=f&&(o=f-1)}}(e,n,s,r,o,a%2),t(e,n,i,r,s-1,a+1),t(e,n,i,s+1,o,a+1)}}(a,s,i,0,a.length-1,0)};R.prototype.range=function(t,e,n,i){return function(t,e,n,i,r,o,a){for(var s,l,c=[0,t.length-1,0],u=[];c.length;){var h=c.pop(),p=c.pop(),d=c.pop();if(p-d<=a)for(var f=d;f<=p;f++)l=e[2*f+1],(s=e[2*f])>=n&&s<=r&&l>=i&&l<=o&&u.push(t[f]);else{var g=Math.floor((d+p)/2);l=e[2*g+1],(s=e[2*g])>=n&&s<=r&&l>=i&&l<=o&&u.push(t[g]);var m=(h+1)%2;(0===h?n<=s:i<=l)&&(c.push(d),c.push(g-1),c.push(m)),(0===h?r>=s:o>=l)&&(c.push(g+1),c.push(p),c.push(m))}}return u}(this.ids,this.coords,t,e,n,i,this.nodeSize)},R.prototype.within=function(t,e,n){return function(t,e,n,i,r,o){for(var a=[0,t.length-1,0],s=[],l=r*r;a.length;){var c=a.pop(),u=a.pop(),h=a.pop();if(u-h<=o)for(var p=h;p<=u;p++)L(e[2*p],e[2*p+1],n,i)<=l&&s.push(t[p]);else{var d=Math.floor((h+u)/2),f=e[2*d],g=e[2*d+1];L(f,g,n,i)<=l&&s.push(t[d]);var m=(c+1)%2;(0===c?n-r<=f:i-r<=g)&&(a.push(h),a.push(d-1),a.push(m)),(0===c?n+r>=f:i+r>=g)&&(a.push(d+1),a.push(u),a.push(m))}}return s}(this.ids,this.coords,t,e,n,this.nodeSize)};var D={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},F=function(t){this.options=G(Object.create(D),t),this.trees=new Array(this.options.maxZoom+1)};function B(t,e,n,i,r){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:i,properties:r}}function j(t,e){var n=t.geometry.coordinates,i=n[1];return{x:U(n[0]),y:W(i),zoom:1/0,index:e,parentId:-1}}function N(t){return{type:"Feature",id:t.id,properties:V(t),geometry:{type:"Point",coordinates:[(i=t.x,360*(i-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,i}function V(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return G(G({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function U(t){return t/360+.5}function W(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function G(t,e){for(var n in e)t[n]=e[n];return t}function q(t){return t.x}function Z(t){return t.y}function H(t,e,n,i,r,o){var a=r-n,s=o-i;if(0!==a||0!==s){var l=((t-n)*a+(e-i)*s)/(a*a+s*s);l>1?(n=r,i=o):l>0&&(n+=a*l,i+=s*l)}return(a=t-n)*a+(s=e-i)*s}function X(t,e,n,i){var r={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Y(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)Y(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)Y(t,e[i][r])}(r),r}function Y(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function K(t,e,n,i){if(e.geometry){var r=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===o)J(r,s);else if("MultiPoint"===o)for(var c=0;c<r.length;c++)J(r[c],s);else if("LineString"===o)Q(r,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<r.length;c++)Q(r[c],s=[],a,!1),t.push(X(l,"LineString",s,e.properties));return}$(r,s,a,!1)}else if("Polygon"===o)$(r,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<e.geometry.geometries.length;c++)K(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];$(r[c],u,a,!0),s.push(u)}}t.push(X(l,o,s,e.properties))}}function J(t,e){e.push(tt(t[0])),e.push(et(t[1])),e.push(0)}function Q(t,e,n,i){for(var r,o,a=0,s=0;s<t.length;s++){var l=tt(t[s][0]),c=et(t[s][1]);e.push(l),e.push(c),e.push(0),s>0&&(a+=i?(r*c-l*o)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-o,2))),r=l,o=c}var u=e.length-3;e[2]=1,function t(e,n,i,r){for(var o,a=r,s=i-n>>1,l=i-n,c=e[n],u=e[n+1],h=e[i],p=e[i+1],d=n+3;d<i;d+=3){var f=H(e[d],e[d+1],c,u,h,p);if(f>a)o=d,a=f;else if(f===a){var g=Math.abs(d-s);g<l&&(o=d,l=g)}}a>r&&(o-n>3&&t(e,n,o,r),e[o+2]=a,i-o>3&&t(e,o,i,r))}(e,0,u,n),e[u+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function $(t,e,n,i){for(var r=0;r<t.length;r++){var o=[];Q(t[r],o,n,i),e.push(o)}}function tt(t){return t/360+.5}function et(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function nt(t,e,n,i,r,o,a,s){if(i/=e,o>=(n/=e)&&a<i)return t;if(a<n||o>=i)return null;for(var l=[],c=0;c<t.length;c++){var u=t[c],h=u.geometry,p=u.type,d=0===r?u.minX:u.minY,f=0===r?u.maxX:u.maxY;if(d>=n&&f<i)l.push(u);else if(!(f<n||d>=i)){var g=[];if("Point"===p||"MultiPoint"===p)it(h,g,n,i,r);else if("LineString"===p)rt(h,g,n,i,r,!1,s.lineMetrics);else if("MultiLineString"===p)at(h,g,n,i,r,!1);else if("Polygon"===p)at(h,g,n,i,r,!0);else if("MultiPolygon"===p)for(var m=0;m<h.length;m++){var y=[];at(h[m],y,n,i,r,!0),y.length&&g.push(y)}if(g.length){if(s.lineMetrics&&"LineString"===p){for(m=0;m<g.length;m++)l.push(X(u.id,p,g[m],u.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===g.length?(p="LineString",g=g[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===g.length?"Point":"MultiPoint"),l.push(X(u.id,p,g,u.tags))}}}return l.length?l:null}function it(t,e,n,i,r){for(var o=0;o<t.length;o+=3){var a=t[o+r];a>=n&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function rt(t,e,n,i,r,o,a){for(var s,l,c=ot(t),u=0===r?lt:ct,h=t.start,p=0;p<t.length-3;p+=3){var d=t[p],f=t[p+1],g=t[p+2],m=t[p+3],y=t[p+4],v=0===r?d:f,_=0===r?m:y,b=!1;a&&(s=Math.sqrt(Math.pow(d-m,2)+Math.pow(f-y,2))),v<n?_>n&&(l=u(c,d,f,m,y,n),a&&(c.start=h+s*l)):v>i?_<i&&(l=u(c,d,f,m,y,i),a&&(c.start=h+s*l)):st(c,d,f,g),_<n&&v>=n&&(l=u(c,d,f,m,y,n),b=!0),_>i&&v<=i&&(l=u(c,d,f,m,y,i),b=!0),!o&&b&&(a&&(c.end=h+s*l),e.push(c),c=ot(t)),a&&(h+=s)}var x=t.length-3;d=t[x],f=t[x+1],g=t[x+2],(v=0===r?d:f)>=n&&v<=i&&st(c,d,f,g),x=c.length-3,o&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&st(c,c[0],c[1],c[2]),c.length&&e.push(c)}function ot(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function at(t,e,n,i,r,o){for(var a=0;a<t.length;a++)rt(t[a],e,n,i,r,o,!1)}function st(t,e,n,i){t.push(e),t.push(n),t.push(i)}function lt(t,e,n,i,r,o){var a=(o-e)/(i-e);return t.push(o),t.push(n+(r-n)*a),t.push(1),a}function ct(t,e,n,i,r,o){var a=(o-n)/(r-n);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function ut(t,e){for(var n=[],i=0;i<t.length;i++){var r,o=t[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)r=ht(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){r=[];for(var s=0;s<o.geometry.length;s++)r.push(ht(o.geometry[s],e))}else if("MultiPolygon"===a)for(r=[],s=0;s<o.geometry.length;s++){for(var l=[],c=0;c<o.geometry[s].length;c++)l.push(ht(o.geometry[s][c],e));r.push(l)}n.push(X(o.id,a,r,o.tags))}return n}function ht(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function pt(t,e){if(t.transformed)return t;var n,i,r,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(i=0;i<c.length;i+=2)l.geometry.push(dt(c[i],c[i+1],e,o,a,s));else for(i=0;i<c.length;i++){var h=[];for(r=0;r<c[i].length;r+=2)h.push(dt(c[i][r],c[i][r+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function dt(t,e,n,i,r,o){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-o))]}function ft(t,e,n,i,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,gt(a,t[s],o,r);var l=t[s].minX,c=t[s].minY,u=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),c<a.minY&&(a.minY=c),u>a.maxX&&(a.maxX=u),h>a.maxY&&(a.maxY=h)}return a}function gt(t,e,n,i){var r=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<r.length;s+=3)a.push(r[s]),a.push(r[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)mt(a,r,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<r.length;s++)mt(a,r[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var c=r[l];for(s=0;s<c.length;s++)mt(a,c[s],t,n,!0,0===s)}if(a.length){var u=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var h in u={},e.tags)u[h]=e.tags[h];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:u};null!==e.id&&(p.id=e.id),t.features.push(p)}}function mt(t,e,n,i,r,o){var a=i*i;if(i>0&&e.size<(r?a:i))n.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(n.numSimplified++,s.push(e[l]),s.push(e[l+1])),n.numPoints++;r&&function(t,e){for(var n=0,i=0,r=t.length,o=r-2;i<r;o=i,i+=2)n+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=a,t[r-1-i]=s}}(s,o),t.push(s)}}function yt(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)K(n,t.features[i],e,i);else K(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,r=nt(t,1,-1-n,n,0,-1,2,e),o=nt(t,1,1-n,2+n,0,-1,2,e);return(r||o)&&(i=nt(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=ut(r,1).concat(i)),o&&(i=i.concat(ut(o,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vt(t,e,n){return 32*((1<<t)*n+e)+t}function _t(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return e(null,null);var r=new g(i.features),o=b(r);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:r,rawData:o.buffer})}F.prototype.load=function(t){var e=this.options,n=e.log,i=e.minZoom,r=e.maxZoom,o=e.nodeSize;n&&console.time("total time");var a="prepare "+t.length+" points";n&&console.time(a),this.points=t;for(var s=[],l=0;l<t.length;l++)t[l].geometry&&s.push(j(t[l],l));this.trees[r+1]=new R(s,q,Z,o,Float32Array),n&&console.timeEnd(a);for(var c=r;c>=i;c--){var u=+Date.now();s=this._cluster(s,c),this.trees[c]=new R(s,q,Z,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",c,s.length,+Date.now()-u)}return n&&console.timeEnd("total time"),this},F.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),r=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){var a=this.getClusters([n,i,180,o],e),s=this.getClusters([-180,i,r,o],e);return a.concat(s)}for(var l=this.trees[this._limitZoom(e)],c=[],u=0,h=l.range(U(n),W(o),U(r),W(i));u<h.length;u+=1){var p=l.points[h[u]];c.push(p.numPoints?N(p):this.points[p.index])}return c},F.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);var o=r.points[e];if(!o)throw new Error(i);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=[],l=0,c=r.within(o.x,o.y,a);l<c.length;l+=1){var u=r.points[c[l]];u.parentId===t&&s.push(u.numPoints?N(u):this.points[u.index])}if(0===s.length)throw new Error(i);return s},F.prototype.getLeaves=function(t,e,n){var i=[];return this._appendLeaves(i,t,e=e||10,n=n||0,0),i},F.prototype.getTile=function(t,e,n){var i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),o=this.options,a=o.radius/o.extent,s=(n-a)/r,l=(n+1+a)/r,c={features:[]};return this._addTileFeatures(i.range((e-a)/r,s,(e+1+a)/r,l),i.points,e,n,r,c),0===e&&this._addTileFeatures(i.range(1-a/r,s,1,l),i.points,r,n,r,c),e===r-1&&this._addTileFeatures(i.range(0,s,a/r,l),i.points,-1,n,r,c),c.features.length?c:null},F.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},F.prototype._appendLeaves=function(t,e,n,i,r){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],l=s.properties;if(l&&l.cluster?r+l.point_count<=i?r+=l.point_count:r=this._appendLeaves(t,l.cluster_id,n,i,r):r<i?r++:t.push(s),t.length===n)break}return r},F.prototype._addTileFeatures=function(t,e,n,i,r,o){for(var a=0,s=t;a<s.length;a+=1){var l=e[s[a]],c=l.numPoints,u={type:1,geometry:[[Math.round(this.options.extent*(l.x*r-n)),Math.round(this.options.extent*(l.y*r-i))]],tags:c?V(l):this.points[l.index].properties},h=void 0;c?h=l.id:this.options.generateId?h=l.index:this.points[l.index].id&&(h=this.points[l.index].id),void 0!==h&&(u.id=h),o.features.push(u)}},F.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},F.prototype._cluster=function(t,e){for(var n=[],i=this.options,r=i.reduce,o=i.minPoints,a=i.radius/(i.extent*Math.pow(2,e)),s=0;s<t.length;s++){var l=t[s];if(!(l.zoom<=e)){l.zoom=e;for(var c=this.trees[e+1],u=c.within(l.x,l.y,a),h=l.numPoints||1,p=h,d=0,f=u;d<f.length;d+=1){var g=c.points[f[d]];g.zoom>e&&(p+=g.numPoints||1)}if(p>=o){for(var m=l.x*h,y=l.y*h,v=r&&h>1?this._map(l,!0):null,_=(s<<5)+(e+1)+this.points.length,b=0,x=u;b<x.length;b+=1){var w=c.points[x[b]];if(!(w.zoom<=e)){w.zoom=e;var S=w.numPoints||1;m+=w.x*S,y+=w.y*S,w.parentId=_,r&&(v||(v=this._map(l,!0)),r(v,this._map(w)))}}l.parentId=_,n.push(B(m/p,y/p,_,p,v))}else if(n.push(l),p>1)for(var P=0,E=u;P<E.length;P+=1){var T=c.points[E[P]];T.zoom<=e||(T.zoom=e,n.push(T))}}}return n},F.prototype._getOriginId=function(t){return t-this.points.length>>5},F.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},F.prototype._map=function(t,e){if(t.numPoints)return e?G({},t.properties):t.properties;var n=this.points[t.index].properties,i=this.options.map(n);return e&&i===n?G({},i):i},yt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yt.prototype.splitTile=function(t,e,n,i,r,o,a){for(var s=[t,e,n,i],l=this.options,c=l.debug;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var u=1<<e,h=vt(e,n,i),p=this.tiles[h];if(!p&&(c>1&&console.time("creation"),p=this.tiles[h]=ft(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=t,r){if(e===l.maxZoom||e===r)continue;var f=1<<r-e;if(n!==Math.floor(o/f)||i!==Math.floor(a/f))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){c>1&&console.time("clipping");var g,m,y,v,_,b,x=.5*l.buffer/l.extent,w=.5-x,S=.5+x,P=1+x;g=m=y=v=null,_=nt(t,u,n-x,n+S,0,p.minX,p.maxX,l),b=nt(t,u,n+w,n+P,0,p.minX,p.maxX,l),t=null,_&&(g=nt(_,u,i-x,i+S,1,p.minY,p.maxY,l),m=nt(_,u,i+w,i+P,1,p.minY,p.maxY,l),_=null),b&&(y=nt(b,u,i-x,i+S,1,p.minY,p.maxY,l),v=nt(b,u,i+w,i+P,1,p.minY,p.maxY,l),b=null),c>1&&console.timeEnd("clipping"),s.push(g||[],e+1,2*n,2*i),s.push(m||[],e+1,2*n,2*i+1),s.push(y||[],e+1,2*n+1,2*i),s.push(v||[],e+1,2*n+1,2*i+1)}}},yt.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,o=i.debug;if(t<0||t>24)return null;var a=1<<t,s=vt(t,e=(e%a+a)%a,n);if(this.tiles[s])return pt(this.tiles[s],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,c=t,u=e,h=n;!l&&c>0;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[vt(c,u,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,u,h),o>1&&console.time("drilling down"),this.splitTile(l.source,c,u,h,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?pt(this.tiles[s],r):null):null};var bt=function(e){function n(t,n,i,r){e.call(this,t,n,i,_t),r&&(this.loadGeoJSON=r)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var n=this._pendingCallback,i=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var r=!!(i&&i.request&&i.request.collectResourceTiming)&&new t.RequestPerformance(i.request);this.loadGeoJSON(i,(function(o,a){if(o||!a)return n(o);if("object"!=typeof a)return n(new Error("Input data given to '"+i.source+"' is not a valid GeoJSON object."));!function t(e,n){var i,r=e&&e.type;if("FeatureCollection"===r)for(i=0;i<e.features.length;i++)t(e.features[i],n);else if("GeometryCollection"===r)for(i=0;i<e.geometries.length;i++)t(e.geometries[i],n);else if("Feature"===r)t(e.geometry,n);else if("Polygon"===r)h(e.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<e.coordinates.length;i++)h(e.coordinates[i],n);return e}(a,!0);try{if(i.filter){var s=t.createExpression(i.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===s.result)throw new Error(s.value.map((function(t){return t.key+": "+t.message})).join(", "));var l=a.features.filter((function(t){return s.value.evaluate({zoom:0},t)}));a={type:"FeatureCollection",features:l}}e._geoJSONIndex=i.cluster?new F(function(e){var n=e.superclusterOptions,i=e.clusterProperties;if(!i||!n)return n;for(var r={},o={},a={accumulated:null,zoom:0},s={properties:null},l=Object.keys(i),c=0,u=l;c<u.length;c+=1){var h=u[c],p=i[h],d=p[0],f=t.createExpression(p[1]),g=t.createExpression("string"==typeof d?[d,["accumulated"],["get",h]]:d);r[h]=f.value,o[h]=g.value}return n.map=function(t){s.properties=t;for(var e={},n=0,i=l;n<i.length;n+=1){var o=i[n];e[o]=r[o].evaluate(a,s)}return e},n.reduce=function(t,e){s.properties=e;for(var n=0,i=l;n<i.length;n+=1){var r=i[n];a.accumulated=t[r],t[r]=o[r].evaluate(a,s)}},n}(i)).load(a.features):function(t,e){return new yt(t,e)}(a,i.geojsonVtOptions)}catch(o){return n(o)}e.loaded={};var c={};if(r){var u=r.finish();u&&(c.resourceTiming={},c.resourceTiming[i.source]=JSON.parse(JSON.stringify(u)))}n(null,c)}))}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var i=this.loaded;return i&&i[t.uid]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n.prototype.getClusterExpansionZoom=function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterChildren=function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}},n.prototype.getClusterLeaves=function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}},n}(l),xt=function(e){var n=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:bt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return xt.prototype.setReferrer=function(t,e){this.referrer=e},xt.prototype.setImages=function(t,e,n){for(var i in this.availableImages[t]=e,this.workerSources[t]){var r=this.workerSources[t][i];for(var o in r)r[o].availableImages=e}n()},xt.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},xt.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},xt.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},xt.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},xt.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},xt.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},xt.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},xt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},xt.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,n):n()}},xt.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},xt.prototype.syncRTLPluginState=function(e,n,i){try{t.plugin.setState(n);var r=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=r){this.self.importScripts(r);var o=t.plugin.isParsed();i(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+r),o)}}catch(t){i(t.toString())}},xt.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e||(e=[]),e},xt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new i),e},xt.prototype.getWorkerSource=function(t,e,n){var i=this;return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][n]||(this.workerSources[t][e][n]=new this.workerSourceTypes[e]({send:function(e,n,r){i.actor.send(e,n,r,t)}},this.getLayerIndex(t),this.getAvailableImages(t))),this.workerSources[t][e][n]},xt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new u),this.demWorkerSources[t][e]},xt.prototype.enforceCacheSizeLimit=function(e,n){t.enforceCacheSizeLimit(n)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new xt(self)),xt})),i(["./shared"],(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!n(t)}function n(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{e=new Worker(i),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(i),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var n=e.getImageData(0,0,1,1);return n&&n.width===t.width}()?(void 0===i[n=t&&t.failIfMajorPerformanceCaveat]&&(i[n]=function(t){var n=function(t){var n=document.createElement("canvas"),i=Object.create(e.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",i)||n.probablySupportsContext("experimental-webgl",i):n.supportsContext?n.supportsContext("webgl",i)||n.supportsContext("experimental-webgl",i):n.getContext("webgl",i)||n.getContext("experimental-webgl",i)}(t);if(!n)return!1;var i=n.createShader(n.VERTEX_SHADER);return!(!i||n.isContextLost())&&(n.shaderSource(i,"void main() {}"),n.compileShader(i),!0===n.getShaderParameter(i,n.COMPILE_STATUS))}(n)),i[n]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var n}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=n);var i={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),n={create:function(e,n,i){var r=t.window.document.createElement(e);return void 0!==n&&(r.className=n),i&&i.appendChild(r),r},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},i=t.window.document&&t.window.document.documentElement.style;function r(t){if(!i)return t[0];for(var e=0;e<t.length;e++)if(t[e]in i)return t[e];return t[0]}var o,a=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){i&&a&&(o=i[a],i[a]="none")},n.enableDrag=function(){i&&a&&(i[a]=o)};var s=r(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[s]=e};var l=!1;try{var c=Object.defineProperty({},"passive",{get:function(){l=!0}});t.window.addEventListener("test",c,c),t.window.removeEventListener("test",c,c)}catch(t){l=!1}n.addEventListener=function(t,e,n,i){void 0===i&&(i={}),t.addEventListener(e,n,"passive"in i&&l?i:i.capture)},n.removeEventListener=function(t,e,n,i){void 0===i&&(i={}),t.removeEventListener(e,n,"passive"in i&&l?i:i.capture)};var u=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",u,!0)};function h(t){var e=t.userImage;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}n.suppressClick=function(){t.window.addEventListener("click",u,!0),t.window.setTimeout((function(){t.window.removeEventListener("click",u,!0)}),0)},n.mousePos=function(e,n){var i=e.getBoundingClientRect();return new t.Point(n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop)},n.touchPos=function(e,n){for(var i=e.getBoundingClientRect(),r=[],o=0;o<n.length;o++)r.push(new t.Point(n[o].clientX-i.left-e.clientLeft,n[o].clientY-i.top-e.clientTop));return r},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var p=function(e){function n(){e.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.isLoaded=function(){return this.loaded},n.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var i=n[e];this._notify(i.ids,i.callback)}this.requestors=[]}},n.prototype.getImage=function(t){return this.images[t]},n.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},n.prototype._validate=function(e,n){var i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchX" value'))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchY" value'))),i=!1),this._validateContent(n.content,n)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "content" value'))),i=!1),i},n.prototype._validateStretch=function(t,e){if(!t)return!0;for(var n=0,i=0,r=t;i<r.length;i+=1){var o=r[i];if(o[0]<n||o[1]<o[0]||e<o[1])return!1;n=o[1]}return!0},n.prototype._validateContent=function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))},n.prototype.updateImage=function(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0},n.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},n.prototype.listImages=function(){return Object.keys(this.images)},n.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var i=0,r=t;i<r.length;i+=1)this.images[r[i]]||(n=!1);this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},n.prototype._notify=function(e,n){for(var i={},r=0,o=e;r<o.length;r+=1){var a=o[r];this.images[a]||this.fire(new t.Event("styleimagemissing",{id:a}));var s=this.images[a];s?i[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:t.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}n(null,i)},n.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},n.prototype.getPattern=function(e){var n=this.patterns[e],i=this.getImage(e);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{var r={w:i.data.width+2,h:i.data.height+2,x:0,y:0},o=new t.ImagePosition(r,i);this.patterns[e]={bin:r,position:o}}return this._updatePatternAtlas(),this.patterns[e].position},n.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},n.prototype._updatePatternAtlas=function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var i=t.potpack(e),r=i.w,o=i.h,a=this.atlasImage;for(var s in a.resize({width:r||1,height:o||1}),this.patterns){var l=this.patterns[s].bin,c=l.x+1,u=l.y+1,h=this.images[s].data,p=h.width,d=h.height;t.RGBAImage.copy(h,a,{x:0,y:0},{x:c,y:u},{width:p,height:d}),t.RGBAImage.copy(h,a,{x:0,y:d-1},{x:c,y:u-1},{width:p,height:1}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:c,y:u+d},{width:p,height:1}),t.RGBAImage.copy(h,a,{x:p-1,y:0},{x:c-1,y:u},{width:1,height:d}),t.RGBAImage.copy(h,a,{x:0,y:0},{x:c+p,y:u},{width:1,height:d})}this.dirty=!0},n.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},n.prototype.dispatchRenderCallbacks=function(t){for(var e=0,n=t;e<n.length;e+=1){var i=n[e];if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var r=this.images[i];h(r)&&this.updateImage(i,r)}}},n}(t.Evented),d=m,f=m,g=1e20;function m(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function y(t,e,n,i,r,o,a){for(var s=0;s<e;s++){for(var l=0;l<n;l++)i[l]=t[l*e+s];for(v(i,r,o,a,n),l=0;l<n;l++)t[l*e+s]=r[l]}for(l=0;l<n;l++){for(s=0;s<e;s++)i[s]=t[l*e+s];for(v(i,r,o,a,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(r[s])}}function v(t,e,n,i,r){n[0]=0,i[0]=-g,i[1]=+g;for(var o=1,a=0;o<r;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=i[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,i[a]=s,i[a+1]=+g}for(o=0,a=0;o<r;o++){for(;i[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}m.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var r=e.data[4*i+3]/255;this.gridOuter[i]=1===r?0:0===r?g:Math.pow(Math.max(0,.5-r),2),this.gridInner[i]=1===r?g:0===r?0:Math.pow(Math.max(0,r-.5),2)}for(y(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),y(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++)n[i]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[i]-this.gridInner[i])/this.radius+this.cutoff))));return n},d.default=f;var _=function(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}};_.prototype.setURL=function(t){this.url=t},_.prototype.getGlyphs=function(e,n){var i=this,r=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1)r.push({stack:o,id:s[a]});t.asyncAll(r,(function(t,e){var n=t.stack,r=t.id,o=i.entries[n];o||(o=i.entries[n]={glyphs:{},requests:{},ranges:{}});var a=o.glyphs[r];if(void 0===a){if(a=i._tinySDF(o,n,r))return o.glyphs[r]=a,void e(null,{stack:n,id:r,glyph:a});var s=Math.floor(r/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else if(o.ranges[s])e(null,{stack:n,id:r,glyph:a});else{var l=o.requests[s];l||(l=o.requests[s]=[],_.loadGlyphRange(n,s,i.url,i.requestManager,(function(t,e){if(e){for(var n in e)i._doesCharSupportLocalGlyph(+n)||(o.glyphs[+n]=e[+n]);o.ranges[s]=!0}for(var r=0,a=l;r<a.length;r+=1)(0,a[r])(t,e);delete o.requests[s]}))),l.push((function(t,i){t?e(t):i&&e(null,{stack:n,id:r,glyph:i[r]||null})}))}}else e(null,{stack:n,id:r,glyph:a})}),(function(t,e){if(t)n(t);else if(e){for(var i={},r=0,o=e;r<o.length;r+=1){var a=o[r],s=a.stack,l=a.id,c=a.glyph;(i[s]||(i[s]={}))[l]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}n(null,i)}}))},_.prototype._doesCharSupportLocalGlyph=function(e){return!!this.localIdeographFontFamily&&(t.isChar["CJK Unified Ideographs"](e)||t.isChar["Hangul Syllables"](e)||t.isChar.Hiragana(e)||t.isChar.Katakana(e))},_.prototype._tinySDF=function(e,n,i){var r=this.localIdeographFontFamily;if(r&&this._doesCharSupportLocalGlyph(i)){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new _.TinySDF(24,3,8,.25,r,a)}return{id:i,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(e,n,i,r,o){var a=256*n,s=a+255,l=r.transformRequest(r.normalizeGlyphsURL(i).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,(function(e,n){if(e)o(e);else if(n){for(var i={},r=0,a=t.parseGlyphPBF(n);r<a.length;r+=1){var s=a[r];i[s.id]=s}o(null,i)}}))},_.TinySDF=d;var b=function(){this.specification=t.styleSpec.light.position};b.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},b.prototype.interpolate=function(e,n,i){return{x:t.number(e.x,n.x,i),y:t.number(e.y,n.y,i),z:t.number(e.z,n.z,i)}};var x=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new b,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),w=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(x),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e,n){if(void 0===n&&(n={}),!this._validate(t.validateLight,e,n))for(var i in e){var r=e[i];t.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-"-transition".length),r):this._transitionable.setValue(i,r)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n,i){return(!i||!1!==i.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},n}(t.Evented),S=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};S.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]},S.prototype.getDashRanges=function(t,e,n){var i=[],r=t.length%2==1?-t[t.length-1]*n:0,o=t[0]*n,a=!0;i.push({left:r,right:o,isDash:a,zeroLength:0===t[0]});for(var s=t[0],l=1;l<t.length;l++){var c=t[l];i.push({left:r=s*n,right:o=(s+=c)*n,isDash:a=!a,zeroLength:0===c})}return i},S.prototype.addRoundDash=function(t,e,n){for(var i=e/2,r=-n;r<=n;r++)for(var o=this.width*(this.nextRow+n+r),a=0,s=t[a],l=0;l<this.width;l++){l/s.right>1&&(s=t[++a]);var c=Math.abs(l-s.left),u=Math.abs(l-s.right),h=Math.min(c,u),p=void 0,d=r/n*(i+1);if(s.isDash){var f=i-Math.abs(d);p=Math.sqrt(h*h+f*f)}else p=i-Math.sqrt(h*h+d*d);this.data[o+l]=Math.max(0,Math.min(255,p+128))}},S.prototype.addRegularDash=function(t){for(var e=t.length-1;e>=0;--e){var n=t[e],i=t[e+1];n.zeroLength?t.splice(e,1):i&&i.isDash===n.isDash&&(i.left=n.left,t.splice(e,1))}var r=t[0],o=t[t.length-1];r.isDash===o.isDash&&(r.left=o.left-this.width,o.right=r.right+this.width);for(var a=this.width*this.nextRow,s=0,l=t[s],c=0;c<this.width;c++){c/l.right>1&&(l=t[++s]);var u=Math.abs(c-l.left),h=Math.abs(c-l.right),p=Math.min(u,h);this.data[a+c]=Math.max(0,Math.min(255,(l.isDash?p:-p)+128))}},S.prototype.addDash=function(e,n){var i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];if(0!==o){var s=this.width/o,l=this.getDashRanges(e,this.width,s);n?this.addRoundDash(l,s,i):this.addRegularDash(l)}var c={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:o};return this.nextRow+=r,this.dirty=!0,c},S.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))};var P=function e(n,i){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var r=this.workerPool.acquire(this.id),o=0;o<r.length;o++){var a=new e.Actor(r[o],i,this.id);a.name="Worker "+o,this.actors.push(a)}};function E(e,n,i){var r=function(r,o){if(r)return i(r);if(o){var a=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(a.vectorLayers=o.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(t){return t.id}))),a.tiles=n.canonicalizeTileset(a,e.url),i(null,a)}};return e.url?t.getJSON(n.transformRequest(n.normalizeSourceURL(e.url),t.ResourceType.Source),r):t.browser.frame((function(){return r(null,e)}))}P.prototype.broadcast=function(e,n,i){t.asyncAll(this.actors,(function(t,i){t.send(e,n,i)}),i=i||function(){})},P.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},P.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},P.Actor=t.Actor;var T=function(e,n,i){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=i||24};T.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},T.prototype.contains=function(e){var n=Math.pow(2,e.z),i=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*n),r=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*n),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*n);return e.x>=i&&e.x<o&&e.y>=r&&e.y<a};var k=function(e){function n(n,i,r,o){if(e.call(this),this.id=n,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(i,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,(function(n,i){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new T(i.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(i.tiles,e.map._requestManager._customAccessToken),t.postMapLoadEvent(i.tiles,e.map._getMapId(),e.map._requestManager._skuToken,e.map._requestManager._customAccessToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setSourceProperty=function(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},n.prototype.setTiles=function(t){var e=this;return this.setSourceProperty((function(){e._options.tiles=t})),this},n.prototype.setUrl=function(t){var e=this;return this.setSourceProperty((function(){e.url=t,e._options.url=t})),this},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(i,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(i,r){return delete e.request,e.aborted?n(null):i&&404!==i.status?n(i):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}r.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=n:e.request=e.actor.send("reloadTile",r,o.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",r,o.bind(this)))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),A=function(e){function n(n,i,r,o){e.call(this),this.id=n,this.dispatcher=r,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},i),t.extend(this,t.pick(i,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,(function(n,i){e._tileJSONRequest=null,e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):i&&(t.extend(e,i),i.bounds&&(e.tileBounds=new T(i.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(i.tiles),t.postMapLoadEvent(i.tiles,e.map._getMapId(),e.map._requestManager._skuToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var i=this,r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),(function(r,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(o){i.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=i.map.painter.context,s=a.gl;e.texture=i.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(i.dispatcher),n(null)}}))},n.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),C=function(e){function n(n,i,r,o){e.call(this,n,i,r,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function r(t,i){t&&(e.state="errored",n(t)),i&&(e.dem=i,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}e.request=t.getImage(this.map._requestManager.transformRequest(i,t.ResourceType.Tile),function(i,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=t.window.ImageBitmap&&o instanceof t.window.ImageBitmap&&t.offscreenCanvasSupported()?o:t.browser.getImageData(o,1),s={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:a,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",s,r.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+i)%i,s=n.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new t.OverscaledTileID(e.overscaledZ,o,n.z,r,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),l},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},n}(A),M=function(e){function n(n,i,r,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(o),this._data=i.data,this._options=t.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?Math.min(i.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:t.EXTENT,radius:(i.clusterRadius||50)*a,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(n){if(n)e.fire(new t.ErrorEvent(n));else{var i={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(i.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",i))}}))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)n.fire(new t.ErrorEvent(e));else{var i={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(i.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",i))}})),this},n.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},n.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},n.prototype.getClusterLeaves=function(t,e,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},i),this},n.prototype._updateWorkerData=function(e){var n=this;this._loaded=!1;var i=t.extend({},this.workerOptions),r=this._data;"string"==typeof r?(i.request=this.map._requestManager.transformRequest(t.browser.resolveURL(r),t.ResourceType.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(r),this.actor.send(this.type+".loadData",i,(function(t,r){n._removed||r&&r.abandoned||(n._loaded=!0,r&&r.resourceTiming&&r.resourceTiming[n.id]&&(n._resourceTiming=r.resourceTiming[n.id].slice(0)),n.actor.send(n.type+".coalesce",{source:i.source},null),e(t))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.loadTile=function(e,n){var i=this,r=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(r,{type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(t,o){return delete e.request,e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,i.map.painter,"reloadTile"===r),n(null))}))},n.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},n.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),I=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),L=function(e){function n(t,n,i,r){e.call(this),this.id=t,this.dispatcher=i,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(e,n){var i=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(r,o){i._loaded=!0,r?i.fire(new t.ErrorEvent(r)):o&&(i.image=o,e&&(i.coordinates=e),n&&n(),i._finishLoading())}))},n.prototype.loaded=function(){return this._loaded},n.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null})),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){var n=this;this.coordinates=e;var i=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){for(var n=1/0,i=1/0,r=-1/0,o=-1/0,a=0,s=e;a<s.length;a+=1){var l=s[a];n=Math.min(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.x),o=Math.max(o,l.y)}var c=Math.max(r-n,o-i),u=Math.max(0,Math.floor(-Math.log(c)/Math.LN2)),h=Math.pow(2,u);return new t.CanonicalTileID(u,Math.floor((n+r)/2*h),Math.floor((i+o)/2*h))}(i),this.minzoom=this.maxzoom=this.tileID.z;var r=i.map((function(t){return n.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(r[2].x,r[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),O=function(e){function n(t,n,i,r){e.call(this,t,n,i,r),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){var e=this;this._loaded=!1;var n=this.options;this.urls=[];for(var i=0,r=n.urls;i<r.length;i+=1)this.urls.push(this.map._requestManager.transformRequest(r[i],t.ResourceType.Source).url);t.getVideo(this.urls,(function(n,i){e._loaded=!0,n?e.fire(new t.ErrorEvent(n)):i&&(e.video=i,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))},n.prototype.pause=function(){this.video&&this.video.pause()},n.prototype.play=function(){this.video&&this.video.play()},n.prototype.seek=function(e){if(this.video){var n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+n.start(0)+" and "+n.end(0)+"-second mark."))):this.video.currentTime=e}},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var r=this.tiles[i];"loaded"!==r.state&&(r.state="loaded",r.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(L),z=function(e){function n(n,i,r,o){e.call(this,n,i,r,o),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,i=n.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,I.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,i.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[r];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(L),R={vector:k,raster:A,"raster-dem":C,geojson:M,video:O,image:L,canvas:z};function D(e,n){var i=t.identity([]);return t.translate(i,i,[1,1,0]),t.scale(i,i,[.5*e.width,.5*e.height,1]),t.multiply(i,i,e.calculatePosMatrix(n.toUnwrapped()))}function F(t,e,n,i,r,o){var a=function(t,e,n){if(t)for(var i=0,r=t;i<r.length;i+=1){var o=e[r[i]];if(o&&o.source===n&&"fill-extrusion"===o.type)return!0}else for(var a in e){var s=e[a];if(s.source===n&&"fill-extrusion"===s.type)return!0}return!1}(r&&r.layers,e,t.id),s=o.maxPitchScaleFactor(),l=t.tilesIn(i,s,a);l.sort(B);for(var c=[],u=0,h=l;u<h.length;u+=1){var p=h[u];c.push({wrappedTileID:p.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,n,t._state,p.queryGeometry,p.cameraQueryGeometry,p.scale,r,o,s,D(t.transform,p.tileID))})}var d=function(t){for(var e={},n={},i=0,r=t;i<r.length;i+=1){var o=r[i],a=o.queryResults,s=o.wrappedTileID,l=n[s]=n[s]||{};for(var c in a)for(var u=a[c],h=l[c]=l[c]||{},p=e[c]=e[c]||[],d=0,f=u;d<f.length;d+=1){var g=f[d];h[g.featureIndex]||(h[g.featureIndex]=!0,p.push(g))}}return e}(c);for(var f in d)d[f].forEach((function(e){var n=e.feature,i=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i}));return d}function B(t,e){var n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}var j=function(t,e){this.max=t,this.onRemove=e,this.reset()};j.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var i=n[e];i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value)}return this.data={},this.order=[],this},j.prototype.add=function(t,e,n){var i=this,r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout((function(){i.remove(t,o)}),n)),this.data[r].push(o),this.order.push(r),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},j.prototype.has=function(t){return t.wrapped().key in this.data},j.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},j.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},j.prototype.getByKey=function(t){var e=this.data[t];return e?e[0].value:null},j.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},j.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this},j.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},j.prototype.filter=function(t){var e=[];for(var n in this.data)for(var i=0,r=this.data[n];i<r.length;i+=1){var o=r[i];t(o.value)||e.push(o)}for(var a=0,s=e;a<s.length;a+=1){var l=s[a];this.remove(l.value.tileID,l)}};var N=function(t,e,n){this.context=t;var i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};N.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},N.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},N.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var V={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},U=function(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;var r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};U.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},U.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},U.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var i=e.attributes[this.attributes[n].name];void 0!==i&&t.enableVertexAttribArray(i)}},U.prototype.setVertexAttribPointers=function(t,e,n){for(var i=0;i<this.attributes.length;i++){var r=this.attributes[i],o=e.attributes[r.name];void 0!==o&&t.vertexAttribPointer(o,r.components,t[V[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}},U.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var W=function(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};W.prototype.get=function(){return this.current},W.prototype.set=function(t){},W.prototype.getDefault=function(){return this.default},W.prototype.setDefault=function(){this.set(this.default)};var G=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(W),q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},e}(W),Z=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},e}(W),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(W),X=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)},e}(W),Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},e}(W),K=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},e}(W),J=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},e}(W),Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},e}(W),$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},e}(W),tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},e}(W),et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},e}(W),nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},e}(W),it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},e}(W),rt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(W),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},e}(W),at=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},e}(W),st=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)},e}(W),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)},e}(W),ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)},e}(W),ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},e}(W),ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(W),pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},e}(W),dt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(W),ft=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},e}(W),gt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},e}(W),mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},e}(W),yt=function(t){function e(e){t.call(this,e),this.vao=e.extVertexArrayObject}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},e}(W),vt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},e}(W),_t=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},e}(W),bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},e}(W),xt=function(t){function e(e,n){t.call(this,e),this.context=e,this.parent=n}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e}(W),wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e}(xt),St=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(xt),Pt=function(t,e,n,i){this.context=t,this.width=e,this.height=n;var r=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new wt(t,r),i&&(this.depthAttachment=new St(t,r))};Pt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n)}t.deleteFramebuffer(this.framebuffer)};var Et=function(t,e,n){this.func=t,this.mask=e,this.range=n};Et.ReadOnly=!1,Et.ReadWrite=!0,Et.disabled=new Et(519,Et.ReadOnly,[0,1]);var Tt=function(t,e,n,i,r,o){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=o};Tt.disabled=new Tt({func:519,mask:0},0,0,7680,7680,7680);var kt=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};kt.disabled=new kt(kt.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),kt.unblended=new kt(kt.Replace,t.Color.transparent,[!0,!0,!0,!0]),kt.alphaBlended=new kt([1,771],t.Color.transparent,[!0,!0,!0,!0]);var At=function(t,e,n){this.enable=t,this.mode=e,this.frontFace=n};At.disabled=new At(!1,1029,2305),At.backCCW=new At(!0,1029,2305);var Ct=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new G(this),this.clearDepth=new q(this),this.clearStencil=new Z(this),this.colorMask=new H(this),this.depthMask=new X(this),this.stencilMask=new Y(this),this.stencilFunc=new K(this),this.stencilOp=new J(this),this.stencilTest=new Q(this),this.depthRange=new $(this),this.depthTest=new tt(this),this.depthFunc=new et(this),this.blend=new nt(this),this.blendFunc=new it(this),this.blendColor=new rt(this),this.blendEquation=new ot(this),this.cullFace=new at(this),this.cullFaceSide=new st(this),this.frontFace=new lt(this),this.program=new ct(this),this.activeTexture=new ut(this),this.viewport=new ht(this),this.bindFramebuffer=new pt(this),this.bindRenderbuffer=new dt(this),this.bindTexture=new ft(this),this.bindVertexBuffer=new gt(this),this.bindElementBuffer=new mt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new yt(this),this.pixelStoreUnpack=new vt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new bt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)};Ct.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ct.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ct.prototype.createIndexBuffer=function(t,e){return new N(this,t,e)},Ct.prototype.createVertexBuffer=function(t,e,n){return new U(this,t,e,n)},Ct.prototype.createRenderbuffer=function(t,e,n){var i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r},Ct.prototype.createFramebuffer=function(t,e,n){return new Pt(this,t,e,n)},Ct.prototype.clear=function(t){var e=t.color,n=t.depth,i=this.gl,r=0;e&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(r|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),i.clear(r)},Ct.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},Ct.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Ct.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Ct.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,kt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},Ct.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Mt=function(e){function n(n,i,r){var o=this;e.call(this),this.id=n,this.dispatcher=r,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))})),this.on("error",(function(){o._sourceErrored=!0})),this._source=function(e,n,i,r){var o=new R[n.type](e,n,i,r);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o}(n,i,r,this),this._tiles={},this._cache=new j(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}},n.prototype.getIds=function(){return t.values(this._tiles).map((function(t){return t.tileID})).sort(It).map((function(t){return t.key}))},n.prototype.getRenderableIds=function(e){var n=this,i=[];for(var r in this._tiles)this._isIdRenderable(r,e)&&i.push(this._tiles[r]);return e?i.sort((function(e,i){var r=e.tileID,o=i.tileID,a=new t.Point(r.canonical.x,r.canonical.y)._rotate(n.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return r.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})).map((function(t){return t.tileID.key})):i.map((function(t){return t.tileID})).sort(It).map((function(t){return t.key}))},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,i,r){if(r)return e.state="errored",void(404!==r.status?this._source.fire(new t.ErrorEvent(r,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var i=e[n];if(t.neighboringTiles&&t.neighboringTiles[i]){var r=this.getTileByID(i);o(t,r),o(r,t)}}function o(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype._retainLoadedChildren=function(t,e,n,i){for(var r in this._tiles){var o=this._tiles[r];if(!(i[r]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var l=a;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){i[a.key]=a;break}}}},n.prototype.findLoadedParent=function(t,e){if(t.key in this._loadedParentTiles){var n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(var i=t.overscaledZ-1;i>=e;i--){var r=t.scaledTo(i),o=this._getLoadedTile(r);if(o)return o}},n.prototype._getLoadedTile=function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)},n.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,n=Math.ceil(t.height/this._source.tileSize)+1,i=Math.floor(e*n*5),r="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(r)},n.prototype.handleWrapJump=function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var n={};for(var i in this._tiles){var r=this._tiles[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),n[r.tileID.key]=r}for(var o in this._tiles=n,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},n.prototype.update=function(e){var i=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var r;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(r=r.filter((function(t){return i._source.hasTile(t)})))):r=[];var o=e.coveringZoomLevel(this._source),a=Math.max(o-n.maxOverzooming,this._source.minzoom),s=Math.max(o+n.maxUnderzooming,this._source.minzoom),l=this._updateRetainedTiles(r,o);if(Lt(this._source.type)){for(var c={},u={},h=0,p=Object.keys(l);h<p.length;h+=1){var d=p[h],f=l[d],g=this._tiles[d];if(g&&!(g.fadeEndTime&&g.fadeEndTime<=t.browser.now())){var m=this.findLoadedParent(f,a);m&&(this._addTile(m.tileID),c[m.tileID.key]=m.tileID),u[d]=f}}for(var y in this._retainLoadedChildren(u,o,s,l),c)l[y]||(this._coveredTiles[y]=!0,l[y]=c[y])}for(var v in l)this._tiles[v].clearFadeHold();for(var _=0,b=t.keysDifference(this._tiles,l);_<b.length;_+=1){var x=b[_],w=this._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(x)}this._updateLoadedParentTileCache()}},n.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},n.prototype._updateRetainedTiles=function(t,e){for(var i={},r={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),s={},l=0,c=t;l<c.length;l+=1){var u=c[l],h=this._addTile(u);i[u.key]=u,h.hasData()||e<this._source.maxzoom&&(s[u.key]=u)}this._retainLoadedChildren(s,e,a,i);for(var p=0,d=t;p<d.length;p+=1){var f=d[p],g=this._tiles[f.key];if(!g.hasData()){if(e+1>this._source.maxzoom){var m=f.children(this._source.maxzoom)[0],y=this.getTile(m);if(y&&y.hasData()){i[m.key]=m;continue}}else{var v=f.children(this._source.maxzoom);if(i[v[0].key]&&i[v[1].key]&&i[v[2].key]&&i[v[3].key])continue}for(var _=g.wasRequested(),b=f.overscaledZ-1;b>=o;--b){var x=f.scaledTo(b);if(r[x.key])break;if(r[x.key]=!0,!(g=this.getTile(x))&&_&&(g=this._addTile(x)),g&&(i[x.key]=x,_=g.wasRequested(),g.hasData()))break}}}return i},n.prototype._updateLoadedParentTileCache=function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],n=void 0,i=this._tiles[t].tileID;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);var r=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(r))break;i=r}for(var o=0,a=e;o<a.length;o+=1)this._loadedParentTiles[a[o]]=n}},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var i=Boolean(n);return i||(n=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,i||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((function(){n._reloadTile(t,"expired"),delete n._timers[t]}),i))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n,i){var r=this,o=[],a=this.transform;if(!a)return o;for(var s=i?a.getCameraQueryGeometry(e):e,l=e.map((function(t){return a.pointCoordinate(t)})),c=s.map((function(t){return a.pointCoordinate(t)})),u=this.getIds(),h=1/0,p=1/0,d=-1/0,f=-1/0,g=0,m=c;g<m.length;g+=1){var y=m[g];h=Math.min(h,y.x),p=Math.min(p,y.y),d=Math.max(d,y.x),f=Math.max(f,y.y)}for(var v=function(e){var i=r._tiles[u[e]];if(!i.holdingForFade()){var s=i.tileID,g=Math.pow(2,a.zoom-i.tileID.overscaledZ),m=n*i.queryPadding*t.EXTENT/i.tileSize/g,y=[s.getTilePoint(new t.MercatorCoordinate(h,p)),s.getTilePoint(new t.MercatorCoordinate(d,f))];if(y[0].x-m<t.EXTENT&&y[0].y-m<t.EXTENT&&y[1].x+m>=0&&y[1].y+m>=0){var v=l.map((function(t){return s.getTilePoint(t)})),_=c.map((function(t){return s.getTilePoint(t)}));o.push({tile:i,tileID:s,queryGeometry:v,cameraQueryGeometry:_,scale:g})}}},_=0;_<u.length;_++)v(_);return o},n.prototype.getVisibleCoordinates=function(t){for(var e=this,n=this.getRenderableIds(t).map((function(t){return e._tiles[t].tileID})),i=0,r=n;i<r.length;i+=1){var o=r[i];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Lt(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.browser.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)},n.prototype.removeFeatureState=function(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)},n.prototype.getFeatureState=function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)},n.prototype.setDependencies=function(t,e,n){var i=this._tiles[t];i&&i.setDependencies(e,n)},n.prototype.reloadTilesForDependencies=function(t,e){for(var n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((function(n){return!n.hasDependency(t,e)}))},n}(t.Evented);function It(t,e){var n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Lt(t){return"raster"===t||"image"===t||"video"===t}function Ot(){return new t.window.Worker(Yr.workerUrl)}Mt.maxOverzooming=10,Mt.maxUnderzooming=3;var zt="mapboxgl_preloaded_worker_pool",Rt=function(){this.active={}};Rt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Rt.workerCount;)this.workers.push(new Ot);return this.active[t]=!0,this.workers.slice()},Rt.prototype.release=function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)},Rt.prototype.isPreloaded=function(){return!!this.active[zt]},Rt.prototype.numActive=function(){return Object.keys(this.active).length};var Dt,Ft=Math.floor(t.browser.hardwareConcurrency/2);function Bt(){return Dt||(Dt=new Rt),Dt}function jt(e,n){var i={};for(var r in e)"ref"!==r&&(i[r]=e[r]);return t.refProperties.forEach((function(t){t in n&&(i[t]=n[t])})),i}function Nt(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=jt(t[i],e[t[i].ref]));return t}Rt.workerCount=Math.max(Math.min(Ft,6),1);var Vt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ut(t,e,n){n.push({command:Vt.addSource,args:[t,e[t]]})}function Wt(t,e,n){e.push({command:Vt.removeSource,args:[t]}),n[t]=!0}function Gt(t,e,n,i){Wt(t,n,i),Ut(t,e,n)}function qt(e,n,i){var r;for(r in e[i])if(e[i].hasOwnProperty(r)&&"data"!==r&&!t.deepEqual(e[i][r],n[i][r]))return!1;for(r in n[i])if(n[i].hasOwnProperty(r)&&"data"!==r&&!t.deepEqual(e[i][r],n[i][r]))return!1;return!0}function Zt(e,n,i,r,o,a){var s;for(s in n=n||{},e=e||{})e.hasOwnProperty(s)&&(t.deepEqual(e[s],n[s])||i.push({command:a,args:[r,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.deepEqual(e[s],n[s])||i.push({command:a,args:[r,s,n[s],o]}))}function Ht(t){return t.id}function Xt(t,e){return t[e.id]=e,t}var Yt=function(t,e){this.reset(t,e)};Yt.prototype.reset=function(t,e){this.points=t||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Yt.prototype.lerp=function(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);for(var n=1,i=this._distances[n],r=e*this.paddedLength+this.padding;i<r&&n<this._distances.length;)i=this._distances[++n];var o=n-1,a=this._distances[o],s=i-a,l=s>0?(r-a)/s:0;return this.points[o].mult(1-l).add(this.points[n].mult(l))};var Kt=function(t,e,n){var i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};function Jt(e,n,i,r,o){var a=t.create();return n?(t.scale(a,a,[1/o,1/o,1]),i||t.rotateZ(a,a,r.angle)):t.multiply(a,r.labelPlaneMatrix,e),a}function Qt(e,n,i,r,o){if(n){var a=t.clone(e);return t.scale(a,a,[o,o,1]),i||t.rotateZ(a,a,-r.angle),a}return r.glCoordMatrix}function $t(e,n){var i=[e.x,e.y,0,1];ue(i,i,n);var r=i[3];return{point:new t.Point(i[0]/r,i[1]/r),signedDistanceFromCamera:r}}function te(t,e){return.5+t/e*.5}function ee(t,e){var n=t[0]/t[3],i=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&i>=-e[1]&&i<=e[1]}function ne(e,n,i,r,o,a,s,l){var c=r?e.textSizeData:e.iconSizeData,u=t.evaluateSizeForZoom(c,i.transform.zoom),h=[256/i.width*2+1,256/i.height*2+1],p=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var d=e.lineVertexArray,f=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,g=i.transform.width/i.transform.height,m=!1,y=0;y<f.length;y++){var v=f.get(y);if(v.hidden||v.writingMode===t.WritingMode.vertical&&!m)ce(v.numGlyphs,p);else{m=!1;var _=[v.anchorX,v.anchorY,0,1];if(t.transformMat4(_,_,n),ee(_,h)){var b=te(i.transform.cameraToCenterDistance,_[3]),x=t.evaluateSizeForFeature(c,u,v),w=s?x/b:x*b,S=new t.Point(v.anchorX,v.anchorY),P=$t(S,o).point,E={},T=oe(v,w,!1,l,n,o,a,e.glyphOffsetArray,d,p,P,S,E,g);m=T.useVertical,(T.notEnoughRoom||m||T.needsFlipping&&oe(v,w,!0,l,n,o,a,e.glyphOffsetArray,d,p,P,S,E,g).notEnoughRoom)&&ce(v.numGlyphs,p)}else ce(v.numGlyphs,p)}}r?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function ie(t,e,n,i,r,o,a,s,l,c,u){var h=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,f=e.getoffsetX(s.glyphStartIndex),g=e.getoffsetX(h-1),m=se(t*f,n,i,r,o,a,s.segment,p,d,l,c,u);if(!m)return null;var y=se(t*g,n,i,r,o,a,s.segment,p,d,l,c,u);return y?{first:m,last:y}:null}function re(e,n,i,r){return e===t.WritingMode.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function oe(e,n,i,r,o,a,s,l,c,u,h,p,d,f){var g,m=n/24,y=e.lineOffsetX*m,v=e.lineOffsetY*m;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=ie(m,l,y,v,i,h,p,e,c,a,d);if(!w)return{notEnoughRoom:!0};var S=$t(w.first.point,s).point,P=$t(w.last.point,s).point;if(r&&!i){var E=re(e.writingMode,S,P,f);if(E)return E}g=[w.first];for(var T=e.glyphStartIndex+1;T<_-1;T++)g.push(se(m*l.getoffsetX(T),y,v,i,h,p,e.segment,b,x,c,a,d));g.push(w.last)}else{if(r&&!i){var k=$t(p,o).point,A=e.lineStartIndex+e.segment+1,C=new t.Point(c.getx(A),c.gety(A)),M=$t(C,o),I=M.signedDistanceFromCamera>0?M.point:ae(p,C,k,1,o),L=re(e.writingMode,k,I,f);if(L)return L}var O=se(m*l.getoffsetX(e.glyphStartIndex),y,v,i,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,d);if(!O)return{notEnoughRoom:!0};g=[O]}for(var z=0,R=g;z<R.length;z+=1){var D=R[z];t.addDynamicAttributes(u,D.point,D.angle)}return{}}function ae(t,e,n,i,r){var o=$t(t.add(t.sub(e)._unit()),r).point,a=n.sub(o);return n.add(a._mult(i/a.mag()))}function se(e,n,i,r,o,a,s,l,c,u,h,p){var d=r?e-n:e+n,f=d>0?1:-1,g=0;r&&(f*=-1,g=Math.PI),f<0&&(g+=Math.PI);for(var m=f>0?l+s:l+s+1,y=o,v=o,_=0,b=0,x=Math.abs(d),w=[];_+b<=x;){if((m+=f)<l||m>=c)return null;if(v=y,w.push(y),void 0===(y=p[m])){var S=new t.Point(u.getx(m),u.gety(m)),P=$t(S,h);if(P.signedDistanceFromCamera>0)y=p[m]=P.point;else{var E=m-f;y=ae(0===_?a:new t.Point(u.getx(E),u.gety(E)),S,v,x-_+1,h)}}_+=b,b=v.dist(y)}var T=(x-_)/b,k=y.sub(v),A=k.mult(T)._add(v);A._add(k._unit()._perp()._mult(i*f));var C=g+Math.atan2(y.y-v.y,y.x-v.x);return w.push(A),{point:A,angle:C,path:w}}Kt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Kt.prototype.insert=function(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},Kt.prototype.insertCircle=function(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)},Kt.prototype._insertBoxCell=function(t,e,n,i,r,o){this.boxCells[r].push(o)},Kt.prototype._insertCircleCell=function(t,e,n,i,r,o){this.circleCells[r].push(o)},Kt.prototype._query=function(t,e,n,i,r,o){if(n<0||t>this.width||i<0||e>this.height)return!r&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var c=this.circles[3*l],u=this.circles[3*l+1],h=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:c-h,y1:u-h,x2:c+h,y2:u+h})}return o?a.filter(o):a}return this._forEachCell(t,e,n,i,this._queryCell,a,{hitTest:r,seenUids:{box:{},circle:{}}},o),r?a.length>0:a},Kt.prototype._queryCircle=function(t,e,n,i,r){var o=t-n,a=t+n,s=e-n,l=e+n;if(a<0||o>this.width||l<0||s>this.height)return!i&&[];var c=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,c,{hitTest:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},r),i?c.length>0:c},Kt.prototype.query=function(t,e,n,i,r){return this._query(t,e,n,i,!1,r)},Kt.prototype.hitTest=function(t,e,n,i,r){return this._query(t,e,n,i,!0,r)},Kt.prototype.hitTestCircle=function(t,e,n,i){return this._queryCircle(t,e,n,!0,i)},Kt.prototype._queryCell=function(t,e,n,i,r,o,a,s){var l=a.seenUids,c=this.boxCells[r];if(null!==c)for(var u=this.bboxes,h=0,p=c;h<p.length;h+=1){var d=p[h];if(!l.box[d]){l.box[d]=!0;var f=4*d;if(t<=u[f+2]&&e<=u[f+3]&&n>=u[f+0]&&i>=u[f+1]&&(!s||s(this.boxKeys[d]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[d],x1:u[f],y1:u[f+1],x2:u[f+2],y2:u[f+3]})}}}var g=this.circleCells[r];if(null!==g)for(var m=this.circles,y=0,v=g;y<v.length;y+=1){var _=v[y];if(!l.circle[_]){l.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(m[b],m[b+1],m[b+2],t,e,n,i)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=m[b],w=m[b+1],S=m[b+2];o.push({key:this.circleKeys[_],x1:x-S,y1:w-S,x2:x+S,y2:w+S})}}}},Kt.prototype._queryCellCircle=function(t,e,n,i,r,o,a,s){var l=a.circle,c=a.seenUids,u=this.boxCells[r];if(null!==u)for(var h=this.bboxes,p=0,d=u;p<d.length;p+=1){var f=d[p];if(!c.box[f]){c.box[f]=!0;var g=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,h[g+0],h[g+1],h[g+2],h[g+3])&&(!s||s(this.boxKeys[f])))return o.push(!0),!0}}var m=this.circleCells[r];if(null!==m)for(var y=this.circles,v=0,_=m;v<_.length;v+=1){var b=_[v];if(!c.circle[b]){c.circle[b]=!0;var x=3*b;if(this._circlesCollide(y[x],y[x+1],y[x+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},Kt.prototype._forEachCell=function(t,e,n,i,r,o,a,s){for(var l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i),p=l;p<=u;p++)for(var d=c;d<=h;d++)if(r.call(this,t,e,n,i,this.xCellCount*d+p,o,a,s))return},Kt.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},Kt.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},Kt.prototype._circlesCollide=function(t,e,n,i,r,o){var a=i-t,s=r-e,l=n+o;return l*l>a*a+s*s},Kt.prototype._circleAndRectCollide=function(t,e,n,i,r,o,a){var s=(o-i)/2,l=Math.abs(t-(i+s));if(l>s+n)return!1;var c=(a-r)/2,u=Math.abs(e-(r+c));if(u>c+n)return!1;if(l<=s||u<=c)return!0;var h=l-s,p=u-c;return h*h+p*p<=n*n};var le=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ce(t,e){for(var n=0;n<t;n++){var i=e.length;e.resize(i+4),e.float32.set(le,3*i)}}function ue(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15],t}var he=function(t,e,n){void 0===e&&(e=new Kt(t.width+200,t.height+200,25)),void 0===n&&(n=new Kt(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function pe(e,n,i){return n*(t.EXTENT/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}he.prototype.placeCollisionBox=function(t,e,n,i,r){var o=this.projectAndGetPerspectiveRatio(i,t.anchorPointX,t.anchorPointY),a=n*o.perspectiveRatio,s=t.x1*a+o.point.x,l=t.y1*a+o.point.y,c=t.x2*a+o.point.x,u=t.y2*a+o.point.y;return!this.isInsideGrid(s,l,c,u)||!e&&this.grid.hitTest(s,l,c,u,r)?{box:[],offscreen:!1}:{box:[s,l,c,u],offscreen:this.isOffscreen(s,l,c,u)}},he.prototype.placeCollisionCircles=function(e,n,i,r,o,a,s,l,c,u,h,p,d){var f=[],g=new t.Point(n.anchorX,n.anchorY),m=$t(g,a),y=te(this.transform.cameraToCenterDistance,m.signedDistanceFromCamera),v=(u?o/y:o*y)/t.ONE_EM,_=$t(g,s).point,b=ie(v,r,n.lineOffsetX*v,n.lineOffsetY*v,!1,_,g,n,i,s,{}),x=!1,w=!1,S=!0;if(b){for(var P=.5*p*y+d,E=new t.Point(-100,-100),T=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),k=new Yt,A=b.first,C=b.last,M=[],I=A.path.length-1;I>=1;I--)M.push(A.path[I]);for(var L=1;L<C.path.length;L++)M.push(C.path[L]);var O=2.5*P;if(l){var z=M.map((function(t){return $t(t,l)}));M=z.some((function(t){return t.signedDistanceFromCamera<=0}))?[]:z.map((function(t){return t.point}))}var R=[];if(M.length>0){for(var D=M[0].clone(),F=M[0].clone(),B=1;B<M.length;B++)D.x=Math.min(D.x,M[B].x),D.y=Math.min(D.y,M[B].y),F.x=Math.max(F.x,M[B].x),F.y=Math.max(F.y,M[B].y);R=D.x>=E.x&&F.x<=T.x&&D.y>=E.y&&F.y<=T.y?[M]:F.x<E.x||D.x>T.x||F.y<E.y||D.y>T.y?[]:t.clipLine([M],E.x,E.y,T.x,T.y)}for(var j=0,N=R;j<N.length;j+=1){var V;k.reset(N[j],.25*P),V=k.length<=.5*P?1:Math.ceil(k.paddedLength/O)+1;for(var U=0;U<V;U++){var W=U/Math.max(V-1,1),G=k.lerp(W),q=G.x+100,Z=G.y+100;f.push(q,Z,P,0);var H=q-P,X=Z-P,Y=q+P,K=Z+P;if(S=S&&this.isOffscreen(H,X,Y,K),w=w||this.isInsideGrid(H,X,Y,K),!e&&this.grid.hitTestCircle(q,Z,P,h)&&(x=!0,!c))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!c&&x||!w?[]:f,offscreen:S,collisionDetected:x}},he.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],i=1/0,r=1/0,o=-1/0,a=-1/0,s=0,l=e;s<l.length;s+=1){var c=l[s],u=new t.Point(c.x+100,c.y+100);i=Math.min(i,u.x),r=Math.min(r,u.y),o=Math.max(o,u.x),a=Math.max(a,u.y),n.push(u)}for(var h={},p={},d=0,f=this.grid.query(i,r,o,a).concat(this.ignoredGrid.query(i,r,o,a));d<f.length;d+=1){var g=f[d],m=g.key;if(void 0===h[m.bucketInstanceId]&&(h[m.bucketInstanceId]={}),!h[m.bucketInstanceId][m.featureIndex]){var y=[new t.Point(g.x1,g.y1),new t.Point(g.x2,g.y1),new t.Point(g.x2,g.y2),new t.Point(g.x1,g.y2)];t.polygonIntersectsPolygon(n,y)&&(h[m.bucketInstanceId][m.featureIndex]=!0,void 0===p[m.bucketInstanceId]&&(p[m.bucketInstanceId]=[]),p[m.bucketInstanceId].push(m.featureIndex))}}return p},he.prototype.insertCollisionBox=function(t,e,n,i,r){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:r},t[0],t[1],t[2],t[3])},he.prototype.insertCollisionCircles=function(t,e,n,i,r){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:i,collisionGroupID:r},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},he.prototype.projectAndGetPerspectiveRatio=function(e,n,i){var r=[n,i,0,1];return ue(r,r,e),{point:new t.Point((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5}},he.prototype.isOffscreen=function(t,e,n,i){return n<100||t>=this.screenRightBoundary||i<100||e>this.screenBottomBoundary},he.prototype.isInsideGrid=function(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary},he.prototype.getViewportMatrix=function(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e};var de=function(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n};de.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var fe=function(t,e,n,i,r){this.text=new de(t?t.text:null,e,n,r),this.icon=new de(t?t.icon:null,e,i,r)};fe.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ge=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},me=function(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]},ye=function(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r},ve=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};function _e(e,n,i,r,o){var a=t.getAnchorAlignment(e),s=-(a.horizontalAlign-.5)*n,l=-(a.verticalAlign-.5)*i,c=t.evaluateVariableOffset(e,r);return new t.Point(s+c[0]*o,l+c[1]*o)}function be(e,n,i,r,o,a){var s=e.x1,l=e.x2,c=e.y1,u=e.y2,h=e.anchorPointX,p=e.anchorPointY,d=new t.Point(n,i);return r&&d._rotate(o?a:-a),{x1:s+d.x,y1:c+d.y,x2:l+d.x,y2:u+d.y,anchorPointX:h,anchorPointY:p}}ve.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var xe=function(t,e,n,i){this.transform=t.clone(),this.collisionIndex=new he(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new ve(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}};function we(t,e,n,i,r){t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0),t.emplaceBack(e?1:0,n?1:0,i||0,r||0)}xe.prototype.getBucketParts=function(e,n,i,r){var o=i.getBucket(n),a=i.latestFeatureIndex;if(o&&a&&n.id===o.layerIds[0]){var s=i.collisionBoxArray,l=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(i.tileID.toUnwrapped()),p="map"===l.get("text-pitch-alignment"),d="map"===l.get("text-rotation-alignment"),f=pe(i,1,this.transform.zoom),g=Jt(h,p,d,this.transform,f),m=null;if(p){var y=Qt(h,p,d,this.transform,f);m=t.multiply([],this.transform.labelPlaneMatrix,y)}this.retainedQueryData[o.bucketInstanceId]=new ye(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,i.tileID);var v={bucket:o,layout:l,posMatrix:h,textLabelPlaneMatrix:g,labelToScreenMatrix:m,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(r)for(var _=0,b=o.sortKeyRanges;_<b.length;_+=1){var x=b[_];e.push({sortKey:x.sortKey,symbolInstanceStart:x.symbolInstanceStart,symbolInstanceEnd:x.symbolInstanceEnd,parameters:v})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:v})}},xe.prototype.attemptAnchorPlacement=function(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f){var g,m=[h.textOffset0,h.textOffset1],y=_e(t,n,i,m,r),v=this.collisionIndex.placeCollisionBox(be(e,y.x,y.y,o,a,this.transform.angle),u,s,l,c.predicate);if(!f||0!==this.collisionIndex.placeCollisionBox(be(f,y.x,y.y,o,a,this.transform.angle),u,s,l,c.predicate).box.length)return v.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(g=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:m,width:n,height:i,anchor:t,textBoxScale:r,prevAnchor:g},this.markUsedJustification(p,t,h,d),p.allowVerticalPlacement&&(this.markUsedOrientation(p,d,h),this.placedOrientations[h.crossTileID]=d),{shift:y,placedGlyphBoxes:v}):void 0},xe.prototype.placeLayerBucketPart=function(e,n,i){var r=this,o=e.parameters,a=o.bucket,s=o.layout,l=o.posMatrix,c=o.textLabelPlaneMatrix,u=o.labelToScreenMatrix,h=o.textPixelRatio,p=o.holdingForFade,d=o.collisionBoxArray,f=o.partiallyEvaluatedTextSize,g=o.collisionGroup,m=s.get("text-optional"),y=s.get("icon-optional"),v=s.get("text-allow-overlap"),_=s.get("icon-allow-overlap"),b="map"===s.get("text-rotation-alignment"),x="map"===s.get("text-pitch-alignment"),w="none"!==s.get("icon-text-fit"),S="viewport-y"===s.get("symbol-z-order"),P=v&&(_||!a.hasIconData()||y),E=_&&(v||!a.hasTextData()||m);!a.collisionArrays&&d&&a.deserializeCollisionBoxes(d);var T=function(e,o){if(!n[e.crossTileID])if(p)r.placements[e.crossTileID]=new ge(!1,!1,!1);else{var d,S=!1,T=!1,k=!0,A=null,C={box:null,offscreen:null},M={box:null,offscreen:null},I=null,L=null,O=0,z=0,R=0;o.textFeatureIndex?O=o.textFeatureIndex:e.useRuntimeCollisionCircles&&(O=e.featureIndex),o.verticalTextFeatureIndex&&(z=o.verticalTextFeatureIndex);var D=o.textBox;if(D){var F=function(n){var i=t.WritingMode.horizontal;if(a.allowVerticalPlacement&&!n&&r.prevPlacement){var o=r.prevPlacement.placedOrientations[e.crossTileID];o&&(r.placedOrientations[e.crossTileID]=o,r.markUsedOrientation(a,i=o,e))}return i},B=function(n,i){if(a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&o.verticalTextBox)for(var r=0,s=a.writingModes;r<s.length&&(s[r]===t.WritingMode.vertical?(C=i(),M=C):C=n(),!(C&&C.box&&C.box.length));r+=1);else C=n()};if(s.get("text-variable-anchor")){var j=s.get("text-variable-anchor");if(r.prevPlacement&&r.prevPlacement.variableOffsets[e.crossTileID]){var N=r.prevPlacement.variableOffsets[e.crossTileID];j.indexOf(N.anchor)>0&&(j=j.filter((function(t){return t!==N.anchor}))).unshift(N.anchor)}var V=function(t,n,i){for(var o=t.x2-t.x1,s=t.y2-t.y1,c=e.textBoxScale,u=w&&!_?n:null,p={box:[],offscreen:!1},d=v?2*j.length:j.length,f=0;f<d;++f){var m=r.attemptAnchorPlacement(j[f%j.length],t,o,s,c,b,x,h,l,g,f>=j.length,e,a,i,u);if(m&&(p=m.placedGlyphBoxes)&&p.box&&p.box.length){S=!0,A=m.shift;break}}return p};B((function(){return V(D,o.iconBox,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&!(C&&C.box&&C.box.length)&&e.numVerticalGlyphVertices>0&&n?V(n,o.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),C&&(S=C.box,k=C.offscreen);var U=F(C&&C.box);if(!S&&r.prevPlacement){var W=r.prevPlacement.variableOffsets[e.crossTileID];W&&(r.variableOffsets[e.crossTileID]=W,r.markUsedJustification(a,W.anchor,e,U))}}else{var G=function(t,n){var i=r.collisionIndex.placeCollisionBox(t,v,h,l,g.predicate);return i&&i.box&&i.box.length&&(r.markUsedOrientation(a,n,e),r.placedOrientations[e.crossTileID]=n),i};B((function(){return G(D,t.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?G(n,t.WritingMode.vertical):{box:null,offscreen:null}})),F(C&&C.box&&C.box.length)}}if(S=(d=C)&&d.box&&d.box.length>0,k=d&&d.offscreen,e.useRuntimeCollisionCircles){var q=a.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),Z=t.evaluateSizeForFeature(a.textSizeData,f,q),H=s.get("text-padding");I=r.collisionIndex.placeCollisionCircles(v,q,a.lineVertexArray,a.glyphOffsetArray,Z,l,c,u,i,x,g.predicate,e.collisionCircleDiameter,H),S=v||I.circles.length>0&&!I.collisionDetected,k=k&&I.offscreen}if(o.iconFeatureIndex&&(R=o.iconFeatureIndex),o.iconBox){var X=function(t){var e=w&&A?be(t,A.x,A.y,b,x,r.transform.angle):t;return r.collisionIndex.placeCollisionBox(e,_,h,l,g.predicate)};T=M&&M.box&&M.box.length&&o.verticalIconBox?(L=X(o.verticalIconBox)).box.length>0:(L=X(o.iconBox)).box.length>0,k=k&&L.offscreen}var Y=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,K=y||0===e.numIconVertices;if(Y||K?K?Y||(T=T&&S):S=T&&S:T=S=T&&S,S&&d&&d.box&&r.collisionIndex.insertCollisionBox(d.box,s.get("text-ignore-placement"),a.bucketInstanceId,M&&M.box&&z?z:O,g.ID),T&&L&&r.collisionIndex.insertCollisionBox(L.box,s.get("icon-ignore-placement"),a.bucketInstanceId,R,g.ID),I&&(S&&r.collisionIndex.insertCollisionCircles(I.circles,s.get("text-ignore-placement"),a.bucketInstanceId,O,g.ID),i)){var J=a.bucketInstanceId,Q=r.collisionCircleArrays[J];void 0===Q&&(Q=r.collisionCircleArrays[J]=new me);for(var $=0;$<I.circles.length;$+=4)Q.circles.push(I.circles[$+0]),Q.circles.push(I.circles[$+1]),Q.circles.push(I.circles[$+2]),Q.circles.push(I.collisionDetected?1:0)}r.placements[e.crossTileID]=new ge(S||P,T||E,k||a.justReloaded),n[e.crossTileID]=!0}};if(S)for(var k=a.getSortedSymbolIndexes(this.transform.angle),A=k.length-1;A>=0;--A){var C=k[A];T(a.symbolInstances.get(C),a.collisionArrays[C])}else for(var M=e.symbolInstanceStart;M<e.symbolInstanceEnd;M++)T(a.symbolInstances.get(M),a.collisionArrays[M]);if(i&&a.bucketInstanceId in this.collisionCircleArrays){var I=this.collisionCircleArrays[a.bucketInstanceId];t.invert(I.invProjMatrix,l),I.viewportMatrix=this.collisionIndex.getViewportMatrix()}a.justReloaded=!1},xe.prototype.markUsedJustification=function(e,n,i,r){var o;o=r===t.WritingMode.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(n)];for(var a=0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];a<s.length;a+=1){var l=s[a];l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=o>=0&&l!==o?0:i.crossTileID)}},xe.prototype.markUsedOrientation=function(e,n,i){for(var r=n===t.WritingMode.horizontal||n===t.WritingMode.horizontalOnly?n:0,o=n===t.WritingMode.vertical?n:0,a=0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];a<s.length;a+=1)e.text.placedSymbolArray.get(s[a]).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=o)},xe.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var i=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],c=r[s];c?(this.opacities[s]=new fe(c,i,l.text,l.icon),n=n||l.text!==c.text.placed||l.icon!==c.icon.placed):(this.opacities[s]=new fe(null,i,l.text,l.icon,l.skipFade),n=n||l.text||l.icon)}for(var u in r){var h=r[u];if(!this.opacities[u]){var p=new fe(h,i,!1,!1);p.isHidden()||(this.opacities[u]=p,n=n||h.text.placed||h.icon.placed)}}for(var d in o)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=o[d]);for(var f in a)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=a[f]);n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},xe.prototype.updateLayerOpacities=function(t,e){for(var n={},i=0,r=e;i<r.length;i+=1){var o=r[i],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},xe.prototype.updateBucketOpacities=function(e,n,i){var r=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var o=e.layers[0].layout,a=new fe(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),l=o.get("icon-allow-overlap"),c=o.get("text-variable-anchor"),u="map"===o.get("text-rotation-alignment"),h="map"===o.get("text-pitch-alignment"),p="none"!==o.get("icon-text-fit"),d=new fe(null,0,s&&(l||!e.hasIconData()||o.get("icon-optional")),l&&(s||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);for(var f=function(t,e,n){for(var i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(n)},g=function(i){var o=e.symbolInstances.get(i),s=o.numHorizontalGlyphVertices,l=o.numVerticalGlyphVertices,g=o.crossTileID,m=r.opacities[g];n[g]?m=a:m||(r.opacities[g]=m=d),n[g]=!0;var y=o.numIconVertices>0,v=r.placedOrientations[o.crossTileID],_=v===t.WritingMode.vertical,b=v===t.WritingMode.horizontal||v===t.WritingMode.horizontalOnly;if(s>0||l>0){var x=Me(m.text);f(e.text,s,_?Ie:x),f(e.text,l,b?Ie:x);var w=m.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(t){t>=0&&(e.text.placedSymbolArray.get(t).hidden=w||_?1:0)})),o.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=w||b?1:0);var S=r.variableOffsets[o.crossTileID];S&&r.markUsedJustification(e,S.anchor,o,v);var P=r.placedOrientations[o.crossTileID];P&&(r.markUsedJustification(e,"left",o,P),r.markUsedOrientation(e,P,o))}if(y){var E=Me(m.icon),T=!(p&&o.verticalPlacedIconSymbolIndex&&_);o.placedIconSymbolIndex>=0&&(f(e.icon,o.numIconVertices,T?E:Ie),e.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=m.icon.isHidden()),o.verticalPlacedIconSymbolIndex>=0&&(f(e.icon,o.numVerticalIconVertices,T?Ie:E),e.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=m.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){var k=e.collisionArrays[i];if(k){var A=new t.Point(0,0);if(k.textBox||k.verticalTextBox){var C=!0;if(c){var M=r.variableOffsets[g];M?(A=_e(M.anchor,M.width,M.height,M.textOffset,M.textBoxScale),u&&A._rotate(h?r.transform.angle:-r.transform.angle)):C=!1}k.textBox&&we(e.textCollisionBox.collisionVertexArray,m.text.placed,!C||_,A.x,A.y),k.verticalTextBox&&we(e.textCollisionBox.collisionVertexArray,m.text.placed,!C||b,A.x,A.y)}var I=Boolean(!b&&k.verticalIconBox);k.iconBox&&we(e.iconCollisionBox.collisionVertexArray,m.icon.placed,I,p?A.x:0,p?A.y:0),k.verticalIconBox&&we(e.iconCollisionBox.collisionVertexArray,m.icon.placed,!I,p?A.x:0,p?A.y:0)}}},m=0;m<e.symbolInstances.length;m++)g(m);if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){var y=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=y.invProjMatrix,e.placementViewportMatrix=y.viewportMatrix,e.collisionCircleArray=y.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}},xe.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},xe.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},xe.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},xe.prototype.stillRecent=function(t,e){var n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t},xe.prototype.setStale=function(){this.stale=!0};var Se=Math.pow(2,25),Pe=Math.pow(2,24),Ee=Math.pow(2,17),Te=Math.pow(2,16),ke=Math.pow(2,9),Ae=Math.pow(2,8),Ce=Math.pow(2,1);function Me(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Se+e*Pe+n*Ee+e*Te+n*ke+e*Ae+n*Ce+e}var Ie=0,Le=function(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Le.prototype.continuePlacement=function(t,e,n,i,r){for(var o=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(o,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((function(t,e){return t.sortKey-e.sortKey})));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,r())return!0;return!1};var Oe=function(t,e,n,i,r,o,a){this.placement=new xe(t,r,o,a),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1};Oe.prototype.isDone=function(){return this._done},Oe.prototype.continuePlacement=function(e,n,i){for(var r=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!r._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=n[e[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new Le(s)),this._inProgressLayer.continuePlacement(i[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Oe.prototype.commit=function(t){return this.placement.commit(t),this.placement};var ze=512/t.EXTENT/2,Re=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var i=0;i<e.length;i++){var r=e.get(i),o=r.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:r.crossTileID,coord:this.getScaledCoordinates(r,t)})}};Re.prototype.getScaledCoordinates=function(e,n){var i=ze/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*i)}},Re.prototype.findMatches=function(t,e,n){for(var i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),r=0;r<t.length;r++){var o=t.get(r);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),l=0,c=a;l<c.length;l+=1){var u=c[l];if(Math.abs(u.coord.x-s.x)<=i&&Math.abs(u.coord.y-s.y)<=i&&!n[u.crossTileID]){n[u.crossTileID]=!0,o.crossTileID=u.crossTileID;break}}}}};var De=function(){this.maxCrossTileID=0};De.prototype.generate=function(){return++this.maxCrossTileID};var Fe=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Fe.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var i=this.indexes[n],r={};for(var o in i){var a=i[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),r[a.tileID.key]=a}this.indexes[n]=r}this.lng=t},Fe.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var i=0;i<e.symbolInstances.length;i++)e.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var r=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,r)}else{var c=a[t.scaledTo(Number(o)).key];c&&c.findMatches(e.symbolInstances,t,r)}}for(var u=0;u<e.symbolInstances.length;u++){var h=e.symbolInstances.get(u);h.crossTileID||(h.crossTileID=n.generate(),r[h.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Re(t,e.symbolInstances,e.bucketInstanceId),!0},Fe.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var i=0,r=e.indexedSymbolInstances[n];i<r.length;i+=1)delete this.usedCrossTileIDs[t][r[i].crossTileID]},Fe.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var i=this.indexes[n];for(var r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e};var Be=function(){this.layerIndexes={},this.crossTileIDs=new De,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Be.prototype.addLayer=function(t,e,n){var i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new Fe);var r=!1,o={};i.handleWrapJump(n);for(var a=0,s=e;a<s.length;a+=1){var l=s[a],c=l.getBucket(t);c&&t.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(l.tileID,c,this.crossTileIDs)&&(r=!0),o[c.bucketInstanceId]=!0)}return i.removeStaleBuckets(o)&&(r=!0),r},Be.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var je=function(e,n){return t.emitValidationErrors(e,n&&n.filter((function(t){return"source.canvas"!==t.identifier})))},Ne=t.pick(Vt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ve=t.pick(Vt,["setCenter","setZoom","setBearing","setPitch"]),Ue=function(){var e={},n=t.styleSpec.$version;for(var i in t.styleSpec.$root){var r,o=t.styleSpec.$root[i];o.required&&null!=(r="version"===i?n:"array"===o.type?[]:{})&&(e[i]=r)}return e}(),We=function(e){function n(i,r){var o=this;void 0===r&&(r={}),e.call(this),this.map=i,this.dispatcher=new P(Bt(),this),this.imageManager=new p,this.imageManager.setEventedParent(this),this.glyphManager=new _(i._requestManager,r.localIdeographFontFamily),this.lineAtlas=new S(256,512),this.crossTileSymbolIndex=new Be,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var a=this;this._rtlTextPluginCallback=n.registerForPluginStateChange((function(e){a.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(function(e,n){if(t.triggerPluginCompletionEvent(e),n&&n.every((function(t){return t})))for(var i in a.sourceCaches)a.sourceCaches[i].reload()}))})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var i in o._layers){var r=o._layers[i];r.source===n.id&&o._validateLayer(r)}}}}))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.loadURL=function(e,n){var i=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var r="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,n.accessToken);var o=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,(function(e,n){i._request=null,e?i.fire(new t.ErrorEvent(e)):n&&i._load(n,r)}))},n.prototype.loadJSON=function(e,n){var i=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame((function(){i._request=null,i._load(e,!1!==n.validate)}))},n.prototype.loadEmpty=function(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ue,!1)},n.prototype._load=function(e,n){if(!n||!je(this,t.validateStyle(e))){for(var i in this._loaded=!0,this.stylesheet=e,e.sources)this.addSource(i,e.sources[i],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var r=Nt(this.stylesheet.layers);this._order=r.map((function(t){return t.id})),this._layers={},this._serializedLayers={};for(var o=0,a=r;o<a.length;o+=1){var s=a[o];(s=t.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._loadSprite=function(e){var n=this;this._spriteRequest=function(e,n,i){var r,o,a,s=t.browser.devicePixelRatio>1?"@2x":"",l=t.getJSON(n.transformRequest(n.normalizeSpriteURL(e,s,".json"),t.ResourceType.SpriteJSON),(function(t,e){l=null,a||(a=t,r=e,u())})),c=t.getImage(n.transformRequest(n.normalizeSpriteURL(e,s,".png"),t.ResourceType.SpriteImage),(function(t,e){c=null,a||(a=t,o=e,u())}));function u(){if(a)i(a);else if(r&&o){var e=t.browser.getImageData(o),n={};for(var s in r){var l=r[s],c=l.width,u=l.height,h=l.x,p=l.y,d=l.sdf,f=l.pixelRatio,g=l.stretchX,m=l.stretchY,y=l.content,v=new t.RGBAImage({width:c,height:u});t.RGBAImage.copy(e,v,{x:h,y:p},{x:0,y:0},{width:c,height:u}),n[s]={data:v,pixelRatio:f,sdf:d,stretchX:g,stretchY:m,content:y}}i(null,n)}}return{cancel:function(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,(function(e,i){if(n._spriteRequest=null,e)n.fire(new t.ErrorEvent(e));else if(i)for(var r in i)n.imageManager.addImage(r,i[r]);n.imageManager.setLoaded(!0),n._availableImages=n.imageManager.listImages(),n.dispatcher.broadcast("setImages",n._availableImages),n.fire(new t.Event("data",{dataType:"style"}))}))},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var i=e.sourceLayer;if(i){var r=n.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+i+'" does not exist on source "'+r.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){for(var e=[],n=0,i=t;n<i.length;n+=1){var r=this._layers[i[n]];"custom"!==r.type&&e.push(r.serialize())}return e},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){var n=this._changed;if(this._changed){var i=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);for(var o in(i.length||r.length)&&this._updateWorkerLayers(i,r),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}var l={};for(var c in this.sourceCaches){var u=this.sourceCaches[c];l[c]=u.used,u.used=!1}for(var h=0,p=this._order;h<p.length;h+=1){var d=this._layers[p[h]];d.recalculate(e,this._availableImages),!d.isHidden(e.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(var f in l){var g=this.sourceCaches[f];l[f]!==g.used&&g.fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}},n.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),je(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=Nt(e.layers);var i=function(e,n){if(!e)return[{command:Vt.setStyle,args:[n]}];var i=[];try{if(!t.deepEqual(e.version,n.version))return[{command:Vt.setStyle,args:[n]}];t.deepEqual(e.center,n.center)||i.push({command:Vt.setCenter,args:[n.center]}),t.deepEqual(e.zoom,n.zoom)||i.push({command:Vt.setZoom,args:[n.zoom]}),t.deepEqual(e.bearing,n.bearing)||i.push({command:Vt.setBearing,args:[n.bearing]}),t.deepEqual(e.pitch,n.pitch)||i.push({command:Vt.setPitch,args:[n.pitch]}),t.deepEqual(e.sprite,n.sprite)||i.push({command:Vt.setSprite,args:[n.sprite]}),t.deepEqual(e.glyphs,n.glyphs)||i.push({command:Vt.setGlyphs,args:[n.glyphs]}),t.deepEqual(e.transition,n.transition)||i.push({command:Vt.setTransition,args:[n.transition]}),t.deepEqual(e.light,n.light)||i.push({command:Vt.setLight,args:[n.light]});var r={},o=[];!function(e,n,i,r){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||Wt(o,i,r));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.deepEqual(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&qt(e,n,o)?i.push({command:Vt.setGeoJSONSourceData,args:[o,n[o].data]}):Gt(o,n,i,r)):Ut(o,n,i))}(e.sources,n.sources,o,r);var a=[];e.layers&&e.layers.forEach((function(t){r[t.source]?i.push({command:Vt.removeLayer,args:[t.id]}):a.push(t)})),i=i.concat(o),function(e,n,i){n=n||[];var r,o,a,s,l,c,u,h=(e=e||[]).map(Ht),p=n.map(Ht),d=e.reduce(Xt,{}),f=n.reduce(Xt,{}),g=h.slice(),m=Object.create(null);for(r=0,o=0;r<h.length;r++)f.hasOwnProperty(a=h[r])?o++:(i.push({command:Vt.removeLayer,args:[a]}),g.splice(g.indexOf(a,o),1));for(r=0,o=0;r<p.length;r++)g[g.length-1-r]!==(a=p[p.length-1-r])&&(d.hasOwnProperty(a)?(i.push({command:Vt.removeLayer,args:[a]}),g.splice(g.lastIndexOf(a,g.length-o),1)):o++,i.push({command:Vt.addLayer,args:[f[a],c=g[g.length-r]]}),g.splice(g.length-r,0,a),m[a]=!0);for(r=0;r<p.length;r++)if(s=d[a=p[r]],l=f[a],!m[a]&&!t.deepEqual(s,l))if(t.deepEqual(s.source,l.source)&&t.deepEqual(s["source-layer"],l["source-layer"])&&t.deepEqual(s.type,l.type)){for(u in Zt(s.layout,l.layout,i,a,null,Vt.setLayoutProperty),Zt(s.paint,l.paint,i,a,null,Vt.setPaintProperty),t.deepEqual(s.filter,l.filter)||i.push({command:Vt.setFilter,args:[a,l.filter]}),t.deepEqual(s.minzoom,l.minzoom)&&t.deepEqual(s.maxzoom,l.maxzoom)||i.push({command:Vt.setLayerZoomRange,args:[a,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Zt(s[u],l[u],i,a,u.slice(6),Vt.setPaintProperty):t.deepEqual(s[u],l[u])||i.push({command:Vt.setLayerProperty,args:[a,u,l[u]]}));for(u in l)l.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Zt(s[u],l[u],i,a,u.slice(6),Vt.setPaintProperty):t.deepEqual(s[u],l[u])||i.push({command:Vt.setLayerProperty,args:[a,u,l[u]]}))}else i.push({command:Vt.removeLayer,args:[a]}),c=g[g.lastIndexOf(a)+1],i.push({command:Vt.addLayer,args:[l,c]})}(a,n.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:Vt.setStyle,args:[n]}]}return i}(this.serialize(),e).filter((function(t){return!(t.command in Ve)}));if(0===i.length)return!1;var r=i.filter((function(t){return!(t.command in Ne)}));if(r.length>0)throw new Error("Unimplemented: "+r.map((function(t){return t.command})).join(", ")+".");return i.forEach((function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)})),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this._afterImageUpdated(e)},n.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._afterImageUpdated(e)},n.prototype._afterImageUpdated=function(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(e,n,i){var r=this;if(void 0===i&&(i={}),this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,i))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Mt(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:r.loaded(),source:o.serialize(),sourceId:e}})),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.clearTiles(),i.onRemove&&i.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,i){void 0===i&&(i={}),this._checkLoaded();var r=e.id;if(this.getLayer(r))this.fire(new t.ErrorEvent(new Error('Layer with id "'+r+'" already exists on this map')));else{var o;if("custom"===e.type){if(je(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone$1(e),e=t.extend(e,{source:r})),this._validate(t.validateStyle.layer,"layers."+r,e,{arrayIndex:-1},i))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[o.id]=o.serialize()}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,r),this._layerOrderChanged=!0,this._layers[r]=o,this._removedLayers[r]&&o.source&&"custom"!==o.type){var s=this._removedLayers[r];delete this._removedLayers[r],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var i=this._order.indexOf(e);this._order.splice(i,1);var r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(r,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.hasLayer=function(t){return t in this._layers},n.prototype.setLayerZoomRange=function(e,n,i){this._checkLoaded();var r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n,i){void 0===i&&(i={}),this._checkLoaded();var r=this.getLayer(e);if(r){if(!t.deepEqual(r.filter,n))return null==n?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(t.validateStyle.filter,"layers."+r.id+".filter",n,null,i)||(r.filter=t.clone$1(n),this._updateLayer(r)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone$1(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,i,r){void 0===r&&(r={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getLayoutProperty(n),i)||(o.setLayoutProperty(n,i,r),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(e,n){var i=this.getLayer(e);if(i)return i.getLayoutProperty(n);this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style.")))},n.prototype.setPaintProperty=function(e,n,i,r){void 0===r&&(r={}),this._checkLoaded();var o=this.getLayer(e);o?t.deepEqual(o.getPaintProperty(n),i)||(o.setPaintProperty(n,i,r)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.setFeatureState=function(e,n){this._checkLoaded();var i=e.source,r=e.sourceLayer,o=this.sourceCaches[i];if(void 0!==o){var a=o.getSource().type;"geojson"===a&&r?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||r?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(r,e.id,n)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},n.prototype.removeFeatureState=function(e,n){this._checkLoaded();var i=e.source,r=this.sourceCaches[i];if(void 0!==r){var o=r.getSource().type,a="vector"===o?e.sourceLayer:void 0;"vector"!==o||a?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):r.removeFeatureState(a,e.id,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,i=e.sourceLayer,r=this.sourceCaches[n];if(void 0!==r){if("vector"!==r.getSource().type||i)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),r.getFeatureState(i,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,n=function(t){return"fill-extrusion"===e._layers[t].type},i={},r=[],o=this._order.length-1;o>=0;o--){var a=this._order[o];if(n(a)){i[a]=o;for(var s=0,l=t;s<l.length;s+=1){var c=l[s][a];if(c)for(var u=0,h=c;u<h.length;u+=1)r.push(h[u])}}}r.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var p=[],d=this._order.length-1;d>=0;d--){var f=this._order[d];if(n(f))for(var g=r.length-1;g>=0;g--){var m=r[g].feature;if(i[m.layer.id]<d)break;p.push(m),r.pop()}else for(var y=0,v=t;y<v.length;y+=1){var _=v[y][f];if(_)for(var b=0,x=_;b<x.length;b+=1)p.push(x[b].feature)}}return p},n.prototype.queryRenderedFeatures=function(e,n,i){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);var r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];r[l.source]=!0}}var c=[];for(var u in n.availableImages=this._availableImages,this.sourceCaches)n.layers&&!r[u]||c.push(F(this.sourceCaches[u],this._layers,this._serializedLayers,e,n,i));return this.placement&&c.push(function(t,e,n,i,r,o,a){for(var s={},l=o.queryRenderedSymbols(i),c=[],u=0,h=Object.keys(l).map(Number);u<h.length;u+=1)c.push(a[h[u]]);c.sort(B);for(var p=function(){var n=f[d],i=n.featureIndex.lookupSymbolFeatures(l[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(var o in i){var a=s[o]=s[o]||[],c=i[o];c.sort((function(t,e){var i=n.featureSortOrder;if(i){var r=i.indexOf(t.featureIndex);return i.indexOf(e.featureIndex)-r}return e.featureIndex-t.featureIndex}));for(var u=0,h=c;u<h.length;u+=1)a.push(h[u])}},d=0,f=c;d<f.length;d+=1)p();var g=function(e){s[e].forEach((function(i){var r=i.feature,o=n[t[e].source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=o}))};for(var m in s)g(m);return s}(this._layers,this._serializedLayers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);var i=this.sourceCaches[e];return i?function(t,e){for(var n=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),i=[],r={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;r[s]||(r[s]=!0,a.querySourceFeatures(i,e))}return i}(i,n):[]},n.prototype.addSourceType=function(t,e,i){return n.getSourceType(t)?i(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e,n){void 0===n&&(n={}),this._checkLoaded();var i=this.light.getLight(),r=!1;for(var o in e)if(!t.deepEqual(e[o],i[o])){r=!0;break}if(r){var a={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(a)}},n.prototype._validate=function(e,n,i,r,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&je(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:i,styleSpec:t.styleSpec},r)))},n.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var n in this.sourceCaches)this.sourceCaches[n].clearTiles(),this.sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(e,n,i,r,o){void 0===o&&(o=!1);for(var a=!1,s=!1,l={},c=0,u=this._order;c<u.length;c+=1){var h=this._layers[u[c]];if("symbol"===h.type){if(!l[h.source]){var p=this.sourceCaches[h.source];l[h.source]=p.getRenderableIds(!0).map((function(t){return p.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var d=this.crossTileSymbolIndex.addLayer(h,l[h.source],e.center.lng);a=a||d}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((o=o||this._layerOrderChanged||0===i)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now(),e.zoom))&&(this.pauseablePlacement=new Oe(e,this._order,o,n,i,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.browser.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(var f=0,g=this._order;f<g.length;f+=1){var m=this._layers[g[f]];"symbol"===m.type&&this.placement.updateLayerOpacities(m,l[m.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n),this._updateTilesForChangedImages();var i=this.sourceCaches[e.source];i&&i.setDependencies(e.tileID.key,e.type,e.icons)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n.prototype.getResource=function(e,n,i){return t.makeRequest(n,i)},n}(t.Evented);We.getSourceType=function(t){return R[t]},We.setSourceType=function(t,e){R[t]=e},We.registerForPluginStateChange=t.registerForPluginStateChange;var Ge=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),qe=vn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Ze=vn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),He=vn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Xe=vn("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ye=vn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ke=vn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Je=vn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Qe=vn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),$e=vn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),tn=vn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),en=vn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),nn=vn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),rn=vn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),on=vn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),an=vn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),sn=vn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),ln=vn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),cn=vn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),un=vn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),hn=vn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),pn=vn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),dn=vn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),fn=vn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),gn=vn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),mn=vn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),yn=vn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function vn(t,e){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=e.match(/attribute ([\w]+) ([\w]+)/g),r=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=o?o.concat(r):r,s={};return{fragmentSource:t=t.replace(n,(function(t,e,n,i,r){return s[r]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+r+"\nvarying "+n+" "+i+" "+r+";\n#else\nuniform "+n+" "+i+" u_"+r+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+r+"\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n"})),vertexSource:e=e.replace(n,(function(t,e,n,i,r){var o="float"===i?"vec2":"vec4",a=r.match(/color/)?"color":o;return s[r]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+n+" "+o+" a_"+r+";\nvarying "+n+" "+i+" "+r+";\n#else\nuniform "+n+" "+i+" u_"+r+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = a_"+r+";\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+r+" = unpack_mix_"+a+"(a_"+r+", u_"+r+"_t);\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+r+"\nuniform lowp float u_"+r+"_t;\nattribute "+n+" "+o+" a_"+r+";\n#else\nuniform "+n+" "+i+" u_"+r+";\n#endif\n":"vec4"===a?"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+n+" "+i+" "+r+" = a_"+r+";\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+r+"\n    "+n+" "+i+" "+r+" = unpack_mix_"+a+"(a_"+r+", u_"+r+"_t);\n#else\n    "+n+" "+i+" "+r+" = u_"+r+";\n#endif\n"})),staticAttributes:i,staticUniforms:a}}var _n=Object.freeze({__proto__:null,prelude:qe,background:Ze,backgroundPattern:He,circle:Xe,clippingMask:Ye,heatmap:Ke,heatmapTexture:Je,collisionBox:Qe,collisionCircle:$e,debug:tn,fill:en,fillOutline:nn,fillOutlinePattern:rn,fillPattern:on,fillExtrusion:an,fillExtrusionPattern:sn,hillshadePrepare:ln,hillshade:cn,line:un,lineGradient:hn,linePattern:pn,lineSDF:dn,raster:fn,symbolIcon:gn,symbolSDF:mn,symbolTextAndIcon:yn}),bn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function xn(t){for(var e=[],n=0;n<t.length;n++)if(null!==t[n]){var i=t[n].split(" ");e.push(i.pop())}return e}bn.prototype.bind=function(t,e,n,i,r,o,a,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==i.length,c=0;!l&&c<i.length;c++)this.boundPaintVertexBuffers[c]!==i[c]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===n&&!l&&this.boundIndexBuffer===r&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind()):this.freshBind(e,n,i,r,o,a,s)},bn.prototype.freshBind=function(t,e,n,i,r,o,a){var s,l=t.numAttributes,c=this.context,u=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var h=l;h<s;h++)u.disableVertexAttribArray(h)}e.enableAttributes(u,t);for(var p=0,d=n;p<d.length;p+=1)d[p].enableAttributes(u,t);o&&o.enableAttributes(u,t),a&&a.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,r);for(var f=0,g=n;f<g.length;f+=1){var m=g[f];m.bind(),m.setVertexAttribPointers(u,t,r)}o&&(o.bind(),o.setVertexAttribPointers(u,t,r)),i&&i.bind(),a&&(a.bind(),a.setVertexAttribPointers(u,t,r)),c.currentNumAttributes=l},bn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var wn=function(t,e,n,i,r,o){var a=t.gl;this.program=a.createProgram();for(var s=xn(n.staticAttributes),l=i?i.getBinderAttributes():[],c=s.concat(l),u=n.staticUniforms?xn(n.staticUniforms):[],h=i?i.getBinderUniforms():[],p=[],d=0,f=u.concat(h);d<f.length;d+=1){var g=f[d];p.indexOf(g)<0&&p.push(g)}var m=i?i.defines():[];o&&m.push("#define OVERDRAW_INSPECTOR;");var y=m.concat(qe.fragmentSource,n.fragmentSource).join("\n"),v=m.concat(qe.vertexSource,n.vertexSource).join("\n"),_=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(_,y),a.compileShader(_),a.attachShader(this.program,_);var b=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(b,v),a.compileShader(b),a.attachShader(this.program,b),this.attributes={};var x={};this.numAttributes=c.length;for(var w=0;w<this.numAttributes;w++)c[w]&&(a.bindAttribLocation(this.program,w,c[w]),this.attributes[c[w]]=w);a.linkProgram(this.program),a.deleteShader(b),a.deleteShader(_);for(var S=0;S<p.length;S++){var P=p[S];if(P&&!x[P]){var E=a.getUniformLocation(this.program,P);E&&(x[P]=E)}}this.fixedUniforms=r(t,x),this.binderUniforms=i?i.getUniforms(t,x):[]}}};function Sn(t,e,n){var i=1/pe(n,1,e.transform.tileZoom),r=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,e.transform.tileZoom)/r,a=o*(n.tileID.canonical.x+n.tileID.wrap*r),s=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}wn.prototype.draw=function(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g){var m,y=t.gl;if(!this.failedToCreate){for(var v in t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(i),t.setColorMode(r),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[v].set(a[v]);d&&d.setUniforms(t,this.binderUniforms,h,{zoom:p});for(var _=(m={},m[y.LINES]=2,m[y.TRIANGLES]=3,m[y.LINE_STRIP]=1,m)[e],b=0,x=u.get();b<x.length;b+=1){var w=x[b],S=w.vaos||(w.vaos={});(S[s]||(S[s]=new bn)).bind(t,this,l,d?d.getPaintVertexBuffers():[],c,w.vertexOffset,f,g),y.drawElements(e,w.primitiveLength*_,y.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var Pn=function(e,n,i,r){var o=n.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],l=t.create$1();"viewport"===o.properties.get("anchor")&&t.fromRotation(l,-n.transform.angle),t.transformMat3(s,s,l);var c=o.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+i,u_opacity:r}},En=function(e,n,i,r,o,a,s){return t.extend(Pn(e,n,i,r),Sn(a,n,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8})},Tn=function(t){return{u_matrix:t}},kn=function(e,n,i,r){return t.extend(Tn(e),Sn(i,n,r))},An=function(t,e){return{u_matrix:t,u_world:e}},Cn=function(e,n,i,r,o){return t.extend(kn(e,n,i,r),{u_world:o})},Mn=function(e,n,i,r){var o,a,s=e.transform;if("map"===r.paint.get("circle-pitch-alignment")){var l=pe(i,1,s.zoom);o=!0,a=[l,l]}else o=!1,a=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(n.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:t.browser.devicePixelRatio,u_extrude_scale:a}},In=function(t,e,n){var i=pe(n,1,e.zoom),r=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:i,u_extrude_scale:[e.pixelsToGLUnits[0]/(i*r),e.pixelsToGLUnits[1]/(i*r)],u_overscale_factor:o}},Ln=function(t,e,n){return{u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}},On=function(t,e,n){return void 0===n&&(n=1),{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}},zn=function(t){return{u_matrix:t}},Rn=function(t,e,n,i){return{u_matrix:t,u_extrude_scale:pe(e,1,n),u_intensity:i}},Dn=function(e,n,i){var r=e.transform;return{u_matrix:Vn(e,n,i),u_ratio:1/pe(n,1,r.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},Fn=function(e,n,i,r){return t.extend(Dn(e,n,i),{u_image:0,u_image_height:r})},Bn=function(e,n,i,r){var o=e.transform,a=Nn(n,o);return{u_matrix:Vn(e,n,i),u_texsize:n.imageAtlasTexture.size,u_ratio:1/pe(n,1,o.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_image:0,u_scale:[a,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},jn=function(e,n,i,r,o){var a=e.lineAtlas,s=Nn(n,e.transform),l="round"===i.layout.get("line-cap"),c=a.getDash(r.from,l),u=a.getDash(r.to,l),h=c.width*o.fromScale,p=u.width*o.toScale;return t.extend(Dn(e,n,i),{u_patternscale_a:[s/h,-c.height/2],u_patternscale_b:[s/p,-u.height/2],u_sdfgamma:a.width/(256*Math.min(h,p)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:u.y,u_mix:o.t})};function Nn(t,e){return 1/pe(t,1,e.tileZoom)}function Vn(t,e,n){return t.translatePosMatrix(e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Un=function(t,e,n,i,r){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Wn(r.paint.get("raster-hue-rotate"))};var o,a};function Wn(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}var Gn,qn=function(t,e,n,i,r,o,a,s,l,c){var u=r.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:u.width/u.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+i,u_texsize:c,u_texture:0}},Zn=function(e,n,i,r,o,a,s,l,c,u,h){var p=o.transform;return t.extend(qn(e,n,i,r,o,a,s,l,c,u),{u_gamma_scale:r?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:t.browser.devicePixelRatio,u_is_halo:+h})},Hn=function(e,n,i,r,o,a,s,l,c,u){return t.extend(Zn(e,n,i,r,o,a,s,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1})},Xn=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},Yn=function(e,n,i,r,o,a){return t.extend(function(t,e,n,i){var r=n.imageManager.getPattern(t.from.toString()),o=n.imageManager.getPattern(t.to.toString()),a=n.imageManager.getPixelSize(),s=a.width,l=a.height,c=Math.pow(2,i.tileID.overscaledZ),u=i.tileSize*Math.pow(2,n.transform.tileZoom)/c,h=u*(i.tileID.canonical.x+i.tileID.wrap*c),p=u*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,l],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/pe(i,1,n.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[65535&h,65535&p]}}(r,a,i,o),{u_matrix:e,u_opacity:n})},Kn={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},collisionCircle:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,n.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,n.u_viewport_size)}},debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_overlay:new t.Uniform1i(e,n.u_overlay),u_overlay_scale:new t.Uniform1f(e,n.u_overlay_scale)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_unpack:new t.Uniform4f(e,n.u_unpack)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image),u_image_height:new t.Uniform1f(e,n.u_image_height)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_image:new t.Uniform1i(e,n.u_image),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_scale:new t.Uniform3f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,n.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},symbolTextAndIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,n.u_coord_matrix),u_is_text:new t.Uniform1i(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texsize_icon:new t.Uniform2f(e,n.u_texsize_icon),u_texture:new t.Uniform1i(e,n.u_texture),u_texture_icon:new t.Uniform1i(e,n.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,n.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}}};function Jn(e,n,i,r,o,a,s){for(var l=e.context,c=l.gl,u=e.useProgram("collisionBox"),h=[],p=0,d=0,f=0;f<r.length;f++){var g=r[f],m=n.getTile(g),y=m.getBucket(i);if(y){var v=g.posMatrix;0===o[0]&&0===o[1]||(v=e.translatePosMatrix(g.posMatrix,m,o,a));var _=s?y.textCollisionBox:y.iconCollisionBox,b=y.collisionCircleArray;if(b.length>0){var x=t.create(),w=v;t.mul(x,y.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(x,x,y.placementViewportMatrix),h.push({circleArray:b,circleOffset:d,transform:w,invTransform:x}),d=p+=b.length/4}_&&u.draw(l,c.LINES,Et.disabled,Tt.disabled,e.colorModeForRenderPass(),At.disabled,In(v,e.transform,m),i.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}if(s&&h.length){var S=e.useProgram("collisionCircle"),P=new t.StructArrayLayout2f1f2i16;P.resize(4*p),P._trim();for(var E=0,T=0,k=h;T<k.length;T+=1)for(var A=k[T],C=0;C<A.circleArray.length/4;C++){var M=4*C,I=A.circleArray[M+0],L=A.circleArray[M+1],O=A.circleArray[M+2],z=A.circleArray[M+3];P.emplace(E++,I,L,O,z,0),P.emplace(E++,I,L,O,z,1),P.emplace(E++,I,L,O,z,2),P.emplace(E++,I,L,O,z,3)}(!Gn||Gn.length<2*p)&&(Gn=function(e){var n=2*e,i=new t.StructArrayLayout3ui6;i.resize(n),i._trim();for(var r=0;r<n;r++){var o=6*r;i.uint16[o+0]=4*r+0,i.uint16[o+1]=4*r+1,i.uint16[o+2]=4*r+2,i.uint16[o+3]=4*r+2,i.uint16[o+4]=4*r+3,i.uint16[o+5]=4*r+0}return i}(p));for(var R=l.createIndexBuffer(Gn,!0),D=l.createVertexBuffer(P,t.collisionCircleLayout.members,!0),F=0,B=h;F<B.length;F+=1){var j=B[F],N=Ln(j.transform,j.invTransform,e.transform);S.draw(l,c.TRIANGLES,Et.disabled,Tt.disabled,e.colorModeForRenderPass(),At.disabled,N,i.id,D,R,t.SegmentVector.simpleSegment(0,2*j.circleOffset,j.circleArray.length,j.circleArray.length/2),null,e.transform.zoom,null,null,null)}D.destroy(),R.destroy()}}var Qn=t.identity(new Float32Array(16));function $n(e,n,i,r,o,a){var s=t.getAnchorAlignment(e),l=-(s.horizontalAlign-.5)*n,c=-(s.verticalAlign-.5)*i,u=t.evaluateVariableOffset(e,r);return new t.Point((l/o+u[0])*a,(c/o+u[1])*a)}function ti(e,n,i,r,o,a,s,l,c,u,h){var p=e.text.placedSymbolArray,d=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,g={};d.clear();for(var m=0;m<p.length;m++){var y=p.get(m),v=y.hidden||!y.crossTileID||e.allowVerticalPlacement&&!y.placedOrientation?null:r[y.crossTileID];if(v){var _=new t.Point(y.anchorX,y.anchorY),b=$t(_,i?l:s),x=te(a.cameraToCenterDistance,b.signedDistanceFromCamera),w=o.evaluateSizeForFeature(e.textSizeData,u,y)*x/t.ONE_EM;i&&(w*=e.tilePixelRatio/c);for(var S=$n(v.anchor,v.width,v.height,v.textOffset,v.textBoxScale,w),P=i?$t(_.add(S),s).point:b.point.add(n?S.rotate(-a.angle):S),E=e.allowVerticalPlacement&&y.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,T=0;T<y.numGlyphs;T++)t.addDynamicAttributes(d,P,E);h&&y.associatedIconIndex>=0&&(g[y.associatedIconIndex]={shiftedAnchor:P,angle:E})}else ce(y.numGlyphs,d)}if(h){f.clear();for(var k=e.icon.placedSymbolArray,A=0;A<k.length;A++){var C=k.get(A);if(C.hidden)ce(C.numGlyphs,f);else{var M=g[A];if(M)for(var I=0;I<C.numGlyphs;I++)t.addDynamicAttributes(f,M.shiftedAnchor,M.angle);else ce(C.numGlyphs,f)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(d)}function ei(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function ni(e,n,i,r,o,a,s,l,c,u,h,p){for(var d=e.context,f=d.gl,g=e.transform,m="map"===l,y="map"===c,v=m&&"point"!==i.layout.get("symbol-placement"),_=m&&!y&&!v,b=void 0!==i.layout.get("symbol-sort-key").constantOr(1),x=!1,w=e.depthModeForSublayer(0,Et.ReadOnly),S=i.layout.get("text-variable-anchor"),P=[],E=0,T=r;E<T.length;E+=1){var k=T[E],A=n.getTile(k),C=A.getBucket(i);if(C){var M=o?C.text:C.icon;if(M&&M.segments.get().length){var I=M.programConfigurations.get(i.id),L=o||C.sdfIcons,O=o?C.textSizeData:C.iconSizeData,z=y||0!==g.pitch,R=e.useProgram(ei(L,o,C),I),D=t.evaluateSizeForZoom(O,g.zoom),F=void 0,B=[0,0],j=void 0,N=void 0,V=null,U=void 0;if(o)j=A.glyphAtlasTexture,N=f.LINEAR,F=A.glyphAtlasTexture.size,C.iconsInText&&(B=A.imageAtlasTexture.size,V=A.imageAtlasTexture,U=z||e.options.rotating||e.options.zooming||"composite"===O.kind||"camera"===O.kind?f.LINEAR:f.NEAREST);else{var W=1!==i.layout.get("icon-size").constantOr(0)||C.iconsNeedLinear;j=A.imageAtlasTexture,N=L||e.options.rotating||e.options.zooming||W||z?f.LINEAR:f.NEAREST,F=A.imageAtlasTexture.size}var G=pe(A,1,e.transform.zoom),q=Jt(k.posMatrix,y,m,e.transform,G),Z=Qt(k.posMatrix,y,m,e.transform,G),H=S&&C.hasTextData(),X="none"!==i.layout.get("icon-text-fit")&&H&&C.hasIconData();v&&ne(C,k.posMatrix,e,o,q,Z,y,u);var Y=e.translatePosMatrix(k.posMatrix,A,a,s),K=v||o&&S||X?Qn:q,J=e.translatePosMatrix(Z,A,a,s,!0),Q=L&&0!==i.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),$={program:R,buffers:M,uniformValues:L?C.iconsInText?Hn(O.kind,D,_,y,e,Y,K,J,F,B):Zn(O.kind,D,_,y,e,Y,K,J,o,F,!0):qn(O.kind,D,_,y,e,Y,K,J,o,F),atlasTexture:j,atlasTextureIcon:V,atlasInterpolation:N,atlasInterpolationIcon:U,isSDF:L,hasHalo:Q};if(b&&C.canOverlap){x=!0;for(var tt=0,et=M.segments.get();tt<et.length;tt+=1){var nt=et[tt];P.push({segments:new t.SegmentVector([nt]),sortKey:nt.sortKey,state:$})}}else P.push({segments:M.segments,sortKey:0,state:$})}}}x&&P.sort((function(t,e){return t.sortKey-e.sortKey}));for(var it=0,rt=P;it<rt.length;it+=1){var ot=rt[it],at=ot.state;if(d.activeTexture.set(f.TEXTURE0),at.atlasTexture.bind(at.atlasInterpolation,f.CLAMP_TO_EDGE),at.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),at.atlasTextureIcon&&at.atlasTextureIcon.bind(at.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),at.isSDF){var st=at.uniformValues;at.hasHalo&&(st.u_is_halo=1,ii(at.buffers,ot.segments,i,e,at.program,w,h,p,st)),st.u_is_halo=0}ii(at.buffers,ot.segments,i,e,at.program,w,h,p,at.uniformValues)}}function ii(t,e,n,i,r,o,a,s,l){var c=i.context;r.draw(c,c.gl.TRIANGLES,o,a,s,At.disabled,l,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,i.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function ri(t,e,n,i,r,o,a){var s,l,c,u,h,p=t.context.gl,d=n.paint.get("fill-pattern"),f=d&&d.constantOr(1),g=n.getCrossfadeParameters();a?(l=f&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=p.LINES):(l=f?"fillPattern":"fill",s=p.TRIANGLES);for(var m=0,y=i;m<y.length;m+=1){var v=y[m],_=e.getTile(v);if(!f||_.patternsLoaded()){var b=_.getBucket(n);if(b){var x=b.programConfigurations.get(n.id),w=t.useProgram(l,x);f&&(t.context.activeTexture.set(p.TEXTURE0),_.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),x.updatePaintBuffers(g));var S=d.constantOr(null);if(S&&_.imageAtlas){var P=_.imageAtlas,E=P.patternPositions[S.to.toString()],T=P.patternPositions[S.from.toString()];E&&T&&x.setConstantPatternPositions(E,T)}var k=t.translatePosMatrix(v.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){u=b.indexBuffer2,h=b.segments2;var A=[p.drawingBufferWidth,p.drawingBufferHeight];c="fillOutlinePattern"===l&&f?Cn(k,t,g,_,A):An(k,A)}else u=b.indexBuffer,h=b.segments,c=f?kn(k,t,g,_):Tn(k);w.draw(t.context,s,r,t.stencilModeForClipping(v),o,At.disabled,c,n.id,b.layoutVertexBuffer,u,h,n.paint,t.transform.zoom,x)}}}}function oi(t,e,n,i,r,o,a){for(var s=t.context,l=s.gl,c=n.paint.get("fill-extrusion-pattern"),u=c.constantOr(1),h=n.getCrossfadeParameters(),p=n.paint.get("fill-extrusion-opacity"),d=0,f=i;d<f.length;d+=1){var g=f[d],m=e.getTile(g),y=m.getBucket(n);if(y){var v=y.programConfigurations.get(n.id),_=t.useProgram(u?"fillExtrusionPattern":"fillExtrusion",v);u&&(t.context.activeTexture.set(l.TEXTURE0),m.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(h));var b=c.constantOr(null);if(b&&m.imageAtlas){var x=m.imageAtlas,w=x.patternPositions[b.to.toString()],S=x.patternPositions[b.from.toString()];w&&S&&v.setConstantPatternPositions(w,S)}var P=t.translatePosMatrix(g.posMatrix,m,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),E=n.paint.get("fill-extrusion-vertical-gradient"),T=u?En(P,t,E,p,g,h,m):Pn(P,t,E,p);_.draw(s,s.gl.TRIANGLES,r,o,a,At.backCCW,T,n.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,n.paint,t.transform.zoom,v)}}}function ai(e,n,i,r,o,a){var s=e.context,l=s.gl,c=n.fbo;if(c){var u=e.useProgram("hillshade");s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get());var h=function(e,n,i){var r=i.paint.get("hillshade-shadow-color"),o=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color"),s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);var l,c,u,h=!e.options.moving;return{u_matrix:e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),h),u_image:0,u_latrange:(l=n.tileID,c=Math.pow(2,l.canonical.z),u=l.canonical.y,[new t.MercatorCoordinate(0,u/c).toLngLat().lat,new t.MercatorCoordinate(0,(u+1)/c).toLngLat().lat]),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:o,u_accent:a}}(e,n,i);u.draw(s,l.TRIANGLES,r,o,a,At.disabled,h,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function si(e,n,i,r,o,a){var s=e.context,l=s.gl,c=n.dem;if(c&&c.data){var u=c.dim,h=c.stride,p=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(h),n.demTexture){var d=n.demTexture;d.update(p,{premultiply:!1}),d.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else n.demTexture=new t.Texture(s,p,l.RGBA,{premultiply:!1}),n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);var f=n.fbo;if(!f){var g=new t.Texture(s,{width:u,height:u,data:null},l.RGBA);g.bind(l.LINEAR,l.CLAMP_TO_EDGE),(f=n.fbo=s.createFramebuffer(u,u,!0)).colorAttachment.set(g.texture)}s.bindFramebuffer.set(f.framebuffer),s.viewport.set([0,0,u,u]),e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,o,a,At.disabled,function(e,n){var i=n.stride,r=t.create();return t.ortho(r,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(r,r,[0,-t.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_unpack:n.getUnpackVector()}}(n.tileID,c),i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function li(e,n,i,r,o){var a=r.paint.get("raster-fade-duration");if(a>0){var s=t.browser.now(),l=(s-e.timeAdded)/a,c=n?(s-n.timeAdded)/a:-1,u=i.getSource(),h=o.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),p=!n||Math.abs(n.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=p&&e.refreshedUponExpiration?1:t.clamp(p?l:1-c,0,1);return e.refreshedUponExpiration&&l>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}var ci=new t.Color(1,0,0,1),ui=new t.Color(0,1,0,1),hi=new t.Color(0,0,1,1),pi=new t.Color(1,0,1,1),di=new t.Color(0,1,1,1);function fi(t,e,n,i){mi(t,0,e+n/2,t.transform.width,n,i)}function gi(t,e,n,i){mi(t,e-n/2,0,n,t.transform.height,i)}function mi(e,n,i,r,o,a){var s=e.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*t.browser.devicePixelRatio,i*t.browser.devicePixelRatio,r*t.browser.devicePixelRatio,o*t.browser.devicePixelRatio),s.clear({color:a}),l.disable(l.SCISSOR_TEST)}function yi(e,n,i){var r=e.context,o=r.gl,a=i.posMatrix,s=e.useProgram("debug"),l=Et.disabled,c=Tt.disabled,u=e.colorModeForRenderPass();r.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s.draw(r,o.LINE_STRIP,l,c,u,At.disabled,On(a,t.Color.red),"$debug",e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);var h=n.getTileByID(i.key).latestRawTileData,p=Math.floor((h&&h.byteLength||0)/1024),d=n.getTile(i).tileSize,f=512/Math.min(d,512)*(i.overscaledZ/e.transform.zoom)*.5,g=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(g+=" => "+i.overscaledZ),function(t,e){t.initDebugOverlayCanvas();var n=t.debugOverlayCanvas,i=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,g+" "+p+"kb"),s.draw(r,o.TRIANGLES,l,c,kt.alphaBlended,At.disabled,On(a,t.Color.transparent,f),"$debug",e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}var vi={symbol:function(e,n,i,r,o){if("translucent"===e.renderPass){var a=Tt.disabled,s=e.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(e,n,i,r,o,a,s){for(var l=n.transform,c="map"===o,u="map"===a,h=0,p=e;h<p.length;h+=1){var d=p[h],f=r.getTile(d),g=f.getBucket(i);if(g&&g.text&&g.text.segments.get().length){var m=t.evaluateSizeForZoom(g.textSizeData,l.zoom),y=pe(f,1,n.transform.zoom),v=Jt(d.posMatrix,u,c,n.transform,y),_="none"!==i.layout.get("icon-text-fit")&&g.hasIconData();if(m){var b=Math.pow(2,l.zoom-f.tileID.overscaledZ);ti(g,c,u,s,t.symbolSize,l,v,d.posMatrix,b,m,_)}}}}(r,e,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),o),0!==i.paint.get("icon-opacity").constantOr(1)&&ni(e,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),a,s),0!==i.paint.get("text-opacity").constantOr(1)&&ni(e,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),a,s),n.map.showCollisionBoxes&&(Jn(e,n,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),Jn(e,n,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))}},circle:function(e,n,i,r){if("translucent"===e.renderPass){var o=i.paint.get("circle-opacity"),a=i.paint.get("circle-stroke-width"),s=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var c=e.context,u=c.gl,h=e.depthModeForSublayer(0,Et.ReadOnly),p=Tt.disabled,d=e.colorModeForRenderPass(),f=[],g=0;g<r.length;g++){var m=r[g],y=n.getTile(m),v=y.getBucket(i);if(v){var _=v.programConfigurations.get(i.id),b={programConfiguration:_,program:e.useProgram("circle",_),layoutVertexBuffer:v.layoutVertexBuffer,indexBuffer:v.indexBuffer,uniformValues:Mn(e,m,y,i)};if(l)for(var x=0,w=v.segments.get();x<w.length;x+=1){var S=w[x];f.push({segments:new t.SegmentVector([S]),sortKey:S.sortKey,state:b})}else f.push({segments:v.segments,sortKey:0,state:b})}}l&&f.sort((function(t,e){return t.sortKey-e.sortKey}));for(var P=0,E=f;P<E.length;P+=1){var T=E[P],k=T.state;k.program.draw(c,u.TRIANGLES,h,p,d,At.disabled,k.uniformValues,i.id,k.layoutVertexBuffer,k.indexBuffer,T.segments,i.paint,e.transform.zoom,k.programConfiguration)}}}},heatmap:function(e,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=Tt.disabled,l=new kt([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{var o=i.createTexture();i.bindTexture(i.TEXTURE_2D,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),r=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,n,i){var r=t.gl;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width/4,e.height/4,0,r.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:r.UNSIGNED_BYTE,null),i.colorAttachment.set(n)}(t,e,o,r)}}(o,e,i),o.clear({color:t.Color.transparent});for(var c=0;c<r.length;c++){var u=r[c];if(!n.hasRenderableParent(u)){var h=n.getTile(u),p=h.getBucket(i);if(p){var d=p.programConfigurations.get(i.id);e.useProgram("heatmap",d).draw(o,a.TRIANGLES,Et.disabled,s,l,At.disabled,Rn(u.posMatrix,h,e.transform.zoom,i.paint.get("heatmap-intensity")),i.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,i.paint,e.transform.zoom,d)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var i=e.context,r=i.gl,o=n.heatmapFbo;if(o){i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new t.Texture(i,n.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(i,r.TRIANGLES,Et.disabled,Tt.disabled,e.colorModeForRenderPass(),At.disabled,function(e,n,i,r){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}}(e,n),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,i))},line:function(e,n,i,r){if("translucent"===e.renderPass){var o=i.paint.get("line-opacity"),a=i.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1))for(var s=e.depthModeForSublayer(0,Et.ReadOnly),l=e.colorModeForRenderPass(),c=i.paint.get("line-dasharray"),u=i.paint.get("line-pattern"),h=u.constantOr(1),p=i.paint.get("line-gradient"),d=i.getCrossfadeParameters(),f=h?"linePattern":c?"lineSDF":p?"lineGradient":"line",g=e.context,m=g.gl,y=!0,v=0,_=r;v<_.length;v+=1){var b=_[v],x=n.getTile(b);if(!h||x.patternsLoaded()){var w=x.getBucket(i);if(w){var S=w.programConfigurations.get(i.id),P=e.context.program.get(),E=e.useProgram(f,S),T=y||E.program!==P,k=u.constantOr(null);if(k&&x.imageAtlas){var A=x.imageAtlas,C=A.patternPositions[k.to.toString()],M=A.patternPositions[k.from.toString()];C&&M&&S.setConstantPatternPositions(C,M)}var I=h?Bn(e,x,i,d):c?jn(e,x,i,c,d):p?Fn(e,x,i,w.lineClipsArray.length):Dn(e,x,i);if(h)g.activeTexture.set(m.TEXTURE0),x.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),S.updatePaintBuffers(d);else if(c&&(T||e.lineAtlas.dirty))g.activeTexture.set(m.TEXTURE0),e.lineAtlas.bind(g);else if(p){var L=w.gradients[i.id],O=L.texture;if(i.gradientVersion!==L.version){var z=256;if(i.stepInterpolant){var R=n.getSource().maxzoom,D=b.canonical.z===R?Math.ceil(1<<e.transform.maxZoom-b.canonical.z):1;z=t.clamp(t.nextPowerOfTwo(w.maxLineLength/t.EXTENT*1024*D),256,g.maxTextureSize)}L.gradient=t.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:z,image:L.gradient||void 0,clips:w.lineClipsArray}),L.texture?L.texture.update(L.gradient):L.texture=new t.Texture(g,L.gradient,m.RGBA),L.version=i.gradientVersion,O=L.texture}g.activeTexture.set(m.TEXTURE0),O.bind(i.stepInterpolant?m.NEAREST:m.LINEAR,m.CLAMP_TO_EDGE)}E.draw(g,m.TRIANGLES,s,e.stencilModeForClipping(b),l,At.disabled,I,i.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,i.paint,e.transform.zoom,S,w.layoutVertexBuffer2),y=!1}}}}},fill:function(e,n,i,r){var o=i.paint.get("fill-color"),a=i.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){var u=e.depthModeForSublayer(1,"opaque"===e.renderPass?Et.ReadWrite:Et.ReadOnly);ri(e,n,i,r,u,s,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){var h=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Et.ReadOnly);ri(e,n,i,r,h,s,!0)}}},"fill-extrusion":function(t,e,n,i){var r=n.paint.get("fill-extrusion-opacity");if(0!==r&&"translucent"===t.renderPass){var o=new Et(t.context.gl.LEQUAL,Et.ReadWrite,t.depthRangeFor3D);if(1!==r||n.paint.get("fill-extrusion-pattern").constantOr(1))oi(t,e,n,i,o,Tt.disabled,kt.disabled),oi(t,e,n,i,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var a=t.colorModeForRenderPass();oi(t,e,n,i,o,Tt.disabled,a)}}},hillshade:function(t,e,n,i){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var r=t.context,o=t.depthModeForSublayer(0,Et.ReadOnly),a=t.colorModeForRenderPass(),s="translucent"===t.renderPass?t.stencilConfigForOverlap(i):[{},i],l=s[0],c=0,u=s[1];c<u.length;c+=1){var h=u[c],p=e.getTile(h);p.needsHillshadePrepare&&"offscreen"===t.renderPass?si(t,p,n,o,Tt.disabled,a):"translucent"===t.renderPass&&ai(t,p,n,o,l[h.overscaledZ],a)}r.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,i){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")&&i.length)for(var r=t.context,o=r.gl,a=e.getSource(),s=t.useProgram("raster"),l=t.colorModeForRenderPass(),c=a instanceof L?[{},i]:t.stencilConfigForOverlap(i),u=c[0],h=c[1],p=h[h.length-1].overscaledZ,d=!t.options.moving,f=0,g=h;f<g.length;f+=1){var m=g[f],y=t.depthModeForSublayer(m.overscaledZ-p,1===n.paint.get("raster-opacity")?Et.ReadWrite:Et.ReadOnly,o.LESS),v=e.getTile(m),_=t.transform.calculatePosMatrix(m.toUnwrapped(),d);v.registerFadeDuration(n.paint.get("raster-fade-duration"));var b=e.findLoadedParent(m,0),x=li(v,b,e,n,t.transform),w=void 0,S=void 0,P="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;r.activeTexture.set(o.TEXTURE0),v.texture.bind(P,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),r.activeTexture.set(o.TEXTURE1),b?(b.texture.bind(P,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,b.tileID.overscaledZ-v.tileID.overscaledZ),S=[v.tileID.canonical.x*w%1,v.tileID.canonical.y*w%1]):v.texture.bind(P,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var E=Un(_,S||[0,0],w||1,x,n);a instanceof L?s.draw(r,o.TRIANGLES,y,Tt.disabled,l,At.disabled,E,n.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):s.draw(r,o.TRIANGLES,y,u[m.overscaledZ],l,At.disabled,E,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n){var i=n.paint.get("background-color"),r=n.paint.get("background-opacity");if(0!==r){var o=t.context,a=o.gl,s=t.transform,l=s.tileSize,c=n.paint.get("background-pattern");if(!t.isPatternMissing(c)){var u=!c&&1===i.a&&1===r&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===u){var h=Tt.disabled,p=t.depthModeForSublayer(0,"opaque"===u?Et.ReadWrite:Et.ReadOnly),d=t.colorModeForRenderPass(),f=t.useProgram(c?"backgroundPattern":"background"),g=s.coveringTiles({tileSize:l});c&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));for(var m=n.getCrossfadeParameters(),y=0,v=g;y<v.length;y+=1){var _=v[y],b=t.transform.calculatePosMatrix(_.toUnwrapped()),x=c?Yn(b,r,t,c,{tileID:_,tileSize:l},m):Xn(b,r,i);f.draw(o,a.TRIANGLES,p,h,d,At.disabled,x,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,n){for(var i=0;i<n.length;i++)yi(t,e,n[i])},custom:function(t,e,n){var i=t.context,r=n.implementation;if("offscreen"===t.renderPass){var o=r.prerender;o&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),o.call(r,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(Tt.disabled);var a="3d"===r.renderingMode?new Et(t.context.gl.LEQUAL,Et.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Et.ReadOnly);i.setDepthMode(a),r.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}},_i=function(t,e){this.context=new Ct(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=Mt.maxUnderzooming+Mt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Be,this.gpuTimers={}};_i.prototype.resize=function(e,n){if(this.width=e*t.browser.devicePixelRatio,this.height=n*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,r=this.style._order;i<r.length;i+=1)this.style._layers[r[i]].resize()},_i.prototype.setup=function(){var e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,Ge.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(i,Ge.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var r=new t.StructArrayLayout4i8;r.emplaceBack(0,0,0,0),r.emplaceBack(t.EXTENT,0,t.EXTENT,0),r.emplaceBack(0,t.EXTENT,0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(r,I.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,Ge.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new Tt({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},_i.prototype.clearStencil=function(){var e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var i=t.create();t.ortho(i,0,this.width,this.height,0,0,1),t.scale(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Et.disabled,this.stencilClearMode,kt.disabled,At.disabled,zn(i),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},_i.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var n=this.context,i=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(kt.disabled),n.setDepthMode(Et.disabled);var r=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=e;o<a.length;o+=1){var s=a[o],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;r.draw(n,i.TRIANGLES,Et.disabled,new Tt({func:i.ALWAYS,mask:0},l,255,i.KEEP,i.KEEP,i.REPLACE),kt.disabled,At.disabled,zn(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},_i.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new Tt({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},_i.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Tt({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},_i.prototype.stencilConfigForOverlap=function(t){var e,n=this.context.gl,i=t.sort((function(t,e){return e.overscaledZ-t.overscaledZ})),r=i[i.length-1].overscaledZ,o=i[0].overscaledZ-r+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();for(var a={},s=0;s<o;s++)a[s+r]=new Tt({func:n.GEQUAL,mask:255},s+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=o,[a,i]}return[(e={},e[r]=Tt.disabled,e),i]},_i.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new kt([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?kt.unblended:kt.alphaBlended},_i.prototype.depthModeForSublayer=function(t,e,n){if(!this.opaquePassEnabledForLayer())return Et.disabled;var i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Et(n||this.context.gl.LEQUAL,e,[i,i])},_i.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},_i.prototype.render=function(e,n){var i=this;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now()),this.imageManager.beginFrame();var r=this.style._order,o=this.style.sourceCaches;for(var a in o){var s=o[a];s.used&&s.prepare(this.context)}var l,c,u={},h={},p={};for(var d in o){var f=o[d];u[d]=f.getVisibleCoordinates(),h[d]=u[d].slice().reverse(),p[d]=f.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var g=0;g<r.length;g++)if(this.style._layers[r[g]].is3D()){this.opaquePassCutoff=g;break}this.renderPass="offscreen";for(var m=0,y=r;m<y.length;m+=1){var v=this.style._layers[y[m]];if(v.hasOffscreenPass()&&!v.isHidden(this.transform.zoom)){var _=h[v.source];("custom"===v.type||_.length)&&this.renderLayer(this,o[v.source],v,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){var b=this.style._layers[r[this.currentLayer]],x=o[b.source],w=u[b.source];this._renderTileClippingMasks(b,w),this.renderLayer(this,x,b,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){var S=this.style._layers[r[this.currentLayer]],P=o[S.source],E=("symbol"===S.type?p:h)[S.source];this._renderTileClippingMasks(S,u[S.source]),this.renderLayer(this,P,S,E)}this.options.showTileBoundaries&&(t.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(i.transform.zoom)&&(t.source!==(c&&c.id)&&(c=i.style.sourceCaches[t.source]),(!l||l.getSource().maxzoom<c.getSource().maxzoom)&&(l=c))})),l&&vi.debug(this,l,l.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;fi(t,t.transform.height-(e.top||0),3,ci),fi(t,e.bottom||0,3,ui),gi(t,e.left||0,3,hi),gi(t,t.transform.width-(e.right||0),3,pi);var n=t.transform.centerPoint;!function(t,e,n,i){mi(t,e-1,n-10,2,20,i),mi(t,e-10,n-1,20,2,i)}(t,n.x,t.transform.height-n.y,di)}(this),this.context.setDefault()},_i.prototype.renderLayer=function(t,e,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||i.length)&&(this.id=n.id,this.gpuTimingStart(n),vi[n.type](t,e,n,i,this.style.placement.variableOffsets),this.gpuTimingEnd())},_i.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,n=this.gpuTimers[t.id];n||(n=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),n.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,n.query)}},_i.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},_i.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},_i.prototype.queryGpuTimers=function(t){var e={};for(var n in t){var i=t[n],r=this.context.extTimerQuery,o=r.getQueryObjectEXT(i.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(i.query),e[n]=o}return e},_i.prototype.translatePosMatrix=function(e,n,i,r,o){if(!i[0]&&!i[1])return e;var a=o?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(a){var s=Math.sin(a),l=Math.cos(a);i=[i[0]*l-i[1]*s,i[0]*s+i[1]*l]}var c=[o?i[0]:pe(n,i[0],this.transform.zoom),o?i[1]:pe(n,i[1],this.transform.zoom),0],u=new Float32Array(16);return t.translate(u,e,c),u},_i.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},_i.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},_i.prototype.isPatternMissing=function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n},_i.prototype.useProgram=function(t,e){this.cache=this.cache||{};var n=""+t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new wn(this.context,t,_n[t],e,Kn[t],this._showOverdrawInspector)),this.cache[n]},_i.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},_i.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)},_i.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},_i.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var bi=function(t,e){this.points=t,this.planes=e};bi.fromInvProjectionMatrix=function(e,n,i){var r=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(n){return t.transformMat4([],n,e)})).map((function(e){return t.scale$1([],e,1/e[3]/n*r)})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var n=t.sub([],o[e[0]],o[e[1]]),i=t.sub([],o[e[2]],o[e[1]]),r=t.normalize([],t.cross([],n,i)),a=-t.dot(r,o[e[1]]);return r.concat(a)}));return new bi(o,a)};var xi=function(e,n){this.min=e,this.max=n,this.center=t.scale$2([],t.add([],this.min,this.max),.5)};xi.prototype.quadrant=function(e){for(var n=[e%2==0,e<2],i=t.clone$2(this.min),r=t.clone$2(this.max),o=0;o<n.length;o++)i[o]=n[o]?this.min[o]:this.center[o],r[o]=n[o]?this.center[o]:this.max[o];return r[2]=this.max[2],new xi(i,r)},xi.prototype.distanceX=function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]},xi.prototype.distanceY=function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]},xi.prototype.intersects=function(e){for(var n=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],i=!0,r=0;r<e.planes.length;r++){for(var o=e.planes[r],a=0,s=0;s<n.length;s++)a+=t.dot$1(o,n[s])>=0;if(0===a)return 0;a!==n.length&&(i=!1)}if(i)return 2;for(var l=0;l<3;l++){for(var c=Number.MAX_VALUE,u=-Number.MAX_VALUE,h=0;h<e.points.length;h++){var p=e.points[h][l]-this.min[l];c=Math.min(c,p),u=Math.max(u,p)}if(u<0||c>this.max[l]-this.min[l])return 0}return 1};var wi=function(t,e,n,i){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=i};wi.prototype.interpolate=function(e,n,i){return null!=n.top&&null!=e.top&&(this.top=t.number(e.top,n.top,i)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,n.bottom,i)),null!=n.left&&null!=e.left&&(this.left=t.number(e.left,n.left,i)),null!=n.right&&null!=e.right&&(this.right=t.number(e.right,n.right,i)),this},wi.prototype.getCenter=function(e,n){var i=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+n-this.bottom)/2,0,n);return new t.Point(i,r)},wi.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right},wi.prototype.clone=function(){return new wi(this.top,this.bottom,this.left,this.right)},wi.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Si=function(e,n,i,r,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wi,this._posMatrixCache={},this._alignedPosMatrixCache={}},Pi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Si.prototype.clone=function(){var t=new Si(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t},Pi.minZoom.get=function(){return this._minZoom},Pi.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Pi.maxZoom.get=function(){return this._maxZoom},Pi.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Pi.minPitch.get=function(){return this._minPitch},Pi.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},Pi.maxPitch.get=function(){return this._maxPitch},Pi.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},Pi.renderWorldCopies.get=function(){return this._renderWorldCopies},Pi.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Pi.worldSize.get=function(){return this.tileSize*this.scale},Pi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Pi.size.get=function(){return new t.Point(this.width,this.height)},Pi.bearing.get=function(){return-this.angle/Math.PI*180},Pi.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Pi.pitch.get=function(){return this._pitch/Math.PI*180},Pi.pitch.set=function(e){var n=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},Pi.fov.get=function(){return this._fov/Math.PI*180},Pi.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Pi.zoom.get=function(){return this._zoom},Pi.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Pi.center.get=function(){return this._center},Pi.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Pi.padding.get=function(){return this._edgeInsets.toJSON()},Pi.padding.set=function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())},Pi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Si.prototype.isPaddingEqual=function(t){return this._edgeInsets.equals(t)},Si.prototype.interpolatePadding=function(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()},Si.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},Si.prototype.getVisibleUnwrappedCoordinates=function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var i=this.pointCoordinate(new t.Point(0,0)),r=this.pointCoordinate(new t.Point(this.width,0)),o=this.pointCoordinate(new t.Point(this.width,this.height)),a=this.pointCoordinate(new t.Point(0,this.height)),s=Math.floor(Math.min(i.x,r.x,o.x,a.x)),l=Math.floor(Math.max(i.x,r.x,o.x,a.x)),c=s-1;c<=l+1;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e));return n},Si.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),i=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var r=t.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,n),a=[o*r.x,o*r.y,0],s=bi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),l=e.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(l=n);var c=function(t){return{aabb:new xi([t*o,0,0],[(t+1)*o,o,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}},u=[],h=[],p=n,d=e.reparseOverscaled?i:n;if(this._renderWorldCopies)for(var f=1;f<=3;f++)u.push(c(-f)),u.push(c(f));for(u.push(c(0));u.length>0;){var g=u.pop(),m=g.x,y=g.y,v=g.fullyVisible;if(!v){var _=g.aabb.intersects(s);if(0===_)continue;v=2===_}var b=g.aabb.distanceX(a),x=g.aabb.distanceY(a),w=Math.max(Math.abs(b),Math.abs(x));if(g.zoom===p||w>3+(1<<p-g.zoom)-2&&g.zoom>=l)h.push({tileID:new t.OverscaledTileID(g.zoom===p?d:g.zoom,g.wrap,g.zoom,m,y),distanceSq:t.sqrLen([a[0]-.5-m,a[1]-.5-y])});else for(var S=0;S<4;S++){var P=(m<<1)+S%2,E=(y<<1)+(S>>1);u.push({aabb:g.aabb.quadrant(S),zoom:g.zoom+1,x:P,y:E,wrap:g.wrap,fullyVisible:v})}}return h.sort((function(t,e){return t.distanceSq-e.distanceSq})).map((function(t){return t.tileID}))},Si.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Pi.unmodified.get=function(){return this._unmodified},Si.prototype.zoomScale=function(t){return Math.pow(2,t)},Si.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Si.prototype.project=function(e){var n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)},Si.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},Pi.point.get=function(){return this.project(this.center)},Si.prototype.setLocationAtPoint=function(e,n){var i=this.pointCoordinate(n),r=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(i.x-r.x),o.y-(i.y-r.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},Si.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Si.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Si.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},Si.prototype.coordinateLocation=function(t){return t.toLngLat()},Si.prototype.pointCoordinate=function(e){var n=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse);var r=n[3],o=i[3],a=n[1]/r,s=i[1]/o,l=n[2]/r,c=i[2]/o,u=l===c?0:(0-l)/(c-l);return new t.MercatorCoordinate(t.number(n[0]/r,i[0]/o,u)/this.worldSize,t.number(a,s,u)/this.worldSize)},Si.prototype.coordinatePoint=function(e){var n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},Si.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},Si.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Si.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Si.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var i=e.key,r=n?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*a,o.y*a,0]),t.scale(l,l,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(l,n?this.alignedProjMatrix:this.projMatrix,l),r[i]=new Float32Array(l),r[i]},Si.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Si.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,i,r,o=-90,a=90,s=-180,l=180,c=this.size,u=this._unmodified;if(this.latRange){var h=this.latRange;o=t.mercatorYfromLat(h[1])*this.worldSize,e=(a=t.mercatorYfromLat(h[0])*this.worldSize)-o<c.y?c.y/(a-o):0}if(this.lngRange){var p=this.lngRange;s=t.mercatorXfromLng(p[0])*this.worldSize,n=(l=t.mercatorXfromLng(p[1])*this.worldSize)-s<c.x?c.x/(l-s):0}var d=this.point,f=Math.max(n||0,e||0);if(f)return this.center=this.unproject(new t.Point(n?(l+s)/2:d.x,e?(a+o)/2:d.y)),this.zoom+=this.scaleZoom(f),this._unmodified=u,void(this._constraining=!1);if(this.latRange){var g=d.y,m=c.y/2;g-m<o&&(r=o+m),g+m>a&&(r=a-m)}if(this.lngRange){var y=d.x,v=c.x/2;y-v<s&&(i=s+v),y+v>l&&(i=l-v)}void 0===i&&void 0===r||(this.center=this.unproject(new t.Point(void 0!==i?i:d.x,void 0!==r?r:d.y))),this._unmodified=u,this._constraining=!1}},Si.prototype._calcMatrices=function(){if(this.height){var e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var n=Math.PI/2+this._pitch,i=this._fov*(.5+e.y/this.height),r=Math.sin(i)*this.cameraToCenterDistance/Math.sin(t.clamp(Math.PI-n-i,.01,Math.PI-.01)),o=this.point,a=o.x,s=o.y,l=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),c=this.height/50,u=new Float64Array(16);t.perspective(u,this._fov,this.width/this.height,c,l),u[8]=2*-e.x/this.width,u[9]=2*e.y/this.height,t.scale(u,u,[1,-1,1]),t.translate(u,u,[0,0,-this.cameraToCenterDistance]),t.rotateX(u,u,this._pitch),t.rotateZ(u,u,this.angle),t.translate(u,u,[-a,-s,0]),this.mercatorMatrix=t.scale([],u,[this.worldSize,this.worldSize,this.worldSize]),t.scale(u,u,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=u,this.invProjMatrix=t.invert([],this.projMatrix);var h=this.width%2/2,p=this.height%2/2,d=Math.cos(this.angle),f=Math.sin(this.angle),g=a-Math.round(a)+d*h+f*p,m=s-Math.round(s)+d*p+f*h,y=new Float64Array(u);if(t.translate(y,y,[g>.5?g-1:g,m>.5?m-1:m,0]),this.alignedProjMatrix=y,u=t.create(),t.scale(u,u,[this.width/2,-this.height/2,1]),t.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=t.create(),t.scale(u,u,[1,-1,1]),t.translate(u,u,[-1,-1,0]),t.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(u=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Si.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},Si.prototype.getCameraPoint=function(){var e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))},Si.prototype.getCameraQueryGeometry=function(e){var n=this.getCameraPoint();if(1===e.length)return[e[0],n];for(var i=n.x,r=n.y,o=n.x,a=n.y,s=0,l=e;s<l.length;s+=1){var c=l[s];i=Math.min(i,c.x),r=Math.min(r,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}return[new t.Point(i,r),new t.Point(o,r),new t.Point(o,a),new t.Point(i,a),new t.Point(i,r)]},Object.defineProperties(Si.prototype,Pi);var Ei=function(e){var n,i,r,o;this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),i=!1,r=null,o=function(){r=null,i&&(n(),r=setTimeout(o,300),i=!1)},function(){return i=!0,r||o(),r})};Ei.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ei.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ei.prototype.getHashString=function(e){var n=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,r),a=Math.round(n.lng*o)/o,s=Math.round(n.lat*o)/o,l=this._map.getBearing(),c=this._map.getPitch(),u="";if(u+=e?"/"+a+"/"+s+"/"+i:i+"/"+s+"/"+a,(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+="/"+Math.round(c)),this._hashName){var h=this._hashName,p=!1,d=t.window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===h?(p=!0,e+"="+u):t})).filter((function(t){return t}));return p||d.push(h+"="+u),"#"+d.join("&")}return"#"+u},Ei.prototype._getCurrentHash=function(){var e,n=this,i=t.window.location.hash.replace("#","");return this._hashName?(i.split("&").map((function(t){return t.split("=")})).forEach((function(t){t[0]===n._hashName&&(e=t)})),(e&&e[1]||"").split("/")):i.split("/")},Ei.prototype._onHashChange=function(){var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(t){return isNaN(t)}))){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},Ei.prototype._updateHashUnthrottled=function(){var e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());try{t.window.history.replaceState(t.window.history.state,null,e)}catch(t){}};var Ti={linearity:.3,easing:t.bezier(0,0,.3,1)},ki=t.extend({deceleration:2500,maxSpeed:1400},Ti),Ai=t.extend({deceleration:20,maxSpeed:1400},Ti),Ci=t.extend({deceleration:1e3,maxSpeed:360},Ti),Mi=t.extend({deceleration:1e3,maxSpeed:90},Ti),Ii=function(t){this._map=t,this.clear()};function Li(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Oi(e,n,i){var r=i.maxSpeed,o=i.linearity,a=i.deceleration,s=t.clamp(e*o/(n/1e3),-r,r),l=Math.abs(s)/(a*o);return{easing:i.easing,duration:1e3*l,amount:s*(l/2)}}Ii.prototype.clear=function(){this._inertiaBuffer=[]},Ii.prototype.record=function(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.browser.now(),settings:e})},Ii.prototype._drainInertiaBuffer=function(){for(var e=this._inertiaBuffer,n=t.browser.now();e.length>0&&n-e[0].time>160;)e.shift()},Ii.prototype._onMoveEnd=function(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var n={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0},i=0,r=this._inertiaBuffer;i<r.length;i+=1){var o=r[i].settings;n.zoom+=o.zoomDelta||0,n.bearing+=o.bearingDelta||0,n.pitch+=o.pitchDelta||0,o.panDelta&&n.pan._add(o.panDelta),o.around&&(n.around=o.around),o.pinchAround&&(n.pinchAround=o.pinchAround)}var a=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(n.pan.mag()){var l=Oi(n.pan.mag(),a,t.extend({},ki,e||{}));s.offset=n.pan.mult(l.amount/n.pan.mag()),s.center=this._map.transform.center,Li(s,l)}if(n.zoom){var c=Oi(n.zoom,a,Ai);s.zoom=this._map.transform.zoom+c.amount,Li(s,c)}if(n.bearing){var u=Oi(n.bearing,a,Ci);s.bearing=this._map.transform.bearing+t.clamp(u.amount,-179,179),Li(s,u)}if(n.pitch){var h=Oi(n.pitch,a,Mi);s.pitch=this._map.transform.pitch+h.amount,Li(s,h)}if(s.zoom||s.bearing){var p=void 0===n.pinchAround?n.around:n.pinchAround;s.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),t.extend(s,{noMoveStart:!0})}};var zi=function(e){function i(i,r,o,a){void 0===a&&(a={});var s=n.mousePos(r.getCanvasContainer(),o),l=r.unproject(s);e.call(this,i,t.extend({point:s,lngLat:l,originalEvent:o},a)),this._defaultPrevented=!1,this.target=r}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var r={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,r),i}(t.Event),Ri=function(e){function i(i,r,o){var a="touchend"===i?o.changedTouches:o.touches,s=n.touchPos(r.getCanvasContainer(),a),l=s.map((function(t){return r.unproject(t)})),c=s.reduce((function(t,e,n,i){return t.add(e.div(i.length))}),new t.Point(0,0)),u=r.unproject(c);e.call(this,i,{points:s,point:c,lngLats:l,lngLat:u,originalEvent:o}),this._defaultPrevented=!1}e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i;var r={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,r),i}(t.Event),Di=function(t){function e(e,n,i){t.call(this,e,{originalEvent:i}),this._defaultPrevented=!1}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),Fi=function(t,e){this._map=t,this._clickTolerance=e.clickTolerance};Fi.prototype.reset=function(){delete this._mousedownPos},Fi.prototype.wheel=function(t){return this._firePreventable(new Di(t.type,this._map,t))},Fi.prototype.mousedown=function(t,e){return this._mousedownPos=e,this._firePreventable(new zi(t.type,this._map,t))},Fi.prototype.mouseup=function(t){this._map.fire(new zi(t.type,this._map,t))},Fi.prototype.click=function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new zi(t.type,this._map,t))},Fi.prototype.dblclick=function(t){return this._firePreventable(new zi(t.type,this._map,t))},Fi.prototype.mouseover=function(t){this._map.fire(new zi(t.type,this._map,t))},Fi.prototype.mouseout=function(t){this._map.fire(new zi(t.type,this._map,t))},Fi.prototype.touchstart=function(t){return this._firePreventable(new Ri(t.type,this._map,t))},Fi.prototype.touchmove=function(t){this._map.fire(new Ri(t.type,this._map,t))},Fi.prototype.touchend=function(t){this._map.fire(new Ri(t.type,this._map,t))},Fi.prototype.touchcancel=function(t){this._map.fire(new Ri(t.type,this._map,t))},Fi.prototype._firePreventable=function(t){if(this._map.fire(t),t.defaultPrevented)return{}},Fi.prototype.isEnabled=function(){return!0},Fi.prototype.isActive=function(){return!1},Fi.prototype.enable=function(){},Fi.prototype.disable=function(){};var Bi=function(t){this._map=t};Bi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Bi.prototype.mousemove=function(t){this._map.fire(new zi(t.type,this._map,t))},Bi.prototype.mousedown=function(){this._delayContextMenu=!0},Bi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Bi.prototype.contextmenu=function(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new zi(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()},Bi.prototype.isEnabled=function(){return!0},Bi.prototype.isActive=function(){return!1},Bi.prototype.enable=function(){},Bi.prototype.disable=function(){};var ji=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1};function Ni(t,e){for(var n={},i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}ji.prototype.isEnabled=function(){return!!this._enabled},ji.prototype.isActive=function(){return!!this._active},ji.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ji.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ji.prototype.mousedown=function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(n.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)},ji.prototype.mousemoveWindow=function(t,e){if(this._active){var i=e;if(!(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=i,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var o=Math.min(r.x,i.x),a=Math.max(r.x,i.x),s=Math.min(r.y,i.y),l=Math.max(r.y,i.y);n.setTransform(this._box,"translate("+o+"px,"+s+"px)"),this._box.style.width=a-o+"px",this._box.style.height=l-s+"px"}}},ji.prototype.mouseupWindow=function(e,i){var r=this;if(this._active&&0===e.button){var o=this._startPos,a=i;if(this.reset(),n.suppressClick(),o.x!==a.x||o.y!==a.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:function(t){return t.fitScreenCoordinates(o,a,r._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",e)}},ji.prototype.keydown=function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))},ji.prototype.blur=function(){this.reset()},ji.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},ji.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var Vi=function(t){this.reset(),this.numTouches=t.numTouches};Vi.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Vi.prototype.touchstart=function(e,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){for(var n=new t.Point(0,0),i=0,r=e;i<r.length;i+=1)n._add(r[i]);return n.div(e.length)}(n),this.touches=Ni(i,n)))},Vi.prototype.touchmove=function(t,e,n){if(!this.aborted&&this.centroid){var i=Ni(n,e);for(var r in this.touches){var o=i[r];(!o||o.dist(this.touches[r])>30)&&(this.aborted=!0)}}},Vi.prototype.touchend=function(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){var i=!this.aborted&&this.centroid;if(this.reset(),i)return i}};var Ui=function(t){this.singleTap=new Vi(t),this.numTaps=t.numTaps,this.reset()};Ui.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ui.prototype.touchstart=function(t,e,n){this.singleTap.touchstart(t,e,n)},Ui.prototype.touchmove=function(t,e,n){this.singleTap.touchmove(t,e,n)},Ui.prototype.touchend=function(t,e,n){var i=this.singleTap.touchend(t,e,n);if(i){var r=t.timeStamp-this.lastTime<500,o=!this.lastTap||this.lastTap.dist(i)<30;if(r&&o||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}};var Wi=function(){this._zoomIn=new Ui({numTouches:1,numTaps:2}),this._zoomOut=new Ui({numTouches:2,numTaps:1}),this.reset()};Wi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Wi.prototype.touchstart=function(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)},Wi.prototype.touchmove=function(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)},Wi.prototype.touchend=function(t,e,n){var i=this,r=this._zoomIn.touchend(t,e,n),o=this._zoomOut.touchend(t,e,n);return r?(this._active=!0,t.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(r)},{originalEvent:t})}}):o?(this._active=!0,t.preventDefault(),setTimeout((function(){return i.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(o)},{originalEvent:t})}}):void 0},Wi.prototype.touchcancel=function(){this.reset()},Wi.prototype.enable=function(){this._enabled=!0},Wi.prototype.disable=function(){this._enabled=!1,this.reset()},Wi.prototype.isEnabled=function(){return this._enabled},Wi.prototype.isActive=function(){return this._active};var Gi={0:1,2:2},qi=function(t){this.reset(),this._clickTolerance=t.clickTolerance||1};qi.prototype.blur=function(){this.reset()},qi.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},qi.prototype._correctButton=function(t,e){return!1},qi.prototype._move=function(t,e){return{}},qi.prototype.mousedown=function(t,e){if(!this._lastPoint){var i=n.mouseButton(t);this._correctButton(t,i)&&(this._lastPoint=e,this._eventButton=i)}},qi.prototype.mousemoveWindow=function(t,e){var n=this._lastPoint;if(n)if(t.preventDefault(),function(t,e){var n=Gi[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(n,e)},qi.prototype.mouseupWindow=function(t){this._lastPoint&&n.mouseButton(t)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},qi.prototype.enable=function(){this._enabled=!0},qi.prototype.disable=function(){this._enabled=!1,this.reset()},qi.prototype.isEnabled=function(){return this._enabled},qi.prototype.isActive=function(){return this._active};var Zi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.mousedown=function(e,n){t.prototype.mousedown.call(this,e,n),this._lastPoint&&(this._active=!0)},e.prototype._correctButton=function(t,e){return 0===e&&!t.ctrlKey},e.prototype._move=function(t,e){return{around:e,panDelta:e.sub(t)}},e}(qi),Hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=.8*(e.x-t.x);if(n)return this._active=!0,{bearingDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(qi),Xi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var n=-.5*(e.y-t.y);if(n)return this._active=!0,{pitchDelta:n}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(qi),Yi=function(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()};Yi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)},Yi.prototype.touchstart=function(t,e,n){return this._calculateTransform(t,e,n)},Yi.prototype.touchmove=function(t,e,n){if(this._active&&!(n.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,n)},Yi.prototype.touchend=function(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this._minTouches&&this.reset()},Yi.prototype.touchcancel=function(){this.reset()},Yi.prototype._calculateTransform=function(e,n,i){i.length>0&&(this._active=!0);var r=Ni(i,n),o=new t.Point(0,0),a=new t.Point(0,0),s=0;for(var l in r){var c=r[l],u=this._touches[l];u&&(o._add(c),a._add(c.sub(u)),s++,r[l]=c)}if(this._touches=r,!(s<this._minTouches)&&a.mag()){var h=a.div(s);if(this._sum._add(h),!(this._sum.mag()<this._clickTolerance))return{around:o.div(s),panDelta:h}}},Yi.prototype.enable=function(){this._enabled=!0},Yi.prototype.disable=function(){this._enabled=!1,this.reset()},Yi.prototype.isEnabled=function(){return this._enabled},Yi.prototype.isActive=function(){return this._active};var Ki=function(){this.reset()};function Ji(t,e,n){for(var i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function Qi(t,e){return Math.log(t/e)/Math.LN2}Ki.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ki.prototype._start=function(t){},Ki.prototype._move=function(t,e,n){return{}},Ki.prototype.touchstart=function(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))},Ki.prototype.touchmove=function(t,e,n){if(this._firstTwoTouches){t.preventDefault();var i=this._firstTwoTouches,r=i[1],o=Ji(n,e,i[0]),a=Ji(n,e,r);if(o&&a){var s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,t)}}},Ki.prototype.touchend=function(t,e,i){if(this._firstTwoTouches){var r=this._firstTwoTouches,o=r[1],a=Ji(i,e,r[0]),s=Ji(i,e,o);a&&s||(this._active&&n.suppressClick(),this.reset())}},Ki.prototype.touchcancel=function(){this.reset()},Ki.prototype.enable=function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around},Ki.prototype.disable=function(){this._enabled=!1,this.reset()},Ki.prototype.isEnabled=function(){return this._enabled},Ki.prototype.isActive=function(){return this._active};var $i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._distance,delete this._startDistance},e.prototype._start=function(t){this._startDistance=this._distance=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Qi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qi(this._distance,n),pinchAround:e}},e}(Ki);function tr(t,e){return 180*t.angleWith(e)/Math.PI}var er=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},e.prototype._start=function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])},e.prototype._move=function(t,e){var n=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:tr(this._vector,n),pinchAround:e}},e.prototype._isBelowThreshold=function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,n=tr(t,this._startVector);return Math.abs(n)<e},e}(Ki);function nr(t){return Math.abs(t.y)>Math.abs(t.x)}var ir=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},e.prototype._start=function(t){this._lastPoints=t,nr(t[0].sub(t[1]))&&(this._valid=!1)},e.prototype._move=function(t,e,n){var i=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(i,r,n.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+r.y)/2*-.5}},e.prototype.gestureBeginsVertically=function(t,e,n){if(void 0!==this._valid)return this._valid;var i=t.mag()>=2,r=e.mag()>=2;if(i||r){if(!i||!r)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;var o=t.y>0==e.y>0;return nr(t)&&nr(e)&&o}},e}(Ki),rr={panStep:100,bearingStep:15,pitchStep:10},or=function(){var t=rr;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1};function ar(t){return t*(2-t)}or.prototype.blur=function(){this.reset()},or.prototype.reset=function(){this._active=!1},or.prototype.keydown=function(t){var e=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var n=0,i=0,r=0,o=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),o=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),o=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(i=0,r=0),{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:ar,zoom:n?Math.round(l)+n*(t.shiftKey?2:1):l,bearing:s.getBearing()+i*e._bearingStep,pitch:s.getPitch()+r*e._pitchStep,offset:[-o*e._panStep,-a*e._panStep],center:s.getCenter()},{originalEvent:t})}}}},or.prototype.enable=function(){this._enabled=!0},or.prototype.disable=function(){this._enabled=!1,this.reset()},or.prototype.isEnabled=function(){return this._enabled},or.prototype.isActive=function(){return this._active},or.prototype.disableRotation=function(){this._rotationDisabled=!0},or.prototype.enableRotation=function(){this._rotationDisabled=!1};var sr=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,t.bindAll(["_onTimeout"],this)};sr.prototype.setZoomRate=function(t){this._defaultZoomRate=t},sr.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},sr.prototype.isEnabled=function(){return!!this._enabled},sr.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},sr.prototype.isZooming=function(){return!!this._zooming},sr.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},sr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},sr.prototype.wheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,i=t.browser.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}},sr.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},sr.prototype._start=function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var i=n.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},sr.prototype.renderFrame=function(){var e=this;if(this._frameId&&(this._frameId=null,this.isActive())){var n=this._map.transform;if(0!==this._delta){var i="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,r=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==r&&(r=1/r);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*r))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a,s="number"==typeof this._targetZoom?this._targetZoom:n.zoom,l=this._startZoom,c=this._easing,u=!1;if("wheel"===this._type&&l&&c){var h=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),p=c(h);a=t.number(l,s,p),h<1?this._frameId||(this._frameId=!0):u=!0}else a=s,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._handler._triggerRenderFrame(),delete e._targetZoom,delete e._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:a-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},sr.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var i=this._prevEase,r=(t.browser.now()-i.start)/i.duration,o=i.easing(r+.01)-i.easing(r),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:n},n},sr.prototype.blur=function(){this.reset()},sr.prototype.reset=function(){this._active=!1};var lr=function(t,e){this._clickZoom=t,this._tapZoom=e};lr.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},lr.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},lr.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},lr.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var cr=function(){this.reset()};cr.prototype.reset=function(){this._active=!1},cr.prototype.blur=function(){this.reset()},cr.prototype.dblclick=function(t,e){return t.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(t.shiftKey?-1:1),around:n.unproject(e)},{originalEvent:t})}}},cr.prototype.enable=function(){this._enabled=!0},cr.prototype.disable=function(){this._enabled=!1,this.reset()},cr.prototype.isEnabled=function(){return this._enabled},cr.prototype.isActive=function(){return this._active};var ur=function(){this._tap=new Ui({numTouches:1,numTaps:1}),this.reset()};ur.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ur.prototype.touchstart=function(t,e,n){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=e[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(t,e,n))},ur.prototype.touchmove=function(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var i=e[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,n)},ur.prototype.touchend=function(t,e,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(t,e,n)&&(this._tapTime=t.timeStamp)},ur.prototype.touchcancel=function(){this.reset()},ur.prototype.enable=function(){this._enabled=!0},ur.prototype.disable=function(){this._enabled=!1,this.reset()},ur.prototype.isEnabled=function(){return this._enabled},ur.prototype.isActive=function(){return this._active};var hr=function(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n};hr.prototype.enable=function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},hr.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},hr.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},hr.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var pr=function(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n};pr.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},pr.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},pr.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},pr.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var dr=function(t,e,n,i){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0};dr.prototype.enable=function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},dr.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},dr.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},dr.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},dr.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},dr.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var fr=function(t){return t.zoom||t.drag||t.pitch||t.rotate},gr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(t.Event);function mr(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}var yr=function(e,i){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ii(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(i),t.bindAll(["handleEvent","handleWindowEvent"],this);var r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[t.window,"blur",void 0]];for(var o=0,a=this._listeners;o<a.length;o+=1){var s=a[o],l=s[0];n.addEventListener(l,s[1],l===t.window.document?this.handleWindowEvent:this.handleEvent,s[2])}};yr.prototype.destroy=function(){for(var e=0,i=this._listeners;e<i.length;e+=1){var r=i[e],o=r[0];n.removeEventListener(o,r[1],o===t.window.document?this.handleWindowEvent:this.handleEvent,r[2])}},yr.prototype._addDefaultHandlers=function(t){var e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Fi(e,t));var i=e.boxZoom=new ji(e,t);this._add("boxZoom",i);var r=new Wi,o=new cr;e.doubleClickZoom=new lr(o,r),this._add("tapZoom",r),this._add("clickZoom",o);var a=new ur;this._add("tapDragZoom",a);var s=e.touchPitch=new ir;this._add("touchPitch",s);var l=new Hi(t),c=new Xi(t);e.dragRotate=new pr(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);var u=new Zi(t),h=new Yi(t);e.dragPan=new hr(n,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);var p=new er,d=new $i;e.touchZoomRotate=new dr(n,d,p,a),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]);var f=e.scrollZoom=new sr(e,this);this._add("scrollZoom",f,["mousePan"]);var g=e.keyboard=new or;this._add("keyboard",g),this._add("blockableMapEvent",new Bi(e));for(var m=0,y=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];m<y.length;m+=1){var v=y[m];t.interactive&&t[v]&&e[v].enable(t[v])}},yr.prototype._add=function(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e},yr.prototype.stop=function(t){if(!this._updatingCamera){for(var e=0,n=this._handlers;e<n.length;e+=1)n[e].handler.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}},yr.prototype.isActive=function(){for(var t=0,e=this._handlers;t<e.length;t+=1)if(e[t].handler.isActive())return!0;return!1},yr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},yr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},yr.prototype.isMoving=function(){return Boolean(fr(this._eventsInProgress))||this.isZooming()},yr.prototype._blockedByActive=function(t,e,n){for(var i in t)if(i!==n&&(!e||e.indexOf(i)<0))return!0;return!1},yr.prototype.handleWindowEvent=function(t){this.handleEvent(t,t.type+"Window")},yr.prototype._getMapTouches=function(t){for(var e=[],n=0,i=t;n<i.length;n+=1){var r=i[n];this._el.contains(r.target)&&e.push(r)}return e},yr.prototype.handleEvent=function(t,e){this._updatingCamera=!0;for(var i="renderFrame"===t.type?void 0:t,r={needsRenderFrame:!1},o={},a={},s=t.touches?this._getMapTouches(t.touches):void 0,l=s?n.touchPos(this._el,s):n.mousePos(this._el,t),c=0,u=this._handlers;c<u.length;c+=1){var h=u[c],p=h.handlerName,d=h.handler,f=h.allowed;if(d.isEnabled()){var g=void 0;this._blockedByActive(a,f,p)?d.reset():d[e||t.type]&&(g=d[e||t.type](t,l,s),this.mergeHandlerResult(r,o,g,p,i),g&&g.needsRenderFrame&&this._triggerRenderFrame()),(g||d.isActive())&&(a[p]=d)}}var m={};for(var y in this._previousActiveHandlers)a[y]||(m[y]=i);this._previousActiveHandlers=a,(Object.keys(m).length||mr(r))&&(this._changes.push([r,o,m]),this._triggerRenderFrame()),(Object.keys(a).length||mr(r))&&this._map._stop(!0),this._updatingCamera=!1;var v=r.cameraAnimation;v&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],v(this._map))},yr.prototype.mergeHandlerResult=function(e,n,i,r,o){if(i){t.extend(e,i);var a={handlerName:r,originalEvent:i.originalEvent||o};void 0!==i.zoomDelta&&(n.zoom=a),void 0!==i.panDelta&&(n.drag=a),void 0!==i.pitchDelta&&(n.pitch=a),void 0!==i.bearingDelta&&(n.rotate=a)}},yr.prototype._applyChanges=function(){for(var e={},n={},i={},r=0,o=this._changes;r<o.length;r+=1){var a=o[r],s=a[0],l=a[1],c=a[2];s.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(e.around=s.around),void 0!==s.pinchAround&&(e.pinchAround=s.pinchAround),s.noInertia&&(e.noInertia=s.noInertia),t.extend(n,l),t.extend(i,c)}this._updateMapTransform(e,n,i),this._changes=[]},yr.prototype._updateMapTransform=function(t,e,n){var i=this._map,r=i.transform;if(!mr(t))return this._fireEvents(e,n,!0);var o=t.panDelta,a=t.zoomDelta,s=t.bearingDelta,l=t.pitchDelta,c=t.around,u=t.pinchAround;void 0!==u&&(c=u),i._stop(!0),c=c||i.transform.centerPoint;var h=r.pointLocation(o?c.sub(o):c);s&&(r.bearing+=s),l&&(r.pitch+=l),a&&(r.zoom+=a),r.setLocationAtPoint(h,c),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,n,!0)},yr.prototype._fireEvents=function(e,n,i){var r=this,o=fr(this._eventsInProgress),a=fr(e),s={};for(var l in e)this._eventsInProgress[l]||(s[l+"start"]=e[l].originalEvent),this._eventsInProgress[l]=e[l];for(var c in!o&&a&&this._fireEvent("movestart",a.originalEvent),s)this._fireEvent(c,s[c]);for(var u in a&&this._fireEvent("move",a.originalEvent),e)this._fireEvent(u,e[u].originalEvent);var h,p={};for(var d in this._eventsInProgress){var f=this._eventsInProgress[d],g=f.handlerName,m=f.originalEvent;this._handlersById[g].isActive()||(delete this._eventsInProgress[d],p[d+"end"]=h=n[g]||m)}for(var y in p)this._fireEvent(y,p[y]);var v=fr(this._eventsInProgress);if(i&&(o||a)&&!v){this._updatingCamera=!0;var _=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),b=function(t){return 0!==t&&-r._bearingSnap<t&&t<r._bearingSnap};_?(b(_.bearing||this._map.getBearing())&&(_.bearing=0),this._map.easeTo(_,{originalEvent:h})):(this._map.fire(new t.Event("moveend",{originalEvent:h})),b(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},yr.prototype._fireEvent=function(e,n){this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},yr.prototype._requestFrame=function(){var t=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(e){delete t._frameId,t.handleEvent(new gr("renderFrame",{timeStamp:e})),t._applyChanges()}))},yr.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var vr=function(e){function n(n,i){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=i.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCenter=function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,i){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),i)},n.prototype.panTo=function(e,n,i){return this.easeTo(t.extend({center:e},n),i)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,i){return this.easeTo(t.extend({zoom:e},n),i)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.getPadding=function(){return this.transform.padding},n.prototype.setPadding=function(t,e){return this.jumpTo({padding:t},e),this},n.prototype.rotateTo=function(e,n,i){return this.easeTo(t.extend({bearing:e},n),i)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.resetNorthPitch=function(e,n){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(e,n){e=t.LngLatBounds.convert(e);var i=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),i,n)},n.prototype._cameraForBoxAndBearing=function(e,n,i,r){var o={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=t.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){var a=r.padding;r.padding={top:a,bottom:a,right:a,left:a}}r.padding=t.extend(o,r.padding);var s=this.transform,l=s.padding,c=s.project(t.LngLat.convert(e)),u=s.project(t.LngLat.convert(n)),h=c.rotate(-i*Math.PI/180),p=u.rotate(-i*Math.PI/180),d=new t.Point(Math.max(h.x,p.x),Math.max(h.y,p.y)),f=new t.Point(Math.min(h.x,p.x),Math.min(h.y,p.y)),g=d.sub(f),m=(s.width-(l.left+l.right+r.padding.left+r.padding.right))/g.x,y=(s.height-(l.top+l.bottom+r.padding.top+r.padding.bottom))/g.y;if(!(y<0||m<0)){var v=Math.min(s.scaleZoom(s.scale*Math.min(m,y)),r.maxZoom),_="number"==typeof r.offset.x?new t.Point(r.offset.x,r.offset.y):t.Point.convert(r.offset),b=new t.Point((r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2).rotate(i*Math.PI/180),x=_.add(b).mult(s.scale/s.zoomScale(v));return{center:s.unproject(c.add(u).div(2).sub(x)),zoom:v,bearing:i}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},n.prototype.fitBounds=function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)},n.prototype.fitScreenCoordinates=function(e,n,i,r,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(n)),i,r),r,o)},n.prototype._fitInternal=function(e,n,i){return e?(delete(n=t.extend(e,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this},n.prototype.jumpTo=function(e,n){this.stop();var i=this.transform,r=!1,o=!1,a=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(r=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.LngLat.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(o=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(a=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),r&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var i=this;this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.browser.prefersReducedMotion)&&(e.duration=0);var r=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),l=this.getPadding(),c="zoom"in e?+e.zoom:o,u="bearing"in e?this._normalizeBearing(e.bearing,a):a,h="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:r.padding,d=t.Point.convert(e.offset),f=r.centerPoint.add(d),g=r.pointLocation(f),m=t.LngLat.convert(e.center||g);this._normalizeCenter(m);var y,v,_=r.project(g),b=r.project(m).sub(_),x=r.zoomScale(c-o);e.around&&(y=t.LngLat.convert(e.around),v=r.locationPoint(y));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||c!==o,this._rotating=this._rotating||a!==u,this._pitching=this._pitching||h!==s,this._padding=!r.isPaddingEqual(p),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,w),this._ease((function(e){if(i._zooming&&(r.zoom=t.number(o,c,e)),i._rotating&&(r.bearing=t.number(a,u,e)),i._pitching&&(r.pitch=t.number(s,h,e)),i._padding&&(r.interpolatePadding(l,p,e),f=r.centerPoint.add(d)),y)r.setLocationAtPoint(y,v);else{var g=r.zoomScale(r.zoom-o),m=c>o?Math.min(2,x):Math.max(.5,x),w=Math.pow(m,1-e),S=r.unproject(_.add(b.mult(e*w)).mult(g));r.setLocationAtPoint(r.renderWorldCopies?S.wrap():S,f)}i._fireMoveEvents(n)}),(function(t){i._afterEase(n,t)}),e),this},n.prototype._prepareEase=function(e,n,i){void 0===i&&(i={}),this._moving=!0,n||i.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e,n){if(!this._easeId||!n||this._easeId!==n){delete this._easeId;var i=this._zooming,r=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}},n.prototype.flyTo=function(e,n){var i=this;if(!e.essential&&t.browser.prefersReducedMotion){var r=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,n)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var o=this.transform,a=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="zoom"in e?t.clamp(+e.zoom,o.minZoom,o.maxZoom):a,h="bearing"in e?this._normalizeBearing(e.bearing,s):s,p="pitch"in e?+e.pitch:l,d="padding"in e?e.padding:o.padding,f=o.zoomScale(u-a),g=t.Point.convert(e.offset),m=o.centerPoint.add(g),y=o.pointLocation(m),v=t.LngLat.convert(e.center||y);this._normalizeCenter(v);var _=o.project(y),b=o.project(v).sub(_),x=e.curve,w=Math.max(o.width,o.height),S=w/f,P=b.mag();if("minZoom"in e){var E=t.clamp(Math.min(e.minZoom,a,u),o.minZoom,o.maxZoom),T=w/o.zoomScale(E-a);x=Math.sqrt(T/P*2)}var k=x*x;function A(t){var e=(S*S-w*w+(t?-1:1)*k*k*P*P)/(2*(t?S:w)*k*P);return Math.log(Math.sqrt(e*e+1)-e)}function C(t){return(Math.exp(t)-Math.exp(-t))/2}function M(t){return(Math.exp(t)+Math.exp(-t))/2}var I=A(0),L=function(t){return M(I)/M(I+x*t)},O=function(t){return w*((M(I)*(C(e=I+x*t)/M(e))-C(I))/k)/P;var e},z=(A(1)-I)/x;if(Math.abs(P)<1e-6||!isFinite(z)){if(Math.abs(w-S)<1e-6)return this.easeTo(e,n);var R=S<w?-1:1;z=Math.abs(Math.log(S/w))/x,O=function(){return 0},L=function(t){return Math.exp(R*x*t)}}return e.duration="duration"in e?+e.duration:1e3*z/("screenSpeed"in e?+e.screenSpeed/x:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==h,this._pitching=p!==l,this._padding=!o.isPaddingEqual(d),this._prepareEase(n,!1),this._ease((function(e){var r=e*z,f=1/L(r);o.zoom=1===e?u:a+o.scaleZoom(f),i._rotating&&(o.bearing=t.number(s,h,e)),i._pitching&&(o.pitch=t.number(l,p,e)),i._padding&&(o.interpolatePadding(c,d,e),m=o.centerPoint.add(g));var y=1===e?v:o.unproject(_.add(b.mult(O(r))).mult(f));o.setLocationAtPoint(o.renderWorldCopies?y.wrap():y,m),i._fireMoveEvents(n)}),(function(){return i._afterEase(n)}),e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){return this._stop()},n.prototype._stop=function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var n=this._onEaseEnd;delete this._onEaseEnd,n.call(this,e)}if(!t){var i=this.handlers;i&&i.stop(!1)}return this},n.prototype._ease=function(e,n,i){!1===i.animate||0===i.duration?(e(1),n()):(this._easeStart=t.browser.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),_r=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};_r.prototype.getDefaultPosition=function(){return"bottom-right"},_r.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=n.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},_r.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},_r.prototype._setElementTitle=function(t,e){var n=this._map._getUIString("AttributionControl."+e);t.title=n,t.setAttribute("aria-label",n)},_r.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},_r.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){var i=n.reduce((function(t,e,i){return e.value&&(t+=e.key+"="+e.value+(i<n.length-1?"&":"")),t}),"?");e.href=t.config.FEEDBACK_URL+"/"+i+(this._map._hash?this._map._hash.getHashString(!0):""),e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}},_r.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},_r.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var i in n){var r=n[i];if(r.used){var o=r.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}t.sort((function(t,e){return t.length-e.length}));var a=(t=t.filter((function(e,n){for(var i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,t.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},_r.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var br=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};br.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},br.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},br.prototype.getDefaultPosition=function(){return"bottom-left"},br.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},br.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},br.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var xr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};xr.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},xr.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,i=e?this._queue.concat(e):this._queue;n<i.length;n+=1){var r=i[n];if(r.id===t)return void(r.cancelled=!0)}},xr.prototype.run=function(t){void 0===t&&(t=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,i=e;n<i.length;n+=1){var r=i[n];if(!r.cancelled&&(r.callback(t),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},xr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var wr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Sr=t.window.HTMLImageElement,Pr=t.window.HTMLElement,Er=t.window.ImageBitmap,Tr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},kr=function(i){function r(e){var n=this;if(null!=(e=t.extend({},Tr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var r=new Si(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(i.call(this,r,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new xr,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},wr,e.locale),this._clickTolerance=e.clickTolerance,this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken),"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof Pr))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return n._update(!1)})),this.on("moveend",(function(){return n._update(!1)})),this.on("zoom",(function(){return n._update(!0)})),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new yr(this,e),this._hash=e.hash&&new Ei("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new _r({customAttribution:e.customAttribution})),this.addControl(new br,e.logoPosition),this.on("style.load",(function(){n.transform.unmodified&&n.jumpTo(n.style.stylesheet)})),this.on("data",(function(e){n._update("style"===e.dataType),n.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(function(e){n.fire(new t.Event(e.dataType+"dataloading",e))}))}i&&(r.__proto__=i),(r.prototype=Object.create(i&&i.prototype)).constructor=r;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return r.prototype._getMapId=function(){return this._mapId},r.prototype.addControl=function(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var i=e.onAdd(this);this._controls.push(e);var r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this},r.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this},r.prototype.hasControl=function(t){return this._controls.indexOf(t)>-1},r.prototype.resize=function(e){var n=this._containerDimensions(),i=n[0],r=n[1];if(i===this.transform.width&&r===this.transform.height)return this;this._resizeCanvas(i,r),this.transform.resize(i,r),this.painter.resize(i,r);var o=!this._moving;return o&&this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this},r.prototype.getBounds=function(){return this.transform.getBounds()},r.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},r.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},r.prototype.setMinZoom=function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},r.prototype.getMinZoom=function(){return this.transform.minZoom},r.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},r.prototype.getMaxZoom=function(){return this.transform.maxZoom},r.prototype.setMinPitch=function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},r.prototype.getMinPitch=function(){return this.transform.minPitch},r.prototype.setMaxPitch=function(t){if((t=null==t?60:t)>60)throw new Error("maxPitch must be less than or equal to 60");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},r.prototype.getMaxPitch=function(){return this.transform.maxPitch},r.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},r.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},r.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},r.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},r.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},r.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},r.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},r.prototype._createDelegatedListener=function(t,e,n){var i,r=this;if("mouseenter"===t||"mouseover"===t){var o=!1;return{layer:e,listener:n,delegates:{mousemove:function(i){var a=r.getLayer(e)?r.queryRenderedFeatures(i.point,{layers:[e]}):[];a.length?o||(o=!0,n.call(r,new zi(t,r,i.originalEvent,{features:a}))):o=!1},mouseout:function(){o=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:n,delegates:{mousemove:function(i){(r.getLayer(e)?r.queryRenderedFeatures(i.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,n.call(r,new zi(t,r,i.originalEvent)))},mouseout:function(e){a&&(a=!1,n.call(r,new zi(t,r,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(i={},i[t]=function(t){var i=r.getLayer(e)?r.queryRenderedFeatures(t.point,{layers:[e]}):[];i.length&&(t.features=i,n.call(r,t),delete t.features)},i)}},r.prototype.on=function(t,e,n){if(void 0===n)return i.prototype.on.call(this,t,e);var r=this._createDelegatedListener(t,e,n);for(var o in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r),r.delegates)this.on(o,r.delegates[o]);return this},r.prototype.once=function(t,e,n){if(void 0===n)return i.prototype.once.call(this,t,e);var r=this._createDelegatedListener(t,e,n);for(var o in r.delegates)this.once(o,r.delegates[o]);return this},r.prototype.off=function(t,e,n){var r=this;return void 0===n?i.prototype.off.call(this,t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&function(i){for(var o=i[t],a=0;a<o.length;a++){var s=o[a];if(s.layer===e&&s.listener===n){for(var l in s.delegates)r.off(l,s.delegates[l]);return o.splice(a,1),r}}}(this._delegatedListeners),this)},r.prototype.queryRenderedFeatures=function(e,n){if(!this.style)return[];var i;if(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])i=[t.Point.convert(e)];else{var r=t.Point.convert(e[0]),o=t.Point.convert(e[1]);i=[r,new t.Point(o.x,r.y),o,new t.Point(r.x,o.y),r]}return this.style.queryRenderedFeatures(i,n,this.transform)},r.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},r.prototype.setStyle=function(e,n){return!1!==(n=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))},r.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},r.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new We(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},r.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new We(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},r.prototype._diffStyle=function(e,n){var i=this;if("string"==typeof e){var r=this._requestManager.normalizeStyleURL(e),o=this._requestManager.transformRequest(r,t.ResourceType.Style);t.getJSON(o,(function(e,r){e?i.fire(new t.ErrorEvent(e)):r&&i._updateDiff(r,n)}))}else"object"==typeof e&&this._updateDiff(e,n)},r.prototype._updateDiff=function(e,n){try{this.style.setState(e)&&this._update(!0)}catch(i){t.warnOnce("Unable to perform style diff: "+(i.message||i.error||i)+".  Rebuilding the style from scratch."),this._updateStyle(e,n)}},r.prototype.getStyle=function(){if(this.style)return this.style.serialize()},r.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},r.prototype.addSource=function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)},r.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},r.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var i in n){var r=n[i];if("loaded"!==r.state&&"errored"!==r.state)return!1}}return!0},r.prototype.addSourceType=function(t,e,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,n)},r.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},r.prototype.getSource=function(t){return this.style.getSource(t)},r.prototype.addImage=function(e,n,i){void 0===i&&(i={});var r=i.pixelRatio;void 0===r&&(r=1);var o=i.sdf;void 0===o&&(o=!1);var a=i.stretchX,s=i.stretchY,l=i.content;if(this._lazyInitEmptyStyle(),n instanceof Sr||Er&&n instanceof Er){var c=t.browser.getImageData(n);this.style.addImage(e,{data:new t.RGBAImage({width:c.width,height:c.height},c.data),pixelRatio:r,stretchX:a,stretchY:s,content:l,sdf:o,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var u=n;this.style.addImage(e,{data:new t.RGBAImage({width:n.width,height:n.height},new Uint8Array(n.data)),pixelRatio:r,stretchX:a,stretchY:s,content:l,sdf:o,version:0,userImage:u}),u.onAdd&&u.onAdd(this,e)}},r.prototype.updateImage=function(e,n){var i=this.style.getImage(e);if(!i)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var r=n instanceof Sr||Er&&n instanceof Er?t.browser.getImageData(n):n,o=r.width,a=r.height,s=r.data;return void 0===o||void 0===a?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==i.data.width||a!==i.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(i.data.replace(s,!(n instanceof Sr||Er&&n instanceof Er)),void this.style.updateImage(e,i))},r.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},r.prototype.removeImage=function(t){this.style.removeImage(t)},r.prototype.loadImage=function(e,n){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),n)},r.prototype.listImages=function(){return this.style.listImages()},r.prototype.addLayer=function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)},r.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},r.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},r.prototype.getLayer=function(t){return this.style.getLayer(t)},r.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)},r.prototype.setFilter=function(t,e,n){return void 0===n&&(n={}),this.style.setFilter(t,e,n),this._update(!0)},r.prototype.getFilter=function(t){return this.style.getFilter(t)},r.prototype.setPaintProperty=function(t,e,n,i){return void 0===i&&(i={}),this.style.setPaintProperty(t,e,n,i),this._update(!0)},r.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},r.prototype.setLayoutProperty=function(t,e,n,i){return void 0===i&&(i={}),this.style.setLayoutProperty(t,e,n,i),this._update(!0)},r.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},r.prototype.setLight=function(t,e){return void 0===e&&(e={}),this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)},r.prototype.getLight=function(){return this.style.getLight()},r.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},r.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},r.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},r.prototype.getContainer=function(){return this._container},r.prototype.getCanvasContainer=function(){return this._canvasContainer},r.prototype.getCanvas=function(){return this._canvas},r.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},r.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},r.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);var r=this._controlContainer=n.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){o[t]=n.create("div","mapboxgl-ctrl-"+t,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)},r.prototype._resizeCanvas=function(e,n){var i=t.browser.devicePixelRatio||1;this._canvas.width=i*e,this._canvas.height=i*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},r.prototype._setupPainter=function(){var n=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);i?(this.painter=new _i(i,this.transform),t.webpSupported.testSupport(i)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},r.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},r.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},r.prototype._onMapScroll=function(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},r.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},r.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},r.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},r.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},r.prototype._render=function(e){var n,i=this,r=0,o=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,n),r=t.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){var a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=t.browser.now();this.style.zoomHistory.update(s,l);var c=new t.EvaluationParameters(s,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=c.crossFadingFactor();1===u&&u===this._crossFadingFactor||(a=!0,this._crossFadingFactor=u),this.style.update(c)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var h=t.browser.now()-r;o.endQueryEXT(o.TIME_ELAPSED_EXT,n),setTimeout((function(){var e=o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(n),i.fire(new t.Event("gpu-timing-frame",{cpuTime:h,gpuTime:e}))}),50)}if(this.listens("gpu-timing-layer")){var p=this.painter.collectGpuTimers();setTimeout((function(){var e=i.painter.queryGpuTimers(p);i.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}var d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0),this}},r.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,n=this._controls;e<n.length;e+=1)n[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),Ar(this._canvasContainer),Ar(this._controlContainer),Ar(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new t.Event("remove"))},r.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame((function(t){e._frame=null,e._render(t)})))},r.prototype._onWindowOnline=function(){this._update()},r.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(t){this._showPadding!==t&&(this._showPadding=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},r.prototype._setCacheLimits=function(e,n){t.setCacheLimits(e,n)},o.version.get=function(){return t.version},Object.defineProperties(r.prototype,o),r}(vr);function Ar(t){t.parentNode&&t.parentNode.removeChild(t)}var Cr={showCompass:!0,showZoom:!0,visualizePitch:!1},Mr=function(e){var i=this;this.options=t.extend({},Cr,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(t){return i._map.zoomIn({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(t){return i._map.zoomOut({},{originalEvent:t})})),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(t){i.options.visualizePitch?i._map.resetNorthPitch({},{originalEvent:t}):i._map.resetNorth({},{originalEvent:t})})),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Mr.prototype._updateZoomButtons=function(){var t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Mr.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},Mr.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ir(this._map,this._compass,this.options.visualizePitch)),this._container},Mr.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Mr.prototype._createButton=function(t,e){var i=n.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i},Mr.prototype._setButtonTitle=function(t,e){var n=this._map._getUIString("NavigationControl."+e);t.title=n,t.setAttribute("aria-label",n)};var Ir=function(e,i,r){void 0===r&&(r=!1),this._clickTolerance=10,this.element=i,this.mouseRotate=new Hi({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,r&&(this.mousePitch=new Xi({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(i,"mousedown",this.mousedown),n.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(i,"touchmove",this.touchmove),n.addEventListener(i,"touchend",this.touchend),n.addEventListener(i,"touchcancel",this.reset)};function Lr(e,n,i){if(e=new t.LngLat(e.lng,e.lat),n){var r=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=i.locationPoint(e).distSqr(n);i.locationPoint(r).distSqr(n)<a?e=r:i.locationPoint(o).distSqr(n)<a&&(e=o)}for(;Math.abs(e.lng-i.center.lng)>180;){var s=i.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=i.width&&s.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e}Ir.prototype.down=function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),n.disableDrag()},Ir.prototype.move=function(t,e){var n=this.map,i=this.mouseRotate.mousemoveWindow(t,e);if(i&&i.bearingDelta&&n.setBearing(n.getBearing()+i.bearingDelta),this.mousePitch){var r=this.mousePitch.mousemoveWindow(t,e);r&&r.pitchDelta&&n.setPitch(n.getPitch()+r.pitchDelta)}},Ir.prototype.off=function(){var t=this.element;n.removeEventListener(t,"mousedown",this.mousedown),n.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(t,"touchmove",this.touchmove),n.removeEventListener(t,"touchend",this.touchend),n.removeEventListener(t,"touchcancel",this.reset),this.offTemp()},Ir.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(t.window,"mousemove",this.mousemove),n.removeEventListener(t.window,"mouseup",this.mouseup)},Ir.prototype.mousedown=function(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:function(){return e.preventDefault()}}),n.mousePos(this.element,e)),n.addEventListener(t.window,"mousemove",this.mousemove),n.addEventListener(t.window,"mouseup",this.mouseup)},Ir.prototype.mousemove=function(t){this.move(t,n.mousePos(this.element,t))},Ir.prototype.mouseup=function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()},Ir.prototype.touchstart=function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))},Ir.prototype.touchmove=function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=n.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))},Ir.prototype.touchend=function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ir.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Or={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zr(t,e,n){var i=t.classList;for(var r in Or)i.remove("mapboxgl-"+n+"-anchor-"+r);i.add("mapboxgl-"+n+"-anchor-"+e)}var Rr,Dr=function(e){function i(i,r){if(e.call(this),(i instanceof t.window.HTMLElement||r)&&(i=t.extend({element:i},r)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&"auto"!==i.pitchAlignment?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=t.Point.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var o=n.createNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","41px"),o.setAttributeNS(null,"width","27px"),o.setAttributeNS(null,"viewBox","0 0 27 41");var a=n.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");var s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");var l=n.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");for(var c=0,u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];c<u.length;c+=1){var h=u[c],p=n.createNS("http://www.w3.org/2000/svg","ellipse");p.setAttributeNS(null,"opacity","0.04"),p.setAttributeNS(null,"cx","10.5"),p.setAttributeNS(null,"cy","5.80029008"),p.setAttributeNS(null,"rx",h.rx),p.setAttributeNS(null,"ry",h.ry),l.appendChild(p)}var d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var f=n.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(f);var g=n.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"fill","#000000");var m=n.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),g.appendChild(m);var y=n.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),y.setAttributeNS(null,"fill","#FFFFFF");var v=n.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _=n.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000"),_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962");var b=n.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#FFFFFF"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962"),v.appendChild(_),v.appendChild(b),s.appendChild(l),s.appendChild(d),s.appendChild(g),s.appendChild(y),s.appendChild(v),o.appendChild(s),o.setAttributeNS(null,"height",41*this._scale+"px"),o.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(o),this._offset=t.Point.convert(i&&i.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(t){t.preventDefault()})),this._element.addEventListener("mousedown",(function(t){t.preventDefault()})),zr(this._element,this._anchor,"marker"),this._popup=null}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},i.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},i.prototype.getElement=function(){return this._element},i.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},i.prototype._onKeyPress=function(t){var e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()},i.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},i.prototype.getPopup=function(){return this._popup},i.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},i.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Lr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,Or[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+i+" "+e)}},i.prototype.getOffset=function(){return this._offset},i.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},i.prototype._onMove=function(e){if(!this._isDragging){var n=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=n}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))},i.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},i.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},i.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},i.prototype.isDraggable=function(){return this._draggable},i.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},i.prototype.getRotation=function(){return this._rotation},i.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},i.prototype.getRotationAlignment=function(){return this._rotationAlignment},i.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},i.prototype.getPitchAlignment=function(){return this._pitchAlignment},i}(t.Evented),Fr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Br=0,jr=!1,Nr=function(e){function i(n){e.call(this),this.options=t.extend({},Fr,n),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.onAdd=function(e){var i;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==Rr?i(Rr):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((function(t){i(Rr="denied"!==t.state)})):i(Rr=!!t.window.navigator.geolocation),this._container},i.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Br=0,jr=!1},i.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())},i.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},i.prototype._onSuccess=function(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}},i.prototype._updateCamera=function(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,r=this._map.getBearing(),o=t.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(i),o,{geolocateSource:!0})},i.prototype._updateMarker=function(e){if(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},i.prototype._updateCircleRadius=function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),n=this._map.unproject([1,t]),i=e.distanceTo(n),r=Math.ceil(2*this._accuracy/i);this._circleElement.style.width=r+"px",this._circleElement.style.height=r+"px"},i.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},i.prototype._onError=function(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&jr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}},i.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},i.prototype._setupUI=function(e){var i=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Dr(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Dr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==i._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(i._watchState="BACKGROUND",i._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),i._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),i.fire(new t.Event("trackuserlocationend")))}))},i.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Br--,jr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Br>1?(e={maximumAge:6e5,timeout:0},jr=!0):(e=this.options.positionOptions,jr=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},i.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},i}(t.Evented),Vr={maxWidth:100,unit:"metric"},Ur=function(e){this.options=t.extend({},Vr,e),t.bindAll(["_onMove","setUnit"],this)};function Wr(t,e,n){var i=n&&n.maxWidth||100,r=t._container.clientHeight/2,o=t.unproject([0,r]),a=t.unproject([i,r]),s=o.distanceTo(a);if(n&&"imperial"===n.unit){var l=3.2808*s;l>5280?Gr(e,i,l/5280,t._getUIString("ScaleControl.Miles")):Gr(e,i,l,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?Gr(e,i,s/1852,t._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Gr(e,i,s/1e3,t._getUIString("ScaleControl.Kilometers")):Gr(e,i,s,t._getUIString("ScaleControl.Meters"))}function Gr(t,e,n,i){var r,o,a,s=(r=n,(o=Math.pow(10,(""+Math.floor(r)).length-1))*(a=(a=r/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(a)));t.style.width=e*(s/n)+"px",t.innerHTML=s+"&nbsp;"+i}Ur.prototype.getDefaultPosition=function(){return"bottom-left"},Ur.prototype._onMove=function(){Wr(this._map,this._container,this.options)},Ur.prototype.onAdd=function(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ur.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ur.prototype.setUnit=function(t){this.options.unit=t,Wr(this._map,this._container,this.options)};var qr=function(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange")};qr.prototype.onAdd=function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},qr.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},qr.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},qr.prototype._setupUI=function(){var e=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},qr.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},qr.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},qr.prototype._isFullscreen=function(){return this._fullscreen},qr.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},qr.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Zr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Hr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Xr=function(e){function i(n){e.call(this),this.options=t.extend(Object.create(Zr),n),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.addTo=function(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this},i.prototype.isOpen=function(){return!!this._map},i.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},i.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},i.prototype.getElement=function(){return this._container},i.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},i.prototype.setHTML=function(e){var n,i=t.window.document.createDocumentFragment(),r=t.window.document.createElement("body");for(r.innerHTML=e;n=r.firstChild;)i.appendChild(n);return this.setDOMContent(i)},i.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},i.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},i.prototype.setDOMContent=function(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=n.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this},i.prototype.addClassName=function(t){this._container&&this._container.classList.add(t)},i.prototype.removeClassName=function(t){this._container&&this._container.classList.remove(t)},i.prototype.setOffset=function(t){return this.options.offset=t,this._update(),this},i.prototype.toggleClassName=function(t){if(this._container)return this._container.classList.toggle(t)},i.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},i.prototype._onMouseUp=function(t){this._update(t.point)},i.prototype._onMouseMove=function(t){this._update(t.point)},i.prototype._onDrag=function(t){this._update(t.point)},i.prototype._update=function(e){var i=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return i._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Lr(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var r=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),o=this.options.anchor,a=function e(n){if(n){if("number"==typeof n){var i=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.Point(0,0),top:new t.Point(0,n),"top-left":new t.Point(i,i),"top-right":new t.Point(-i,i),bottom:new t.Point(0,-n),"bottom-left":new t.Point(i,-i),"bottom-right":new t.Point(-i,-i),left:new t.Point(n,0),right:new t.Point(-n,0)}}if(n instanceof t.Point||Array.isArray(n)){var r=t.Point.convert(n);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.Point.convert(n.center||[0,0]),top:t.Point.convert(n.top||[0,0]),"top-left":t.Point.convert(n["top-left"]||[0,0]),"top-right":t.Point.convert(n["top-right"]||[0,0]),bottom:t.Point.convert(n.bottom||[0,0]),"bottom-left":t.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(n["bottom-right"]||[0,0]),left:t.Point.convert(n.left||[0,0]),right:t.Point.convert(n.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!o){var s,l=this._container.offsetWidth,c=this._container.offsetHeight;s=r.y+a.bottom.y<c?["top"]:r.y>this._map.transform.height-c?["bottom"]:[],r.x<l/2?s.push("left"):r.x>this._map.transform.width-l/2&&s.push("right"),o=0===s.length?"bottom":s.join("-")}var u=r.add(a[o]).round();n.setTransform(this._container,Or[o]+" translate("+u.x+"px,"+u.y+"px)"),zr(this._container,o,"popup")}},i.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var t=this._container.querySelector(Hr);t&&t.focus()}},i.prototype._onClose=function(){this.remove()},i}(t.Evented),Yr={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:kr,NavigationControl:Mr,GeolocateControl:Nr,AttributionControl:_r,ScaleControl:Ur,FullscreenControl:qr,Popup:Xr,Marker:Dr,Style:We,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,prewarm:function(){Bt().acquire(zt)},clearPrewarmedResources:function(){var t=Dt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(zt),Dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Rt.workerCount},set workerCount(t){Rt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:""};return Yr})),n}()},374:(t,e,n)=>{"use strict";var i=n(791),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var i,o={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(u=e.ref),e)a.call(e,i)&&!l.hasOwnProperty(i)&&(o[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===o[i]&&(o[i]=e[i]);return{$$typeof:r,type:t,key:c,ref:u,props:o,_owner:s.current}}e.jsx=c,e.jsxs=c},117:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),d=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||f}function v(){}function _(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var b=_.prototype=new v;b.constructor=_,g(b,y.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,i){var r,o={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)w.call(e,r)&&!P.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:t,key:a,ref:s,props:o,_owner:S.current}}function T(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var k=/\/+/g;function A(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function C(t,e,r,o,a){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var l=!1;if(null===t)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return a=a(l=t),t=""===o?"."+A(l,0):o,x(a)?(r="",null!=t&&(r=t.replace(k,"$&/")+"/"),C(a,e,r,"",(function(t){return t}))):null!=a&&(T(a)&&(a=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(k,"$&/")+"/")+t)),e.push(a)),1;if(l=0,o=""===o?".":o+":",x(t))for(var c=0;c<t.length;c++){var u=o+A(s=t[c],c);l+=C(s,e,r,u,a)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),c=0;!(s=t.next()).done;)l+=C(s=s.value,e,r,u=o+A(s,c++),a);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function M(t,e,n){if(null==t)return t;var i=[],r=0;return C(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function I(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var L={current:null},O={transition:null},z={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};e.Children={map:M,forEach:function(t,e,n){M(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return M(t,(function(){e++})),e},toArray:function(t){return M(t,(function(t){return t}))||[]},only:function(t){if(!T(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=r,e.Profiler=a,e.PureComponent=_,e.StrictMode=o,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,e.cloneElement=function(t,e,i){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=g({},t.props),o=t.key,a=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,s=S.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)w.call(e,c)&&!P.hasOwnProperty(c)&&(r[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:t.type,key:o,ref:a,props:r,_owner:s}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=T,e.lazy=function(t){return{$$typeof:p,_payload:{_status:-1,_result:t},_init:I}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=O.transition;O.transition={};try{t()}finally{O.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return L.current.useCallback(t,e)},e.useContext=function(t){return L.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return L.current.useDeferredValue(t)},e.useEffect=function(t,e){return L.current.useEffect(t,e)},e.useId=function(){return L.current.useId()},e.useImperativeHandle=function(t,e,n){return L.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return L.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return L.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return L.current.useMemo(t,e)},e.useReducer=function(t,e,n){return L.current.useReducer(t,e,n)},e.useRef=function(t){return L.current.useRef(t)},e.useState=function(t){return L.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return L.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return L.current.useTransition()},e.version="18.1.0"},791:(t,e,n)=>{"use strict";t.exports=n(117)},184:(t,e,n)=>{"use strict";t.exports=n(374)},813:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<o(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,a=r>>>1;i<a;){var s=2*(i+1)-1,l=t[s],c=s+1,u=t[c];if(0>o(l,n))c<r&&0>o(u,l)?(t[i]=u,t[c]=n,i=c):(t[i]=l,t[s]=n,i=s);else{if(!(c<r&&0>o(u,n)))break t;t[i]=u,t[c]=n,i=c}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,p=null,d=3,f=!1,g=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(t){for(var e=i(u);null!==e;){if(null===e.callback)r(u);else{if(!(e.startTime<=t))break;r(u),e.sortIndex=e.expirationTime,n(c,e)}e=i(u)}}function x(t){if(m=!1,b(t),!g)if(null!==i(c))g=!0,O(w);else{var e=i(u);null!==e&&z(x,e.startTime-t)}}function w(t,n){g=!1,m&&(m=!1,v(T),T=-1),f=!0;var o=d;try{for(b(n),p=i(c);null!==p&&(!(p.expirationTime>n)||t&&!C());){var a=p.callback;if("function"===typeof a){p.callback=null,d=p.priorityLevel;var s=a(p.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?p.callback=s:p===i(c)&&r(c),b(n)}else r(c);p=i(c)}if(null!==p)var l=!0;else{var h=i(u);null!==h&&z(x,h.startTime-n),l=!1}return l}finally{p=null,d=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,P=!1,E=null,T=-1,k=5,A=-1;function C(){return!(e.unstable_now()-A<k)}function M(){if(null!==E){var t=e.unstable_now();A=t;var n=!0;try{n=E(!0,t)}finally{n?S():(P=!1,E=null)}}else P=!1}if("function"===typeof _)S=function(){_(M)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,L=I.port2;I.port1.onmessage=M,S=function(){L.postMessage(null)}}else S=function(){y(M,0)};function O(t){E=t,P||(P=!0,S())}function z(t,n){T=y((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||f||(g=!0,O(w))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(c)},e.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_scheduleCallback=function(t,r,o){var a=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(t.sortIndex=o,n(u,t),null===i(c)&&t===i(u)&&(m?(v(T),T=-1):m=!0,z(x,o-a))):(t.sortIndex=s,n(c,t),g||f||(g=!0,O(w))),t},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(t){var e=d;return function(){var n=d;d=e;try{return t.apply(this,arguments)}finally{d=n}}}},296:(t,e,n)=>{"use strict";t.exports=n(813)},521:()=>{},214:()=>{}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var o=Object.create(null);n.r(o);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&r&&i;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>i[t]));return a.default=()=>i,n.d(o,a),o}})(),n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((e,i)=>(n.f[i](t,e),e)),[])),n.u=t=>"static/js/"+t+".eaba38ef.chunk.js",n.miniCssF=t=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="trip:";n.l=(i,r,o,a)=>{if(t[i])t[i].push(r);else{var s,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==e+o){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",e+o),s.src=i),t[i]=[r];var p=(e,n)=>{s.onerror=s.onload=null,clearTimeout(d);var r=t[i];if(delete t[i],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((t=>t(n))),e)return e(n)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/",(()=>{var t={179:0};n.f.j=(e,i)=>{var r=n.o(t,e)?t[e]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise(((n,i)=>r=t[e]=[n,i]));i.push(r[2]=o);var a=n.p+n.u(e),s=new Error;n.l(a,(i=>{if(n.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}}),"chunk-"+e,e)}};var e=(e,i)=>{var r,o,a=i[0],s=i[1],l=i[2],c=0;if(a.some((e=>0!==t[e]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)l(n)}for(e&&e(i);c<a.length;c++)o=a[c],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0},i=self.webpackChunktrip=self.webpackChunktrip||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),(()=>{"use strict";var t=n(791),e=n.t(t,2),i=n(250);function r(){return r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r.apply(this,arguments)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function a(t,e){if(t){if("string"===typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function s(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=n(7),u=n.n(c);function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(l){s=!0,r=l}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=1e-6,d="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=function(){var t=new d(4);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();function f(t,e){const n=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}([],e,t);var i,r,o;return i=n,r=n,o=1/n[3],i[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,i[3]=r[3]*o,n}function g(t,e){const n=t%e;return n<0?e+n:n}function m(t,e,n){return n*e+(1-n)*t}function y(t,e,n){return t<e?e:t>n?n:t}const v=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function _(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*i+b*s+x*h+w*g,t[1]=_*r+b*l+x*p+w*m,t[2]=_*o+b*c+x*d+w*y,t[3]=_*a+b*u+x*f+w*v,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*i+b*s+x*h+w*g,t[5]=_*r+b*l+x*p+w*m,t[6]=_*o+b*c+x*d+w*y,t[7]=_*a+b*u+x*f+w*v,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*i+b*s+x*h+w*g,t[9]=_*r+b*l+x*p+w*m,t[10]=_*o+b*c+x*d+w*y,t[11]=_*a+b*u+x*f+w*v,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*i+b*s+x*h+w*g,t[13]=_*r+b*l+x*p+w*m,t[14]=_*o+b*c+x*d+w*y,t[15]=_*a+b*u+x*f+w*v,t}function b(t,e,n){var i,r,o,a,s,l,c,u,h,p,d,f,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=i*g+s*m+h*y+e[12],t[13]=r*g+l*m+p*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=a*g+u*m+f*y+e[15]),t}function x(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function w(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],g=t[12],m=t[13],y=t[14],v=t[15],_=e[0],b=e[1],x=e[2],w=e[3],S=e[4],P=e[5],E=e[6],T=e[7],k=e[8],A=e[9],C=e[10],M=e[11],I=e[12],L=e[13],O=e[14],z=e[15];return Math.abs(n-_)<=p*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-b)<=p*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(r-x)<=p*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(o-w)<=p*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-S)<=p*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(s-P)<=p*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(l-E)<=p*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-T)<=p*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(u-k)<=p*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(h-A)<=p*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(d-C)<=p*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(f-M)<=p*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(g-I)<=p*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(m-L)<=p*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(y-O)<=p*Math.max(1,Math.abs(y),Math.abs(O))&&Math.abs(v-z)<=p*Math.max(1,Math.abs(v),Math.abs(z))}function S(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function P(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function E(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function T(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}var k=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};!function(){var t=function(){var t=new d(2);return d!=Float32Array&&(t[0]=0,t[1]=0),t}()}();var A=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t};!function(){var t=function(){var t=new d(3);return d!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function C(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const M=Math.PI,I=M/4,L=M/180,O=180/M,z=512,R=4003e4,D=85.051129,F=1.5;function B(t){return Math.pow(2,t)}function j(t){return v(t)}function N(t){let[e,n]=t;C(Number.isFinite(e)),C(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=n*L;return[z*(e*L+M)/(2*M),z*(M+Math.log(Math.tan(I+.5*i)))/(2*M)]}function V(t){let[e,n]=t;const i=e/z*(2*M)-M,r=2*(Math.atan(Math.exp(n/z*(2*M)-M))-I);return[i*O,r*O]}function U(t){let{latitude:e,longitude:n,highPrecision:i=!1}=t;C(Number.isFinite(e)&&Number.isFinite(n));const r={},o=Math.cos(e*L),a=512/360,s=a/o,l=12790407194604047e-21/o;if(r.unitsPerMeter=[l,l,l],r.metersPerUnit=[1/l,1/l,1/l],r.unitsPerDegree=[a,s,l],r.degreesPerUnit=[.703125,1/s,1/l],i){const t=L*Math.tan(e*L)/o,n=a*t/2,i=12790407194604047e-21*t,c=i/s*l;r.unitsPerDegree2=[0,n,i],r.unitsPerMeter2=[c,0,c]}return r}function W(t,e){const[n,i,r]=t,[o,a,s]=e,{unitsPerMeter:l,unitsPerMeter2:c}=U({longitude:n,latitude:i,highPrecision:!0}),u=N(t);u[0]+=o*(l[0]+c[0]*a),u[1]+=a*(l[1]+c[1]*a);const h=V(u),p=(r||0)+(s||0);return Number.isFinite(r)||Number.isFinite(s)?[h[0],h[1],p]:h}function G(t){let{height:e,pitch:n,bearing:i,altitude:r,scale:o,center:a=null}=t;const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var l,c;return b(s,s,[0,0,-r]),function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],p=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=a*r+u*i,t[6]=s*r+h*i,t[7]=l*r+p*i,t[8]=c*r-o*i,t[9]=u*r-a*i,t[10]=h*r-s*i,t[11]=p*r-l*i}(s,s,-n*L),function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],p=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=a*r+u*i,t[2]=s*r+h*i,t[3]=l*r+p*i,t[4]=c*r-o*i,t[5]=u*r-a*i,t[6]=h*r-s*i,t[7]=p*r-l*i}(s,s,i*L),o/=e,x(s,s,[o,o,o]),a&&b(s,s,((l=[])[0]=-(c=a)[0],l[1]=-c[1],l[2]=-c[2],l)),s}function q(t){let{width:e,height:n,fovy:i=H(F),altitude:r,pitch:o=0,nearZMultiplier:a=1,farZMultiplier:s=1}=t;void 0!==r&&(i=H(r));const l=.5*i*L,c=X(i),u=o*L,h=Math.sin(l)*c/Math.sin(Math.min(Math.max(Math.PI/2-u-l,.01),Math.PI-.01));return{fov:2*l,aspect:e/n,focalDistance:c,near:a,far:(Math.sin(u)*h+c)*s}}function Z(t){let{width:e,height:n,pitch:i,altitude:r,fovy:o,nearZMultiplier:a,farZMultiplier:s}=t;const{fov:l,aspect:c,near:u,far:h}=q({width:e,height:n,altitude:r,fovy:o,pitch:i,nearZMultiplier:a,farZMultiplier:s}),p=function(t,e,n,i,r){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t}([],l,c,u,h);return p}function H(t){return 2*Math.atan(.5/t)*O}function X(t){return.5/Math.tan(.5*t*L)}function Y(t,e){const[n,i,r=0]=t;return C(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),f(e,[n,i,r,1])}function K(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const[i,r,o]=t;if(C(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(o)){return f(e,[i,r,o,1])}const a=f(e,[i,r,0,1]),s=f(e,[i,r,1,1]),l=a[2],c=s[2],u=l===c?0:((n||0)-l)/(c-l);return T([],a,s,u)}function J(t){let{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,padding:a=0,offset:s=[0,0]}=t;const[[l,c],[u,h]]=i;if(Number.isFinite(a)){a={top:a,bottom:a,left:a,right:a}}else C(Number.isFinite(a.top)&&Number.isFinite(a.bottom)&&Number.isFinite(a.left)&&Number.isFinite(a.right));const p=N([l,y(h,-85.051129,D)]),d=N([u,y(c,-85.051129,D)]),f=[Math.max(Math.abs(d[0]-p[0]),r),Math.max(Math.abs(d[1]-p[1]),r)],g=[e-a.left-a.right-2*Math.abs(s[0]),n-a.top-a.bottom-2*Math.abs(s[1])];C(g[0]>0&&g[1]>0);const m=g[0]/f[0],_=g[1]/f[1],b=(a.right-a.left)/2/m,x=(a.bottom-a.top)/2/_,w=V([(d[0]+p[0])/2+b,(d[1]+p[1])/2+x]),S=Math.min(o,v(Math.abs(Math.min(m,_))));return C(Number.isFinite(S)),{longitude:w[0],latitude:w[1],zoom:S}}const Q=Math.PI/180;function $(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{width:n,height:i,unproject:r}=t,o={targetZ:e},a=r([0,i],o),s=r([n,i],o);let l,c;const u=t.fovy?.5*t.fovy*Q:Math.atan(.5/t.altitude),h=(90-t.pitch)*Q;return u>h-.01?(l=tt(t,0,e),c=tt(t,n,e)):(l=r([0,0],o),c=r([n,0],o)),[a,s,c,l]}function tt(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=f(i,[e,0,1,1]),o=f(i,[e,t.height,1,1]),a=V(T([],r,o,(n*t.distanceScales.unitsPerMeter[2]-r[2])/(o[2]-r[2])));return a[2]=n,a}class et{constructor(){let{width:t,height:e,latitude:n=0,longitude:i=0,zoom:r=0,pitch:o=0,bearing:a=0,altitude:s=null,fovy:l=null,position:c=null,nearZMultiplier:u=.02,farZMultiplier:h=1.01}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1};t=t||1,e=e||1,null===l&&null===s?(s=F,l=H(s)):null===l?l=H(s):null===s&&(s=X(l));const p=B(r);s=Math.max(.75,s);const d=U({longitude:i,latitude:n}),f=N([i,n]);var g,m,y;f[2]=0,c&&(g=f,m=f,y=A([],c,d.unitsPerMeter),g[0]=m[0]+y[0],g[1]=m[1]+y[1],g[2]=m[2]+y[2]),this.projectionMatrix=Z({width:t,height:e,pitch:o,fovy:l,nearZMultiplier:u,farZMultiplier:h}),this.viewMatrix=G({height:e,scale:p,center:f,pitch:o,bearing:a,altitude:s}),this.width=t,this.height=e,this.scale=p,this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=o,this.bearing=a,this.altitude=s,this.fovy=l,this.center=f,this.meterOffset=c||[0,0,0],this.distanceScales=d,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:i}=this,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];_(r,r,n),_(r,r,i),this.viewProjectionMatrix=r;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];x(o,o,[t/2,-e/2,1]),b(o,o,[1,-1,0]),_(o,o,r);const a=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],d=e[11],f=e[12],g=e[13],m=e[14],y=e[15],v=n*s-i*a,_=n*l-r*a,b=n*c-o*a,x=i*l-r*s,w=i*c-o*s,S=r*c-o*l,P=u*g-h*f,E=u*m-p*f,T=u*y-d*f,k=h*m-p*g,A=h*y-d*g,C=p*y-d*m,M=v*C-_*A+b*k+x*T-w*E+S*P;return M?(M=1/M,t[0]=(s*C-l*A+c*k)*M,t[1]=(r*A-i*C-o*k)*M,t[2]=(g*S-m*w+y*x)*M,t[3]=(p*w-h*S-d*x)*M,t[4]=(l*T-a*C-c*E)*M,t[5]=(n*C-r*T+o*E)*M,t[6]=(m*b-f*S-y*_)*M,t[7]=(u*S-p*b+d*_)*M,t[8]=(a*A-s*T+c*P)*M,t[9]=(i*T-n*A-o*P)*M,t[10]=(f*w-g*b+y*v)*M,t[11]=(h*b-u*w-d*v)*M,t[12]=(s*E-a*k-l*P)*M,t[13]=(n*k-i*E+r*P)*M,t[14]=(g*_-f*x-m*v)*M,t[15]=(u*x-h*_+p*v)*M,t):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=a}equals(t){return t instanceof et&&(t.width===this.width&&t.height===this.height&&w(t.projectionMatrix,this.projectionMatrix)&&w(t.viewMatrix,this.viewMatrix))}project(t){let{topLeft:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Y(this.projectPosition(t),this.pixelProjectionMatrix),[i,r]=n,o=e?r:this.height-r;return 2===t.length?[i,o]:[i,o,n[2]]}unproject(t){let{topLeft:e=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[i,r,o]=t,a=e?r:this.height-r,s=n&&n*this.distanceScales.unitsPerMeter[2],l=K([i,a,o],this.pixelUnprojectionMatrix,s),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(t){const[e,n]=N(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=V(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return N(t)}unprojectFlat(t){return V(t)}getMapCenterByLngLatPosition(t){let{lngLat:e,pos:n}=t;const i=K(n,this.pixelUnprojectionMatrix),r=S([],N(e),((o=[])[0]=-(a=i)[0],o[1]=-a[1],o));var o,a;return V(S([],this.center,r))}getLocationAtPoint(t){let{lngLat:e,pos:n}=t;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}fitBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:i}=this,{longitude:r,latitude:o,zoom:a}=J(Object.assign({width:n,height:i,bounds:t},e));return new et({width:n,height:i,longitude:r,latitude:o,zoom:a})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map((t=>t[0]))),i=Math.max(...e.map((t=>t[0])));return[[n,Math.min(...e.map((t=>t[1])))],[i,Math.max(...e.map((t=>t[1])))]]}getBoundingRegion(){return $(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0)}}function nt(t){let{width:e,height:n,longitude:i,latitude:r,zoom:o,pitch:a=0,bearing:s=0}=t;(i<-180||i>180)&&(i=g(i+180,360)-180),(s<-180||s>180)&&(s=g(s+180,360)-180);const l=v(n/512);if(o<=l)o=l,r=0;else{const t=n/2/Math.pow(2,o),e=V([0,t])[1];if(r<e)r=e;else{const e=V([0,512-t])[1];r>e&&(r=e)}}return{width:e,height:n,longitude:i,latitude:r,zoom:o,pitch:a,bearing:s}}const it=.01,rt=["longitude","latitude","zoom"],ot={curve:1.414,speed:1.2};function at(t,e,n){const i=(n=Object.assign({},ot,n)).curve,r=t.zoom,o=[t.longitude,t.latitude],a=B(r),s=e.zoom,l=[e.longitude,e.latitude],c=B(s-r),u=N(o),h=N(l),p=k([],h,u),d=Math.max(t.width,t.height),f=d/c,g=E(p)*a,m=Math.max(g,it),y=i*i,v=(f*f-d*d+y*y*m*m)/(2*d*y*m),_=(f*f-d*d-y*y*m*m)/(2*f*y*m),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(_*_+1)-_);return{startZoom:r,startCenterXY:u,uDelta:p,w0:d,u1:g,S:(x-b)/i,rho:i,rho2:y,r0:b,r1:x}}var st=function(){if("undefined"!==typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,i){return t[0]===e&&(n=i,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(e,n){var i=t(this.__entries__,e);~i?this.__entries__[i][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,i=t(n,e);~i&&n.splice(i,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,i=this.__entries__;n<i.length;n++){var r=i[n];t.call(e,r[1],r[0])}},e}()}(),lt="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,ct="undefined"!==typeof n.g&&n.g.Math===Math?n.g:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),ut="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(ct):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var ht=["top","right","bottom","left","width","height","size","weight"],pt="undefined"!==typeof MutationObserver,dt=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,i=!1,r=0;function o(){n&&(n=!1,t()),i&&s()}function a(){ut(o)}function s(){var t=Date.now();if(n){if(t-r<2)return;i=!0}else n=!0,i=!1,setTimeout(a,e);r=t}return s}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){lt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),pt?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){lt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;ht.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),ft=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},gt=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||ct},mt=wt(0,0,0,0);function yt(t){return parseFloat(t)||0}function vt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+yt(t["border-"+n+"-width"])}),0)}function _t(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return mt;var i=gt(t).getComputedStyle(t),r=function(t){for(var e={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var r=i[n],o=t["padding-"+r];e[r]=yt(o)}return e}(i),o=r.left+r.right,a=r.top+r.bottom,s=yt(i.width),l=yt(i.height);if("border-box"===i.boxSizing&&(Math.round(s+o)!==e&&(s-=vt(i,"left","right")+o),Math.round(l+a)!==n&&(l-=vt(i,"top","bottom")+a)),!function(t){return t===gt(t).document.documentElement}(t)){var c=Math.round(s+o)-e,u=Math.round(l+a)-n;1!==Math.abs(c)&&(s-=c),1!==Math.abs(u)&&(l-=u)}return wt(r.left,r.top,s,l)}var bt="undefined"!==typeof SVGGraphicsElement?function(t){return t instanceof gt(t).SVGGraphicsElement}:function(t){return t instanceof gt(t).SVGElement&&"function"===typeof t.getBBox};function xt(t){return lt?bt(t)?function(t){var e=t.getBBox();return wt(0,0,e.width,e.height)}(t):_t(t):mt}function wt(t,e,n,i){return{x:t,y:e,width:n,height:i}}var St=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=wt(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=xt(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),Pt=function(t,e){var n=function(t){var e=t.x,n=t.y,i=t.width,r=t.height,o="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(o.prototype);return ft(a,{x:e,y:n,width:i,height:r,top:n,right:e+i,bottom:r+n,left:e}),a}(e);ft(this,{target:t,contentRect:n})},Et=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new st,"function"!==typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof gt(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new St(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof gt(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new Pt(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Tt="undefined"!==typeof WeakMap?new WeakMap:new st,kt=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=dt.getInstance(),i=new Et(e,n,this);Tt.set(this,i)};["observe","unobserve","disconnect"].forEach((function(t){kt.prototype[t]=function(){var e;return(e=Tt.get(this))[t].apply(e,arguments)}}));const At="undefined"!==typeof ct.ResizeObserver?ct.ResizeObserver:kt;function Ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function It(t,e,n){return e&&Mt(t.prototype,e),n&&Mt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}"undefined"!==typeof window?window:n.g,"undefined"!==typeof n.g?n.g:window;var Lt="undefined"!==typeof document?document:{};function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function zt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Dt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Ft=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Bt(t){if(!t)return null;if("string"===typeof t)return t;t.toJS&&(t=t.toJS());var e,n={},i=Rt(t.layers);try{for(i.s();!(e=i.n()).done;){var r=e.value;n[r.id]=r}}catch(a){i.e(a)}finally{i.f()}var o=t.layers.map((function(t){var e=n[t.ref],i=null;if("interactive"in t&&delete(i=zt({},t)).interactive,e){delete(i=i||zt({},t)).ref;var r,o=Rt(Ft);try{for(o.s();!(r=o.n()).done;){var s=r.value;s in e&&(i[s]=e[s])}}catch(a){o.e(a)}finally{o.f()}}return i||t}));return zt(zt({},t),{},{layers:o})}var jt={container:c.object,gl:c.object,mapboxApiAccessToken:c.string,mapboxApiUrl:c.string,attributionControl:c.bool,preserveDrawingBuffer:c.bool,reuseMaps:c.bool,transformRequest:c.func,mapOptions:c.object,mapStyle:c.oneOfType([c.string,c.object]),preventStyleDiffing:c.bool,visible:c.bool,asyncRender:c.bool,onLoad:c.func,onError:c.func,width:c.number,height:c.number,viewState:c.object,longitude:c.number,latitude:c.number,zoom:c.number,bearing:c.number,pitch:c.number,altitude:c.number},Nt={container:Lt.body,mapboxApiAccessToken:function(){var t=null;if("undefined"!==typeof window&&window.location){var e=window.location.search.match(/access_token=([^&\/]*)/);t=e&&e[1]}t||"undefined"===typeof process||(t=t||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.MapboxAccessToken||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_MAPBOX_ACCESS_TOKEN);return t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function Vt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&c.checkPropTypes(jt,t,"prop",e)}var Ut=function(){function t(e){var n=this;if(Ct(this,t),l(this,"props",Nt),l(this,"width",0),l(this,"height",0),l(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),l(this,"_handleError",(function(t){n.props.onError(t)})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return It(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var n=this._map.getContainer(),i=e.container;for(i.classList.add("mapboxgl-map");n.childNodes.length>0;)i.appendChild(n.childNodes[0]);this._map._container=i,t.savedMap=null,e.mapStyle&&this._map.setStyle(Bt(e.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,e.gl}}var i={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:Bt(e.mapStyle),interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(i.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},i,e.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!t.savedMap?(t.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(t){var e=this;Vt(t=Object.assign({},Nt,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||Nt.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{configurable:!0,get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{configurable:!0,get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{configurable:!0,get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{configurable:!0,get:function(){return e.height}});var i=this._map.getCanvas();i&&(i.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){Vt(e=Object.assign({},this.props,e),"Mapbox");var n=this._updateMapViewport(t,e),i=this._updateMapSize(t,e);this._updateMapStyle(t,e),e.asyncRender||!n&&!i||this.redraw(),this.props=e}}},{key:"_updateMapStyle",value:function(t,e){t.mapStyle!==e.mapStyle&&this._map.setStyle(Bt(e.mapStyle),{diff:!e.preventStyleDiffing})}},{key:"_updateMapSize",value:function(t,e){var n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this._map.resize()),n}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),i=this._getViewState(e),r=i.latitude!==n.latitude||i.longitude!==n.longitude||i.zoom!==n.zoom||i.pitch!==n.pitch||i.bearing!==n.bearing||i.altitude!==n.altitude;return r&&(this._map.jumpTo(this._viewStateToMapboxProps(i)),i.altitude!==n.altitude&&(this._map.transform.altitude=i.altitude)),r}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,i=e.latitude,r=e.zoom,o=e.pitch,a=void 0===o?0:o,s=e.bearing,l=void 0===s?0:s,c=e.altitude;return{longitude:n,latitude:i,zoom:r,pitch:a,bearing:l,altitude:void 0===c?1.5:c}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if("undefined"!==typeof Lt)try{var e=Lt.createElement("div");e.className="mapboxgl-map",e.style.display="none",Lt.body.appendChild(e);var n="static"!==window.getComputedStyle(e).position;if(!n){var i=Lt.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),Lt.head.appendChild(i)}}catch(r){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}]),t}();l(Ut,"initialized",!1),l(Ut,"propTypes",jt),l(Ut,"defaultProps",Nt),l(Ut,"savedMap",null);var Wt=n(302),Gt=n.n(Wt);function qt(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Zt(t,e){if(t===e)return!0;if(qt(t)&&qt(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Zt(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=1e-7}function Ht(t,e,n){return Math.max(e,Math.min(n,t))}function Xt(t,e,n){return qt(t)?t.map((function(t,i){return Xt(t,e[i],n)})):n*e+(1-n)*t}function Yt(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}function Kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Jt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kt(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qt={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},$t=0,te=0,ee=1.5,ne=function(){function t(e){var n=e.width,i=e.height,r=e.latitude,o=e.longitude,a=e.zoom,s=e.bearing,l=void 0===s?te:s,c=e.pitch,u=void 0===c?$t:c,h=e.altitude,p=void 0===h?ee:h,d=e.maxZoom,f=void 0===d?Qt.maxZoom:d,g=e.minZoom,m=void 0===g?Qt.minZoom:g,y=e.maxPitch,v=void 0===y?Qt.maxPitch:y,_=e.minPitch,b=void 0===_?Qt.minPitch:_,x=e.transitionDuration,w=e.transitionEasing,S=e.transitionInterpolator,P=e.transitionInterruption,E=e.startPanLngLat,T=e.startZoomLngLat,k=e.startRotatePos,A=e.startBearing,C=e.startPitch,M=e.startZoom;Ct(this,t),Yt(Number.isFinite(n),"`width` must be supplied"),Yt(Number.isFinite(i),"`height` must be supplied"),Yt(Number.isFinite(o),"`longitude` must be supplied"),Yt(Number.isFinite(r),"`latitude` must be supplied"),Yt(Number.isFinite(a),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:i,latitude:r,longitude:o,zoom:a,bearing:l,pitch:u,altitude:p,maxZoom:f,minZoom:m,maxPitch:v,minPitch:b,transitionDuration:x,transitionEasing:w,transitionInterpolator:S,transitionInterruption:P}),this._state={startPanLngLat:E,startZoomLngLat:T,startRotatePos:k,startBearing:A,startPitch:C,startZoom:M}}return It(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,i=this._state.startPanLngLat||this._unproject(n);if(!i)return this;var r=h(this._calculateNewLngLat({startPanLngLat:i,pos:e}),2),o=r[0],a=r[1];return this._getUpdatedMapState({longitude:o,latitude:a})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e,n=t.pos,i=t.deltaAngleX,r=void 0===i?0:i,o=t.deltaAngleY,a=void 0===o?0:o,s=this._state,l=s.startRotatePos,c=s.startBearing,u=s.startPitch;return Number.isFinite(c)&&Number.isFinite(u)?(e=n?this._calculateNewPitchAndBearing(Jt(Jt({},this._getRotationParams(n,l)),{},{startBearing:c,startPitch:u})):{bearing:c+r,pitch:u+a},this._getUpdatedMapState(e)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,i=t.scale;Yt(i>0,"`scale` must be a positive number");var r=this._state,o=r.startZoom,a=r.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,a=this._unproject(n)||this._unproject(e)),Yt(a,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:i,startZoom:o||0}),l=h(new et(Object.assign({},this._viewportProps,{zoom:s})).getMapCenterByLngLatPosition({lngLat:a,pos:e}),2),c=l[0],u=l[1];return this._getUpdatedMapState({zoom:s,longitude:c,latitude:u})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._state,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,i=t.zoom;t.zoom=Ht(i,n,e);var r=t.maxPitch,o=t.minPitch,a=t.pitch;return t.pitch=Ht(a,o,r),Object.assign(t,nt(t)),t}},{key:"_unproject",value:function(t){var e=new et(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new et(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,i=this._viewportProps,r=i.maxZoom,o=i.minZoom;return Ht(n+Math.log2(e),o,r)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,i=t.startBearing,r=t.startPitch;n=Ht(n,-1,1);var o=this._viewportProps,a=o.minPitch,s=o.maxPitch,l=r;return n>0?l=r+n*(s-r):n<0&&(l=r-n*(a-r)),{pitch:l,bearing:i+180*e}}},{key:"_getRotationParams",value:function(t,e){var n=t[0]-e[0],i=t[1]-e[1],r=t[1],o=e[1],a=this._viewportProps,s=a.width,l=a.height,c=n/s,u=0;return i>0?Math.abs(l-o)>5&&(u=i/(o-l)*1.2):i<0&&o>5&&(u=1-r/o),{deltaScaleX:c,deltaScaleY:u=Math.min(1,Math.max(-1,u))}}}]),t}();function ie(t){return t[0].toLowerCase()+t.slice(1)}function re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?re(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ae=(0,t.createContext)({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),se=ae.Provider;ae.Provider=function(e){var n=e.value,i=e.children,r=h((0,t.useState)(null),2),o=r[0],a=r[1],s=(0,t.useContext)(ae);return n=oe(oe({setMap:a},s),{},{map:s&&s.map||o},n),t.createElement(se,{value:n},i)};const le=ae;const ce="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;function ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function he(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var pe="A valid API access token is required to use Mapbox data";function de(t){var e=t.props,n=t.width,i=t.height;return new et(he(he(he({},e),e.viewState),{},{width:n,height:i}))}var fe={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},ge=Object.assign({},Ut.propTypes,{width:c.oneOfType([c.number,c.string]),height:c.oneOfType([c.number,c.string]),onResize:c.func,disableTokenWarning:c.bool,visible:c.bool,className:c.string,style:c.object,visibilityConstraints:c.object}),me=Object.assign({},Ut.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:Qt});function ye(){return t.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},t.createElement("h3",{key:"header"},pe),t.createElement("div",{key:"text"},"For information on setting up your basemap, read"),t.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}var ve=(0,t.forwardRef)((function(e,n){var i=h((0,t.useState)(!0),2),r=i[0],o=i[1],a=h((0,t.useState)({width:0,height:0}),2),s=a[0],l=a[1],c=(0,t.useRef)(null),u=(0,t.useRef)(null),p=(0,t.useRef)(null),d=(0,t.useRef)(null),f=(0,t.useContext)(le);ce((function(){if(ve.supported()){var t=new Ut(he(he(he({},e),s),{},{mapboxgl:Gt(),container:u.current,onError:function(t){401===(t.error&&t.error.status||t.status)&&r&&(console.error(pe),o(!1)),e.onError(t)}}));c.current=t,f&&f.setMap&&f.setMap(t.getMap());var n=new At((function(t){if(t[0].contentRect){var n=t[0].contentRect,i=n.width,r=n.height;l({width:i,height:r}),e.onResize({width:i,height:r})}}));return n.observe(p.current),function(){t.finalize(),c.current=null,n.disconnect()}}}),[]),ce((function(){c.current&&c.current.setProps(he(he({},e),s))}));var g=c.current&&c.current.getMap();(0,t.useImperativeHandle)(n,(function(){return function(t){return{getMap:function(){return t.current&&t.current.getMap()},queryRenderedFeatures:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.current&&t.current.getMap();return i&&i.queryRenderedFeatures(e,n)}}}(c)}),[]);var m=(0,t.useCallback)((function(t){var e=t.target;e===d.current&&e.scrollTo(0,0)}),[]),y=g&&t.createElement(se,{value:he(he({},f),{},{viewport:f.viewport||de(he({map:g,props:e},s)),map:g,container:f.container||p.current})},t.createElement("div",{key:"map-overlays",className:"overlays",ref:d,style:fe,onScroll:m},e.children)),v=e.className,_=e.width,b=e.height,x=e.style,w=e.visibilityConstraints,S=Object.assign({position:"relative"},x,{width:_,height:b}),P=e.visible&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qt;for(var n in e){var i=n.slice(0,3),r=ie(n.slice(3));if("min"===i&&t[r]<e[n])return!1;if("max"===i&&t[r]>e[n])return!1}return!0}(e.viewState||e,w),E=Object.assign({},fe,{visibility:P?"inherit":"hidden"});return t.createElement("div",{key:"map-container",ref:p,style:S},t.createElement("div",{key:"map-mapbox",ref:u,style:E,className:v}),y,!r&&!e.disableTokenWarning&&t.createElement(ye,null))}));ve.supported=function(){return Gt()&&Gt().supported()},ve.propTypes=ge,ve.defaultProps=me;const _e=ve;function be(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return xe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xe(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function xe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var we=function(){function t(){Ct(this,t),l(this,"propNames",[])}return It(t,[{key:"arePropsEqual",value:function(t,e){var n,i=be(this.propNames||[]);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!Zt(t[r],e[r]))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,n){Yt(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(t,e){return e.transitionDuration}}]),t}();function Se(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pe(t,e){return Pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pe(t,e)}function Ee(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pe(t,e)}function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function ke(t,e){if(e&&("object"===Te(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Se(t)}function Ae(t){return Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ae(t)}var Ce={longitude:1,bearing:1};function Me(t){return Number.isFinite(t)||Array.isArray(t)}function Ie(t,e,n){return function(t){return t in Ce}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}function Le(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Oe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ze(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ae(t);if(e){var r=Ae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ke(this,n)}}var Re=["longitude","latitude","zoom","bearing","pitch"],De=["latitude","longitude","zoom","width","height"],Fe=["bearing","pitch"],Be={speed:1.2,curve:1.414};!function(t){Ee(n,t);var e=ze(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ct(this,n),l(Se(t=e.call(this)),"propNames",Re),t.props=Object.assign({},Be,i),t}It(n,[{key:"initializeProps",value:function(t,e){var n,i={},r={},o=Le(De);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=t[a],l=e[a];Yt(Me(s)&&Me(l),"".concat(a," must be supplied for transition")),i[a]=s,r[a]=Ie(a,s,l)}}catch(f){o.e(f)}finally{o.f()}var c,u=Le(Fe);try{for(u.s();!(c=u.n()).done;){var h=c.value,p=t[h]||0,d=e[h]||0;i[h]=p,r[h]=Ie(h,p,d)}}catch(f){u.e(f)}finally{u.f()}return{start:i,end:r}}},{key:"interpolateProps",value:function(t,e,n){var i,r=function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r={},{startZoom:o,startCenterXY:a,uDelta:s,w0:l,u1:c,S:u,rho:h,rho2:p,r0:d}=at(t,e,i);if(c<it){for(const i of rt){const o=t[i],a=e[i];r[i]=m(o,a,n)}return r}const f=n*u,g=Math.cosh(d)/Math.cosh(d+h*f),y=l*((Math.cosh(d)*Math.tanh(d+h*f)-Math.sinh(d))/p)/c,v=o+j(1/g),_=P([],s,y);S(_,_,a);const b=V(_);return r.longitude=b[0],r.latitude=b[1],r.zoom=v,r}(t,e,n,this.props),o=Le(Fe);try{for(o.s();!(i=o.n()).done;){var a=i.value;r[a]=Xt(t[a],e[a],n)}}catch(s){o.e(s)}finally{o.f()}return r}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=Object.assign({},ot,n);const{screenSpeed:i,speed:r,maxDuration:o}=n,{S:a,rho:s}=at(t,e,n),l=1e3*a;let c;return c=Number.isFinite(i)?l/(i/s):l/r,Number.isFinite(o)&&c>o?0:c}(t,e,this.props)),n}}])}(we);function je(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Ne(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ne(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ve(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ae(t);if(e){var r=Ae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ke(this,n)}}var Ue=["longitude","latitude","zoom","bearing","pitch"],We=function(t){Ee(n,t);var e=Ve(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ct(this,n),t=e.call(this),Array.isArray(i)&&(i={transitionProps:i}),t.propNames=i.transitionProps||Ue,i.around&&(t.around=i.around),t}return It(n,[{key:"initializeProps",value:function(t,e){var n={},i={};if(this.around){n.around=this.around;var r=new et(t).unproject(this.around);Object.assign(i,e,{around:new et(e).project(r),aroundLngLat:r})}var o,a=je(this.propNames);try{for(a.s();!(o=a.n()).done;){var s=o.value,l=t[s],c=e[s];Yt(Me(l)&&Me(c),"".concat(s," must be supplied for transition")),n[s]=l,i[s]=Ie(s,l,c)}}catch(u){a.e(u)}finally{a.f()}return{start:n,end:i}}},{key:"interpolateProps",value:function(t,e,n){var i,r={},o=je(this.propNames);try{for(o.s();!(i=o.n()).done;){var a=i.value;r[a]=Xt(t[a],e[a],n)}}catch(u){o.e(u)}finally{o.f()}if(e.around){var s=h(new et(Object.assign({},e,r)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:Xt(t.around,e.around,n)}),2),l=s[0],c=s[1];r.longitude=l,r.latitude=c}return r}}]),n}(we),Ge=function(){};var qe=1,Ze=2,He=3,Xe=4,Ye={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new We,transitionInterruption:qe,onTransitionStart:Ge,onTransitionInterrupt:Ge,onTransitionEnd:Ge},Ke=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ct(this,t),l(this,"_animationFrame",null),l(this,"_onTransitionFrame",(function(){e._animationFrame=requestAnimationFrame(e._onTransitionFrame),e._updateViewport()})),this.props=null,this.onViewportChange=n.onViewportChange||Ge,this.onStateChange=n.onStateChange||Ge,this.time=n.getTime||Date.now}return It(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,!e||this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var n=Object.assign({},e),i=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===Ze?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===Xe)){var r=this.time(),o=(r-this.state.startTime)/this.state.duration;i.transitionDuration=this.state.duration-(r-this.state.startTime),i.transitionEasing=function(t,e){var n=t(e);return function(i){return 1/(1-n)*(t(i*(1-e)+e)-n)}}(this.state.easing,o),i.transitionInterpolator=n.transitionInterpolator}return i.onTransitionStart(),this._triggerTransition(n,i),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,n=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===He||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){Yt(this._isTransitionEnabled(e)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=e.transitionInterpolator,i=n.getDuration?n.getDuration(t,e):e.transitionDuration;if(0!==i){var r=e.transitionInterpolator.initializeProps(t,e),o={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:i,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:r.start,endProps:r.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(o)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=this.time(),e=this.state,n=e.startTime,i=e.duration,r=e.easing,o=e.interpolator,a=e.startProps,s=e.endProps,l=!1,c=(t-n)/i;c>=1&&(c=1,l=!0),c=r(c);var u=o.interpolateProps(a,s,c),h=new ne(Object.assign({},this.props,u));this.state.propsInTransition=h.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),l&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();l(Ke,"defaultProps",Ye);var Je=n(97),Qe=n.n(Je);const $e={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(n,(e=>e.pointerId===t.pointerId))||n.push(t)),e.call(this,t)}}(Qe().PointerEventInput),Qe().MouseInput.prototype.handler=function(t){let e=$e[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const tn=Qe().Manager,en=Qe(),nn=en?[[en.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[en.Rotate,{enable:!1}],[en.Pinch,{enable:!1}],[en.Swipe,{enable:!1}],[en.Pan,{threshold:0,enable:!1}],[en.Press,{enable:!1}],[en.Tap,{event:"doubletap",taps:2,enable:!1}],[en.Tap,{event:"anytap",enable:!1}],[en.Tap,{enable:!1}]]:null,rn={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},on={doubletap:["tap"]},an={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},sn={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},ln={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},cn={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},un="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",hn="undefined"!==typeof window?window:n.g;"undefined"!==typeof n.g?n.g:window,"undefined"!==typeof document&&document;let pn=!1;try{const t={get passive(){return pn=!0,!0}};hn.addEventListener("test",t,t),hn.removeEventListener("test",t,t)}catch(RM){}const dn=-1!==un.indexOf("firefox"),{WHEEL_EVENTS:fn}=sn,gn="wheel",mn=4.000244140625;class yn{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.events=fn.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!pn&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===gn&&(this.options.enable=e)}handleEvent(t){if(!this.options.enable)return;let e=t.deltaY;hn.WheelEvent&&(dn&&t.deltaMode===hn.WheelEvent.DOM_DELTA_PIXEL&&(e/=hn.devicePixelRatio),t.deltaMode===hn.WheelEvent.DOM_DELTA_LINE&&(e*=40));const n={x:t.clientX,y:t.clientY};0!==e&&e%mn===0&&(e=Math.floor(e/mn)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}_onWheel(t,e,n){this.callback({type:gn,center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}const{MOUSE_EVENTS:vn}=sn,_n="pointermove",bn="pointerover",xn="pointerout",wn="pointerleave";class Sn{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.element=t,this.callback=e,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=vn.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===_n&&(this.enableMoveEvent=e),t===bn&&(this.enableOverEvent=e),t===xn&&(this.enableOutEvent=e),t===wn&&(this.enableLeaveEvent=e)}handleEvent(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:bn,srcEvent:t,pointerType:"mouse",target:t.target})}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:xn,srcEvent:t,pointerType:"mouse",target:t.target})}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:wn,srcEvent:t,pointerType:"mouse",target:t.target})}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:_n,srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:Pn}=sn,En="keydown",Tn="keyup";class kn{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Pn.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=n.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===En&&(this.enableDownEvent=e),t===Tn&&(this.enableUpEvent=e)}handleEvent(t){const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:En,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:Tn,srcEvent:t,key:t.key,target:t.target}))}}const An="contextmenu";class Cn{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===An&&(this.options.enable=e)}handleEvent(t){this.options.enable&&this.callback({type:An,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const Mn={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};const In={srcElement:"root",priority:0};class Ln{constructor(t){this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{handlers:o,handlersByElement:a}=this;n&&("object"!==typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},In,n):In;let s=a.get(n.srcElement);s||(s=[],a.set(n.srcElement,s));const l={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};i&&(l.once=!0),r&&(l.passive=!0),o.push(l),this._active=this._active||!l.passive;let c=s.length-1;for(;c>=0&&!(s[c].priority>=l.priority);)c--;s.splice(c+1,0,l)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.type===t&&o.handler===e){n.splice(r,1);const t=i.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&i.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}handleEvent(t){if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const i=()=>{t.handled=!0},r=()=>{t.handled=!0,e=!0},o=[];for(let a=0;a<n.length;a++){const{type:s,handler:l,once:c}=n[a];if(l(Object.assign({},t,{type:s,stopPropagation:i,stopImmediatePropagation:r})),c&&o.push(n[a]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.element;return Object.assign({},t,function(t){const e=Mn[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let o=!1,a=!1,s=!1;return 4===e||2===e&&!Number.isFinite(n)?(o=1===r,a=2===r,s=3===r):2===e?(o=Boolean(1&n),a=Boolean(4&n),s=Boolean(2&n)):1===e&&(o=0===i,a=1===i,s=2===i),{leftButton:o,middleButton:a,rightButton:s}}(t),function(t,e){const{srcEvent:n}=t;if(!t.center&&!Number.isFinite(n.clientX))return null;const i=t.center||{x:n.clientX,y:n.clientY},r=e.getBoundingClientRect(),o=r.width/e.offsetWidth||1,a=r.height/e.offsetHeight||1;return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/o,y:(i.y-r.top-e.clientTop)/a}}}(t,e),{handled:!1,rootElement:e})}}const On={events:null,recognizers:null,recognizerOptions:{},Manager:tn,touchAction:"none",tabIndex:0};class zn{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=Object.assign({},On,e),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);const{events:n}=e;n&&this.on(n)}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||nn}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(rn).forEach((t=>{const e=this.manager.get(t);e&&rn[t].forEach((t=>{e.recognizeWith(t)}))}));for(const i in e.recognizerOptions){const t=this.manager.get(i);if(t){const n=e.recognizerOptions[i];delete n.enable,t.set(n)}}this.wheelInput=new yn(t,this._onOtherEvent,{enable:!1}),this.moveInput=new Sn(t,this._onOtherEvent,{enable:!1}),this.keyInput=new kn(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new Cn(t,this._onOtherEvent,{enable:!1});for(const[i,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(i,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const r=on[t];r&&!this.options.recognizers&&r.forEach((r=>{const o=n.get(r);e?(o.requireFailure(t),i.dropRequireFailure(r)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,r){if("string"!==typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,i,r);return}const{manager:o,events:a}=this,s=cn[t]||t;let l=a.get(s);l||(l=new Ln(this),a.set(s,l),l.recognizerName=ln[s]||s,o&&o.on(s,l.handleEvent)),l.add(t,e,n,i,r),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,e){if("string"!==typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,i=cn[t]||t,r=n.get(i);if(r&&(r.remove(t,e),r.isEmpty())){const{recognizerName:t}=r;let e=!1;for(const i of n.values())if(i.recognizerName===t&&!i.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}_onBasicInput(t){const{srcEvent:e}=t,n=an[e.type];n&&this.manager.emit(n,t)}_onOtherEvent(t){this.manager.emit(t.type,t)}}function Rn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Dn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rn(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Fn={transitionDuration:0},Bn={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new We,transitionInterruption:qe},jn=300,Nn=function(t){return 1-(1-t)*(1-t)},Vn=["wheel"],Un=["panstart","panmove","panend"],Wn=["pinchstart","pinchmove","pinchend"],Gn=["tripanstart","tripanmove","tripanend"],qn=["doubletap"],Zn=["keydown"],Hn=function(){function t(){var e=this;Ct(this,t),l(this,"events",[]),l(this,"scrollZoom",!0),l(this,"dragPan",!0),l(this,"dragRotate",!0),l(this,"doubleClickZoom",!0),l(this,"touchZoom",!0),l(this,"touchRotate",!1),l(this,"keyboard",!0),l(this,"_interactionState",{isDragging:!1}),l(this,"_events",{}),l(this,"_setInteractionState",(function(t){Object.assign(e._interactionState,t),e.onStateChange&&e.onStateChange(e._interactionState)})),l(this,"_onTransition",(function(t,n){e.onViewportChange(t,e._interactionState,n)})),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new Ke({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return It(t,[{key:"handleEvent",value:function(t){this.mapState=this.getMapState();var e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"blockEvents",value:function(t){var e=this,n=setTimeout((function(){e._eventStartBlocked===n&&(e._eventStartBlocked=null)}),t);this._eventStartBlocked=n}},{key:"updateViewport",value:function(t,e,n){var i=this.mapState instanceof ne?this.mapState.getViewportProps():this.mapState,r=Dn(Dn({},t.getViewportProps()),e),o=Object.keys(r).some((function(t){return i[t]!==r[t]}));this._state=t.getState(),this._setInteractionState(n),o&&this.onViewportChange(r,this._interactionState,i)}},{key:"getMapState",value:function(t){return new ne(Dn(Dn(Dn({},this.mapStateProps),this._state),t))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(t){var e=t.onViewportChange,n=t.onStateChange,i=t.eventManager,r=void 0===i?this.eventManager:i,o=t.isInteractive,a=void 0===o||o,s=t.scrollZoom,l=void 0===s?this.scrollZoom:s,c=t.dragPan,u=void 0===c?this.dragPan:c,h=t.dragRotate,p=void 0===h?this.dragRotate:h,d=t.doubleClickZoom,f=void 0===d?this.doubleClickZoom:d,g=t.touchZoom,m=void 0===g?this.touchZoom:g,y=t.touchRotate,v=void 0===y?this.touchRotate:y,_=t.keyboard,b=void 0===_?this.keyboard:_;this.onViewportChange=e,this.onStateChange=n;var x=this.mapStateProps||{},w=x.height!==t.height||x.width!==t.width;this.mapStateProps=t,w&&(this.mapState=x,this.updateViewport(new ne(t))),this._transitionManager.processViewportChange(t),this.eventManager!==r&&(this.eventManager=r,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Vn,a&&Boolean(l)),this.toggleEvents(Un,a&&Boolean(u||p)),this.toggleEvents(Wn,a&&Boolean(m||v)),this.toggleEvents(Gn,a&&Boolean(v)),this.toggleEvents(qn,a&&Boolean(f)),this.toggleEvents(Zn,a&&Boolean(b)),this.scrollZoom=l,this.dragPan=u,this.dragRotate=p,this.doubleClickZoom=f,this.touchZoom=m,this.touchRotate=v,this.keyboard=b}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);this._panRotate=this.isFunctionKeyPressed(t)||t.rightButton;var n=this._panRotate?this.mapState.rotateStart({pos:e}):this.mapState.panStart({pos:e});return this.updateViewport(n,Fn,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotate(t):this._onPanMove(t))}},{key:"_onPanEnd",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotateEnd(t):this._onPanMoveEnd(t))}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,Fn,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(t){if(this.dragPan){var e=this.dragPan.inertia,n=void 0===e?jn:e;if(n&&t.velocity){var i=this.getCenter(t),r=[i[0]+t.velocityX*n/2,i[1]+t.velocityY*n/2],o=this.mapState.pan({pos:r}).panEnd();return this.updateViewport(o,Dn(Dn({},Bn),{},{transitionDuration:n,transitionEasing:Nn}),{isDragging:!1,isPanning:!0}),!0}}var a=this.mapState.panEnd();return this.updateViewport(a,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=this.getCenter(t),n=this.mapState.rotate({pos:e});return this.updateViewport(n,Fn,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(t){if(this.dragRotate){var e=this.dragRotate.inertia,n=void 0===e?jn:e;if(n&&t.velocity){var i=this.getCenter(t),r=[i[0]+t.velocityX*n/2,i[1]+t.velocityY*n/2],o=this.mapState.rotate({pos:r}).rotateEnd();return this.updateViewport(o,Dn(Dn({},Bn),{},{transitionDuration:n,transitionEasing:Nn}),{isDragging:!1,isRotating:!0}),!0}}var a=this.mapState.panEnd();return this.updateViewport(a,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;var e=this.scrollZoom,n=e.speed,i=void 0===n?.01:n,r=e.smooth,o=void 0!==r&&r;t.preventDefault();var a=this.getCenter(t),s=t.delta,l=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==l&&(l=1/l);var c=this.mapState.zoom({pos:a,scale:l});return c.getViewportProps().zoom!==this.mapStateProps.zoom&&(this.updateViewport(c,Dn(Dn({},Bn),{},{transitionInterpolator:new We({around:a}),transitionDuration:o?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,Fn,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.isDragging())return!1;if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var n=t.scale,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){var r=t.rotation;e=e.rotate({deltaAngleX:this._startPinchRotation-r})}return this.updateViewport(e,Fn,{isDragging:!0,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:Boolean(this.touchRotate)}),this._lastPinchEvent=t,!0}},{key:"_onPinchEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchZoom){var e=this.touchZoom.inertia,n=void 0===e?jn:e,i=this._lastPinchEvent;if(n&&i&&t.scale!==i.scale){var r=this.getCenter(t),o=this.mapState.rotateEnd(),a=Math.log2(t.scale),s=(a-Math.log2(i.scale))/(t.deltaTime-i.deltaTime),l=Math.pow(2,a+s*n/2);return o=o.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(o,Dn(Dn({},Bn),{},{transitionInterpolator:new We({around:r}),transitionDuration:n,transitionEasing:Nn}),{isDragging:!1,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:!1}),this.blockEvents(n),!0}}var c=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(c,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(t){var e=this.getCenter(t),n=this.mapState.rotateStart({pos:e});return this.updateViewport(n,Fn,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(t){if(!this.isDragging())return!1;if(!this.touchRotate)return!1;var e=this.getCenter(t);e[0]-=t.deltaX;var n=this.mapState.rotate({pos:e});return this.updateViewport(n,Fn,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchRotate){var e=this.touchRotate.inertia,n=void 0===e?jn:e;if(n&&t.velocityY){var i=this.getCenter(t),r=[i[0],i[1]+=t.velocityY*n/2],o=this.mapState.rotate({pos:r});return this.updateViewport(o,Dn(Dn({},Bn),{},{transitionDuration:n,transitionEasing:Nn}),{isDragging:!1,isRotating:!0}),this.blockEvents(n),!1}}var a=this.mapState.rotateEnd();return this.updateViewport(a,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),n=this.isFunctionKeyPressed(t),i=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,Object.assign({},Bn,{transitionInterpolator:new We({around:e})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),i=this.keyboard,r=i.zoomSpeed,o=void 0===r?2:r,a=i.moveSpeed,s=void 0===a?100:a,l=i.rotateSpeedX,c=void 0===l?15:l,u=i.rotateSpeedY,h=void 0===u?10:u,p=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=n?this.getMapState({zoom:p.zoom-Math.log2(o)-1}):this.getMapState({zoom:p.zoom-Math.log2(o)});break;case 187:e=n?this.getMapState({zoom:p.zoom+Math.log2(o)+1}):this.getMapState({zoom:p.zoom+Math.log2(o)});break;case 37:e=n?this.getMapState({bearing:p.bearing-c}):this.mapState.pan({pos:[s,0],startPos:[0,0]});break;case 39:e=n?this.getMapState({bearing:p.bearing+c}):this.mapState.pan({pos:[-s,0],startPos:[0,0]});break;case 38:e=n?this.getMapState({pitch:p.pitch+h}):this.mapState.pan({pos:[0,s],startPos:[0,0]});break;case 40:e=n?this.getMapState({pitch:p.pitch-h}):this.mapState.pan({pos:[0,-s],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,Bn)}}]),t}();function Xn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Yn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xn(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Kn=Object.assign({},_e.propTypes,{maxZoom:c.number,minZoom:c.number,maxPitch:c.number,minPitch:c.number,onViewStateChange:c.func,onViewportChange:c.func,onInteractionStateChange:c.func,transitionDuration:c.oneOfType([c.number,c.string]),transitionInterpolator:c.object,transitionInterruption:c.number,transitionEasing:c.func,onTransitionStart:c.func,onTransitionInterrupt:c.func,onTransitionEnd:c.func,scrollZoom:c.oneOfType([c.bool,c.object]),dragPan:c.oneOfType([c.bool,c.object]),dragRotate:c.oneOfType([c.bool,c.object]),doubleClickZoom:c.bool,touchZoom:c.oneOfType([c.bool,c.object]),touchRotate:c.oneOfType([c.bool,c.object]),keyboard:c.oneOfType([c.bool,c.object]),onHover:c.func,onClick:c.func,onDblClick:c.func,onContextMenu:c.func,onMouseDown:c.func,onMouseMove:c.func,onMouseUp:c.func,onTouchStart:c.func,onTouchMove:c.func,onTouchEnd:c.func,onMouseEnter:c.func,onMouseLeave:c.func,onMouseOut:c.func,onWheel:c.func,touchAction:c.string,eventRecognizerOptions:c.object,clickRadius:c.number,interactiveLayerIds:c.array,getCursor:c.func,controller:c.instanceOf(Hn)}),Jn=Object.assign({},_e.defaultProps,Qt,Ke.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:function(t){var e=t.isDragging,n=t.isHovering;return e?"grabbing":n?"pointer":"grab"}});function Qn(t){if(t.lngLat||!t.offsetCenter)return t;var e=t.offsetCenter,n=e.x,i=e.y;if(!Number.isFinite(n)||!Number.isFinite(i))return t;var r=[n,i];return t.point=r,t.lngLat=this.viewport.unproject(r),t}function $n(t){var e=this.map;if(!e||!t)return null;var n={},i=this.props.clickRadius;this.props.interactiveLayerIds&&(n.layers=this.props.interactiveLayerIds);try{return e.queryRenderedFeatures(i?[[t[0]-i,t[1]+i],[t[0]+i,t[1]-i]]:t,n)}catch(r){return null}}function ti(t,e){var n=this.props[t];n&&n(Qn.call(this,e))}function ei(t){ti.call(this,"touch"===t.pointerType?"onTouchStart":"onMouseDown",t)}function ni(t){ti.call(this,"touch"===t.pointerType?"onTouchEnd":"onMouseUp",t)}function ii(t){if(ti.call(this,"touch"===t.pointerType?"onTouchMove":"onMouseMove",t),!this.state.isDragging){var e,n=this.props,i=n.onHover,r=n.interactiveLayerIds;t=Qn.call(this,t),(r||i)&&(e=$n.call(this,t.point));var o=Boolean(r&&e&&e.length>0),a=o&&!this.state.isHovering,s=!o&&this.state.isHovering;(i||a)&&(t.features=e,i&&i(t)),a&&ti.call(this,"onMouseEnter",t),s&&ti.call(this,"onMouseLeave",t),(a||s)&&this.setState({isHovering:o})}}function ri(t){var e=this.props,n=e.onClick,i=e.onNativeClick,r=e.onDblClick,o=e.doubleClickZoom,a=[],s=r||o;switch(t.type){case"anyclick":a.push(i),s||a.push(n);break;case"click":s&&a.push(n)}(a=a.filter(Boolean)).length&&((t=Qn.call(this,t)).features=$n.call(this,t.point),a.forEach((function(e){return e(t)})))}var oi=(0,t.forwardRef)((function(e,n){var i=(0,t.useContext)(le),o=(0,t.useMemo)((function(){return e.controller||new Hn}),[]),a=(0,t.useMemo)((function(){return new zn(null,{touchAction:e.touchAction,recognizerOptions:e.eventRecognizerOptions})}),[]),l=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)({width:0,height:0,state:{isHovering:!1,isDragging:!1}}).current;u.props=e,u.map=c.current&&c.current.getMap(),u.setState=function(t){u.state=Yn(Yn({},u.state),t),l.current.style.cursor=e.getCursor(u.state)};var h,p,d=!0,f=function(t,e,n){if(d)h=[t,e,n];else{var i=u.props,r=i.onViewStateChange,o=i.onViewportChange;r&&r({viewState:t,interactionState:e,oldViewState:n}),o&&o(t,e,n)}};(0,t.useImperativeHandle)(n,(function(){return function(t){return{getMap:t.current&&t.current.getMap,queryRenderedFeatures:t.current&&t.current.queryRenderedFeatures}}(c)}),[]);var g=(0,t.useMemo)((function(){return Yn(Yn({},i),{},{eventManager:a,container:i.container||l.current})}),[i,l.current]);g.onViewportChange=f,g.viewport=i.viewport||de(u),u.viewport=g.viewport;var m=function(t){var e=t.isDragging,n=void 0!==e&&e;if(n!==u.state.isDragging&&u.setState({isDragging:n}),d)p=t;else{var i=u.props.onInteractionStateChange;i&&i(t)}},y=function(){u.width&&u.height&&o.setOptions(Yn(Yn(Yn({},u.props),u.props.viewState),{},{isInteractive:Boolean(u.props.onViewStateChange||u.props.onViewportChange),onViewportChange:f,onStateChange:m,eventManager:a,width:u.width,height:u.height}))};(0,t.useEffect)((function(){return a.setElement(l.current),a.on({pointerdown:ei.bind(u),pointermove:ii.bind(u),pointerup:ni.bind(u),pointerleave:ti.bind(u,"onMouseOut"),click:ri.bind(u),anyclick:ri.bind(u),dblclick:ti.bind(u,"onDblClick"),wheel:ti.bind(u,"onWheel"),contextmenu:ti.bind(u,"onContextMenu")}),function(){a.destroy()}}),[]),ce((function(){h&&f.apply(void 0,s(h)),p&&m(p)})),y();var v=e.width,_=e.height,b=e.style,x=e.getCursor,w=(0,t.useMemo)((function(){return Yn(Yn({position:"relative"},b),{},{width:v,height:_,cursor:x(u.state)})}),[b,v,_,x,u.state]);return h&&u._child||(u._child=t.createElement(se,{value:g},t.createElement("div",{key:"event-canvas",ref:l,style:w},t.createElement(_e,r({},e,{width:"100%",height:"100%",style:null,onResize:function(t){var e=t.width,n=t.height;u.width=e,u.height=n,y(),u.props.onResize({width:e,height:n})},ref:c}))))),d=!1,u._child}));oi.supported=_e.supported,oi.propTypes=Kn,oi.defaultProps=Jn;function ai(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!ai(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"===Te(t)&&"object"===Te(e)){var i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(var o=0,a=i;o<a.length;o++){var s=a[o];if(!e.hasOwnProperty(s))return!1;if(!ai(t[s],e[s]))return!1}return!0}return!1}function si(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var li={type:c.string.isRequired,id:c.string},ci=0;function ui(t,e,n){if(t.style&&t.style._loaded){var i=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?si(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):si(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n);return delete i.id,delete i.children,t.addSource(e,i),t.getSource(e)}return null}function hi(e){var n=(0,t.useContext)(le),i=(0,t.useRef)({id:e.id,type:e.type}),r=h((0,t.useState)(0),2)[1],o=(0,t.useMemo)((function(){return e.id||"jsx-source-".concat(ci++)}),[]),a=n.map;(0,t.useEffect)((function(){if(a){var t=function(){return r((function(t){return t+1}))};return a.on("styledata",t),function(){a.off("styledata",t),requestAnimationFrame((function(){a.style&&a.style._loaded&&a.getSource(o)&&a.removeSource(o)}))}}}),[a,o]);var s=a&&a.style&&a.getSource(o);return s?function(t,e,n){Yt(e.id===n.id,"source id changed"),Yt(e.type===n.type,"source type changed");var i="",r=0;for(var o in e)"children"===o||"id"===o||ai(n[o],e[o])||(i=o,r++);if(r){var a=e.type;if("geojson"===a)t.setData(e.data);else if("image"===a)t.updateImage({url:e.url,coordinates:e.coordinates});else if("canvas"!==a&&"video"!==a||1!==r||"coordinates"!==i)if("vector"===a&&t.setUrl)switch(i){case"url":t.setUrl(e.url);break;case"tiles":t.setTiles(e.tiles)}else console.warn("Unable to update <Source> prop: ".concat(i));else t.setCoordinates(e.coordinates)}}(s,e,i.current):s=ui(a,o,e),i.current=e,s&&t.Children.map(e.children,(function(e){return e&&(0,t.cloneElement)(e,{source:o})}))||null}hi.propTypes=li;function pi(t,e){if(null==t)return{};var n,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}function di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function fi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?di(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var gi={type:c.oneOf(["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade"]).isRequired,id:c.string,source:c.string,beforeId:c.string};function mi(t,e,n,i){var r=n.layout,o=void 0===r?{}:r,a=n.paint,s=void 0===a?{}:a,l=n.filter,c=n.minzoom,u=n.maxzoom,h=n.beforeId,p=function(t,e){if(null==t)return{};var n,i,r=pi(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}(n,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==i.beforeId&&t.moveLayer(e,h),o!==i.layout){var d=i.layout||{};for(var f in o)ai(o[f],d[f])||t.setLayoutProperty(e,f,o[f]);for(var g in d)o.hasOwnProperty(g)||t.setLayoutProperty(e,g,void 0)}if(s!==i.paint){var m=i.paint||{};for(var y in s)ai(s[y],m[y])||t.setPaintProperty(e,y,s[y]);for(var v in m)s.hasOwnProperty(v)||t.setPaintProperty(e,v,void 0)}for(var _ in ai(l,i.filter)||t.setFilter(e,l),c===i.minzoom&&u===i.maxzoom||t.setLayerZoomRange(e,c,u),p)ai(p[_],i[_])||t.setLayerProperty(e,_,p[_])}var yi=0;function vi(e){var n=(0,t.useContext)(le),i=(0,t.useRef)({id:e.id,type:e.type}),r=h((0,t.useState)(0),2)[1],o=(0,t.useMemo)((function(){return e.id||"jsx-layer-".concat(yi++)}),[]),a=n.map;return(0,t.useEffect)((function(){if(a){var t=function(){return r((function(t){return t+1}))};return a.on("styledata",t),function(){a.off("styledata",t),a.style&&a.style._loaded&&a.removeLayer(o)}}}),[a]),a&&a.style&&a.getLayer(o)?function(t,e,n,i){Yt(n.id===i.id,"layer id changed"),Yt(n.type===i.type,"layer type changed");try{mi(t,e,n,i)}catch(r){console.warn(r)}}(a,o,e,i.current):function(t,e,n){if(t.style&&t.style._loaded){var i=fi(fi({},n),{},{id:e});delete i.beforeId,t.addLayer(i,n.beforeId)}}(a,o,e),i.current=e,null}vi.propTypes=gi;var _i={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},bi={captureScroll:c.bool,captureDrag:c.bool,captureClick:c.bool,captureDoubleClick:c.bool,capturePointerMove:c.bool};function xi(t){var e=t.containerRef.current,n=t.context.eventManager;if(e&&n){var i={wheel:function(e){var n=t.props;n.captureScroll&&e.stopPropagation(),n.onScroll&&n.onScroll(e,t)},panstart:function(e){var n=t.props;n.captureDrag&&e.stopPropagation(),n.onDragStart&&n.onDragStart(e,t)},anyclick:function(e){var n=t.props;n.captureClick&&e.stopPropagation(),n.onNativeClick&&n.onNativeClick(e,t)},click:function(e){var n=t.props;n.captureClick&&e.stopPropagation(),n.onClick&&n.onClick(e,t)},dblclick:function(e){var n=t.props;n.captureDoubleClick&&e.stopPropagation(),n.onDoubleClick&&n.onDoubleClick(e,t)},pointermove:function(e){var n=t.props;n.capturePointerMove&&e.stopPropagation(),n.onPointerMove&&n.onPointerMove(e,t)}};return n.watch(i,e),function(){n.off(i)}}}function wi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,t.useContext)(le),i=(0,t.useRef)(null),r=(0,t.useRef)({props:e,state:{},context:n,containerRef:i}),o=r.current;return o.props=e,o.context=n,(0,t.useEffect)((function(){return xi(o)}),[n.eventManager]),o}function Si(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ae(t);if(e){var r=Ae(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ke(this,n)}}function Pi(t){var e=t.instance,n=wi(t),i=n.context,r=n.containerRef;return e._context=i,e._containerRef=r,e._render()}var Ei=function(e){Ee(i,e);var n=Si(i);function i(){var e;Ct(this,i);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return l(Se(e=n.call.apply(n,[this].concat(o))),"_context",{}),l(Se(e),"_containerRef",(0,t.createRef)()),l(Se(e),"_onScroll",(function(t){})),l(Se(e),"_onDragStart",(function(t){})),l(Se(e),"_onDblClick",(function(t){})),l(Se(e),"_onClick",(function(t){})),l(Se(e),"_onPointerMove",(function(t){})),e}return It(i,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return t.createElement(Pi,r({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),i}(t.PureComponent);function Ti(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ki(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ti(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ti(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}l(Ei,"propTypes",bi),l(Ei,"defaultProps",_i);var Ai=Object.assign({},bi,{draggable:c.bool,onDrag:c.func,onDragEnd:c.func,onDragStart:c.func,offsetLeft:c.number,offsetTop:c.number}),Ci=Object.assign({},_i,{draggable:!1,offsetLeft:0,offsetTop:0});function Mi(t){var e=t.offsetCenter;return[e.x,e.y]}function Ii(t,e,n,i){var r=t[0]+e[0]-n.offsetLeft,o=t[1]+e[1]-n.offsetTop;return i.viewport.unproject([r,o])}function Li(t,e){var n=e.props,i=e.callbacks,r=e.state,o=e.context,a=e.containerRef;if(n.draggable){t.stopPropagation();var s=Mi(t),l=function(t,e){var n=t.center,i=n.x,r=n.y;if(e){var o=e.getBoundingClientRect();return[o.left-i,o.top-r]}return null}(t,a.current);if(r.setDragPos(s),r.setDragOffset(l),i.onDragStart&&l){var c=Object.assign({},t);c.lngLat=Ii(s,l,n,o),i.onDragStart(c)}}}function Oi(t){var e=t.context.eventManager;if(e&&t.state.dragPos){var n={panmove:function(e){return function(t,e){var n=e.props,i=e.callbacks,r=e.state,o=e.context;t.stopPropagation();var a=Mi(t);r.setDragPos(a);var s=r.dragOffset;if(i.onDrag&&s){var l=Object.assign({},t);l.lngLat=Ii(a,s,n,o),i.onDrag(l)}}(e,t)},panend:function(e){return function(t,e){var n=e.props,i=e.callbacks,r=e.state,o=e.context;t.stopPropagation();var a=r.dragPos,s=r.dragOffset;if(r.setDragPos(null),r.setDragOffset(null),i.onDragEnd&&a&&s){var l=Object.assign({},t);l.lngLat=Ii(a,s,n,o),i.onDragEnd(l)}}(e,t)},pancancel:function(e){return function(t,e){var n=e.state;t.stopPropagation(),n.setDragPos(null),n.setDragOffset(null)}(e,t)}};return e.watch(n),function(){e.off(n)}}}var zi="undefined"!==typeof window&&window.devicePixelRatio||1,Ri=function(t){return Math.round(t*zi)/zi},Di=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===t)return e;var i="x"===n?t.offsetWidth:t.offsetHeight;return Ri(e/100*i)/i*100};function Fi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var Bi=Object.assign({},Ai,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired,style:c.object}),ji=Object.assign({},Ci,{className:""});function Ni(e){var n=function(e){var n=h((0,t.useState)(null),2),i=n[0],r=n[1],o=h((0,t.useState)(null),2),a=o[0],s=o[1],l=wi(ki(ki({},e),{},{onDragStart:Li}));return l.callbacks=e,l.state.dragPos=i,l.state.setDragPos=r,l.state.dragOffset=a,l.state.setDragOffset=s,(0,t.useEffect)((function(){return Oi(l)}),[l.context.eventManager,Boolean(i)]),l}(e),i=n.state,r=n.containerRef,o=e.children,a=e.className,s=e.draggable,c=e.style,u=i.dragPos,p=function(t){var e=t.props,n=t.state,i=t.context,r=e.longitude,o=e.latitude,a=e.offsetLeft,s=e.offsetTop,l=n.dragPos,c=n.dragOffset;if(l&&c)return[l[0]+c[0],l[1]+c[1]];var u=h(i.viewport.project([r,o]),2),p=u[0],d=u[1];return[p+=a,d+=s]}(n),d=h(p,2),f=d[0],g=d[1],m="translate(".concat(Ri(f),"px, ").concat(Ri(g),"px)"),y=s?u?"grabbing":"grab":"auto",v=(0,t.useMemo)((function(){var e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fi(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute",left:0,top:0,transform:m,cursor:y},c);return t.createElement("div",{className:"mapboxgl-marker ".concat(a),ref:n.containerRef,style:e},o)}),[o,a]),_=r.current;return _&&(_.style.transform=m,_.style.cursor=y),v}Ni.defaultProps=ji,Ni.propTypes=Bi;t.memo(Ni);var Vi={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},Ui=Object.keys(Vi);var Wi=Object.assign({},bi,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired,altitude:c.number,offsetLeft:c.number,offsetTop:c.number,tipSize:c.number,closeButton:c.bool,closeOnClick:c.bool,anchor:c.oneOf(Object.keys(Vi)),dynamicPosition:c.bool,sortByDepth:c.bool,onClose:c.func}),Gi=Object.assign({},_i,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function qi(t,e,n,i){var r=h(i,2),o=r[0],a=r[1],s=t.anchor,l=t.dynamicPosition,c=t.tipSize;return n&&l?function(t){var e=t.x,n=t.y,i=t.width,r=t.height,o=t.selfWidth,a=t.selfHeight,s=t.anchor,l=t.padding,c=void 0===l?0:l,u=Vi[s],h=u.x,p=u.y,d=n-p*a,f=d+a,g=Math.max(0,c-d)+Math.max(0,f-r+c);if(g>0){var m=p,y=g;for(p=0;p<=1;p+=.5)f=(d=n-p*a)+a,(g=Math.max(0,c-d)+Math.max(0,f-r+c))<y&&(y=g,m=p);p=m}var v=.5;.5===p&&(h=Math.floor(h),v=1);var _=e-h*o,b=_+o,x=Math.max(0,c-_)+Math.max(0,b-i+c);if(x>0){var w=h,S=x;for(h=0;h<=1;h+=v)b=(_=e-h*o)+o,(x=Math.max(0,c-_)+Math.max(0,b-i+c))<S&&(S=x,w=h);h=w}return Ui.find((function(t){var e=Vi[t];return e.x===h&&e.y===p}))||s}({x:o,y:a,anchor:s,padding:c,width:e.width,height:e.height,selfWidth:n.clientWidth,selfHeight:n.clientHeight}):s}function Zi(e){var n=(0,t.useRef)(null),i=wi(e),r=i.context,o=i.containerRef,a=h((0,t.useState)(!1),2)[1];(0,t.useEffect)((function(){a(!0)}),[n.current]),(0,t.useEffect)((function(){if(r.eventManager&&e.closeOnClick){var t=function(){return i.props.onClose()};return r.eventManager.on("anyclick",t),function(){r.eventManager.off("anyclick",t)}}}),[r.eventManager,e.closeOnClick]);var s=r.viewport,l=e.className,c=e.longitude,u=e.latitude,p=e.altitude,d=e.tipSize,f=e.closeButton,g=e.children,m=s.project([c,u,p]),y=qi(e,s,n.current,m),v=function(t,e,n,i,r){var o=h(i,3),a=o[0],s=o[1],l=o[2],c=t.offsetLeft,u=t.offsetTop,p=t.sortByDepth,d=Vi[r],f=a+c,g=s+u,m=Di(n,100*-d.x),y=Di(n,100*-d.y,"y"),v={position:"absolute",transform:"\n      translate(".concat(m,"%, ").concat(y,"%)\n      translate(").concat(Ri(f),"px, ").concat(Ri(g),"px)\n    "),display:void 0,zIndex:void 0};return p?(l>1||l<-1||a<0||a>e.width||s<0||s>e.height?v.display="none":v.zIndex=Math.floor((1-l)/2*1e5),v):v}(e,s,o.current,m,y),_=(0,t.useCallback)((function(t){i.props.onClose();var e=i.context.eventManager;e&&e.once("click",(function(t){return t.stopPropagation()}),t.target)}),[]);return t.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(y," ").concat(l),style:v,ref:o},t.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:d}}),t.createElement("div",{key:"content",ref:n,className:"mapboxgl-popup-content"},f&&t.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:_},"\xd7"),g))}Zi.propTypes=Wi,Zi.defaultProps=Gi;t.memo(Zi);function Hi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var Xi=Object.assign({},bi,{toggleLabel:c.string,className:c.string,style:c.object,compact:c.bool,customAttribution:c.oneOfType([c.string,c.arrayOf(c.string)])}),Yi=Object.assign({},_i,{className:"",toggleLabel:"Toggle Attribution"});function Ki(e){var n=wi(e),i=n.context,r=n.containerRef,o=(0,t.useRef)(null),a=h((0,t.useState)(!1),2),s=a[0],c=a[1];(0,t.useEffect)((function(){var t;return i.map&&(t=function(t,e,n,i){var r=new(Gt().AttributionControl)(t);return r._map=e,r._container=n,r._innerContainer=i,r._updateAttributions(),r._updateEditLink(),e.on("styledata",r._updateData),e.on("sourcedata",r._updateData),r}({customAttribution:e.customAttribution},i.map,r.current,o.current)),function(){return t&&function(t){t._map.off("styledata",t._updateData),t._map.off("sourcedata",t._updateData)}(t)}}),[i.map]);var u=void 0===e.compact?i.viewport.width<=640:e.compact;(0,t.useEffect)((function(){!u&&s&&c(!1)}),[u]);var p=(0,t.useCallback)((function(){return c((function(t){return!t}))}),[]),d=(0,t.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Hi(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},e.style)}),[e.style]);return t.createElement("div",{style:d,className:e.className},t.createElement("div",{ref:r,"aria-pressed":s,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(u?"mapboxgl-compact":""," ").concat(s?"mapboxgl-compact-show":"")},t.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:e.toggleLabel,onClick:p}),t.createElement("div",{ref:o,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}Ki.propTypes=Xi,Ki.defaultProps=Yi;t.memo(Ki);function Ji(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var Qi=Object.assign({},bi,{className:c.string,style:c.object,container:c.object,label:c.string}),$i=Object.assign({},_i,{className:"",container:null,label:"Toggle fullscreen"});function tr(e){var n=wi(e),i=n.context,r=n.containerRef,o=h((0,t.useState)(!1),2),a=o[0],s=o[1],c=h((0,t.useState)(!1),2),u=c[0],p=c[1],d=h((0,t.useState)(null),2),f=d[0],g=d[1];(0,t.useEffect)((function(){var t=new(Gt().FullscreenControl);g(t),p(t._checkFullscreenSupport());var e=function(){var e=!t._fullscreen;t._fullscreen=e,s(e)};return Lt.addEventListener(t._fullscreenchange,e),function(){Lt.removeEventListener(t._fullscreenchange,e)}}),[]);var m=(0,t.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ji(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ji(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},e.style)}),[e.style]);if(!u)return null;var y=e.className,v=e.label,_=a?"shrink":"fullscreen";return t.createElement("div",{style:m,className:y},t.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},t.createElement("button",{key:_,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(_),type:"button",title:v,onClick:function(){f&&(f._container=e.container||i.container,f._onClickFullscreen())}},t.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}tr.propTypes=Qi,tr.defaultProps=$i;t.memo(tr);var er;function nr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var ir=function(){},rr=Object.assign({},bi,{className:c.string,style:c.object,label:c.string,disabledLabel:c.string,auto:c.bool,positionOptions:c.object,fitBoundsOptions:c.object,trackUserLocation:c.bool,showUserLocation:c.bool,showAccuracyCircle:c.bool,showUserHeading:c.bool,onViewStateChange:c.func,onViewportChange:c.func,onGeolocate:c.func}),or=Object.assign({},_i,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showUserHeading:!1,showAccuracyCircle:!0,onGeolocate:function(){}});function ar(t,e){var n=e.context,i=e.props,r=function(t){var e=new(Gt().LngLat)(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,i=e.toBounds(n);return[[i._ne.lng,i._ne.lat],[i._sw.lng,i._sw.lat]]}(t),o=n.viewport.fitBounds(r,i.fitBoundsOptions),a=o.longitude,s=o.latitude,l=o.zoom,c=Object.assign({},n.viewport,{longitude:a,latitude:s,zoom:l}),u=new ne(c),h=Object.assign({},u.getViewportProps(),Bn),p=i.onViewportChange||n.onViewportChange||ir;(i.onViewStateChange||n.onViewStateChange||ir)({viewState:h}),p(h)}function sr(e){var n=wi(e),i=n.context,r=n.containerRef,o=(0,t.useRef)(null),a=h((0,t.useState)(null),2),s=a[0],c=a[1],u=h((0,t.useState)(!1),2),p=u[0],d=u[1];(0,t.useEffect)((function(){var t;return i.map&&(void 0!==er?Promise.resolve(er):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){return er="denied"!==t.state})):(er=Boolean(window.navigator.geolocation),Promise.resolve(er))).then((function(r){d(r),o.current&&(t=function(t,e,n){var i=new(Gt().GeolocateControl)(e);i._container=Lt.createElement("div"),i._map={on:function(){},_getUIString:function(){return""}},i._setupUI(!0),i._map=t.map,i._geolocateButton=n;var r=t.eventManager;return i.options.trackUserLocation&&r&&r.on("panstart",(function(){"ACTIVE_LOCK"===i._watchState&&(i._watchState="BACKGROUND",n.classList.add("mapboxgl-ctrl-geolocate-background"),n.classList.remove("mapboxgl-ctrl-geolocate-active"))})),i.on("geolocate",e.onGeolocate),i}(i,e,o.current),t._updateCamera=function(t){return ar(t,n)},c(t))})),function(){t&&t._clearWatch()}}),[i.map]);var f=(0,t.useCallback)((function(){s&&(s.options=n.props,s.trigger())}),[s]);(0,t.useEffect)((function(){e.auto&&f()}),[s,e.auto]),(0,t.useEffect)((function(){s&&s._onZoom()}),[i.viewport.zoom]);var g=e.className,m=e.label,y=e.disabledLabel,v=e.trackUserLocation,_=(0,t.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nr(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},e.style)}),[e.style]);return t.createElement("div",{style:_,className:g},t.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},t.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:o,disabled:!p,"aria-pressed":!v,type:"button",title:p?m:y,"aria-label":p?m:y,onClick:f},t.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}sr.propTypes=rr,sr.defaultProps=or;t.memo(sr);function lr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var cr=function(){},ur=Object.assign({},bi,{className:c.string,style:c.object,onViewStateChange:c.func,onViewportChange:c.func,showCompass:c.bool,showZoom:c.bool,zoomInLabel:c.string,zoomOutLabel:c.string,compassLabel:c.string}),hr=Object.assign({},_i,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function pr(t){return function(t,e){for(var n=(t||"").split(".").map(Number),i=(e||"").split(".").map(Number),r=0;r<3;r++){var o=n[r]||0,a=i[r]||0;if(o<a)return-1;if(o>a)return 1}return 0}(t,"1.6.0")>=0?2:1}function dr(t,e,n){var i=t.viewport,r=new ne(Object.assign({},i,n)),o=Object.assign({},r.getViewportProps(),Bn),a=e.onViewportChange||t.onViewportChange||cr;(e.onViewStateChange||t.onViewStateChange||cr)({viewState:o}),a(o)}function fr(e,n,i,r){return t.createElement("button",{key:e,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(e),type:"button",title:n,onClick:i},r||t.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function gr(e){var n=wi(e),i=n.context,r=n.containerRef,o=e.className,a=e.showCompass,s=e.showZoom,c=e.zoomInLabel,u=e.zoomOutLabel,h=e.compassLabel,p=(0,t.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lr(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},e.style)}),[e.style]);return t.createElement("div",{style:p,className:o},t.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},s&&fr("zoom-in",c,(function(){dr(i,e,{zoom:i.viewport.zoom+1})})),s&&fr("zoom-out",u,(function(){dr(i,e,{zoom:i.viewport.zoom-1})})),a&&fr("compass",h,(function(){dr(i,e,{bearing:0,pitch:0})}),function(e){var n=(0,t.useMemo)((function(){return e.map?pr(e.map.version):2}),[e.map]),i=e.viewport.bearing,r={transform:"rotate(".concat(-i,"deg)")};return 2===n?t.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:r}):t.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:r})}(i))))}gr.propTypes=ur,gr.defaultProps=hr;t.memo(gr);function mr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var yr=Object.assign({},bi,{className:c.string,style:c.object,maxWidth:c.number,unit:c.oneOf(["imperial","metric","nautical"])}),vr=Object.assign({},_i,{className:"",maxWidth:100,unit:"metric"});function _r(e){var n=wi(e),i=n.context,r=n.containerRef,o=h((0,t.useState)(null),2),a=o[0],s=o[1];(0,t.useEffect)((function(){if(i.map){var t=new(Gt().ScaleControl);t._map=i.map,t._container=r.current,s(t)}}),[i.map]),a&&(a.options=e,a._onMove());var c=(0,t.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mr(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},e.style)}),[e.style]);return t.createElement("div",{style:c,className:e.className},t.createElement("div",{ref:r,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}_r.propTypes=yr,_r.defaultProps=vr;t.memo(_r);var br="undefined"!==typeof window&&window.devicePixelRatio||1,xr=Object.assign({},bi,{redraw:c.func.isRequired});function wr(e){var n=wi(e),i=n.context,r=n.containerRef,o=h((0,t.useState)(null),2),a=o[0],s=o[1];(0,t.useEffect)((function(){s(r.current.getContext("2d"))}),[]);var l=i.viewport,c=i.isDragging;return a&&(a.save(),a.scale(br,br),e.redraw({width:l.width,height:l.height,ctx:a,isDragging:c,project:l.project,unproject:l.unproject}),a.restore()),t.createElement("canvas",{ref:r,width:l.width*br,height:l.height*br,style:{width:"".concat(l.width,"px"),height:"".concat(l.height,"px"),position:"absolute",left:0,top:0}})}wr.propTypes=xr,wr.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function Sr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var Pr=Object.assign({},bi,{redraw:c.func.isRequired,style:c.object});function Er(e){var n=wi(e),i=n.context,r=n.containerRef,o=i.viewport,a=i.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sr(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute",left:0,top:0,width:o.width,height:o.height},e.style);return t.createElement("div",{ref:r,style:s},e.redraw({width:o.width,height:o.height,isDragging:a,project:o.project,unproject:o.unproject}))}Er.propTypes=Pr,Er.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function Tr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var kr=Object.assign({},bi,{redraw:c.func.isRequired,style:c.object});function Ar(e){var n=wi(e),i=n.context,r=n.containerRef,o=i.viewport,a=i.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tr(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute",left:0,top:0},e.style);return t.createElement("svg",{width:o.width,height:o.height,ref:r,style:s},e.redraw({width:o.width,height:o.height,isDragging:a,project:o.project,unproject:o.unproject}))}Ar.propTypes=kr,Ar.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};Gt()&&Gt().setRTLTextPlugin;const Cr=[255,255,255],Mr=1;let Ir=0;class Lr{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e=Cr}=t,{intensity:n=Mr}=t;this.id=t.id||"ambient-".concat(Ir++),this.color=e,this.intensity=n,this.type="ambient"}}function Or(t){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof process&&"object"===typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function zr(){return!("object"===typeof process&&"[object process]"===String(process)&&!process.browser)||Or()}const Rr="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source";zr();class Dr{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";l(this,"storage",void 0),l(this,"id",void 0),l(this,"config",{}),this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function Fr(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}let Br;function jr(t){return"string"===typeof t?Br[t.toUpperCase()]||Br.WHITE:t}function Nr(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(Br||(Br={}));const Vr={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document,process:"object"===typeof process&&process},Ur=globalThis,Wr=Vr.window||Vr.self||Vr.global,Gr=Vr.process||{};console;function qr(){let t;var e,n;if(zr&&"performance"in Wr)t=null===Wr||void 0===Wr||null===(e=Wr.performance)||void 0===e||null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in Gr){var i;const e=null===Gr||void 0===Gr||null===(i=Gr.hrtime)||void 0===i?void 0:i.call(Gr);t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const Zr={debug:zr&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Hr={enabled:!0,level:0};function Xr(){}const Yr={},Kr={once:!0};class Jr{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};l(this,"id",void 0),l(this,"VERSION",Rr),l(this,"_startTs",qr()),l(this,"_deltaTs",qr()),l(this,"_storage",void 0),l(this,"userData",{}),l(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this._storage=new Dr("__probe-".concat(this.id,"__"),Hr),this.userData={},this.timeStamp("".concat(this.id," started")),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)"function"===typeof t[r]&&(e.find((t=>r===t))||(t[r]=t[r].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((qr()-this._startTs).toPrecision(10))}getDelta(){return Number((qr()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){Nr(t,e)}warn(t){return this._getLogFunction(0,t,Zr.warn,arguments,Kr)}error(t){return this._getLogFunction(0,t,Zr.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Zr.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Zr.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this._getLogFunction(t,e,Zr.debug||Zr.info,arguments,Kr)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||Xr,n&&[n],{tag:to(e)}):Xr}image(t){let{logLevel:e,priority:i,image:r,message:o="",scale:a=1}=t;return this._shouldLog(e||i)?zr?function(t){let{image:e,message:n="",scale:i=1}=t;if("string"===typeof e){const t=new Image;return t.onload=()=>{const e=Fr(t,n,i);console.log(...e)},t.src=e,Xr}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...Fr(e,n,i)),Xr;if("canvas"===r.toLowerCase()){const t=new Image;return t.onload=()=>console.log(...Fr(t,n,i)),t.src=e.toDataURL(),Xr}return Xr}({image:r,message:o,scale:a}):function(t){let{image:e,message:i="",scale:r=1}=t,o=null;try{o=n(214)}catch(a){}if(o)return()=>o(e,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then((t=>console.log(t)));return Xr}({image:r,message:o,scale:a}):Xr}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||Xr)}group(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=$r({logLevel:t,message:e,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Xr)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=Qr(t)}_getLogFunction(t,e,n,i,r){if(this._shouldLog(t)){r=$r({logLevel:t,message:e,args:i,opts:r}),Nr(n=n||r.method),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=qr();const o=r.tag||r.message;if(r.once){if(Yr[o])return Xr;Yr[o]=qr()}return e=function(t,e,n){if("string"===typeof e){const i=n.time?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";e=function(t,e,n){return zr||"string"!==typeof t||(e&&(e=jr(e),t="\x1b[".concat(e,"m").concat(t,"\x1b[39m")),n&&(e=jr(n),t="\x1b[".concat(n+10,"m").concat(t,"\x1b[49m"))),t}(e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),n.color,n.background)}return e}(this.id,r.message,r),n.bind(console,e,...r.args)}return Xr}}function Qr(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Nr(Number.isFinite(e)&&e>=0),e}function $r(t){const{logLevel:e,message:n}=t;t.logLevel=Qr(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"===typeof t.message&&(t.message=t.message());const r=typeof t.message;return Nr("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function to(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}l(Jr,"VERSION",Rr);const eo=new Jr({id:"deck"}),no={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(no,"IDENTITY",{get:()=>eo.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const io={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},ro={common:0,meters:1,pixels:2},oo={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},ao="draw",so="mask";function lo(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],d=e[11],f=e[12],g=e[13],m=e[14],y=e[15],v=n*s-i*a,_=n*l-r*a,b=n*c-o*a,x=i*l-r*s,w=i*c-o*s,S=r*c-o*l,P=u*g-h*f,E=u*m-p*f,T=u*y-d*f,k=h*m-p*g,A=h*y-d*g,C=p*y-d*m,M=v*C-_*A+b*k+x*T-w*E+S*P;return M?(M=1/M,t[0]=(s*C-l*A+c*k)*M,t[1]=(r*A-i*C-o*k)*M,t[2]=(g*S-m*w+y*x)*M,t[3]=(p*w-h*S-d*x)*M,t[4]=(l*T-a*C-c*E)*M,t[5]=(n*C-r*T+o*E)*M,t[6]=(m*b-f*S-y*_)*M,t[7]=(u*S-p*b+d*_)*M,t[8]=(a*A-s*T+c*P)*M,t[9]=(i*T-n*A-o*P)*M,t[10]=(f*w-g*b+y*v)*M,t[11]=(h*b-u*w-d*v)*M,t[12]=(s*E-a*k-l*P)*M,t[13]=(n*k-i*E+r*P)*M,t[14]=(g*_-f*x-m*v)*M,t[15]=(u*x-h*_+p*v)*M,t):null}function co(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*i+b*s+x*h+w*g,t[1]=_*r+b*l+x*p+w*m,t[2]=_*o+b*c+x*d+w*y,t[3]=_*a+b*u+x*f+w*v,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*i+b*s+x*h+w*g,t[5]=_*r+b*l+x*p+w*m,t[6]=_*o+b*c+x*d+w*y,t[7]=_*a+b*u+x*f+w*v,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*i+b*s+x*h+w*g,t[9]=_*r+b*l+x*p+w*m,t[10]=_*o+b*c+x*d+w*y,t[11]=_*a+b*u+x*f+w*v,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*i+b*s+x*h+w*g,t[13]=_*r+b*l+x*p+w*m,t[14]=_*o+b*c+x*d+w*y,t[15]=_*a+b*u+x*f+w*v,t}var uo="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function ho(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=function(){var t=new uo(4);return uo!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();function po(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function fo(t){let e,n={};return i=>{for(const r in i)if(!po(i[r],n[r])){e=t(i),n=i;break}return e}}const go=[0,0,0,0],mo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],yo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],vo=[0,0,0],_o=[0,0,0],bo=fo((function(t){let{viewport:e,devicePixelRatio:n,coordinateSystem:i,coordinateOrigin:r}=t;const{projectionCenter:o,viewProjectionMatrix:a,originCommon:s,cameraPosCommon:l,shaderCoordinateOrigin:c,geospatialOrigin:u}=function(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:o,viewProjectionMatrix:a}=t,s=go,l=go,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:p}=xo(t,e,n);p&&(l=t.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,s=ho([],l,a),o=i||o,a=co([],r,o),a=co([],a,mo));return{viewMatrix:o,viewProjectionMatrix:a,projectionCenter:s,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(e,i,r),h=e.getDistanceScales(),p=[e.width*n,e.height*n],d=ho([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,f={project_uCoordinateSystem:i,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:s.slice(0,3),project_uCenter:o,project_uPseudoMeters:Boolean(e._pseudoMeters),project_uViewportSize:p,project_uDevicePixelRatio:n,project_uFocalDistance:d,project_uCommonUnitsPerMeter:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit:h.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:vo,project_uScale:e.scale,project_uViewProjectionMatrix:a,project_uCameraPosition:l};if(u){const t=e.getDistanceScales(u);switch(i){case no.METER_OFFSETS:f.project_uCommonUnitsPerWorldUnit=t.unitsPerMeter,f.project_uCommonUnitsPerWorldUnit2=t.unitsPerMeter2;break;case no.LNGLAT:case no.LNGLAT_OFFSETS:e._pseudoMeters||(f.project_uCommonUnitsPerMeter=t.unitsPerMeter),f.project_uCommonUnitsPerWorldUnit=t.unitsPerDegree,f.project_uCommonUnitsPerWorldUnit2=t.unitsPerDegree2;break;case no.CARTESIAN:f.project_uCommonUnitsPerWorldUnit=[1,1,t.unitsPerMeter[2]],f.project_uCommonUnitsPerWorldUnit2=[0,0,t.unitsPerMeter2[2]]}}return f}));function xo(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_o;n.length<3&&(n=[n[0],n[1],0]);let i,r=n,o=!0;switch(i=e===no.LNGLAT_OFFSETS||e===no.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case io.WEB_MERCATOR:e!==no.LNGLAT&&e!==no.CARTESIAN||(i=[0,0,0],o=!1);break;case io.WEB_MERCATOR_AUTO_OFFSET:e===no.LNGLAT?r=i:e===no.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case io.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case io.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}function wo(){let{viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=no.DEFAULT,coordinateOrigin:r,autoWrapLongitude:o=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i===no.DEFAULT&&(i=t.isGeospatial?no.LNGLAT:no.CARTESIAN);const a=bo({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return a.project_uWrapLongitude=o,a.project_uModelMatrix=n||yo,a}const So=new class{constructor(t){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}setProps(t){Object.assign(this.props,t)}allocate(t,e,n){let{size:i=1,type:r,padding:o=0,copy:a=!1,initialize:s=!1,maxCount:l}=n;const c=r||t&&t.constructor||Float32Array,u=e*i+o;if(ArrayBuffer.isView(t)){if(u<=t.length)return t;if(u*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new c(t.buffer,0,u)}let h;l&&(h=l*i+o);const p=this._allocate(c,u,s,h);return t&&a?p.set(t):s||p.fill(0,0,4),this._release(t),p}release(t){this._release(t)}_allocate(t,e,n,i){let r=Math.max(Math.ceil(e*this.props.overAlloc),1);r>i&&(r=i);const o=this._pool,a=t.BYTES_PER_ELEMENT*r,s=o.findIndex((t=>t.byteLength>=a));if(s>=0){const e=new t(o.splice(s,1)[0],0,r);return n&&e.fill(0),e}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,r=e.findIndex((t=>t.byteLength>=i));r<0?e.push(n):(r>0||e.length<this.props.poolSize)&&e.splice(r,0,n),e.length>this.props.poolSize&&e.shift()}},Po=(Math.PI,Math.PI,{});function Eo(t){return Math.round(t/Po.EPSILON)*Po.EPSILON}function To(t){let{precision:e=Po.precision||4}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=Eo(t),"".concat(parseFloat(t.toPrecision(e)))}function ko(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ao(t,e,n){if(ko(t)){n=n||((i=t).clone?i.clone():new Array(i.length));for(let i=0;i<n.length&&i<t.length;++i)n[i]=e(t[i],i,n);return n}var i;return e(t)}function Co(t,e,n){return Ao(t,(t=>Math.max(e,Math.min(n,t))))}function Mo(t,e,n){return ko(t)?t.map(((t,i)=>Mo(t,e[i],n))):n*e+(1-n)*t}function Io(t,e,n){const i=Po.EPSILON;n&&(Po.EPSILON=n);try{if(t===e)return!0;if(ko(t)&&ko(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Io(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=Po.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{Po.EPSILON=i}}function Lo(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}Po.EPSILON=1e-12,Po.debug=!1,Po.precision=4,Po.printTypes=!1,Po.printDegrees=!1,Po.printRowMajor=!0;class Oo extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return Lo(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}to(t){return t===this?this:ko(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Po)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+To(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Io(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){void 0===n&&(n=e,e=t,t=this);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+n*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]+=i[t];return this.check()}subtract(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]-=i[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(Po.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}function zo(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ro(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Do(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(Po.debug&&!zo(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}const Fo={};function Bo(t,e){Fo[t]||(Fo[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}class jo extends Oo{get ELEMENTS(){return Lo(!1),0}copy(t){return Lo(!1),this}get x(){return this[0]}set x(t){this[0]=Ro(t)}get y(){return this[1]}set y(t){this[1]=Ro(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return Ro(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Ro(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=i[t];return this.check()}divide(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const i of e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=i[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Lo(t>=0&&t<this.ELEMENTS,"index is out of range"),Ro(this[t])}setComponent(t,e){return Lo(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var No=1e-6,Vo="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function Uo(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[3]*i+n[7]*r+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/a,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/a,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/a,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=function(){var t=new Vo(3);return Vo!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function Wo(t,e,n){const i=e[0],r=e[1],o=e[2],a=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/a,t[1]=(n[1]*i+n[5]*r+n[9]*o)/a,t[2]=(n[2]*i+n[6]*r+n[10]*o)/a,t}const Go=[0,0,0],qo={};class Zo extends jo{static get ZERO(){return qo.ZERO=qo.ZERO||Object.freeze(new Zo(0,0,0,0))}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(-0,-0,-0),1===arguments.length&&ko(t)?this.copy(t):(Po.debug&&(Ro(t),Ro(e),Ro(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Po.debug&&(Ro(t.x),Ro(t.y),Ro(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Ro(t)}angle(t){return function(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],a=e[1],s=e[2],l=Math.sqrt(n*n+i*i+r*r)*Math.sqrt(o*o+a*a+s*s),c=l&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}(this,t)}cross(t){return function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],l=n[2];t[0]=r*l-o*s,t[1]=o*a-i*l,t[2]=i*s-r*a}(this,this,t),this.check()}rotateX(t){let{radians:e,origin:n=Go}=t;return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,n,e),this.check()}rotateY(t){let{radians:e,origin:n=Go}=t;return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,n,e),this.check()}rotateZ(t){let{radians:e,origin:n=Go}=t;return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,n,e),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Uo(this,this,t),this.check()}transformAsVector(t){return Wo(this,this,t),this.check()}transformByMatrix3(t){return function(t,e,n){var i=e[0],r=e[1],o=e[2];t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8]}(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return function(t,e,n){var i=n[0],r=n[1],o=n[2],a=n[3],s=e[0],l=e[1],c=e[2],u=r*c-o*l,h=o*s-i*c,p=i*l-r*s,d=r*p-o*h,f=o*u-i*p,g=i*h-r*u,m=2*a;u*=m,h*=m,p*=m,d*=2,f*=2,g*=2,t[0]=s+u+d,t[1]=l+h+f,t[2]=c+p+g}(this,this,t),this.check()}}const Ho=new Zo;function Xo(t,e,n,i){Ho.set(t,e,n);const r=Ho.len();return{distance:i/r,normal:new Zo(-t/r,-e/r,-n/r)}}let Yo;function Ko(t,e){const{size:n=1,startIndex:i=0}=e,r=void 0!==e.endIndex?e.endIndex:t.length,o=(r-i)/n;Yo=So.allocate(Yo,o,{type:Float32Array,size:2*n});let a=i,s=0;for(;a<r;){for(let e=0;e<n;e++){const i=t[a++];Yo[s+e]=i,Yo[s+e+n]=(l=i)-Math.fround(l)}s+=2*n}var l;return Yo.subarray(0,o*n*2)}class Jo extends Oo{get ELEMENTS(){return Lo(!1),0}get RANK(){return Lo(!1),0}toString(){let t="[";if(Po.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Ro(n),this}getColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0);const n=t*this.RANK;for(let i=0;i<this.RANK;++i)e[i]=this[n+i];return e}setColumn(t,e){const n=t*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=e[i];return this}}function Qo(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*i+b*s+x*h+w*g,t[1]=_*r+b*l+x*p+w*m,t[2]=_*o+b*c+x*d+w*y,t[3]=_*a+b*u+x*f+w*v,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*i+b*s+x*h+w*g,t[5]=_*r+b*l+x*p+w*m,t[6]=_*o+b*c+x*d+w*y,t[7]=_*a+b*u+x*f+w*v,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*i+b*s+x*h+w*g,t[9]=_*r+b*l+x*p+w*m,t[10]=_*o+b*c+x*d+w*y,t[11]=_*a+b*u+x*f+w*v,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*i+b*s+x*h+w*g,t[13]=_*r+b*l+x*p+w*m,t[14]=_*o+b*c+x*d+w*y,t[15]=_*a+b*u+x*f+w*v,t}function $o(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}!function(){var t=function(){var t=new Vo(2);return Vo!=Float32Array&&(t[0]=0,t[1]=0),t}()}();!function(){var t=function(){var t=new Vo(4);return Vo!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();const ta=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ea=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),na=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),ia={};class ra extends Jo{static get IDENTITY(){return ia.IDENTITY=ia.IDENTITY||Object.freeze(new ra(ta)),ia.IDENTITY}static get ZERO(){return ia.ZERO=ia.ZERO||Object.freeze(new ra(ea)),ia.ZERO}get INDICES(){return na}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=a,this[7]=s,this[8]=l,this[9]=c,this[10]=u,this[11]=h,this[12]=p,this[13]=d,this[14]=f,this[15]=g,this.check()}setRowMajor(t,e,n,i,r,o,a,s,l,c,u,h,p,d,f,g){return this[0]=t,this[1]=r,this[2]=l,this[3]=p,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=a,this[10]=u,this[11]=f,this[12]=i,this[13]=s,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(ta)}fromQuaternion(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,l=r+r,c=n*a,u=i*a,h=i*s,p=r*a,d=r*s,f=r*l,g=o*a,m=o*s,y=o*l;t[0]=1-h-f,t[1]=u+y,t[2]=p-m,t[3]=0,t[4]=u-y,t[5]=1-c-f,t[6]=d+g,t[7]=0,t[8]=p+m,t[9]=d-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum(t){let{left:e,right:n,bottom:i,top:r,near:o,far:a}=t;return a===1/0?ra._computeInfinitePerspectiveOffCenter(this,e,n,i,r,o):function(t,e,n,i,r,o,a){var s=1/(n-e),l=1/(r-i),c=1/(o-a);t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*l,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0}(this,e,n,i,r,o,a),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,n,i,r,o){const a=2*o/(n-e),s=2*o/(r-i),l=(n+e)/(n-e),c=(r+i)/(r-i),u=-2*o;return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0,t}lookAt(t,e,n){return 1===arguments.length&&({eye:t,center:e,up:n}=t),function(t,e,n,i){var r,o,a,s,l,c,u,h,p,d,f=e[0],g=e[1],m=e[2],y=i[0],v=i[1],_=i[2],b=n[0],x=n[1],w=n[2];Math.abs(f-b)<No&&Math.abs(g-x)<No&&Math.abs(m-w)<No?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(u=f-b,h=g-x,p=m-w,r=v*(p*=d=1/Math.hypot(u,h,p))-_*(h*=d),o=_*(u*=d)-y*p,a=y*h-v*u,(d=Math.hypot(r,o,a))?(r*=d=1/d,o*=d,a*=d):(r=0,o=0,a=0),s=h*a-p*o,l=p*r-u*a,c=u*o-h*r,(d=Math.hypot(s,l,c))?(s*=d=1/d,l*=d,c*=d):(s=0,l=0,c=0),t[0]=r,t[1]=s,t[2]=u,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=a,t[9]=c,t[10]=p,t[11]=0,t[12]=-(r*f+o*g+a*m),t[13]=-(s*f+l*g+c*m),t[14]=-(u*f+h*g+p*m),t[15]=1)}(this,t,e=e||[0,0,0],n=n||[0,1,0]),this.check()}ortho(t){let{left:e,right:n,bottom:i,top:r,near:o=.1,far:a=500}=t;return function(t,e,n,i,r,o,a){var s=1/(e-n),l=1/(i-r),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(a+o)*c,t[15]=1}(this,e,n,i,r,o,a),this.check()}orthographic(t){let{fovy:e=45*Math.PI/180,aspect:n=1,focalDistance:i=1,near:r=.1,far:o=500}=t;if(e>2*Math.PI)throw Error("radians");const a=e/2,s=i*Math.tan(a),l=s*n;return(new ra).ortho({left:-l,right:l,bottom:-s,top:s,near:r,far:o})}perspective(){let{fovy:t,fov:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t=t||e,t>2*Math.PI)throw Error("radians");return function(t,e,n,i,r){var o,a=1/Math.tan(e/2);t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i)}(this,t,n,i,r),this.check()}determinant(){return function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],p=t[11],d=t[12],f=t[13],g=t[14],m=t[15];return(e*a-n*o)*(h*m-p*g)-(e*s-i*o)*(u*m-p*f)+(e*l-r*o)*(u*g-h*f)+(n*s-i*a)*(c*m-p*d)-(n*l-r*a)*(c*g-h*d)+(i*l-r*s)*(c*f-u*d)}(this)}getScale(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getScale(e||[-0,-0,-0]),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getScale(e||[-0,-0,-0]),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],d=e[11],f=e[12],g=e[13],m=e[14],y=e[15],v=n*s-i*a,_=n*l-r*a,b=n*c-o*a,x=i*l-r*s,w=i*c-o*s,S=r*c-o*l,P=u*g-h*f,E=u*m-p*f,T=u*y-d*f,k=h*m-p*g,A=h*y-d*g,C=p*y-d*m,M=v*C-_*A+b*k+x*T-w*E+S*P;M&&(M=1/M,t[0]=(s*C-l*A+c*k)*M,t[1]=(r*A-i*C-o*k)*M,t[2]=(g*S-m*w+y*x)*M,t[3]=(p*w-h*S-d*x)*M,t[4]=(l*T-a*C-c*E)*M,t[5]=(n*C-r*T+o*E)*M,t[6]=(m*b-f*S-y*_)*M,t[7]=(u*S-p*b+d*_)*M,t[8]=(a*A-s*T+c*P)*M,t[9]=(i*T-n*A-o*P)*M,t[10]=(f*w-g*b+y*v)*M,t[11]=(h*b-u*w-d*v)*M,t[12]=(s*E-a*k-l*P)*M,t[13]=(n*k-i*E+r*P)*M,t[14]=(g*_-f*x-m*v)*M,t[15]=(u*x-h*_+p*v)*M)}(this,this),this.check()}multiplyLeft(t){return Qo(this,t,this),this.check()}multiplyRight(t){return Qo(this,this,t),this.check()}rotateX(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],p=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+c*i,t[5]=a*r+u*i,t[6]=s*r+h*i,t[7]=l*r+p*i,t[8]=c*r-o*i,t[9]=u*r-a*i,t[10]=h*r-s*i,t[11]=p*r-l*i}(this,this,t),this.check()}rotateY(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],c=e[8],u=e[9],h=e[10],p=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-c*i,t[1]=a*r-u*i,t[2]=s*r-h*i,t[3]=l*r-p*i,t[8]=o*i+c*r,t[9]=a*i+u*r,t[10]=s*i+h*r,t[11]=l*i+p*r}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],p=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+c*i,t[1]=a*r+u*i,t[2]=s*r+h*i,t[3]=l*r+p*i,t[4]=c*r-o*i,t[5]=u*r-a*i,t[6]=h*r-s*i,t[7]=p*r-l*i}(this,this,t),this.check()}rotateXYZ(t){let[e,n,i]=t;return this.rotateX(e).rotateY(n).rotateZ(i)}rotateAxis(t,e){return function(t,e,n,i){var r,o,a,s,l,c,u,h,p,d,f,g,m,y,v,_,b,x,w,S,P,E,T,k,A=i[0],C=i[1],M=i[2],I=Math.hypot(A,C,M);I<No||(A*=I=1/I,C*=I,M*=I,r=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],l=e[1],c=e[2],u=e[3],h=e[4],p=e[5],d=e[6],f=e[7],g=e[8],m=e[9],y=e[10],v=e[11],_=A*A*a+o,b=C*A*a+M*r,x=M*A*a-C*r,w=A*C*a-M*r,S=C*C*a+o,P=M*C*a+A*r,E=A*M*a+C*r,T=C*M*a-A*r,k=M*M*a+o,t[0]=s*_+h*b+g*x,t[1]=l*_+p*b+m*x,t[2]=c*_+d*b+y*x,t[3]=u*_+f*b+v*x,t[4]=s*w+h*S+g*P,t[5]=l*w+p*S+m*P,t[6]=c*w+d*S+y*P,t[7]=u*w+f*S+v*P,t[8]=s*E+h*T+g*k,t[9]=l*E+p*T+m*k,t[10]=c*E+d*T+y*k,t[11]=u*E+f*T+v*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?$o(this,this,t):$o(this,this,[t,t,t]),this.check()}translate(t){return function(t,e,n){var i,r,o,a,s,l,c,u,h,p,d,f,g=n[0],m=n[1],y=n[2];e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=i*g+s*m+h*y+e[12],t[13]=r*g+l*m+p*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=a*g+u*m+f*y+e[15])}(this,this,t),this.check()}transform(t,e){return 4===t.length?(Do(e=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;switch(n){case 2:e=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(e||[-0,-0],t,this);break;case 3:e=Uo(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Do(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=function(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}(e||[-0,-0],t,this);break;case 3:e=Wo(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Do(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}transformPoint(t,e){return Bo("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return Bo("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return Bo("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}const oa=Math.PI/180,aa=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sa=[0,0,0],la={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class ca{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=null,x:n=0,y:i=0,width:r=1,height:o=1}=t;this.id=e||this.constructor.displayName||"viewport",this.x=n,this.y=i,this.width=r||1,this.height=o||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?io.WEB_MERCATOR:io.WEB_MERCATOR_AUTO_OFFSET:io.IDENTITY}equals(t){return t instanceof ca&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Io(t.projectionMatrix,this.projectionMatrix)&&Io(t.viewMatrix,this.viewMatrix))}project(t){let{topLeft:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Y(this.projectPosition(t),this.pixelProjectionMatrix),[i,r]=n,o=e?r:this.height-r;return 2===t.length?[i,o]:[i,o,n[2]]}unproject(t){let{topLeft:e=!0,targetZ:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[i,r,o]=t,a=e?r:this.height-r,s=n&&n*this.distanceScales.unitsPerMeter[2],l=K([i,a,o],this.pixelUnprojectionMatrix,s),[c,u,h]=this.unprojectPosition(l);return Number.isFinite(o)?[c,u,h]:Number.isFinite(n)?[c,u,n]:[c,u]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=N(t);return e[1]=Co(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?V(t):t}getBounds(){const t={targetZ:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0},e=this.unproject([0,0],t),n=this.unproject([this.width,0],t),i=this.unproject([0,this.height],t),r=this.unproject([this.width,this.height],t);return[Math.min(e[0],n[0],i[0],r[0]),Math.min(e[1],n[1],i[1],r[1]),Math.max(e[0],n[0],i[0],r[0]),Math.max(e[1],n[1],i[1],r[1])]}getDistanceScales(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?U({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel(t){let{x:e,y:n,width:i=1,height:r=1}=t;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:Xo((t=this.viewProjectionMatrix)[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Xo(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Xo(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Xo(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Xo(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Xo(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}),this._frustumPlanes;var t}panByPosition(t,e){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix(t){let{orthographic:e,fovyRadians:n,aspect:i,focalDistance:r,near:o,far:a}=t;return e?(new ra).orthographic({fovy:n,aspect:i,focalDistance:r,near:o,far:a}):(new ra).perspective({fovy:n,aspect:i,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:e=aa,longitude:n=null,latitude:i=null,zoom:r=null,position:o=null,modelMatrix:a=null,focalDistance:s=1,distanceScales:l=null}=t;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this.zoom=r,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function(t){let{latitude:e}=t;C(Number.isFinite(e));const n=Math.cos(e*L);return j(R*n)-9}({latitude:i})+Math.log2(s):0);const c=Math.pow(2,this.zoom);this.scale=c,this.distanceScales=this.isGeospatial?U({latitude:i,longitude:n}):l||la,this.focalDistance=s,this.distanceScales.metersPerUnit=new Zo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new Zo(this.distanceScales.unitsPerMeter),this.position=sa,this.meterOffset=sa,o&&(this.position=o,this.modelMatrix=a,this.meterOffset=a?a.transformVector(o):o),this.isGeospatial?(this.longitude=n,this.latitude=i,this.center=this._getCenterInWorld({longitude:n,latitude:i})):this.center=o?this.projectPosition(o):[0,0,0],this.viewMatrixUncentered=e,this.viewMatrix=(new ra).multiplyRight(this.viewMatrixUncentered).translate(new Zo(this.center||sa).negate())}_getCenterInWorld(t){let{longitude:e,latitude:n}=t;const{meterOffset:i,distanceScales:r}=this,o=new Zo(this.projectPosition([e,n,0]));if(i){const t=new Zo(i).scale(r.unitsPerMeter);o.add(t)}return o}_initProjectionMatrix(t){const{projectionMatrix:e=null,orthographic:n=!1,fovyRadians:i,fovy:r=75,near:o=.1,far:a=1e3,focalDistance:s=1}=t;this.projectionMatrix=e||this._createProjectionMatrix({orthographic:n,fovyRadians:i||r*oa,aspect:this.width/this.height,focalDistance:s,near:o,far:a})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var e;co(t,t,this.projectionMatrix),co(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=lo([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(e=this.viewMatrixInverse)[12],e[13],e[14]];const n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];!function(t,e,n){var i=n[0],r=n[1],o=n[2];t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(n,n,[this.width/2,-this.height/2,1]),function(t,e,n){var i,r,o,a,s,l,c,u,h,p,d,f,g=n[0],m=n[1],y=n[2];e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=i*g+s*m+h*y+e[12],t[13]=r*g+l*m+p*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=a*g+u*m+f*y+e[15])}(n,n,[1,-1,0]),co(i,n,this.viewProjectionMatrix),this.pixelProjectionMatrix=i,this.viewportMatrix=n,this.pixelUnprojectionMatrix=lo([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||eo.warn("Pixel project matrix not invertible")()}}function ua(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function ha(t,e){return t[0]=-e[0],t[1]=-e[1],t}ca.displayName="Viewport";!function(){var t=function(){var t=new uo(2);return uo!=Float32Array&&(t[0]=0,t[1]=0),t}()}();const pa=Math.PI/180;function da(t){return 512/4003e4/Math.cos(t*pa)}class fa extends ca{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{latitude:e=0,longitude:n=0,zoom:i=11,pitch:r=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:s=1.01,orthographic:l=!1,projectionMatrix:c,repeat:u=!1,worldOffset:h=0,legacyMeterSizes:p=!1}=t;let{width:d,height:f,altitude:g=1.5}=t;const m=Math.pow(2,i);let y;d=d||1,f=f||1;let v=null;c?(g=c[5]/2,y=H(g)):(t.fovy?(y=t.fovy,g=X(y)):y=H(g),v=q({width:d,height:f,pitch:r,fovy:y,nearZMultiplier:a,farZMultiplier:s}));let _=G({height:f,pitch:r,bearing:o,scale:m,altitude:g});if(h){_=(new ra).translate([512*h,0,0]).multiplyLeft(_)}super({...t,width:d,height:f,viewMatrix:_,longitude:n,latitude:e,zoom:i,...v,fovy:y,focalDistance:g}),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=r,this.bearing=o,this.altitude=g,this.fovy=y,this.orthographic=l,this._subViewports=u?[]:null,this._pseudoMeters=p,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let i=e;i<=n;i++){const t=i?new fa({...this,worldOffset:i}):this;this._subViewports.push(t)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*da(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/da(n)]}addMetersToLngLat(t,e){return W(t,e)}panByPosition(t,e){const n=K(e,this.pixelUnprojectionMatrix),i=ua([],this.projectFlat(t),ha([],n)),r=ua([],this.center,i),[o,a]=this.unprojectFlat(r);return{longitude:o,latitude:a}}getBounds(){const t=$(this,(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{width:n,height:i}=this,{longitude:r,latitude:o,zoom:a}=J({width:n,height:i,bounds:t,...e});return new fa({width:n,height:i,longitude:r,latitude:o,zoom:a})}}fa.displayName="WebMercatorViewport";var ga=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t};!function(){var t=function(){var t=new uo(3);return uo!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function ma(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.projectPosition(t);if(n&&e instanceof fa){const[n,r,o=0]=t,a=e.getDistanceScales([n,r]);i[2]=o*a.unitsPerMeter[2]}return i}function ya(t,e){let{viewport:n,modelMatrix:i,coordinateSystem:r,coordinateOrigin:o,offsetMode:a}=e,[s,l,c=0]=t;switch(i&&([s,l,c]=ho([],[s,l,c,1],i)),r){case no.LNGLAT:return ma([s,l,c],n,a);case no.LNGLAT_OFFSETS:return ma([s+o[0],l+o[1],c+(o[2]||0)],n,a);case no.METER_OFFSETS:return ma(W(o,[s,l,c]),n,a);case no.CARTESIAN:default:return n.isGeospatial?[s+o[0],l+o[1],c+o[2]]:n.projectPosition([s,l,c])}}function va(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:o,fromCoordinateSystem:a,fromCoordinateOrigin:s}=function(t){const e={...t};let{coordinateSystem:n}=t;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:o,fromCoordinateOrigin:a}=t;return n===no.DEFAULT&&(n=i.isGeospatial?no.LNGLAT:no.CARTESIAN),void 0===o&&(e.fromCoordinateSystem=n),void 0===a&&(e.fromCoordinateOrigin=r),e.coordinateSystem=n,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=xo(n,i,r),h=ya(t,{viewport:n,modelMatrix:o,coordinateSystem:a,coordinateOrigin:s,offsetMode:u});if(u){const t=n.projectPosition(l||c);ga(h,h,t)}return h}const _a=[255,255,255],ba=1,xa=[0,0,1],wa=[0,0,1];let Sa=0;const Pa="vs",Ea="fs";function Ta(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const ka={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function Aa(t){let e=Ca(t);return"object"===e?t?"type"in t?Object.assign({},t,ka[t.type]):"value"in t?(e=Ca(t.value),Object.assign({type:e},t,ka[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},ka[e])}function Ca(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class Ma{constructor(t){let{name:e,vs:n,fs:i,dependencies:r=[],uniforms:o,getUniforms:a,deprecations:s=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}=t;Ta("string"===typeof e),this.name=e,this.vs=n||u,this.fs=i||h,this.getModuleUniforms=a,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(s),this.defines=l,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);"string"===typeof i&&(i={order:0,injection:i}),e[r][n]=i}return e}(c),o&&(this.uniforms=function(t){const e={};for(const n in t){const i=Aa(t[n]);e[n]=i}return e}(o))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:Ta(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{if("function"===t.type)t.regex=new RegExp("\\b".concat(t.old,"\\("));else t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))})),t}_defaultGetUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const r=n[i];i in t&&!r.private?(r.validate&&Ta(r.validate(t[i],r),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=r.value}return e}}function Ia(t){return La(za(t))}function La(t){const e={},n={};return Oa({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}function Oa(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of e)i[o.name]=o,(void 0===r[o.name]||r[o.name]<n)&&(r[o.name]=n);for(const o of e)o.dependencies&&Oa({modules:o.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function za(t,e){return t.map((t=>(t instanceof Ma||(Ta("string"!==typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),Ta(t.name,"shader module has no name"),(t=new Ma(t)).dependencies=za(t.dependencies)),t)))}function Ra(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e="undefined"!==typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}const Da={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Fa={};Object.keys(Da).forEach((t=>{Fa[t]=t}));const Ba={};function ja(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Da[e];if(Ta(i,e),!Ra(n))return!0;if(e in Ba)return Ba[e];const r=i[0],o=n.behavior||"enable",a="#extension GL_".concat(r," : ").concat(o,"\nvoid main(void) {}"),s=t.createShader(35633);t.shaderSource(s,a),t.compileShader(s);const l=t.getShaderParameter(s,35713);return t.deleteShader(s),Ba[e]=l,l}function Na(t,e){const n=Da[e];Ta(n,e);const i=function(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],r="string"===typeof i?Boolean(t.getExtension(i)):i;return Ta(!1===r||!0===r),r}function Va(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>Na(t,e)))}const Ua={[Pa]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[Ea]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Wa="__LUMA_INJECT_DECLARATIONS__",Ga=/void\s+main\s*\([^)]*\)\s*\{\n?/,qa=/}\n?[^{}]*$/,Za=[];function Ha(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=e===Pa;for(const o in n){const e=n[o];e.sort(((t,e)=>t.order-e.order)),Za.length=e.length;for(let t=0,n=e.length;t<n;++t)Za[t]=e[t].injection;const i="".concat(Za.join("\n"),"\n");switch(o){case"vs:#decl":r&&(t=t.replace(Wa,i));break;case"vs:#main-start":r&&(t=t.replace(Ga,(t=>t+i)));break;case"vs:#main-end":r&&(t=t.replace(qa,(t=>i+t)));break;case"fs:#decl":r||(t=t.replace(Wa,i));break;case"fs:#main-start":r||(t=t.replace(Ga,(t=>t+i)));break;case"fs:#main-end":r||(t=t.replace(qa,(t=>i+t)));break;default:t=t.replace(o,(t=>t+i))}}return t=t.replace(Wa,""),i&&(t=t.replace(/\}\s*$/,(t=>t+Ua[e]))),t}function Xa(t){const e={};return Ta(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}function Ya(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Ka=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Ja=[...Ka,[Ya("attribute"),"in $1"],[Ya("varying"),"out $1"]],Qa=[...Ka,[Ya("varying"),"in $1"]],$a=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],ts=[...$a,[Ya("in"),"attribute $1"],[Ya("out"),"varying $1"]],es=[...$a,[Ya("in"),"varying $1"]],ns="gl_FragColor",is=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,rs=/void\s+main\s*\([^)]*\)\s*\{\n?/;function os(t,e,n){switch(e){case 300:return n?as(t,Ja):function(t){const e=(t=as(t,Qa)).match(is);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(ns,"\\b"),"g"),n)}else{const e="fragmentColor";t=t.replace(rs,(t=>"out vec4 ".concat(e,";\n").concat(t))).replace(new RegExp("\\b".concat(ns,"\\b"),"g"),e)}return t}(t);case 100:return n?as(t,ts):function(t){const e=(t=as(t,es)).match(is);if(e){const n=e[1];t=t.replace(is,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),ns)}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}function as(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}const ss="\n\n".concat(Wa,"\n\n"),ls={[Pa]:"vertex",[Ea]:"fragment"};function cs(t,e){let{id:n,source:i,type:r,modules:o,defines:a={},hookFunctions:s=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:h}=e;Ta("string"===typeof i,"shader source must be a string");const p=r===Pa,d=i.split("\n");let f=100,g="",m=i;0===d[0].indexOf("#version ")?(f=300,g=d[0],m=d.slice(1).join("\n")):g="#version ".concat(f);const y={};o.forEach((t=>{Object.assign(y,t.getDefines())})),Object.assign(y,a);let v=u?"".concat(g,"\n").concat(function(t){let{id:e,source:n,type:i}=t;return e&&"string"===typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(ls[i],"\n\n"):""}({id:n,source:i,type:r}),"\n").concat(function(t){let{type:e}=t;return"\n#define SHADER_TYPE_".concat(ls[e].toUpperCase(),"\n")}({type:r}),"\n").concat(function(t){const e=function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937),r=function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,i);return{gpuVendor:r,vendor:n,renderer:i,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t);switch(e.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t),"\n").concat(function(t,e,n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Va(t,Fa.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Va(t,Fa.GLSL_DERIVATIVES)&&ja(t,Fa.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Va(t,Fa.GLSL_FRAG_DATA)&&ja(t,Fa.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Va(t,Fa.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(t),"\n").concat(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(const i in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],"\n"))}0===e&&(n+="\n");return n}(y),"\n").concat(p?"":"precision highp float;\n\n","\n"):"".concat(g,"\n");const _=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!==typeof t?(n=t,t=n.hook):n={},t=t.trim();const[i,r]=t.split(":"),o=t.replace(/\(.+/,"");e[i][o]=Object.assign(n,{signature:r})})),e}(s),b={},x={},w={};for(const S in l){const t="string"===typeof l[S]?{injection:l[S],order:0}:l[S],e=S.match(/^(v|f)s:(#)?([\w-]+)$/);if(e){const n=e[2],i=e[3];n?"decl"===i?x[S]=[t]:w[S]=[t]:b[S]=[t]}else w[S]=[t]}for(const S of o){h&&S.checkDeprecations(m,h);v+=S.getModuleSource(r,f);const t=S.injections[r];for(const e in t){const n=e.match(/^(v|f)s:#([\w-]+)$/);if(n){const i="decl"===n[2]?x:w;i[e]=i[e]||[],i[e].push(t[e])}else b[e]=b[e]||[],b[e].push(t[e])}}return v+=ss,v=Ha(v,r,x),v+=function(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),e[i]){const t=e[i];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+="  ".concat(e.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}(_[r],b),v+=m,v=Ha(v,r,w),v=os(v,c?100:f,p),v}function us(t){return function(e){const n={};for(const i of t){const t=i.getUniforms(e,n);Object.assign(n,t)}return n}}const hs=new Jr({id:"luma.gl"});function ps(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const ds="Invalid WebGLRenderingContext";function fs(t){return"undefined"!==typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version)))}function gs(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function ms(t){return ps(fs(t),ds),t}function ys(t){return ps(gs(t),"Requires WebGL2"),t}const vs={};function _s(t,e){var n;vs[t]=!0,void 0!==e&&(n=e,Ur.console&&Ur.console.error&&Ur.console.error(n))}const bs=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const e=new t.VertexAttrib(n);this.attribs[i]=e}this.maxAttrib=0};(bs.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const xs=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(vs[n]=!0)}while(0!==n);for(n in vs)if(vs[n])return delete vs[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);const r=i.attribs[t];return r.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;i.maxAttrib=Math.max(i.maxAttrib,t);const r=i.attribs[t];return r.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,i){switch(t){case 34962:e.currentArrayBuffer=i;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=i}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,i){const r=e.currentVertexArrayObject,o=r.attribs[t];switch(i){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,i,r,o,a,s){const l=e.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);const c=l.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=i,c.type=r,c.normalized=o,c.stride=a,c.offset=s,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{var t;t="OESVertexArrayObject emulation library context restored",Ur.console&&Ur.console.log&&Ur.console.log(t),e.reset_()}),!0),this.reset_()};xs.prototype.VERTEX_ARRAY_BINDING_OES=34229,xs.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new bs(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},xs.prototype.createVertexArrayOES=function(){const t=new bs(this);return this.vertexArrayObjects.push(t),t},xs.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},xs.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof bs&&t.hasBeenBound&&t.ext===this)},xs.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return void _s(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const r=this.currentVertexArrayObject;if(i===r)return;i&&r.elementArrayBuffer===i.elementArrayBuffer||n.bindBuffer.call(e,34963,r.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,r.maxAttrib);for(let s=0;s<=a;s++){const t=r.attribs[s],a=i?i.attribs[s]:null;if(i&&t.enabled===a.enabled||(t.enabled?n.enableVertexAttribArray.call(e,s):n.disableVertexAttribArray.call(e,s)),t.enabled){let r=!1;i&&t.buffer===a.buffer||(o!==t.buffer&&(n.bindBuffer.call(e,34962,t.buffer),o=t.buffer),r=!0),(r||t.cached!==a.cached)&&n.vertexAttribPointer.call(e,s,t.size,t.type,t.normalized,t.stride,t.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)};const ws="OES_element_index",Ss="WEBGL_draw_buffers",Ps="WEBGL_debug_renderer_info",Es=t=>gs(t)?void 0:0,Ts={3074:t=>gs(t)?void 0:36064,35723:t=>gs(t)?void 0:4352,35977:Es,32937:Es,36795:(t,e)=>{const n=gs(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(Ps);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(Ps);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Es,35071:Es,37447:Es,36063:(t,e)=>{if(!gs(t)){const n=t.getExtension(Ss);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Es,35374:Es,35377:Es,34852:t=>{if(!gs(t)){const e=t.getExtension(Ss);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(ws)?2147483647:65535,33001:t=>t.getExtension(ws)?16777216:65535,33e3:t=>16777216,37157:Es,35373:Es,35657:Es,36183:Es,37137:Es,34045:Es,35978:Es,35979:Es,35968:Es,35376:Es,35375:Es,35659:Es,37154:Es,35371:Es,35658:Es,35076:Es,35077:Es,35380:Es};const ks="ANGLE_instanced_arrays";const As={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{ps(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[ks]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){ps(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{ps(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{ps(!1)},deleteQuery:()=>{ps(!1)},beginQuery:()=>{ps(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Cs={readBuffer:(t,e,n)=>{gs(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:o}=function(t,e){return{webgl2:gs(t),ext:t.getExtension(e)}}(t,ks);let a;switch(i){case 35069:a=!!r&&void 0;break;case 35070:a=r||o?void 0:0}return void 0!==a?a:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!gs(t))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>gs(t)||32937!==r?t.getInternalformatParameter(n,i,r):new Int32Array([0]),getTexParameter(t,e,n,i){if(34046===i){const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,i)},getParameter:function(t,e,n){const i=Ts[n],r="function"===typeof i?i(t,e,n):i;return void 0!==r?r:e(n)},hint:(t,e,n,i)=>e(n,i)};function Ms(t,e){let{extension:n,target:i,target2:r}=e;const o=As[n];ps(o);const{meta:a={}}=o,{suffix:s=""}=a,l=t.getExtension(n);for(const c of Object.keys(o)){const e="".concat(c).concat(s);let n=null;"meta"===c||"function"===typeof t[c]||(l&&"function"===typeof l[e]?n=function(){return l[e](...arguments)}:"function"===typeof o[c]&&(n=o[c].bind(i))),n&&(i[c]=n,r[c]=n)}}("undefined"!==typeof n.g?n.g:window).polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(!function(t){if("function"===typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new xs(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&Ms(t,{extension:n,target:t.luma,target2:t})}(t,As),function(t,e){let{target:n,target2:i}=e;Object.keys(Cs).forEach((e=>{if("function"===typeof Cs[e]){const r=t[e]?t[e].bind(t):()=>{},o=Cs[e].bind(null,t,r);n[e]=o,i[e]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const Is={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Ls=(t,e,n)=>e?t.enable(n):t.disable(n),Os=(t,e,n)=>t.hint(n,e),zs=(t,e,n)=>t.pixelStorei(n,e);function Rs(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Ds={3042:Ls,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Ls,2885:(t,e)=>t.cullFace(e),2929:Ls,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Ls,35723:Os,36006:(t,e)=>{const n=gs(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:Os,2849:(t,e)=>t.lineWidth(e),32823:Ls,32824:"polygonOffset",10752:"polygonOffset",35977:Ls,32938:"sampleCoverage",32939:"sampleCoverage",3089:Ls,3088:(t,e)=>t.scissor(...e),2960:Ls,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:zs,3317:zs,37440:zs,37441:zs,37443:zs,3330:zs,3332:zs,3331:zs,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:zs,32878:zs,3316:zs,3315:zs,32877:zs,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Rs(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Rs(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Rs(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=Rs(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,a,s]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,o,a,s)},stencilOp:(t,e)=>{e=Rs(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,a,s]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,o,a,s)},viewport:(t,e)=>t.viewport(...e)};function Fs(t,e,n){return void 0!==e[t]?e[t]:n[t]}const Bs={blendEquation:(t,e,n)=>t.blendEquationSeparate(Fs(32777,e,n),Fs(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Fs(32969,e,n),Fs(32968,e,n),Fs(32971,e,n),Fs(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Fs(32824,e,n),Fs(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Fs(32938,e,n),Fs(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Fs(2962,e,n),Fs(2967,e,n),Fs(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Fs(34816,e,n),Fs(36003,e,n),Fs(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Fs(2964,e,n),Fs(2965,e,n),Fs(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Fs(34817,e,n),Fs(34818,e,n),Fs(34819,e,n))},js={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Ns=(t,e)=>t.isEnabled(e),Vs={3042:Ns,2884:Ns,2929:Ns,3024:Ns,32823:Ns,32926:Ns,32928:Ns,3089:Ns,2960:Ns,35977:Ns};function Us(t){for(const e in t)return!1;return!0}function Ws(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function Gs(t,e){const n=t[e].bind(t);t[e]=function(){const e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache&&t.state.enable?t.state.cache[e]:n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function qs(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];const{valueChanged:a,oldValue:s}=n(t.state._updateCache,...r);return a&&i(...r),s},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function Zs(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}class Hs{constructor(t){let{copyState:e=!1,log:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"===typeof(e=e||Is)){const n=e,i=Vs[n];return i?i(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const e=Vs[r];i[r]=e?e(t,Number(r)):t.getParameter(Number(r))}return i}(t):Object.assign({},Is),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){ps(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Ks(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const r in t){ps(void 0!==r);const o=t[r],a=this.cache[r];Ws(o,a)||(n=!0,e=a,i&&!(r in i)&&(i[r]=a),this.cache[r]=o)}return{valueChanged:n,oldValue:e}}}function Xs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:i=!0,copyState:r}=e;if(ps(void 0!==r),!t.state){const e="undefined"!==typeof n.g?n.g:window,{polyfillContext:i}=e;i&&i(t),t.state=new Hs(t,{copyState:r}),Zs(t);for(const n in js){qs(t,n,js[n])}Gs(t,"getParameter"),Gs(t,"isEnabled")}return t.state.enable=i,t}function Ys(t){ps(t.state),t.state.pop()}function Ks(t,e){if(ps(fs(t),"setParameters requires a WebGL context"),Us(e))return;const n={};for(const r in e){const i=Number(r),o=Ds[r];o&&("string"===typeof o?n[o]=!0:o(t,e[r],i))}const i=t.state&&t.state.cache;if(i)for(const r in n){(0,Bs[r])(t,e,i)}}function Js(t,e,n){if(Us(e))return n(t);const{nocatch:i=!0}=e;let r;if(function(t){t.state||Xs(t,{copyState:!1}),t.state.push()}(t),Ks(t,e),i)r=n(t),Ys(t);else try{r=n(t)}finally{Ys(t)}return r}function Qs(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function $s(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=Qs(t),r=t.drawingBufferWidth,o=t.drawingBufferHeight;return el(e,i,r,o,n)}function tl(t){const e="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function el(t,e,n,i,r){const o=nl(t[0],e,n);let a=il(t[1],e,i,r),s=nl(t[0]+1,e,n);const l=s===n-1?s:s-1;let c;return s=il(t[1]+1,e,i,r),r?(s=0===s?s:s+1,c=a,a=s):c=s===i-1?s:s-1,{x:o,y:a,width:Math.max(l-o+1,1),height:Math.max(c-a+1,1)}}function nl(t,e,n){return Math.min(Math.round(t*e),n-1)}function il(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const rl=zr(),ol=rl&&"undefined"!==typeof document,al={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function sl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ps(rl,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},al,t);const{width:e,height:n}=t;function i(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let r;t.onError=i;const{canvas:o}=t,a=ul({canvas:o,width:e,height:n,onError:i});return r=cl(a,t),r?(r=ll(r,t),hl(r),r):null}function ll(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||pl(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},al,e);const{manageState:n,debug:i}=e;return n&&Xs(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return hs.log(1,...e)()}}),rl&&i&&(Ur.makeDebugContext?(t=Ur.makeDebugContext(t,e),hs.level=Math.max(hs.level,1)):hs.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function cl(t,e){const{onError:n}=e;let i=null;const r=t=>i=t.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:o=!0,webgl2:a=!0}=e;let s=null;return a&&(s=s||t.getContext("webgl2",e),s=s||t.getContext("experimental-webgl2",e)),o&&(s=s||t.getContext("webgl",e),s=s||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),s?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),s):n("Failed to create ".concat(a&&!o?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function ul(t){let e,{canvas:n,width:i=800,height:r=600,onError:o}=t;if("string"===typeof n){ol&&"complete"===document.readyState||o("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)}else n?e=n:(e=document.createElement("canvas"),e.id="lumagl-canvas",e.style.width=Number.isFinite(i)?"".concat(i,"px"):"100%",e.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(e,document.body.firstChild));return e}function hl(t){const e=gs(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";hs.info(1,"".concat(e).concat(r," context ").concat(i))()}function pl(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}function dl(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;i&&r||(hs.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==i||o.clientHeight!==r||o.devicePixelRatio!==e){let n=e;const o=Math.floor(i*n),a=Math.floor(r*n);t.canvas.width=o,t.canvas.height=a,t.drawingBufferWidth===o&&t.drawingBufferHeight===a||(hs.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*n),t.canvas.height=Math.floor(r*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}function fl(){let t;if("undefined"!==typeof window&&window.performance)t=window.performance.now();else if("undefined"!==typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class gl{constructor(t,e){l(this,"name",void 0),l(this,"type",void 0),l(this,"sampleSize",1),l(this,"time",void 0),l(this,"count",void 0),l(this,"samples",void 0),l(this,"lastTiming",void 0),l(this,"lastSampleTime",void 0),l(this,"lastSampleCount",void 0),l(this,"_count",0),l(this,"_time",0),l(this,"_samples",0),l(this,"_startTime",0),l(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=fl(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(fl()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ml{constructor(t){l(this,"id",void 0),l(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof gl?t:new gl(e,n)),this.stats[e]}}const yl="8.5.10";const vl=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new ml({id:t})),this.stats.get(t)}};if(Ur.luma&&Ur.luma.VERSION!==yl)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(Ur.luma.VERSION," vs ").concat(yl));Ur.luma||(zr()&&hs.log(1,"luma.gl ".concat(yl," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),Ur.luma=Ur.luma||{VERSION:yl,version:yl,log:hs,stats:vl,globals:{modules:{},nodeIO:{}}});Ur.luma;function _l(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function bl(t,e){if("string"!==typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return _l(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function xl(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const wl={};function Sl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";wl[t]=wl[t]||1;const e=wl[t]++;return"".concat(t,"-").concat(e)}function Pl(t){return _l("number"===typeof t,"Input must be a number"),t&&0===(t&t-1)}function El(t){let e=!0;for(const n in t){e=!1;break}return e}function Tl(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(t);i.forEach((t=>{o.methodName||(o[t]=()=>{throw hs.removed("Calling removed method ".concat(e,".").concat(t,": "),r)(),new Error(t)})}))}const kl="Resource subclass must define virtual methods";class Al{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ms(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||Sl(this.constructor.name),this.userData=i,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!==typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_l(t=bl(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=gs(this.gl);if(!((!("webgl2"in n)||t)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){const e=n.webgl1,i="webgl2"in n?n.webgl2:n.webgl1;return t?i:e}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},r=gs(this.gl),o={},a=e||Object.keys(i);for(const s of a){const e=i[s];if(e&&(!("webgl2"in e)||r)&&(!("extension"in e)||this.gl.getExtension(e.extension))){const i=n?xl(this.gl,s):s;o[i]=this.getParameter(s,t),n&&"GLenum"===e.type&&(o[i]=xl(this.gl,o[i]))}}return o}setParameter(t,e){_l(t=bl(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=gs(this.gl);if(!((!("webgl2"in n)||t)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=bl(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return Tl(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(kl)}_deleteHandle(){throw new Error(kl)}_bindHandle(t){throw new Error(kl)}_getOptsFromHandle(){throw new Error(kl)}_getParameter(t,e){throw new Error(kl)}_setParameter(t,e){throw new Error(kl)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this.constructor.name,e=vl.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this.constructor.name;vl.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.constructor.name;const n=vl.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get("".concat(e," Memory")).addCount(t),this.byteLength=t}_trackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.constructor.name;const e=vl.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get("".concat(t," Memory")).subtractCount(this.byteLength),this.byteLength=0}}function Cl(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Ml(t){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Il(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:o}=t;const a=n*r;o=o||new Uint8Array(a);for(let s=0;s<i/2;++s){const t=s*a,n=(i-s-1)*a;o.set(e.subarray(t,t+a)),e.copyWithin(t,n,n+a),e.set(o,n)}}function Ll(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),o=Math.round(i/2),a=new Uint8Array(r*o*4);for(let s=0;s<o;s++)for(let t=0;t<r;t++)for(let i=0;i<4;i++)a[4*(s*r+t)+i]=e[4*(2*s*n+2*t)+i];return{data:a,width:r,height:o}}function Ol(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:o={}}=n;for(const s in i)if(s in e){const e=i[s]?"".concat(t,".").concat(i[s]):"N/A";hs.removed("".concat(t,".").concat(s),e)()}for(const s in r)if(s in e){const e=r[s];hs.deprecated("".concat(t,".").concat(s),"".concat(t,".").concat(e))()}let a=null;for(const s in o)if(s in e){const n=o[s];hs.deprecated("".concat(t,".").concat(s),"".concat(t,".").concat(n))(),a=a||Object.assign({},e),a[n]=e[s],delete a[s]}return a||e}const zl={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Rl={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Dl{static getBytesPerElement(t){return Ml(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){_l(t.size);return Ml(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Dl(...[zl,...e])}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Dl.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Dl.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=Ol("Accessor",t,Rl),void 0!==t.type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"===typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const Fl={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Bl={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Fl},jl={removedProps:Fl};class Nl extends Al{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/Dl.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/Dl.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=Ol("Buffer",t,Bl),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=Ol("Buffer",t,jl))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new Dl(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,r=t.byteLength||t.length;_l(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==i||void 0!==r?(ys(this.gl),this.gl.bufferSubData(this.target,n,e,i,r)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:r}=t;const{gl:o}=this;return ys(o),o.bindBuffer(36662,e.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,n,i,r),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ys(this.gl);const r=Ml(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(e),a=n;let s,l;t?(l=t.length,s=l-a):(s=Math.min(o,i||o),l=a+s);const c=Math.min(o,s);return i=i||c,_l(i<=c),t=t||new r(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?void 0!==i?this.gl.bindBufferRange(t,e,this.handle,n,i):(_l(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength+e;_l(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const r=Cl(t);return _l(r),this.setAccessor(new Dl(this.accessor,{type:r})),this}_setByteLength(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;_l(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/Ml(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new Dl(this.accessor,{type:Cl(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return hs.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return hs.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return hs.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return hs.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Dl(this.accessor,t),this}}const Vl={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},Ul={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Wl={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};const Gl=[9729,9728],ql=Ur.WebGLBuffer||function(){};class Zl extends Al{static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:i}=e;let r=!0;return n&&(r=r&&function(t,e){const n=Vl[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const i=gs(t)&&n.gl2||n.gl1;return"string"===typeof i?t.getExtension(i):i}(t,n),r=r&&(!i||function(t,e){const n=Vl[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),r}constructor(t,e){const{id:n=Sl("texture"),handle:i,target:r}=e;super(t,{id:n,handle:i}),this.target=r,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:i=null,format:r=6408,border:o=0,recreate:a=!1,parameters:s={},pixelStore:l={},textureUnit:c}=t;e||(e=i);let{width:u,height:h,dataFormat:p,type:d,compressed:f=!1,mipmaps:g=!0}=t;const{depth:m=0}=t;return({width:u,height:h,compressed:f,dataFormat:p,type:d}=this._deduceParameters({format:r,type:d,dataFormat:p,compressed:f,data:e,width:u,height:h})),this.width=u,this.height=h,this.depth=m,this.format=r,this.type=d,this.dataFormat=p,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(hs.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(s)),this.mipmaps=g,this.setImageData({data:e,width:u,height:h,depth:m,format:r,type:d,dataFormat:p,border:o,mipmaps:g,parameters:l,compressed:f}),g&&this.generateMipmap(),this.setParameters(s),a&&(this.data=e),n&&(this._video={video:e,parameters:s,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(hs.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Js(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:r=this.format,border:o=this.border,offset:a=0,parameters:s={}}=t;let{data:l=null,type:c=this.type,width:u=this.width,height:h=this.height,dataFormat:p=this.dataFormat,compressed:d=!1}=t;l||(l=n),({type:c,dataFormat:p,compressed:d,width:u,height:h}=this._deduceParameters({format:r,type:c,dataFormat:p,compressed:d,data:l,width:u,height:h}));const{gl:f}=this;f.bindTexture(this.target,this.handle);let g,m=null;if(({data:l,dataType:m}=this._getDataType({data:l,compressed:d})),Js(this.gl,s,(()=>{switch(m){case"null":f.texImage2D(e,i,r,u,h,o,p,c,l);break;case"typed-array":f.texImage2D(e,i,r,u,h,o,p,c,l,a);break;case"buffer":g=ys(f),g.bindBuffer(35052,l.handle||l),g.texImage2D(e,i,r,u,h,o,p,c,a),g.bindBuffer(35052,null);break;case"browser-object":gs(f)?f.texImage2D(e,i,r,u,h,o,p,c,l):f.texImage2D(e,i,r,p,c,l);break;case"compressed":for(const[t,n]of l.entries())f.compressedTexImage2D(e,t,n.format,n.width,n.height,o,n.data);break;default:_l(!1,"Unknown image data type")}})),l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const t=Ul[this.dataFormat]||4,e=Wl[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:i=null,x:r=0,y:o=0,width:a=this.width,height:s=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:p=!1,offset:d=0,border:f=this.border,parameters:g={}}=t;if(({type:u,dataFormat:h,compressed:p,width:a,height:s}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:p,data:i,width:a,height:s})),_l(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const t=i;i=t.data,a=t.shape[0],s=t.shape[1]}i instanceof Nl&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Js(this.gl,g,(()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,o,a,s,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,o,a,s,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,o,a,s,h,u,i,d);else if(i instanceof ql){const t=ys(this.gl);t.bindBuffer(35052,i),t.texSubImage2D(e,l,r,o,a,s,h,u,d),t.bindBuffer(35052,null)}else if(gs(this.gl)){ys(this.gl).texSubImage2D(e,l,r,o,a,s,h,u,i)}else this.gl.texSubImage2D(e,l,r,o,h,u,i)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return hs.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof Nl?{data:e.handle,dataType:"buffer"}:e instanceof ql?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:r,dataFormat:o,type:a,compressed:s}=t;const l=Vl[e];return o=o||l&&l.dataFormat,a=a||l&&l.types[0],s=s||l&&l.compressed,({width:i,height:r}=this._deduceImageSize(n,i,r)),{dataFormat:o,type:a,compressed:s,width:i,height:r,format:e,data:n}}_deduceImageSize(t,e,n){let i;return i="undefined"!==typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},_l(i,"Could not deduced texture size"),_l(void 0===e||i.width===e,"Deduced texture width does not match supplied width"),_l(void 0===n||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:_l(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!gs(this.gl)&&(!(!this.width||!this.height)&&(!Pl(this.width)||!Pl(this.height)))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===Gl.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}let Hl="";class Xl extends Zl{static isSupported(t,e){return Zl.isSupported(t,e)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i;ms(t),(e instanceof Promise||"string"===typeof e)&&(e={data:e}),"string"===typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,_l("string"===typeof n),n=Hl+n,new Promise(((t,e)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>e(new Error("Could not load image ".concat(n,"."))),r.crossOrigin=i&&i.crossOrigin||"anonymous",r.src=n}catch(r){e(r)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const Yl="EXT_color_buffer_float",Kl={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Yl,bpp:2},33327:{gl2:Yl,bpp:4},34842:{gl2:Yl,bpp:8},33326:{gl2:Yl,bpp:4},33328:{gl2:Yl,bpp:8},34836:{gl2:Yl,bpp:16},35898:{gl2:Yl,bpp:4}};class Jl extends Al{static isSupported(t){let{format:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!e||function(t,e,n){const i=n[e];if(!i)return!1;const r=gs(t)&&i.gl2||i.gl1;return"string"===typeof r?t.getExtension(r):r}(t,e,Kl)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:r=0}=t;return _l(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&gs(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Kl[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){this.gl.bindRenderbuffer(36161,this.handle);return this.gl.getRenderbufferParameter(36161,t)}}const Ql=6144,$l=6145,tc=6146,ec=34041,nc="clear: bad arguments";function ic(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o={};e&&(o.framebuffer=e);let a=0;n&&(a|=16384,!0!==n&&(o.clearColor=n)),i&&(a|=256,!0!==i&&(o.clearDepth=i)),r&&(a|=1024,!0!==i&&(o.clearStencil=i)),_l(0!==a,nc),Js(t,o,(()=>{t.clear(a)}))}const rc=[34069,34070,34071,34072,34073,34074];class oc extends Zl{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ms(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage(t){let{face:e,data:n,x:i=0,y:r=0,mipmapLevel:o=0}=t;return this._subImage({target:e,data:n,x:i,y:r,mipmapLevel:o})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:r,border:o=0,format:a=6408,type:s=5121}=t;const{gl:l}=this,c=i||r,u=await Promise.all(rc.map((t=>{const e=c[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),rc.forEach(((t,i)=>{u[i].length>1&&!1!==this.opts.mipmaps&&hs.warn("".concat(this.id," has mipmap and multiple LODs."))(),u[i].forEach(((i,r)=>{e&&n?l.texImage2D(t,r,a,e,n,o,a,s,i):l.texImage2D(t,r,a,a,s,i)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:r,data:o,border:a=0,format:s=6408,type:l=5121}=t,{gl:c}=this,u=r||o;return this.bind(),u instanceof Promise?u.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?c.texImage2D(e,0,s,n,i,a,s,l,u):c.texImage2D(e,0,s,s,l,u),this}}oc.FACES=rc;class ac extends Zl{static isSupported(t){return gs(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ys(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:i,height:r,depth:o=1,border:a=0,format:s,type:l=5121,offset:c=0,data:u,parameters:h={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Js(this.gl,h,(()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,n,i,r,o,a,s,l,u),u instanceof Nl&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,n,i,r,o,a,s,l,c))})),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const t=Ul[this.dataFormat]||4,e=Wl[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}function sc(t,e){_l(t instanceof Xl||t instanceof oc||t instanceof ac);const n=t.constructor,{gl:i,width:r,height:o,format:a,type:s,dataFormat:l,border:c,mipmaps:u}=t;return new n(i,Object.assign({width:r,height:o,format:a,type:s,dataFormat:l,border:c,mipmaps:u},e))}function lc(t,e){const{gl:n,width:i,height:r,id:o}=t;return new _c(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:i,height:r,attachments:{36064:t}}))}function cc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:o=36064,target:a=null,sourceWidth:s,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=hc(t);_l(u);const{gl:p,handle:d,attachments:f}=u;s=s||u.width,l=l||u.height,36064===o&&null===d&&(o=1028),_l(f[o]),c=c||f[o].type,a=pc(a,c,r,s,l),c=c||Cl(a);const g=p.bindFramebuffer(36160,d);return p.readPixels(n,i,s,l,r,c,a),p.bindFramebuffer(36160,g||null),h&&u.delete(),a}function uc(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=cc(t,{sourceAttachment:e}),{width:r,height:o}=t;for(;o>n;)({data:i,width:r,height:o}=Ll({data:i,width:r,height:o}));Il({data:i,width:r,height:o});const a=document.createElement("canvas");a.width=r,a.height=o;const s=a.getContext("2d"),l=s.createImageData(r,o);return l.data.set(i),s.putImageData(l,0,0),a.toDataURL()}function hc(t){return t instanceof _c?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:lc(t),deleteFramebuffer:!0}}function pc(t,e,n,i,r){if(t)return t;const o=Ml(e=e||5121,{clamped:!1}),a=function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return _l(!1),0}}(n);return new o(i*r*a)}const dc="TIMER_QUERY",fc="ELEMENT_INDEX_UINT32";const gc={["WEBGL2"]:[!1,!0],["VERTEX_ARRAY_OBJECT"]:["OES_vertex_array_object",!0],[dc]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],["INSTANCED_RENDERING"]:["ANGLE_instanced_arrays",!0],["MULTIPLE_RENDER_TARGETS"]:["WEBGL_draw_buffers",!0],[fc]:["OES_element_index_uint",!0],["BLEND_EQUATION_MINMAX"]:["EXT_blend_minmax",!0],["FLOAT_BLEND"]:["EXT_float_blend"],["COLOR_ENCODING_SRGB"]:["EXT_sRGB",!0],["TEXTURE_DEPTH"]:["WEBGL_depth_texture",!0],["TEXTURE_FLOAT"]:["OES_texture_float",!0],["TEXTURE_HALF_FLOAT"]:["OES_texture_half_float",!0],["TEXTURE_FILTER_LINEAR_FLOAT"]:["OES_texture_float_linear"],["TEXTURE_FILTER_LINEAR_HALF_FLOAT"]:["OES_texture_half_float_linear"],["TEXTURE_FILTER_ANISOTROPIC"]:["EXT_texture_filter_anisotropic"],["COLOR_ATTACHMENT_RGBA32F"]:[function(t){const e=new Xl(t,{format:6408,type:5126,dataFormat:6408}),n=new _c(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),36053===i},"EXT_color_buffer_float"],["COLOR_ATTACHMENT_FLOAT"]:[!1,"EXT_color_buffer_float"],["COLOR_ATTACHMENT_HALF_FLOAT"]:["EXT_color_buffer_half_float"],["GLSL_FRAG_DATA"]:["WEBGL_draw_buffers",!0],["GLSL_FRAG_DEPTH"]:["EXT_frag_depth",!0],["GLSL_DERIVATIVES"]:["OES_standard_derivatives",!0],["GLSL_TEXTURE_LOD"]:["EXT_shader_texture_lod",!0]};function mc(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>yc(t,e)))}function yc(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=gc[e];let i;_l(n,e);const r=gs(t)&&n[1]||n[0];if("function"===typeof r)i=r(t);else if(Array.isArray(r)){i=!0;for(const e of r)i=i&&Boolean(t.getExtension(e))}else"string"===typeof r?i=Boolean(t.getExtension(r)):"boolean"===typeof r?i=r:_l(!1);return i}(t,e)),t.luma.caps[e]||hs.log(2,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}const vc="Multiple render targets not supported";class _c extends Al{static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let r=!0;return n&&(r=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(r=r&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),r}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new _c(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=ys(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=ys(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:r=!0,depth:o=!0,stencil:a=!1,check:s=!0,readBuffer:l,drawBuffers:c}=t;if(_l(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const u in i){const t=i[u];(Array.isArray(t)?t[0]:t).resize({width:e,height:n})}else i=this._createDefaultAttachments(r,o,a,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&s&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:o=!0}=t;this.attach(e,{clearAttachments:r,resizeAttachments:o});const{gl:a}=this,s=a.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,s||null),this}resize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:e,height:n}=t;if(null===this.handle)return _l(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&hs.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const i in this.attachments)this.attachments[i].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach((t=>{i[t]=null})),Object.assign(i,t);const r=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){_l(void 0!==o,"Misspelled framebuffer binding point?");const t=Number(o),e=i[t];let r=e;if(r)if(r instanceof Jl)this._attachRenderbuffer({attachment:t,renderbuffer:r});else if(Array.isArray(e)){const[n,i=0,o=0]=e;r=n,this._attachTexture({attachment:t,texture:n,layer:i,level:o})}else this._attachTexture({attachment:t,texture:r,layer:0,level:0});else this._unattach(t);n&&r&&r.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,r||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(_c.STATUS||{})[t]||"Framebuffer error ".concat(t)}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:r=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&ic(this.gl,{color:e,depth:n,stencil:i}),r.forEach(((t,e)=>{!function(t){let{framebuffer:e=null,buffer:n=Ql,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ys(t),Js(t,{framebuffer:e},(()=>{switch(n){case Ql:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case $l:t.clearBufferfv($l,0,[r]);break;case tc:t.clearBufferiv(tc,0,[r]);break;case ec:const[e,o]=r;t.clearBufferfi(ec,0,e,o);break;default:_l(!1,nc)}}))}(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return hs.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return hs.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return hs.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return hs.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return hs.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return hs.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:i=0,width:r,height:o}=t;const a=ys(this.gl),s=a.bindFramebuffer(36008,this.handle);return 0===n&&0===i&&void 0===r&&void 0===o?a.invalidateFramebuffer(36008,e):a.invalidateFramebuffer(36008,e,n,i,r,o),a.bindFramebuffer(36008,s),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return null===i&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=xl(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const r of n){i[e?xl(this.gl,r):r]=this.getAttachmentParameter(t,r,e)}return i}getParameters(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=Object.keys(this.attachments),n={};for(const i of e){const e=Number(i);n[t?xl(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!==typeof window&&window.open(uc(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>hs.level||"undefined"===typeof window)return this;e=e||"Framebuffer ".concat(this.id);const n=uc(this,{targetMaxHeight:100});return hs.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,r){let o=null;return t&&(o=o||{},o[36064]=new Xl(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:r,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),e&&n?(o=o||{},o[33306]=new Jl(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):e?(o=o||{},o[36096]=new Jl(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:r}),this.ownResources.push(o[36096])):n&&_l(!1),o}_unattach(t){const e=this.attachments[t];e&&(e instanceof Jl?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:i,level:r}=t;const{gl:o}=this;switch(o.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:ys(o).framebufferTextureLayer(36160,e,n.target,r,i);break;case 34067:const t=function(t){return t<34069?t+34069:t}(i);o.framebufferTexture2D(36160,e,t,n.handle,r);break;case 3553:o.framebufferTexture2D(36160,e,3553,n.handle,r);break;default:_l(!1,"Illegal texture type")}o.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=gs(n=this.gl)?n:null;var n;e?e.readBuffer(t):_l(36064===t||1029===t,vc),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=ys(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):_l(1===t.length&&(36064===t[0]||1029===t[0]),vc)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=function(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in gc)void 0===t.luma.caps[e]&&(t.luma.caps[e]=yc(t,e));return t.luma.caps}(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}_c.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const bc={5126:zc.bind(null,"uniform1fv",Tc,1,Rc),35664:zc.bind(null,"uniform2fv",Tc,2,Rc),35665:zc.bind(null,"uniform3fv",Tc,3,Rc),35666:zc.bind(null,"uniform4fv",Tc,4,Rc),5124:zc.bind(null,"uniform1iv",kc,1,Rc),35667:zc.bind(null,"uniform2iv",kc,2,Rc),35668:zc.bind(null,"uniform3iv",kc,3,Rc),35669:zc.bind(null,"uniform4iv",kc,4,Rc),35670:zc.bind(null,"uniform1iv",kc,1,Rc),35671:zc.bind(null,"uniform2iv",kc,2,Rc),35672:zc.bind(null,"uniform3iv",kc,3,Rc),35673:zc.bind(null,"uniform4iv",kc,4,Rc),35674:zc.bind(null,"uniformMatrix2fv",Tc,4,Dc),35675:zc.bind(null,"uniformMatrix3fv",Tc,9,Dc),35676:zc.bind(null,"uniformMatrix4fv",Tc,16,Dc),35678:Oc,35680:Oc,5125:zc.bind(null,"uniform1uiv",Ac,1,Rc),36294:zc.bind(null,"uniform2uiv",Ac,2,Rc),36295:zc.bind(null,"uniform3uiv",Ac,3,Rc),36296:zc.bind(null,"uniform4uiv",Ac,4,Rc),35685:zc.bind(null,"uniformMatrix2x3fv",Tc,6,Dc),35686:zc.bind(null,"uniformMatrix2x4fv",Tc,8,Dc),35687:zc.bind(null,"uniformMatrix3x2fv",Tc,6,Dc),35688:zc.bind(null,"uniformMatrix3x4fv",Tc,12,Dc),35689:zc.bind(null,"uniformMatrix4x2fv",Tc,8,Dc),35690:zc.bind(null,"uniformMatrix4x3fv",Tc,12,Dc),35678:Oc,35680:Oc,35679:Oc,35682:Oc,36289:Oc,36292:Oc,36293:Oc,36298:Oc,36299:Oc,36300:Oc,36303:Oc,36306:Oc,36307:Oc,36308:Oc,36311:Oc},xc={},wc={},Sc={},Pc=[0];function Ec(t,e,n,i){1===e&&"boolean"===typeof t&&(t=t?1:0),Number.isFinite(t)&&(Pc[0]=t,t=Pc);const r=t.length;if(r%e&&hs.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=i[r];o||(o=new n(r),i[r]=o);for(let a=0;a<r;a++)o[a]=t[a];return o}function Tc(t,e){return Ec(t,e,Float32Array,xc)}function kc(t,e){return Ec(t,e,Int32Array,wc)}function Ac(t,e){return Ec(t,e,Uint32Array,Sc)}function Cc(t,e,n){const i=bc[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function Mc(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function Ic(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof Zl||(t instanceof Jl||t instanceof _c&&Boolean(t.texture))))}function Lc(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let t=0,e=n.length;t<e;++t)i[t]=n[t]}else t[e]=n.slice();else t[e]=n}function Oc(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function zc(t,e,n,i){let r=null,o=null;return(a,s,l)=>{const c=e(l,n),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),o=u,h=!0;else{_l(o===u,"Uniform length cannot change.");for(let t=0;t<u;++t)if(c[t]!==r[t]){h=!0;break}}return h&&(i(a,t,s,c),r.set(c)),h}}function Rc(t,e,n,i){t[e](n,i)}function Dc(t,e,n,i){t[e](n,!1,i)}function Fc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}function Bc(t,e,n,i){const r=t.split(/\r?\n/),o={},a={},s=i||Fc(e)||"(unnamed)",l="".concat(function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(s);for(let u=0;u<r.length;u++){const e=r[u];if(e.length<=1)continue;const n=e.split(":"),i=n[0],s=parseInt(n[2],10);if(isNaN(s))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));"WARNING"!==i?o[s]=e:a[s]=e}const c=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map(((t,i)=>{const o=String(i+e),a=o.length;return Nc(o,r-a)+n+t}))}(e);return{shaderName:l,errors:jc(o,c),warnings:jc(a,c)}}function jc(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if((t[i+3]||t[i+2]||t[i+1])&&(n+="".concat(r,"\n"),t[i+1])){const e=t[i+1],r=e.split(":",3),o=r[0],a=parseInt(r[1],10)||0,s=e.substring(r.join(":").length+1).trim();n+=Nc("^^^ ".concat(o,": ").concat(s,"\n\n"),a)}}return n}function Nc(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}class Vc extends Al{static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return _l(!1),"unknown"}}constructor(t,e){ms(t),_l("string"===typeof e.source,"Shader: GLSL source code must be a JavaScript string");super(t,{id:Fc(e.source,null)||e.id||Sl("unnamed ".concat(Vc.getTypeName(e.shaderType)))}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=Fc(e,null);n&&(this.id=Sl(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(Vc.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Fc(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);if(!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:i}=Bc(t,this.source,this.shaderType,this.id);throw hs.error("GLSL compilation errors in ".concat(e,"\n").concat(n))(),hs.warn("GLSL compilation warnings in ".concat(e,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(e))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Uc extends Vc{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Wc extends Vc{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Gc=5126,qc=5124,Zc=5125,Hc={[Gc]:[Gc,1,"float"],35664:[Gc,2,"vec2"],35665:[Gc,3,"vec3"],35666:[Gc,4,"vec4"],[qc]:[qc,1,"int"],35667:[qc,2,"ivec2"],35668:[qc,3,"ivec3"],35669:[qc,4,"ivec4"],[Zc]:[Zc,1,"uint"],36294:[Zc,2,"uvec2"],36295:[Zc,3,"uvec3"],36296:[Zc,4,"uvec4"],35670:[Gc,1,"bool"],35671:[Gc,2,"bvec2"],35672:[Gc,3,"bvec3"],35673:[Gc,4,"bvec4"],35674:[Gc,8,"mat2"],35685:[Gc,8,"mat2x3"],35686:[Gc,8,"mat2x4"],35675:[Gc,12,"mat3"],35687:[Gc,12,"mat3x2"],35688:[Gc,12,"mat3x4"],35676:[Gc,16,"mat4"],35689:[Gc,16,"mat4x2"],35690:[Gc,16,"mat4x3"]};function Xc(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return _l(!1),0}}function Yc(t){const e=Hc[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function Kc(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=Gc}for(const n in Hc){const[i,r,o]=Hc[n];if(i===t&&r===e)return{glType:n,name:o}}return null}class Jc{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getActiveAttrib(t.handle,i),a=e.getAttribLocation(t.handle,n);a>=0&&this._addAttribute(a,n,r,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!gs(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,n,r,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,i){const{type:r,components:o}=Yc(n),a={type:r,size:i*o};this._inferProperties(t,e,a);const s={location:t,name:e,accessor:new Dl(a)};this.attributeInfos.push(s),this.attributeInfosByLocation[t]=s,this.attributeInfosByName[s.name]=s}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:r,components:o}=Yc(n),a={location:t,name:e,accessor:new Dl({type:r,size:i*o})};this.varyingInfos.push(a),this.varyingInfosByName[a.name]=a}}const Qc=35981,$c=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class tu extends Al{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",$c),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:r,bufferMode:o=Qc}=t;return this.hash=e||"",this.vs="string"===typeof n?new Uc(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"===typeof i?new Wc(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,_l(this.vs instanceof Uc),_l(this.fs instanceof Wc),this.uniforms={},this._textureUniforms={},r&&r.length>0&&(ys(this.gl),this.varyings=r,this.gl2.transformFeedbackVaryings(this.handle,r,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Jc(this),this.setProps(t)}delete(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:r=0,start:o,end:a,isIndexed:s=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:p,framebuffer:d,parameters:f={},uniforms:g,samplers:m}=t;if((g||m)&&(hs.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(g||{})),hs.priority>=e){const t=d?d.id:"default",r="mode=".concat(xl(this.gl,n)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat(xl(this.gl,l)," ")+"isInstanced=".concat(u," isIndexed=").concat(s," ")+"Framebuffer=".concat(t);hs.log(e,r)()}return _l(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c)&&(h.bindForDraw(i,c,(()=>{if(void 0!==d&&(f=Object.assign({},f,{framebuffer:d})),p){const t=Xc(n);p.begin(t)}this._bindTextures(),Js(this.gl,f,(()=>{s&&u?this.gl2.drawElementsInstanced(n,i,l,r,c):s&&gs(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(n,o,a,i,l,r):s?this.gl.drawElements(n,i,l,r):u?this.gl2.drawArraysInstanced(n,r,i,c):this.gl.drawArrays(n,r,i)})),p&&p.end()})),!0)}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};hs.priority>=2&&function(t,e,n){for(const i in t){const r=t[i];if((!n||Boolean(n[i]))&&!Ic(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let t=n,r=!1;if(t instanceof _c&&(t=t.texture),t instanceof Zl)if(r=this.uniforms[e]!==n,r){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:r}=i;n.bind(r),t=r,this._textureUniforms[e]=n}else t=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(t)||r)&&Lc(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const i of e){switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new Uc({handle:i});break;case 35632:n.fs=new Wc({handle:i})}}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=Sl(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),hs.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),hs.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||hs.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));t.validateProgram(this.handle);if(!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=Mc(n.name);let r=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=Cc(t,r,n),n.size>1)for(let e=0;e<n.size;e++)r=t.getUniformLocation(this.handle,"".concat(i,"[").concat(e,"]")),this._uniformSetters["".concat(i,"[").concat(e,"]")]=Cc(t,r,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class eu{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new eu(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"===typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:e="",fs:n="",defines:i={},inject:r={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:s=!1}=t,l=this._getModuleList(t.modules),c=this._getHash(e),u=this._getHash(n),h=l.map((t=>this._getHash(t.name))).sort(),p=o.map((t=>this._getHash(t))),d=Object.keys(i).sort(),f=Object.keys(r).sort(),g=[],m=[];for(const v of d)g.push(this._getHash(v)),g.push(this._getHash(i[v]));for(const v of f)m.push(this._getHash(v)),m.push(this._getHash(r[v]));const y="".concat(c,"/").concat(u,"D").concat(g.join("/"),"M").concat(h.join("/"),"I").concat(m.join("/"),"V").concat(p.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(s?"T":"");if(!this._programCache[y]){const t=function(t,e){const{vs:n,fs:i}=e,r=Ia(e.modules||[]);return{gl:t,vs:cs(t,Object.assign({},e,{source:n,type:Pa,modules:r})),fs:cs(t,Object.assign({},e,{source:i,type:Ea,modules:r})),getUniforms:us(r)}}(this.gl,{vs:e,fs:n,modules:l,inject:r,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:s});this._programCache[y]=new tu(this.gl,{hash:y,vs:t.vs,fs:t.fs,varyings:o,bufferMode:a}),this._getUniforms[y]=t.getUniforms||(t=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let r=0,o=this._defaultModules.length;r<o;++r){const t=this._defaultModules[r],o=t.name;e[i++]=t,n[o]=!0}for(let r=0,o=t.length;r<o;++r){const o=t[r],a=o.name;n[a]||(e[i++]=o,n[a]=!0)}return e.length=i,e}}const nu=[255,255,255],iu=1,ru=[0,0,-1];let ou=0;class au{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e=nu}=t,{intensity:n=iu}=t,{direction:i=ru}=t,{_shadow:r=!1}=t;this.id=t.id||"directional-".concat(ou++),this.color=e,this.intensity=n,this.type="directional",this.direction=new Zo(i).normalize().toArray(),this.shadow=r}getProjectedLight(){return this}}class su{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,"id",void 0),l(this,"props",void 0),l(this,"useInPicking",void 0);const{id:e="effect"}=t;this.id=e,this.props={...t},this.useInPicking=!1}preRender(){}getModuleParameters(t){}cleanup(){}}class lu extends class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};l(this,"id",void 0),l(this,"gl",void 0),l(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}{render(t){return Ks(this.gl,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:r,onViewportActive:o,clearCanvas:a=!0}=t;t.pass=t.pass||"unknown";const s=this.gl;a&&function(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;Ks(t,{viewport:[0,0,e,n]}),t.clear(16640)}(s);const l=[];for(const c of i){const i=r&&r[c.id];o(c);const a=this._getDrawLayerParams(c,t),u=c.subViewports||[c];for(const r of u){const o=this._drawLayersInViewport(s,{target:e,moduleParameters:n,viewport:r,view:i,pass:t.pass,layers:t.layers},a);l.push(o)}}return l}_getDrawLayerParams(t,e){let{layers:n,pass:i,layerFilter:r,effects:o,moduleParameters:a}=e;const s=[],l=cu(),c={layer:n[0],viewport:t,isPicking:i.startsWith("picking"),renderPass:i},u={};for(let h=0;h<n.length;h++){const e=n[h],p=this._shouldDrawLayer(e,c,r,u),d={shouldDrawLayer:p,layerRenderIndex:l(e,p)};p&&(d.moduleParameters=this._getModuleParameters(e,o,i,a),d.layerParameters=this.getLayerParameters(e,h,t)),s[h]=d}return s}_drawLayersInViewport(t,e,n){let{layers:i,moduleParameters:r,pass:o,target:a,viewport:s,view:l}=e;const c=function(t,e){let{moduleParameters:n,target:i,viewport:r}=e;const o=i&&"default-framebuffer"!==i.id,a=n&&n.devicePixelRatio||Qs(t),s=o?i.height:t.drawingBufferHeight,l=r;return[l.x*a,s-(l.y+l.height)*a,l.width*a,l.height*a]}(t,{moduleParameters:r,target:a,viewport:s});if(l&&l.props.clear){const e=!0===l.props.clear?{color:!0,depth:!0}:l.props.clear;Js(t,{scissorTest:!0,scissor:c},(()=>ic(t,e)))}const u={totalCount:i.length,visibleCount:0,compositeCount:0,pickableCount:0};Ks(t,{viewport:c});for(let h=0;h<i.length;h++){const t=i[h],{shouldDrawLayer:e,layerRenderIndex:r,moduleParameters:a,layerParameters:l}=n[h];if(e&&t.props.pickable&&u.pickableCount++,t.isComposite)u.compositeCount++;else if(e){u.visibleCount++,a.viewport=s;try{t.drawLayer({moduleParameters:a,uniforms:{layerIndex:r},parameters:l})}catch(RM){t.raiseError(RM,"drawing ".concat(t," to ").concat(o))}}}return u}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!(this.shouldDrawLayer(t)&&t.props.visible))return!1;e.layer=t;let r=t.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}if(n){const t=e.layer.id;if(t in i||(i[t]=n(e)),!i[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var r;const o=Object.assign(Object.create((null===(r=t.internalState)||void 0===r?void 0:r.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Qs(this.gl)});if(e)for(const a of e)Object.assign(o,a.getModuleParameters(t));return Object.assign(o,this.getModuleParameters(t,e),i)}}function cu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={},i=(r,o)=>{const a=r.props._offset,s=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in n){const t=n[l]=n[l]||cu(e[l],e);c=t(r,o),n[s]=t}else Number.isFinite(a)?(c=a+(e[l]||0),n[s]=null):c=t;return o&&c>=t&&(t=c+1),e[s]=c,c};return i}class uu extends lu{constructor(t,e){super(t,e),l(this,"shadowMap",void 0),l(this,"depthBuffer",void 0),l(this,"fbo",void 0),this.shadowMap=new Xl(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Jl(t,{format:33189,width:1,height:1}),this.fbo=new _c(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;Js(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],i=Qs(this.gl),r=n.width*i,o=n.height*i;r===e.width&&o===e.height||e.resize({width:r,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const hu={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},pu="#define SMOOTH_EDGE_RADIUS 0.5",du={name:"geometry",vs:"\n".concat(pu,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(pu,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},fu=Object.keys(no).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(no[t],";"))).join(""),gu=Object.keys(io).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(io[t],";"))).join(""),mu=Object.keys(ro).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(ro[t],";"))).join(""),yu="".concat(fu,"\n").concat(gu,"\n").concat(mu,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n"),vu={};const _u={name:"project",dependencies:[hu,du],vs:yu,getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vu;return t.viewport?wo(t):{}}},bu=fo((function(t){let{viewport:e,center:n}=t;return new ra(e.viewProjectionMatrix).invert().transform(n)})),xu=fo((function(t){let{viewport:e,shadowMatrices:n}=t;const i=[],r=e.pixelUnprojectionMatrix,o=e.isGeospatial?void 0:1,a=[[0,0,o],[e.width,0,o],[0,e.height,o],[e.width,e.height,o],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map((t=>function(t,e){const[n,i,r]=t,o=K([n,i,r],e);if(Number.isFinite(r))return o;return[o[0],o[1],0]}(t,r)));for(const s of n){const t=s.clone().translate(new Zo(e.center).negate()),n=a.map((e=>t.transform(e))),r=(new ra).ortho({left:Math.min(...n.map((t=>t[0]))),right:Math.max(...n.map((t=>t[0]))),bottom:Math.min(...n.map((t=>t[1]))),top:Math.max(...n.map((t=>t[1]))),near:Math.min(...n.map((t=>-t[2]))),far:Math.max(...n.map((t=>-t[2])))});i.push(r.multiplyRight(s))}return i})),wu=[0,0,0,1],Su=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Pu(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||wu,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=bu({viewport:t.viewport,center:e.project_uCenter}),r=[],o=xu({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const n=o[a],s=n.clone().translate(new Zo(t.viewport.center).negate());e.project_uCoordinateSystem===no.LNGLAT&&e.project_uProjectionMode===io.WEB_MERCATOR?(o[a]=s,r[a]=i):(o[a]=n.clone().multiplyRight(Su),r[a]=s.transform(i))}for(let a=0;a<o.length;a++)n["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],n["shadow_uProjectCenters[".concat(a,"]")]=r[a],t.shadowMaps&&t.shadowMaps.length>0?n["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:n["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return n}const Eu={name:"shadow",dependencies:[_u],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0){const{shadowEnabled:n=!0}=t;return n&&t.shadowMatrices&&t.shadowMatrices.length>0?Pu(t,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},Tu={color:[255,255,255],intensity:1},ku=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Au=[0,0,0,200/255];class Cu extends su{constructor(t){super(t),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Au,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow))}preRender(t,e){let{layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:a}=e;if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=eu.getDefaultProgramManager(t),Eu&&this.programManager.addDefaultModule(Eu)),this.dummyShadowMap||(this.dummyShadowMap=new Xl(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++){this.shadowPasses[t].render({layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:a,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Eu),this.programManager=null)}_createLightMatrix(){const t=[];for(const e of this.directionalLights){const n=(new ra).lookAt({eye:new Zo(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new uu(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new Lr(Tu),this.directionalLights.push(new au(ku[0]),new au(ku[1])))}}let Mu=1,Iu=1;class Lu{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:r=1}=t,o=Mu++,a={time:0,delay:e,duration:n,rate:i,repeat:r};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const i of e)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:t,channel:e}=i;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=Iu++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const Ou="Awaiting state",zu="Matched. State transferred from previous layer",Ru="Initialized",Du="Discarded. Awaiting garbage collection",Fu="No longer matched. Awaiting garbage collection",Bu="Finalized! Awaiting garbage collection",ju=Symbol.for("component"),Nu=Symbol.for("asyncPropDefaults"),Vu=Symbol.for("asyncPropOriginal"),Uu=Symbol.for("asyncPropResolved");let Wu={};function Gu(t){eo.level>0&&Wu[t]&&Wu[t].call(...arguments)}function qu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!0;return Array.isArray(t)?Zu(t,e,[]):e(t)?[t]:[]}function Zu(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?Zu(r,e,n):e(r)&&n.push(r)}return n}function Hu(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,a=r*o;let s=0;for(let l=i;s<o;s++)e[l++]=n[s];for(;s<a;)s<a-s?(e.copyWithin(i+s,i,i+s),s*=2):(e.copyWithin(i+s,i,i+a-s),s=a);return e}const Xu=t=>"boolean"===typeof t,Yu=t=>"function"===typeof t,Ku=t=>null!==t&&"object"===typeof t,Ju=t=>Ku(t)&&t.constructor==={}.constructor,Qu=t=>"undefined"!==typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,$u=t=>"undefined"!==typeof Blob&&t instanceof Blob,th=t=>(t=>"undefined"!==typeof ReadableStream&&t instanceof ReadableStream||Ku(t)&&Yu(t.tee)&&Yu(t.cancel)&&Yu(t.getReader))(t)||(t=>Ku(t)&&Yu(t.read)&&Yu(t.pipe)&&Xu(t.readable))(t);function eh(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function nh(t){var e;if(!t)return!1;Array.isArray(t)&&(t=t[0]);return Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions)}function ih(t){var e,n;let i;return eh(t,"null loader"),eh(nh(t),"invalid loader"),Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}let rh="";const oh={};const ah=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,sh=/^([-\w.]+\/[-\w.+]+)/;function lh(t){const e=sh.exec(t);return e?e[1]:t}function ch(t){const e=ah.exec(t);return e?e[1]:""}const uh=/\?.*/;function hh(t){if(Qu(t)){const e=ph(t.url||"");return{url:e,type:lh(t.headers.get("content-type")||"")||ch(e)}}return $u(t)?{url:ph(t.name||""),type:t.type||""}:"string"===typeof t?{url:ph(t),type:ch(t)}:{url:"",type:""}}function ph(t){return t.replace(uh,"")}async function dh(t){if(Qu(t))return t;const e={},n=function(t){return Qu(t)?t.headers["content-length"]||-1:$u(t)?t.size:"string"===typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);n>=0&&(e["content-length"]=String(n));const{url:i,type:r}=hh(t);r&&(e["content-type"]=r);const o=await async function(t){const e=5;if("string"===typeof t)return"data:,".concat(t.slice(0,e));if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){const n=function(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}(t.slice(0,e));return"data:base64,".concat(n)}return null}(t);o&&(e["x-first-bytes"]=o),"string"===typeof t&&(t=(new TextEncoder).encode(t));const a=new Response(t,{headers:e});return Object.defineProperty(a,"url",{value:i}),a}async function fh(t,e){if("string"===typeof t){t=function(t){for(const e in oh)if(t.startsWith(e)){const n=oh[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat(rh).concat(t)),t}(t);let n=e;return null!==e&&void 0!==e&&e.fetch&&"function"!==typeof(null===e||void 0===e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await dh(t)}const gh=new Jr({id:"loaders.gl"});class mh{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const yh={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){l(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},vh={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function _h(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const bh=()=>{const t=_h();return t.globalOptions=t.globalOptions||{...yh},t.globalOptions};function xh(t,e,n,i){return n=n||[],function(t,e){Sh(t,null,yh,vh,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Sh(i,n.id,r,o,e)}}(t,n=Array.isArray(n)?n:[n]),Eh(e,t,i)}function wh(t,e){const n=bh(),i=t||n;return"function"===typeof i.fetch?i.fetch:Ku(i.fetch)?t=>fh(t,i):null!==e&&void 0!==e&&e.fetch?null===e||void 0===e?void 0:e.fetch:fh}function Sh(t,e,n,i,r){const o=e||"Top level",a=e?"".concat(e,"."):"";for(const s in t){const l=!e&&Ku(t[s]),c="baseUri"===s&&!e,u="workerUrl"===s&&e;if(!(s in n)&&!c&&!u)if(s in i)gh.warn("".concat(o," loader option '").concat(a).concat(s,"' no longer supported, use '").concat(i[s],"'"))();else if(!l){const t=Ph(s,r);gh.warn("".concat(o," loader option '").concat(a).concat(s,"' not recognized. ").concat(t))()}}}function Ph(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const e in r.options){if(t===e)return"Did you mean '".concat(r.id,".").concat(e,"'?");const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(e,"'?"))}return i}function Eh(t,e,n){const i={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(i,n),null===i.log&&(i.log=new mh),Th(i,bh()),Th(i,e),i}function Th(t,e){for(const n in e)if(n in e){const i=e[n];Ju(i)&&Ju(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function kh(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Ah="3.1.8";"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document,"object"!==typeof process||"[object process]"!==String(process)||process.browser;const Ch="undefined"!==typeof window&&"undefined"!==typeof window.orientation,Mh="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version),Ih=(Mh&&parseFloat(Mh[1]),new Map);function Lh(t){kh(t.source&&!t.url||!t.source&&t.url);let e=Ih.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Oh((e=t,"try {\n  importScripts('".concat(e,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var e}(t.url),Ih.set(t.url,e)),t.source&&(e=Oh(t.source),Ih.set(t.source,e))),kh(e),e}function Oh(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function zh(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(Rh(t))i.add(t);else if(Rh(t.buffer))i.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"===typeof t)for(const r in t)zh(t[r],e,i)}else;return void 0===n?Array.from(i):[]}function Rh(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&t instanceof MessagePort||("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}const Dh=()=>{};class Fh{static isSupported(){return"undefined"!==typeof Worker}constructor(t){l(this,"name",void 0),l(this,"source",void 0),l(this,"url",void 0),l(this,"terminated",!1),l(this,"worker",void 0),l(this,"onMessage",void 0),l(this,"onError",void 0),l(this,"_loadableURL","");const{name:e,source:n,url:i}=t;kh(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=Dh,this.onError=t=>console.log(t),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=Dh,this.onError=Dh,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||zh(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=Lh({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}}class Bh{constructor(t,e){l(this,"name",void 0),l(this,"workerThread",void 0),l(this,"isRunning",void 0),l(this,"result",void 0),l(this,"_resolve",void 0),l(this,"_reject",void 0),this.name=t,this.workerThread=e,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){kh(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){kh(this.isRunning),this.isRunning=!1,this._reject(t)}}class jh{constructor(t){l(this,"name","unnamed"),l(this,"source",void 0),l(this,"url",void 0),l(this,"maxConcurrency",1),l(this,"maxMobileConcurrency",1),l(this,"onDebug",(()=>{})),l(this,"reuseWorkers",!0),l(this,"props",{}),l(this,"jobQueue",[]),l(this,"idleQueue",[]),l(this,"count",0),l(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e,n)=>t.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(t,e)=>t.error(e);const i=new Promise((i=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:i}),this)));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new Bh(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Fh({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Ch?this.maxMobileConcurrency:this.maxConcurrency}}const Nh={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Vh{static isSupported(){return Fh.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Vh._workerFarm=Vh._workerFarm||new Vh({}),Vh._workerFarm.setProps(t),Vh._workerFarm}constructor(t){l(this,"props",void 0),l(this,"workerPools",new Map),this.props={...Nh},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy()}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let r=this.workerPools.get(e);return r||(r=new jh({name:e,source:n,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}l(Vh,"_workerFarm",void 0);const Uh="latest";async function Wh(t,e,n,i,r){const o=t.id,a=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(r||"compression"!==t.id||(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let e=t.version;"latest"===e&&(e=Uh);const n=e?"@".concat(e):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(n,"/dist/").concat(i)}return kh(r),r}(t,n),s=Vh.getWorkerFarm(n).getWorkerPool({name:o,url:a});n=JSON.parse(JSON.stringify(n));const l=await s.startJob("process-on-worker",Gh.bind(null,r));l.postMessage("process",{input:e,options:n});const c=await l.result;return await c.result}async function Gh(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:o,input:a,options:s}=i;try{const n=await t(a,s);e.postMessage("done",{id:o,result:n})}catch(r){const t=r instanceof Error?r.message:"unknown error";e.postMessage("error",{id:o,error:t})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}n(521);function qh(t){return t&&"object"===typeof t&&t.isBuffer}function Zh(t){if(qh(t))return function(t){if(qh(t))return new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer;return t}(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"===typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"===typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}async function Hh(t){const e=[];for await(const n of t)e.push(n);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),r=i.reduce(((t,e)=>t+e.byteLength),0),o=new Uint8Array(r);let a=0;for(const s of i)o.set(s,a),a+=s.byteLength;return o.buffer}(...e)}const Xh=262144;"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document;const Yh=Boolean("object"!==typeof process||"[object process]"!==String(process)||process.browser),Kh="undefined"!==typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Kh&&parseFloat(Kh[1]);function Jh(t,e){return Yh?async function*(t,e){const n=t.getReader();let i;try{for(;;){const t=i||n.read();null!==e&&void 0!==e&&e._streamReadAhead&&(i=n.read());const{done:r,value:o}=await t;if(r)return;yield Zh(o)}}catch(r){n.releaseLock()}}(t,e):async function*(t,e){for await(const n of t)yield Zh(n)}(t)}function Qh(t,e){if("string"===typeof t)return function*(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<t.length;){const e=Math.min(t.length-i,n),o=t.slice(i,i+e);i+=e,yield r.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{chunkSize:n=Xh}=e;let i=0;for(;i<t.byteLength;){const e=Math.min(t.byteLength-i,n),r=new ArrayBuffer(e),o=new Uint8Array(t,i,e);new Uint8Array(r).set(o),i+=e,yield r}}(t,e);if($u(t))return async function*(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||1048576;let i=0;for(;i<t.size;){const e=i+n,r=await t.slice(i,e).arrayBuffer();i=e,yield r}}(t,e);if(th(t))return Jh(t,e);if(Qu(t)){return Jh(t.body,e)}throw new Error("makeIterator")}const $h="Cannot convert supplied data type";async function tp(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"===typeof t||i)return function(t,e,n){if(e.text&&"string"===typeof t)return t;var i;if((i=t)&&"object"===typeof i&&i.isBuffer&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return 0===t.byteOffset&&i===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error($h)}(t,e);if($u(t)&&(t=await dh(t)),Qu(t)){const n=t;return await async function(t){if(!t.ok){const e=await async function(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(60),"..."):e}catch(n){}return e}(t);throw new Error(e)}}(n),e.binary?await n.arrayBuffer():await n.text()}if(th(t)&&(t=Qh(t,n)),(r=t)&&"function"===typeof r[Symbol.iterator]||(t=>t&&"function"===typeof t[Symbol.asyncIterator])(t))return Hh(t);var r;throw new Error($h)}const ep=new Jr({id:"loaders.gl"}),np=()=>{const t=_h();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function ip(){return np()}const rp=/\.([^.]+)$/;function op(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!sp(t))return null;if(e&&!Array.isArray(e))return ih(e);let r=[];e&&(r=r.concat(e)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||r.push(...ip()),cp(r);const o=ap(t,r,n,i);if(!o&&(null===n||void 0===n||!n.nothrow))throw new Error(lp(t));return o}function ap(t,e,n,i){const{url:r,type:o}=hh(t),a=r||(null===i||void 0===i?void 0:i.url);let s=null,l="";var c;(null!==n&&void 0!==n&&n.mimeType&&(s=up(e,null===n||void 0===n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null===n||void 0===n?void 0:n.mimeType)),s=s||function(t,e){const n=e&&rp.exec(e),i=n&&n[1];return i?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,i):null}(e,a),l=l||(s?"matched url ".concat(a):""),s=s||up(e,o),l=l||(s?"matched MIME type ".concat(o):""),s=s||function(t,e){if(!e)return null;for(const n of t)if("string"===typeof e){if(hp(e,n))return n}else if(ArrayBuffer.isView(e)){if(pp(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer){if(pp(e,0,n))return n}return null}(e,t),l=l||(s?"matched initial data ".concat(dp(t)):""),s=s||up(e,null===n||void 0===n?void 0:n.fallbackMimeType),l=l||(s?"matched fallback MIME type ".concat(o):""),l)&&ep.log(1,"selectLoader selected ".concat(null===(c=s)||void 0===c?void 0:c.name,": ").concat(l,"."));return s}function sp(t){return!(t instanceof Response&&204===t.status)}function lp(t){const{url:e,type:n}=hh(t);let i="No valid loader found (";i+=e?"".concat(function(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?dp(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function cp(t){for(const e of t)ih(e)}function up(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e==="application/x.".concat(n.id))return n}return null}function hp(t,e){if(e.testText)return e.testText(t);return(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function pp(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((i=>function(t,e,n,i){if(i instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":return i===fp(t,e,i.length);default:return!1}}(t,e,n,i)))}function dp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"===typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return fp(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return fp(t,0,e)}return""}function fp(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let o=0;o<n;o++)r+=String.fromCharCode(i.getUint8(e+o));return r}async function gp(t,e,n,i){kh(!i||"object"===typeof i),!e||Array.isArray(e)||nh(e)||(i=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:r}=hh(t),o=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,i),a=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!sp(t))return null;let r=op(t,e,{...n,nothrow:!0},i);if(r)return r;if($u(t)&&(r=op(t=await t.slice(0,10).arrayBuffer(),e,n,i)),!r&&(null===n||void 0===n||!n.nothrow))throw new Error(lp(t));return r}(t,o,n);return a?(i=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)return n;const i={fetch:wh(e,t),...t};return Array.isArray(i.loaders)||(i.loaders=null),i}({url:r,parse:gp,loaders:o},n=xh(n,a,o,r),i),await async function(t,e,n,i){if(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ah;kh(t,"no worker provided");const n=t.version}(t),e=await tp(e,t,n),t.parseTextSync&&"string"===typeof e)return n.dataType="text",t.parseTextSync(e,n,i,t);if(function(t,e){return!!Vh.isSupported()&&t.worker&&(null===e||void 0===e?void 0:e.worker)}(t,n))return await Wh(t,e,n,0,gp);if(t.parseText&&"string"===typeof e)return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw kh(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}(a,t,n,i)):null}async function mp(t,e,n,i){Array.isArray(e)||nh(e)||(void 0,n=e,e=void 0);const r=wh(n);let o=t;return"string"===typeof t&&(o=await r(t)),$u(t)&&(o=await r(t)),await gp(o,e,n)}class yp{constructor(t,e,n){this.id=t,this.context=n,this._loadCount=0,this._subscribers=new Set,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;"string"===typeof t&&(i=mp(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=null,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=null,this._content=t);for(const r of this._subscribers)r.onChange(this.getData())}}class vp{constructor(t){let{gl:e,protocol:n}=t;this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add(t){let{resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}=t,o=this._resources[e];o?o.setData(n,i):(o=new yp(e,n,this._context),this._resources[e]=o),o.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe(t){let{consumerId:e}=t;const n=this._consumers[e];if(n){for(const t in n){const e=n[t];e.resource&&e.resource.unsubscribe(e)}delete this._consumers[e],this.prune()}}subscribe(t){let{resourceId:e,onChange:n,consumerId:i,requestId:r="default"}=t;const{_resources:o,protocol:a}=this;e.startsWith(a)&&(e=e.replace(a,""),o[e]||this.add({resourceId:e,data:null,persistent:!1}));const s=o[e];if(this._track(i,r,s,n),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const r=this._consumers,o=r[t]=r[t]||{},a=o[e]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),n&&(o[e]=a,a.onChange=i,a.resource=n,n.subscribe(a))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}const _p=[_u],bp=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function xp(t){const e=eu.getDefaultProgramManager(t);for(const n of _p)e.addDefaultModule(n);for(const n of bp)e.addShaderHook(n);return e}const wp=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Sp{constructor(t){let{deck:e,stats:n,viewport:i,timeline:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new vp({gl:t,protocol:"deck://"}),this.context={...wp,layerManager:this,gl:t,deck:e,programManager:t&&xp(t),stats:n||new ml({id:"deck.gl"}),viewport:i||new ca({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:r||new Lu,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers(){let{layerIds:t=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){Gu("layerManager.setLayers",this,e,t),this.lastRenderedLayers=t,t=qu(t,Boolean);for(const n of t)n.context=this.context;return this._updateLayers(this.layers,t),this}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this.lastRenderedLayers,t)),this._nextLayers=null}activateViewport(t){return Gu("layerManager.activateViewport",this,t),t&&(this.context.viewport=t),this}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const o of t)n[o.id]?eo.warn("Multiple old layers with same id ".concat(o.id))():n[o.id]=o;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let r=!1;for(const o of i)if(o.hasUniformTransition()){r=!0;break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&eo.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let r=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),r=i.isComposite&&i.getSubLayers()}catch(RM){this._handleError("matching",RM,i)}r&&this._updateSublayersRecursively(r,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=Ru}catch(RM){this._handleError("initialization",RM,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=zu,e!==t&&(t.lifecycle=Du)}_updateLayer(t){try{t._update()}catch(RM){this._handleError("update",RM,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=Fu;try{t._finalize(),t.lifecycle=Bu}catch(RM){this._handleError("finalization",RM,t)}}}function Pp(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const i=t[n],r=e[n];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&Pp(i,r)))return!1}return!0}class Ep{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return"string"===typeof t?this.views.find((e=>e.id===t)):t}getViewState(t){const e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=qu(t,Boolean);this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){!Pp(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else eo.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(e)}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t._getViewport(e,{width:e.width,height:e.height}),...e})}_updateController(t,e,n,i){let r=t.controller;return r?(r={...e,...t.props,...r,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height},i?i.setProps(r):i=this._createController(t,r),i):null}_rebuildViewports(){const{width:t,height:e,views:n}=this,i=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let o=n.length;o--;){const a=n[o],s=this.getViewState(a),l=a.makeViewport({width:t,height:e,viewState:s});let c=i[a.id];a.controller&&!c&&(r=!0),!r&&a.controller||!c||(c.finalize(),c=null),this.controllers[a.id]=this._updateController(a,s,l,c),this._viewports.unshift(l)}for(const o in i)i[o]&&!this.controllers[o]&&i[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,i)=>!t[i].equals(e[i])))}}const Tp=/([0-9]+\.?[0-9]*)(%|px)/;function kp(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=Tp.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function Ap(t,e){return t.relative?Math.round(t.position*e):t.position}function Cp(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Mp{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=null,x:n=0,y:i=0,width:r="100%",height:o="100%",viewportInstance:a,type:s=ca}=t;Cp(!a||a instanceof ca),this.viewportInstance=a,this.id=e||this.constructor.displayName||"view",this.type=s,this.props={...t,id:this.id},this._parseDimensions({x:n,y:i,width:r,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(t){if(this===t)return!0;if(this.viewportInstance)return t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance);return Pp(this.props,t.props)}makeViewport(t){let{width:e,height:n,viewState:i}=t;if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(t){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions(t){let{width:e,height:n}=t;return{x:Ap(this._x,e),y:Ap(this._y,n),width:Ap(this._width,e),height:Ap(this._height,n)}}_getControllerProps(t){let e=this.props.controller;return e?!0===e?t:("function"===typeof e&&(e={type:e}),{...t,...e}):null}_getViewport(t,e){const{type:n}=this;return new n({...t,...this.props,...e})}_parseDimensions(t){let{x:e,y:n,width:i,height:r}=t;this._x=kp(e),this._y=kp(n),this._width=kp(i),this._height=kp(r)}}function Ip(){}const Lp={onStart:Ip,onUpdate:Ip,onInterrupt:Ip,onEnd:Ip};class Op{constructor(t){this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings={...Lp,...t},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const zp=()=>{},Rp=1,Dp=2,Fp=3,Bp={transitionEasing:t=>t,transitionInterruption:Rp,onTransitionStart:zp,onTransitionInterrupt:zp,onTransitionEnd:zp};class jp{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ControllerState=t,this.props={...Bp,...e},this.propsInTransition=null,this.transition=new Op(e.timeline),this.onViewStateChange=e.onViewStateChange||zp,this.onStateChange=e.onStateChange||zp,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(t={...Bp,...t},this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){const{interruption:i,endProps:r}=this.transition.settings,o={...n,...i===Dp?r:this.propsInTransition||n};this._triggerTransition(o,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===Fp||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=new this.ControllerState(t),i=new this.ControllerState(e).shortestPathFrom(n),{transitionInterpolator:r}=e,o=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0===o)return;const a=e.transitionInterpolator.initializeProps(t,i);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:a.start,endProps:a.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t(e)}}_onTransitionUpdate(t){const{time:e,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:a}}=t,s=a(e/o),l=n.interpolateProps(i,r,s);this.propsInTransition=new this.ControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const Np=["longitude","latitude","zoom","bearing","pitch"],Vp=["longitude","latitude","zoom"];class Up extends class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Array.isArray(t)&&(t={compare:t,extract:t,required:t});const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare||Object.keys(e))if(!(n in t)||!(n in e)||!Io(t[n],e[n]))return!1;return!0}initializeProps(t,e){let n;if(this._propsToExtract){const i={},r={};for(const n of this._propsToExtract)i[n]=t[n],r[n]=e[n];n={start:i,end:r}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}interpolateProps(t,e,n){return e}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];Cp(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super((Array.isArray(t)?t:t.transitionProps)||{compare:Np,extract:Np,required:Vp}),this.opts=t}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(t),a=i(e),s=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:a.project(s),aroundPosition:s,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const r of this._propsToExtract)i[r]=Mo(t[r]||0,e[r]||0,n);if(e.aroundPosition){const r=this.opts.makeViewport({...e,...i});Object.assign(i,r.panByPosition(e.aroundPosition,Mo(t.around,e.around,n)))}return i}}const Wp={transitionDuration:0},Gp={transitionDuration:300,transitionEasing:t=>t,transitionInterruption:Rp},qp=t=>1-(1-t)*(1-t),Zp=["wheel"],Hp=["panstart","panmove","panend"],Xp=["pinchstart","pinchmove","pinchend"],Yp=["tripanstart","tripanmove","tripanend"],Kp=["doubletap"],Jp=["keydown"];class Qp{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l(this,"ControllerState",void 0),l(this,"controllerState",null),l(this,"controllerStateProps",null),l(this,"transitionManager",void 0),l(this,"_transition",void 0),l(this,"_events",null),l(this,"eventManager",null),l(this,"_interactionState",{isDragging:!1}),l(this,"_customEvents",[]),l(this,"onViewStateChange",null),l(this,"onStateChange",null),l(this,"makeViewport",void 0),l(this,"_eventStartBlocked",void 0),l(this,"_state",void 0),l(this,"_panMove",void 0),l(this,"invertPan",void 0),l(this,"dragMode","rotate"),l(this,"inertia",0),l(this,"scrollZoom",!0),l(this,"dragPan",!0),l(this,"dragRotate",!0),l(this,"doubleClickZoom",!0),l(this,"touchZoom",!0),l(this,"touchRotate",!1),l(this,"keyboard",!0),this.ControllerState=t,this.transitionManager=new jp(t,{...e,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const n=this.linearTransitionProps;this._transition=n&&{...Gp,transitionInterpolator:new Up({transitionProps:n})},this.handleEvent=this.handleEvent.bind(this),this.setProps(e)}get linearTransitionProps(){return null}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.setProps(this.controllerStateProps)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){const{ControllerState:e}=this;this.controllerState=new e({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const n=this._eventStartBlocked;switch(t.type){case"panstart":return!n&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!n&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!n&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{x:e,y:n}=this.controllerStateProps,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.controllerStateProps;if(e&&e.handled)return!1;const r=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return r&&e&&e.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),"makeViewport"in t&&(this.makeViewport=t.makeViewport),"dragMode"in t&&(this.dragMode=t.dragMode),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:e}=t;!0===e&&(e=300),this.inertia=e;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:s=!1,keyboard:l=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(Zp,c&&n),this.toggleEvents(Hp,c&&(i||r)),this.toggleEvents(Xp,c&&(a||s)),this.toggleEvents(Yp,c&&s),this.toggleEvents(Kp,c&&o),this.toggleEvents(Jp,c&&l),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=s,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={...t.getViewportProps(),...e},r=this.controllerState!==t;if(this._state=t.getState(),this._setInteractionState(n),r){const t=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange&&(t.interactionState=this._interactionState,this.onViewStateChange(t))}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,Wp,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,Wp,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:qp},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,Wp,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:qp},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:i=!1}=this.scrollZoom,{delta:r}=t;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,Wp,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,Wp,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:qp},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,Wp,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(e,Wp,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e,_lastPinchEvent:n}=this;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const o=Math.log2(t.scale),a=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),s=Math.pow(2,o+a*e/2);r=r.zoom({pos:i,scale:s}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:qp},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let s;const l={};switch(t.srcEvent.code){case"Minus":s=e?a.zoomOut(n).zoomOut(n):a.zoomOut(n),l.isZooming=!0;break;case"Equal":s=e?a.zoomIn(n).zoomIn(n):a.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":e?(s=a.rotateLeft(r),l.isRotating=!0):(s=a.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":e?(s=a.rotateRight(r),l.isRotating=!0):(s=a.moveRight(i),l.isPanning=!0);break;case"ArrowUp":e?(s=a.rotateUp(o),l.isRotating=!0):(s=a.moveUp(i),l.isPanning=!0);break;case"ArrowDown":e?(s=a.rotateDown(o),l.isRotating=!0):(s=a.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(s,this._getTransitionProps(),l),!0}_getTransitionProps(t){const{_transition:e}=this;return e?t?{...e,transitionInterpolator:new Up({...t,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:e:Wp}}class $p{constructor(t){l(this,"_viewportProps",void 0),l(this,"_state",void 0),this._viewportProps=this._applyConstraints(t)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(t){return this._viewportProps}_applyConstraints(t){return t}}const td={pitch:0,bearing:0,altitude:1.5,minZoom:0,maxZoom:20,minPitch:0,maxPitch:60,position:[0,0,0]};class ed extends $p{constructor(t){t={...td,...t};const{makeViewport:e,width:n,height:i,latitude:r,longitude:o,zoom:a,bearing:s,pitch:l,altitude:c,position:u,maxZoom:h,minZoom:p,maxPitch:d,minPitch:f,startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:b,normalize:x}=t||{};Cp(Number.isFinite(o)),Cp(Number.isFinite(r)),Cp(Number.isFinite(a)),super({width:n,height:i,latitude:r,longitude:o,zoom:a,bearing:s,pitch:l,altitude:c,maxZoom:h,minZoom:p,maxPitch:d,minPitch:f,normalize:x,position:u}),this._state={startPanLngLat:g,startZoomLngLat:m,startRotatePos:y,startBearing:v,startPitch:_,startZoom:b},this.makeViewport=e}panStart(t){let{pos:e}=t;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan(t){let{pos:e,startPos:n}=t;const i=this._state.startPanLngLat||this._unproject(n);if(!i)return this;const r=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart(t){let{pos:e}=t;return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate(t){let{pos:e,deltaAngleX:n=0,deltaAngleY:i=0}=t;const{startRotatePos:r,startBearing:o,startPitch:a}=this._state;if(!r||!Number.isFinite(o)||!Number.isFinite(a))return this;let s;return s=e?this._calculateNewPitchAndBearing({...this._getRotationParams(e,r),startBearing:o,startPitch:a}):{bearing:o+n,pitch:a+i},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart(t){let{pos:e}=t;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom(t){let{pos:e,startPos:n,scale:i}=t,{startZoom:r,startZoomLngLat:o}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,o=this._unproject(n)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:r}),s=this.makeViewport({...this._viewportProps,zoom:a});return this._getUpdatedState({zoom:a,...s.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(t)}zoomOut(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/t)}moveLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([t,0])}moveRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-t,0])}moveUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,t])}moveDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-t])}rotateLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}_zoomFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=Co(i,n,e);const{maxPitch:r,minPitch:o,pitch:a}=t;t.pitch=Co(a,o,r);const{normalize:s=!0}=t;return s&&Object.assign(t,nt(t)),t}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom(t){let{scale:e,startZoom:n}=t;const{maxZoom:i,minZoom:r}=this._viewportProps;return Co(n+Math.log2(e),r,i)}_calculateNewPitchAndBearing(t){let{deltaScaleX:e,deltaScaleY:n,startBearing:i,startPitch:r}=t;n=Co(n,-1,1);const{minPitch:o,maxPitch:a}=this._viewportProps;let s=r;return n>0?s=r+n*(a-r):n<0&&(s=r-n*(o-r)),{pitch:s,bearing:i+180*e}}_getRotationParams(t,e){const n=t[0]-e[0],i=t[1]-e[1],r=t[1],o=e[1],{width:a,height:s}=this._viewportProps,l=n/a;let c=0;return i>0?Math.abs(s-o)>5&&(c=i/(o-s)*1.2):i<0&&o>5&&(c=1-r/o),c=Math.min(1,Math.max(-1,c)),{deltaScaleX:l,deltaScaleY:c}}}class nd extends Qp{constructor(t){t.dragMode=t.dragMode||"pan",super(ed,t)}setProps(t){t.position=t.position||[0,0,0];const e=this.controllerStateProps;super.setProps(t);(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch","position"]}}class id extends Mp{constructor(t){super({...t,type:fa})}get controller(){return this._getControllerProps({type:nd})}}id.displayName="MapView";class rd extends lu{constructor(t,e){super(t,e),l(this,"maskMap",void 0),l(this,"fbo",void 0);const{mapSize:n=2048}=e;this.maskMap=new Xl(t,{width:n,height:n,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new _c(t,{id:"maskmap",width:n,height:n,attachments:{36064:this.maskMap}})}render(t){const e=this.gl,n=[!1,!1,!1,!1];return n[t.channel]=!0,Js(e,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:n,depthTest:!1},(()=>super.render({...t,target:this.fbo,pass:"mask"})))}shouldDrawLayer(t){return t.props.operation===so}delete(){this.fbo.delete(),this.maskMap.delete()}}const od={rotationX:0,rotationOrbit:0,zoom:0,target:[0,0,0],minRotationX:-90,maxRotationX:90,minZoom:-1/0,maxZoom:1/0};class ad extends $p{constructor(t){let{makeViewport:e,width:n,height:i,rotationX:r=od.rotationX,rotationOrbit:o=od.rotationOrbit,target:a=od.target,zoom:s=od.zoom,minRotationX:l=od.minRotationX,maxRotationX:c=od.maxRotationX,minZoom:u=od.minZoom,maxZoom:h=od.maxZoom,startPanPosition:p,startRotatePos:d,startRotationX:f,startRotationOrbit:g,startZoomPosition:m,startZoom:y}=t;super({width:n,height:i,rotationX:r,rotationOrbit:o,target:a,zoom:s,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h}),this._state={startPanPosition:p,startRotatePos:d,startRotationX:f,startRotationOrbit:g,startZoomPosition:m,startZoom:y},this.makeViewport=e}panStart(t){let{pos:e}=t;return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan(t){let{pos:e,startPosition:n}=t;const i=this._state.startPanPosition||n;if(!i)return this;const r=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart(t){let{pos:e}=t;return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate(t){let{pos:e,deltaAngleX:n=0,deltaAngleY:i=0}=t;const{startRotatePos:r,startRotationX:o,startRotationOrbit:a}=this._state,{width:s,height:l}=this._viewportProps;if(!r||!Number.isFinite(o)||!Number.isFinite(a))return this;let c;if(e){let t=(e[0]-r[0])/s;const n=(e[1]-r[1])/l;(o<-90||o>90)&&(t*=-1),c={rotationX:o+180*n,rotationOrbit:a+180*t}}else c={rotationX:o+i,rotationOrbit:a+n};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{rotationOrbit:i}=n;return Math.abs(i-e.rotationOrbit)>180&&(n.rotationOrbit=i<0?i+360:i-360),n}zoomStart(t){let{pos:e}=t;return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom(t){let{pos:e,startPos:n,scale:i}=t;const{zoom:r}=this._viewportProps;let{startZoom:o,startZoomPosition:a}=this._state;Number.isFinite(o)||(o=r,a=this._unproject(n)||this._unproject(e));const s=this._calculateNewZoom({scale:i,startZoom:o}),l=this.makeViewport({...this._viewportProps,zoom:s});return this._getUpdatedState({zoom:s,...l.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([-t,0])}moveRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([t,0])}moveUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,-t])}moveDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,t])}rotateLeft(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-t})}rotateRight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+t})}rotateUp(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this._viewportProps.rotationX-t})}rotateDown(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this._viewportProps.rotationX+t})}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom(t){let{scale:e,startZoom:n}=t;const{maxZoom:i,minZoom:r}=this._viewportProps;Number.isFinite(n)||(n=this._viewportProps.zoom);return Co(n+Math.log2(e),r,i)}_panFromCenter(t){const{width:e,height:n,target:i}=this._viewportProps;return this.pan({startPosition:i,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i,maxRotationX:r,minRotationX:o,rotationOrbit:a}=t;return t.zoom=Co(i,n,e),t.rotationX=Co(t.rotationX,o,r),(a<-180||a>180)&&(t.rotationOrbit=function(t,e){const n=t%e;return n<0?e+n:n}(a+180,360)-180),t}}class sd extends ad{constructor(t){super(t),l(this,"zoomAxis",void 0),this.zoomAxis=t.zoomAxis||"all"}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;return t.zoom=Array.isArray(i)?[Co(i[0],n,e),Co(i[1],n,e)]:Co(i,n,e),t}_calculateNewZoom(t){let{scale:e,startZoom:n}=t;const{maxZoom:i,minZoom:r}=this._viewportProps;n||0===n||(n=this._viewportProps.zoom);let o=Math.log2(e);if(Array.isArray(n)){let[t,e]=n;switch(this.zoomAxis){case"X":t=Co(t+o,r,i);break;case"Y":e=Co(e+o,r,i);break;default:let n=Math.min(t+o,e+o);n<r&&(o+=r-n),n=Math.max(t+o,e+o),n>i&&(o+=i-n),t+=o,e+=o}return[t,e]}return Co(n+o,r,i)}}class ld extends Qp{constructor(t){t.dragMode=t.dragMode||"pan",super(sd,t)}_onPanRotate(t){return!1}get linearTransitionProps(){return["target","zoom"]}}const cd=(new ra).lookAt({eye:[0,0,1]});function ud(t){let{width:e,height:n,near:i,far:r}=t;return e=e||1,n=n||1,(new ra).ortho({left:-e/2,right:e/2,bottom:-n/2,top:n/2,near:i,far:r})}class hd extends ca{constructor(t){const{width:e,height:n,near:i=.1,far:r=1e3,zoom:o=0,target:a=[0,0,0],flipY:s=!0}=t,l=Array.isArray(o)?o[0]:o,c=Array.isArray(o)?o[1]:o,u=Math.min(l,c),h=Math.pow(2,u);let p;if(l!==c){const t=Math.pow(2,l),e=Math.pow(2,c);p={unitsPerMeter:[t/h,e/h,1],metersPerUnit:[h/t,h/e,1]}}super({...t,longitude:null,position:a,viewMatrix:cd.clone().scale([h,h*(s?-1:1),h]),projectionMatrix:ud({width:e,height:n,near:i,far:r}),zoom:u,distanceScales:p})}projectFlat(t){let[e,n]=t;const{unitsPerMeter:i}=this.distanceScales;return[e*i[0],n*i[1]]}unprojectFlat(t){let[e,n]=t;const{metersPerUnit:i}=this.distanceScales;return[e*i[0],n*i[1]]}panByPosition(t,e){const n=K(e,this.pixelUnprojectionMatrix),i=ua([],this.projectFlat(t),ha([],n)),r=ua([],this.center,i);return{target:this.unprojectFlat(r)}}}class pd extends Mp{constructor(t){super({...t,type:hd})}get controller(){return this._getControllerProps({type:ld})}}pd.displayName="OrthographicView";class dd extends su{constructor(t){super(t),this.dummyMaskMap=null,this.useInPicking=!0,this.channels=[],this.masks=null}preRender(t,e){let{layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:a}=e;this.dummyMaskMap||(this.dummyMaskMap=new Xl(t,{width:1,height:1}));const s=n.filter((t=>t.props.operation===so&&t.props.visible));if(0===s.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new rd(t,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const l=this._sortMaskChannels(s),c=r[0],u=!this.lastViewport||!this.lastViewport.equals(c);for(const h in l)this._renderChannel(l[h],{layerFilter:i,onViewportActive:o,views:a,viewport:c,viewportChanged:u})}_renderChannel(t,e){let{layerFilter:n,onViewportActive:i,views:r,viewport:o,viewportChanged:a}=e;const s=this.channels[t.index],l=t===s||s.layers.length!==t.layers.length||t.layerBounds.some(((t,e)=>t!==s.layerBounds[e]));if(t.bounds=s.bounds,t.maskBounds=s.maskBounds,this.channels[t.index]=t,(l||a)&&(this.lastViewport=o,t.bounds=function(t){let{layers:e,viewport:n}=t,i=null;for(const a of e){const t=a.getBounds();t&&(i?(i[0]=Math.min(i[0],t[0][0]),i[1]=Math.min(i[1],t[0][1]),i[2]=Math.max(i[2],t[1][0]),i[3]=Math.max(i[3],t[1][1])):i=[t[0][0],t[0][1],t[1][0],t[1][1]])}const r=n.getBounds();if(!i)return r;const o=function(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}(r);return i[2]-i[0]<o[2]-o[0]||i[3]-i[1]<o[3]-o[1]||(i[0]=Math.max(i[0],o[0]),i[1]=Math.max(i[1],o[1]),i[2]=Math.min(i[2],o[2]),i[3]=Math.min(i[3],o[3])),i}({layers:t.layers,viewport:o}),l||!Io(t.bounds,s.bounds))){const{maskPass:e,maskMap:a}=this,s=function(t){let{bounds:e,viewport:n,width:i,height:r}=t;if(e[2]<=e[0]||e[3]<=e[1])return null;if(i-=2,r-=2,n instanceof fa){const{longitude:t,latitude:n,zoom:o}=J({width:i,height:r,bounds:[[e[0],e[1]],[e[2],e[3]]],maxZoom:20});return new fa({longitude:t,latitude:n,zoom:o,x:1,y:1,width:i,height:r})}const o=[(e[0]+e[2])/2,(e[1]+e[3])/2,0],a=Math.min(20,i/(e[2]-e[0]),r/(e[3]-e[1]));return new pd({x:1,y:1}).makeViewport({width:i,height:r,viewState:{target:o,zoom:Math.log2(a)}})}({bounds:t.bounds,viewport:o,width:a.width,height:a.height});t.maskBounds=s?s.getBounds():[0,0,1,1],e.render({channel:t.index,layers:t.layers,layerFilter:n,viewports:s?[s]:[],onViewportActive:i,views:r,moduleParameters:{devicePixelRatio:1}})}this.masks[t.id]={index:t.index,bounds:t.maskBounds,coordinateOrigin:t.coordinateOrigin,coordinateSystem:t.coordinateSystem}}_sortMaskChannels(t){const e={};let n=0;for(const i of t){const{id:t}=i.root;let r=e[t];if(!r){if(++n>4){eo.warn("Too many mask layers. The max supported is 4")();continue}r={id:t,index:this.channels.findIndex((e=>(null===e||void 0===e?void 0:e.id)===t)),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},e[t]=r}r.layers.push(i),r.layerBounds.push(i.getBounds())}for(let i=0;i<4;i++){const t=this.channels[i];t&&t.id in e||(this.channels[i]=null)}for(const i in e){const t=e[i];t.index<0&&(t.index=this.channels.findIndex((t=>!t)),this.channels[t.index]=t)}return e}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=null),this.maskPass&&(this.maskPass.delete(),this.maskPass=null,this.maskMap=null),this.lastViewport=null,this.masks=null,this.channels.length=0}}const fd=new Cu;class gd{constructor(){l(this,"effects",void 0),l(this,"_internalEffects",void 0),l(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&Pp(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.cleanup(),this.effects=t,this._internalEffects=t.slice(),this._internalEffects.push(new dd),t.some((t=>t instanceof Cu))||this._internalEffects.push(fd)}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}}class md extends lu{shouldDrawLayer(t){return t.props.operation===ao}}const yd={blendFunc:[1,0,32771,0],blendEquation:32774};class vd extends lu{constructor(){super(...arguments),l(this,"pickZ",void 0),l(this,"_colors",null)}render(t){return t.pickingFBO?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer(t){let{layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:o,pickingFBO:a,deviceRect:{x:s,y:l,width:c,height:u},effects:h,pass:p="picking",pickZ:d}=t;const f=this.gl;this.pickZ=d;const g=d?null:{byLayer:new Map,byAlpha:[]};this._colors=g;const m=Js(f,{scissorTest:!0,scissor:[s,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...yd,blend:!d},(()=>super.render({target:a,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:o,effects:null===h||void 0===h?void 0:h.filter((t=>t.useInPicking)),pass:p})));this._colors=null;return{decodePickingColor:g&&_d.bind(null,g),stats:m}}shouldDrawLayer(t){return t.props.pickable&&t.props.operation===ao}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters};return this._colors?(Object.assign(i,yd),i.blend=!0,i.blendColor=function(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,a=i.get(e);a?(a.viewports.push(n),o=a.a):(o=i.size+1,o<=255?(a={a:o,layer:e,viewports:[n]},i.set(e,a),r[o]=a):(eo.warn("Too many pickable layers, only picking the first 255")(),o=0));return[0,0,0,o/255]}(this._colors,t,n)):i.blend=!1,i}}function _d(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}class bd{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new md(t),this.pickLayersPass=new vd(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=t.layerFilter||this.layerFilter,t.effects=t.effects||[],t.target=t.target||_c.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,i=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,Gu("deckRenderer.renderLayers",this,i,t)}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const i of t)i.preRender(this.gl,e),i.postRender&&(n=i);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new _c(this.gl),new _c(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const r of t)if(r.postRender){if(r===this.lastPostProcessEffect){i.target=e.target,r.postRender(this.gl,i);break}const t=r.postRender(this.gl,i);i.inputBuffer=t,i.swapBuffer=t===n[0]?n[1]:n[0]}}}const xd={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function wd(t){let{pickedColors:e,decodePickingColor:n,deviceX:i,deviceY:r,deviceRadius:o,deviceRect:a}=t;if(e){const{x:t,y:s,width:l,height:c}=a;let u=o*o,h=-1,p=0;for(let n=0;n<c;n++){const o=n+s-r,a=o*o;if(a>u)p+=4*l;else for(let n=0;n<l;n++){if(e[p+3]-1>=0){const e=n+t-i,r=e*e+a;r<=u&&(u=r,h=p)}p+=4}}if(h>=0){const i=e.slice(h,h+4),r=n(i);if(r){const e=Math.floor(h/4/l),n=h/4-e*l;return{...r,pickedColor:i,pickedX:t+n,pickedY:s+e}}eo.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return xd}function Sd(t){let{pickInfo:e,viewports:n,pixelRatio:i,x:r,y:o,z:a}=t,s=n[0];n.length>1&&(s=function(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}((null===e||void 0===e?void 0:e.pickedViewports)||n,{x:r,y:o}));const l=s&&s.unproject([r-s.x,o-s.y,a]);return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:r,y:o,pixel:[r,o],coordinate:l,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:null,pixelRatio:i}}function Pd(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:a,pickedObjectIndex:s}=e,l=a?[a]:[];if("hover"===i){const t=n.index,e=n.layerId,i=a&&a.props.id;if(i!==e||s!==t){if(i!==e){const t=r.find((t=>t.props.id===e));t&&l.unshift(t)}n.layerId=i,n.index=s,n.info=null}}const c=Sd(t),u=new Map;return u.set(null,c),l.forEach((t=>{let e={...c};t===a&&(e.color=o,e.index=s,e.picked=!0),e=Ed({layer:t,info:e,mode:i}),t===a&&"hover"===i&&(n.info=e),u.set(e.layer.id,e),"hover"===i&&e.layer.updateAutoHighlight(e)})),u}function Ed(t){let{layer:e,info:n,mode:i}=t;for(;e&&n;){const t=n.layer||null;n.sourceLayer=t,n.layer=e,n=e.getPickingInfo({info:n,mode:i,sourceLayer:t}),e=e.parent}return n}class Td{constructor(t){this.gl=t,this.pickingFBO=null,this.pickLayersPass=new vd(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject(t){let{x:e,y:n,layers:i,viewports:r}=t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info;const a=o&&o.layer&&o.layer.id,s=o&&o.viewport&&o.viewport.id,l=a?i.find((t=>t.id===a)):null,c=s&&r.find((t=>t.id===s))||r[0],u=c&&c.unproject([e-c.x,n-c.y]),h={x:e,y:n,viewport:c,coordinate:u,layer:l};return{...o,...h}}_resizeBuffer(){const{gl:t}=this;return this.pickingFBO||(this.pickingFBO=new _c(t),_c.isSupported(t,{colorBufferFloat:!0})&&(this.depthFBO=new _c(t),this.depthFBO.attach({36064:new Xl(t,{format:gs(t)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.pickingFBO}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>t.isPickable()&&!t.isComposite));return e.length?e:null}_pickClosestObject(t){let{layers:e,views:n,viewports:i,x:r,y:o,radius:a=0,depth:s=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:h}=t;if(e=this._getPickable(e),!e)return{result:[],emptyInfo:Sd({viewports:i,x:r,y:o})};this._resizeBuffer();const p=Qs(this.gl),d=$s(this.gl,[r,o],!0),f=[d.x+Math.floor(d.width/2),d.y+Math.floor(d.height/2)],g=Math.round(a*p),{width:m,height:y}=this.pickingFBO,v=this._getPickingRect({deviceX:f[0],deviceY:f[1],deviceRadius:g,deviceWidth:m,deviceHeight:y});let _;const b=[],x=new Set;for(let w=0;w<s;w++){const t=wd({...v&&this._drawAndSample({layers:e,views:n,viewports:i,onViewportActive:u,deviceRect:v,effects:h,pass:"picking:".concat(l),redrawReason:l}),deviceX:f[0],deviceY:f[1],deviceRadius:g,deviceRect:v});let a;if(t.pickedLayer&&c&&this.depthFBO){a=this._drawAndSample({layers:[t.pickedLayer],views:n,viewports:i,onViewportActive:u,deviceRect:{x:t.pickedX,y:t.pickedY,width:1,height:1},effects:h,pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0}).pickedColors[0]}t.pickedLayer&&w+1<s&&(x.add(t.pickedLayer),t.pickedLayer.disablePickingIndex(t.pickedObjectIndex)),_=Pd({pickInfo:t,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,viewports:i,x:r,y:o,z:a,pixelRatio:p});for(const e of _.values())e.layer&&b.push(e);if(!t.pickedColor)break}for(const w of x)w.restorePickingColors();return{result:b,emptyInfo:_&&_.get(null)}}_pickVisibleObjects(t){let{layers:e,views:n,viewports:i,x:r,y:o,width:a=1,height:s=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:h}=t;if(e=this._getPickable(e),!e)return[];this._resizeBuffer();const p=Qs(this.gl),d=$s(this.gl,[r,o],!0),f=d.x,g=d.y+d.height,m=$s(this.gl,[r+a,o+s],!0),y=m.x+m.width,v=m.y,_={x:f,y:v,width:y-f,height:g-v},b=function(t){let{pickedColors:e,decodePickingColor:n}=t;const i=new Map;if(e)for(let r=0;r<e.length;r+=4)if(e[r+3]-1>=0){const t=e.slice(r,r+4),o=t.join(",");if(!i.has(o)){const e=n(t);e?i.set(o,{...e,pickedColor:t}):eo.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(i.values())}(this._drawAndSample({layers:e,views:n,viewports:i,onViewportActive:u,deviceRect:_,effects:h,pass:"picking:".concat(l),redrawReason:l})),x=new Map,w=Number.isFinite(c);for(let S=0;S<b.length&&!(w&&x.size>=c);S++){const t=b[S];let e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:r,y:o,width:a,height:s,pixelRatio:p};e=Ed({layer:t.pickedLayer,info:e,mode:l}),x.has(e.object)||x.set(e.object,e)}return Array.from(x.values())}_drawAndSample(t){let{layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:o,effects:a,pass:s,redrawReason:l,pickZ:c}=t;const u=c?this.depthFBO:this.pickingFBO,{decodePickingColor:h}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:o,effects:a,pass:s,redrawReason:l,pickZ:c}),{x:p,y:d,width:f,height:g}=o,m=new(c?Float32Array:Uint8Array)(f*g*4);return cc(u,{sourceX:p,sourceY:d,sourceWidth:f,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:h}}_getPickingRect(t){let{deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:o}=t;const a=Math.max(0,e-i),s=Math.max(0,n-i),l=Math.min(r,e+i+1)-a,c=Math.min(o,n+i+1)-s;return l<=0||c<=0?null:{x:a,y:s,width:l,height:c}}}const kd={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class Ad{constructor(t){const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,kd),e.appendChild(this.el)),this.isVisible=!1}setTooltip(t,e,n){const i=this.el;if("string"===typeof t)i.innerText=t;else{if(!t)return this.isVisible=!1,void(i.style.display="none");"text"in t&&(i.innerText=t.text),"html"in t&&(i.innerHTML=t.html),"className"in t&&(i.className=t.className),Object.assign(i.style,t.style)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}remove(){this.el&&this.el.remove()}}const{_parseImageNode:Cd}=globalThis,Md="undefined"!==typeof Image,Id="undefined"!==typeof ImageBitmap,Ld=Boolean(Cd),Od=!!Yh||Ld;function zd(t){const e=Dd(t);if(!e)throw new Error("Not an image");return e}function Rd(t){switch(zd(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Dd(t){return"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&t instanceof Image?"image":t&&"object"===typeof t&&t.data&&t.width&&t.height?"data":null}const Fd=/^data:image\/svg\+xml/,Bd=/\.svg((\?|#).*)?$/;function jd(t){return t&&(Fd.test(t)||Bd.test(t))}function Nd(t,e){if(jd(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Vd(t,e,n){const i=function(t,e){if(jd(e)){let e=(new TextDecoder).decode(t);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(n){throw new Error(n.message)}return"data:image/svg+xml;base64,".concat(btoa(e))}return Nd(t,e)}(t,n),r=self.URL||self.webkitURL,o="string"!==typeof i&&r.createObjectURL(i);try{return await async function(t,e){const n=new Image;if(n.src=t,e.image&&e.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((e,i)=>{try{n.onload=()=>e(n),n.onerror=e=>i(new Error("Could not load image ".concat(t,": ").concat(e)))}catch(r){i(r)}}))}(o||i,e)}finally{o&&r.revokeObjectURL(o)}}const Ud={};let Wd=!0;async function Gd(t,e,n){let i;if(jd(n)){i=await Vd(t,e,n)}else i=Nd(t,n);const r=e&&e.imagebitmap;return await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!qd(e)&&Wd||(e=null);if(e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Wd=!1}return await createImageBitmap(t)}(i,r)}function qd(t){for(const e in t||Ud)return!1;return!0}const Zd=!1,Hd=!0;function Xd(t){const e=Yd(t);return function(t){const e=Yd(t);if(!(e.byteLength>=24&&2303741511===e.getUint32(0,Zd)))return null;return{mimeType:"image/png",width:e.getUint32(16,Zd),height:e.getUint32(20,Zd)}}(e)||function(t){const e=Yd(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,Zd)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:i}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let r=2;for(;r+9<e.byteLength;){const t=e.getUint16(r,Zd);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(r+5,Zd),width:e.getUint16(r+7,Zd)};if(!n.has(t))return null;r+=2,r+=e.getUint16(r,Zd)}return null}(e)||function(t){const e=Yd(t);if(!(e.byteLength>=10&&1195984440===e.getUint32(0,Zd)))return null;return{mimeType:"image/gif",width:e.getUint16(6,Hd),height:e.getUint16(8,Hd)}}(e)||function(t){const e=Yd(t);if(!(e.byteLength>=14&&16973===e.getUint16(0,Zd)&&e.getUint32(2,Hd)===e.byteLength))return null;return{mimeType:"image/bmp",width:e.getUint32(18,Hd),height:e.getUint32(22,Hd)}}(e)}function Yd(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const Kd={id:"image",module:"images",name:"Images",version:"3.1.8",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:r}=n||{};let o;switch(function(t){switch(t){case"auto":case"data":return function(){if(Id)return"imagebitmap";if(Md)return"image";if(Od)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return Id||Md||Od;case"imagebitmap":return Id;case"image":return Md;case"data":return Od;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(i)){case"imagebitmap":o=await Gd(t,e,r);break;case"image":o=await Vd(t,e,r);break;case"data":o=await async function(t,e){const{mimeType:n}=Xd(t)||{},i=globalThis._parseImageNode;return eh(i),await i(t,n)}(t);break;default:eh(!1)}return"data"===i&&(o=Rd(o)),o},tests:[t=>Boolean(Xd(new DataView(t)))],options:{image:{type:"auto",decode:!0}}};const Jd={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},Qd="8.7.8",$d=globalThis.deck&&globalThis.deck.VERSION;if($d&&$d!==Qd)throw new Error("deck.gl - multiple versions detected: ".concat($d," vs ").concat(Qd));$d||(eo.log(1,"deck.gl ".concat(Qd))(),globalThis.deck={...globalThis.deck,VERSION:Qd,version:Qd,log:eo,_registerLoggers:function(t){Wu=t}},function(t){const e=np();t=Array.isArray(t)?t:[t];for(const n of t){const t=ih(n);e.find((e=>t===e))||e.unshift(t)}}([Jd,[Kd,{imagebitmap:{premultiplyAlpha:"none"}}]]));const tf=globalThis.deck,ef=globalThis;function nf(t){if(!t&&!zr())return"Node";if(Or(t))return"Electron";const e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r?"IE":ef.chrome?"Chrome":ef.safari?"Safari":ef.mozInnerScreenX?"Firefox":"Unknown"}class rf extends Al{static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=gs(t),i=mc(t,dc);let r=n||i;for(const o of e)switch(o){case"queries":r=r&&n;break;case"timers":r=r&&i;break;default:_l(!1)}return r}constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,i)=>{const r=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)})),this._pollingPromise}_createHandle(){return rf.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const of=zr()&&"undefined"!==typeof document;let af=0;class sf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:e=(t=>sl(t)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:r=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:s=null,glOptions:l={},debug:c=!1,createFramebuffer:u=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:p=!0,stats:d=vl.get("animation-loop-".concat(af++))}=t;let{useDevicePixels:f=!0}=t;"useDevicePixelRatio"in t&&(hs.deprecated("useDevicePixelRatio","useDevicePixels")(),f=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:r,onFinalize:o,onError:a,gl:s,glOptions:l,debug:c,createFramebuffer:u},this.gl=s,this.needsRedraw=null,this.timeline=null,this.stats=d,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:p,useDevicePixels:f}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return _l("string"===typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=rf.isSupported(this.gl,["timers"])?new rf(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return hs.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=of?new Promise(((t,e)=>{of&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):function(t){return"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}(t)}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"===typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!==typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?ll(this.props.gl,t):this.onCreateContext(t),!fs(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Ks(this.gl,Is),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas)return void dl(t,tl(e.useDevicePixels),e);const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new _c(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}function lf(){}const cf={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:lf,onResize:lf,onViewStateChange:lf,onInteractionStateChange:lf,onBeforeRender:lf,onAfterRender:lf,onLoad:lf,onError:(t,e)=>eo.error(t)(),_onMetrics:null,getCursor:t=>{let{isDragging:e}=t;return e?"grabbing":"grab"},debug:!1,drawPickingColors:!1};class uf{constructor(t){t={...cf,...t},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),t.viewState&&t.initialViewState&&eo.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===nf()&&eo.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!==typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new ml({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&So.setProps(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&eo.removed("onLayerHover","onHover")(),"onLayerClick"in t&&eo.removed("onLayerClick","onClick")(),t.initialViewState&&!Pp(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||i||r||o,e}redraw(t){if(!this.layerManager)return;const e=t||this.needsRedraw({clearRedrawFlags:!0});e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}getViews(){return this.viewManager.views}getViewports(t){return this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),r}_createCanvas(t){let e=t.canvas;if("string"===typeof e&&(e=document.getElementById(e),Cp(e)),!e){e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay";(t.parent||document.body).appendChild(e)}return Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;let{width:e,height:n}=t;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:t,height:e}=this;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:t}=this;if(!t)return!1;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:r,debug:o,onError:a,onBeforeRender:s,onAfterRender:l,useDevicePixels:c,autoResizeDrawingBuffer:u}=t;return new sf({width:e,height:n,useDevicePixels:c,autoResizeDrawingBuffer:u,autoResizeViewport:!1,gl:i,onCreateContext:t=>sl({...r,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:s,onAfterRender:l,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new id({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_onPointerMove(t){const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t,e.mode="hover"}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.interactiveState.isHovering=e.length>0;let i=n,r=!1;for(const o of e)i=o,r=o.layer.onHover(o,t.event);if(!r&&this.props.onHover&&this.props.onHover(i,t.event),this.props.getTooltip){const t=this.props.getTooltip(i);this.tooltip.setTooltip(t,i.x,i.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,ll(t,{enable:!0,copyState:!0})),this.tooltip=new Ad(this.canvas),Ks(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new Lu;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new zn(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in oo)this.eventManager.on(i,this._onEvent);this.viewManager=new Ep({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new Sp(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new gd,this.deckRenderer=new bd(t),this.deckPicker=new Td(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Ks(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),eo.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.interactiveState.isDragging=t.isDragging,this.props.onInteractionStateChange(t)}_onEvent(t){const e=oo[t.type],n=t.offsetCenter;if(!e||!n)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,a=o&&(o[e.handler]||o.props[e.handler]),s=this.props[e.handler];let l=!1;a&&(l=a.call(o,r,t)),!l&&s&&s(r,t)}_onPointerDown(t){const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=vl.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}uf.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(su)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.oneOfType([t.bool,t.number]),touchAction:t.string,eventRecognizerOptions:t.object,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onInteractionStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLoad:t.func,onError:t.func,debug:t.bool,drawPickingColors:t.bool,_framebuffer:t.object,_animate:t.bool,_pickable:t.bool,_typedArrayManagerProps:t.object}},uf.defaultProps=cf,uf.VERSION=tf.VERSION;const hf="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;function pf(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}class df{constructor(t,e){this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let r=n;if(n&&n.length!==i){r=new Float32Array(i);const t=e.elementOffset||0;for(let e=0;e<i;++e)r[e]=n[t+e]}return r}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function ff(t){return t.stride||t.size*t.bytesPerElement}function gf(t,e){e.offset&&eo.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=ff(t),i=("vertexOffset"in e?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}const mf=[],yf=[];function vf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=mf;const r={index:-1,data:t,target:[]};return t?"function"===typeof t[Symbol.iterator]?i=t:t.length>0&&(yf.length=t.length,i=yf):i=mf,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function _f(t){return t&&t[Symbol.asyncIterator]}function bf(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:a}=e,s=t.BYTES_PER_ELEMENT,l=i?i/s:n,c=r?r/s:0,u=Math.floor((t.length-c)/l);return(e,i)=>{let{index:r,target:s}=i;if(!o){const e=r*l+c;for(let i=0;i<n;i++)s[i]=t[e+i];return s}const h=o[r],p=o[r+1]||u;let d;if(a){d=new Array(p-h);for(let e=h;e<p;e++){const i=e*l+c;s=new Array(n);for(let e=0;e<n;e++)s[e]=t[i+e];d[e-h]=s}}else if(l===n)d=t.subarray(h*n+c,p*n+c);else{d=new t.constructor((p-h)*n);let e=0;for(let i=h;i<p;i++){const r=i*l+c;for(let i=0;i<n;i++)d[e++]=t[r+i]}}return d}}const xf=[],wf=[[0,1/0]];function Sf(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,a=t.end||n.length,s=e.length,l=a-i;if(s>l)return void n.set(e.subarray(0,l),i);if(n.set(e,i),!o)return;let c=s;for(;c<l;){const t=o(c,e);for(let e=0;e<r;e++)n[i+c]=t[e]||0,c++}}const Pf={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Ef(t,e){return t?(Number.isFinite(t)&&(t={duration:t}),t.type=t.type||"interpolation",{...Pf[t.type],...e,...t}):null}function Tf(t,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function kf(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Af(t){t.push(t.shift())}function Cf(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,a=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*o)*a}function Mf(t){let{buffer:e,numInstances:n,attribute:i,fromLength:r,fromStartIndices:o,getData:a=(t=>t)}=t;const s=i.doublePrecision&&i.value instanceof Float64Array?2:1,l=i.size*s,c=i.byteOffset,u=i.startIndices,h=o&&u,p=Cf(i,n),d=i.state.constant;if(!h&&r>=p)return;const f=d?i.value:i.getBuffer().getData({srcByteOffset:c});if(i.settings.normalized&&!d){const t=a;a=(e,n)=>i._normalizeConstant(t(e,n))}const g=d?(t,e)=>a(f,e):(t,e)=>a(f.subarray(t,t+l),e),m=e.getData({length:r}),y=new Float32Array(p);!function(t){let{source:e,target:n,size:i,getData:r,sourceStartIndices:o,targetStartIndices:a}=t;if(!Array.isArray(a))return Sf({source:e,target:n,size:i,getData:r}),n;let s=0,l=0;const c=r&&((t,e)=>r(t+l,e)),u=Math.min(o.length,a.length);for(let h=1;h<u;h++){const t=o[h]*i,r=a[h]*i;Sf({source:e.subarray(s,t),target:n,start:l,end:r,size:i,getData:c}),s=t,l=r}l<n.length&&Sf({source:[],target:n,start:l,size:i,getData:c})}({source:m,target:y,sourceStartIndices:o,targetStartIndices:u,size:l,getData:g}),e.byteLength<y.byteLength+c&&e.reallocate(y.byteLength+c),e.subData({data:y,offset:c})}class If extends class{constructor(t,e){this.gl=t,this.id=e.id,this.size=e.size;const n=e.logicalType||e.type,i=5130===n;let{defaultValue:r}=e;r=Number.isFinite(r)?[r]:r||new Array(this.size).fill(0),e.defaultValue=r;let o=n;i?o=5126:!o&&e.isIndexed?o=t&&function(t,e){return mc(t,e)}(t,fc)?5125:5123:o||(o=5126),e.logicalType=n,e.type=o;let a=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(n||o||5126);this.shaderAttributes={},this.doublePrecision=i,i&&!1===e.fp64&&(a=Float32Array),e.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=e,this.state={externalBuffer:null,bufferAccessor:e,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null,this.setData(e)}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new Nl(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*ff(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),So.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,r=function(t,e){const n=gf(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new df(this,r.high),n["".concat(t,"64Low")]=i?new df(this,r.low):new Float32Array(this.size),n}if(e){const n=gf(this.getAccessor(),e);return{[t]:new df(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant){const e=this.value.slice();t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,r=n*i;if(e&&r&&e.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let t=0;t<r;)for(let r=0;r<i;r++){const i=e[t++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;ArrayBuffer.isView(t)?t={value:t}:t instanceof Nl&&(t={buffer:t});const n={...this.settings,...t};if(e.bufferAccessor=n,e.bounds=null,t.constant){let n=t.value;n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this._normalizeConstant(n));if(!(!e.constant||!this._areValuesEqual(n,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=n}else if(t.buffer){const i=t.buffer;e.externalBuffer=i,e.constant=!1,this.value=t.value;const r=t.value instanceof Float64Array;n.type=t.type||i.accessor.type,n.bytesPerElement=i.accessor.BYTES_PER_ELEMENT*(r?2:1),n.stride=ff(n)}else if(t.value){this._checkExternalBuffer(t);let i=t.value;e.externalBuffer=null,e.constant=!1,this.value=i,n.bytesPerElement=i.BYTES_PER_ELEMENT,n.stride=ff(n);const{buffer:r,byteOffset:o}=this;this.doublePrecision&&i instanceof Float64Array&&(i=Ko(i,n));const a=i.byteLength+o+2*n.stride;r.byteLength<a&&r.reallocate(a),r.setAccessor(null),r.subData({data:i,offset:o}),n.type=t.type||r.accessor.type}return!0}updateSubBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;const{value:e}=this,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?Ko(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t){let{numInstances:e,copy:n=!1}=t;const{state:i}=this,r=i.allocatedValue,o=So.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:n});this.value=o;const{buffer:a,byteOffset:s}=this;return a.byteLength<o.byteLength+s&&(a.reallocate(o.byteLength+s),n&&r&&a.subData({data:r instanceof Float64Array?Ko(r,this):r,offset:s})),i.allocatedValue=o,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!t.constant&&e){const n=this.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||eo.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=i[0],e;switch(r){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let o=r;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:i[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e);const{transition:n=!1,noAlloc:i=!1,update:r=null,accessor:o=null,transform:a=null,startIndices:s=null}=e;Object.assign(this.settings,{transition:n,noAlloc:i,update:r||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:wf,startIndices:s}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw(){let{clearChangedFlags:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!==typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return Ef(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],n)}setNeedsUpdate(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,e=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===wf)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const i=t[o];i[1]<e[0]?(n.push(i),r=o+1):i[0]>e[1]?n.push(i):e=[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=wf}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=xf}setNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||t}update(t){this.setData(t)}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate({numInstances:t,copy:e.updateRanges!==wf}),!0))}updateBuffer(t){let{numInstances:e,data:n,props:i,context:r}=t;if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:a,noAlloc:s}}=this;let l=!0;if(a){for(const[t,s]of o)a.call(r,this,{data:n,startRow:t,endRow:s,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[t,n]of o){const i=Number.isFinite(t)?this.getVertexOffset(t):0,r=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}else;this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(t){if(void 0===t||"function"===typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;n.binaryValue=t,this.setNeedsRedraw(),ArrayBuffer.isView(t)&&(t={value:t});if(i.transform||e!==this.startIndices){Cp(ArrayBuffer.isView(t.value),"invalid ".concat(i.accessor));const r=t.size&&t.size!==this.size;return n.binaryAccessor=bf(t.value,{size:t.size||this.size,stride:t.stride,offset:t.offset,startIndices:e,nested:r}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,e){let{data:n,startRow:i,endRow:r,props:o,numInstances:a}=e;if(t.constant)return;const{settings:s,state:l,value:c,size:u,startIndices:h}=t,{accessor:p,transform:d}=s,f=l.binaryAccessor||("function"===typeof p?p:o[p]);Cp("function"===typeof f,'accessor "'.concat(p,'" is not a function'));let g=t.getVertexOffset(i);const{iterable:m,objectInfo:y}=vf(n,i,r);for(const v of m){y.index++;let e=f(v,y);if(d&&(e=d.call(this,e)),h){const n=(y.index<h.length-1?h[y.index+1]:a)-h[y.index];if(e&&Array.isArray(e[0])){let n=g;for(const i of e)t._normalizeValue(i,c,n),n+=u}else e&&e.length>u?c.set(e,g):(t._normalizeValue(e,y.target,0),Hu({target:c,source:y.target,start:g,count:n}));g+=n*u}else t._normalizeValue(e,c,g),g+=u}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"===typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const Lf="void main() {gl_FragColor = vec4(0);}",Of="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",zf="#version 300 es\n".concat(Of);function Rf(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,o]=n;if(!e.includes(i)||!r||!o)return null;return{qualifier:i,type:r,name:o.split(";")[0]}}function Df(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return 300===e?zf:e>300?"#version ".concat(e,"\n").concat(Of):Lf;const o=Ff(n,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(n,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(o,";\n}"):"varying ".concat(i," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(o,";\n}")}function Ff(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ta(!1),null}}class Bf extends Al{static isSupported(t){return gs(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ys(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,El(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:r,byteOffset:o}=this._getBufferParams(e);return n<0?(this.unused[t]=i,hs.warn((()=>"".concat(this.id," unused varying buffer ").concat(t)))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,o,r),this)}begin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof Nl===!1?(i=t.buffer,n=t.byteSize,e=t.byteOffset):i=t,void 0===e&&void 0===n||(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const r=e&&e.handle;return r&&void 0!==i?this.gl.bindBufferRange(35982,t,r,n,i):this.gl.bindBufferBase(35982,t,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}class jf{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof Nl?n:n.buffer:null}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&_l(gs(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const t=this.feedbackMap[i];i in e&&(n[t]=i)}Object.assign(n,t.feedbackBuffers);for(const i in n){const t=n[i];if("string"===typeof t){const r=e[t],{byteLength:o,usage:a,accessor:s}=r;n[i]=this._createNewBuffer(i,{byteLength:o,usage:a,accessor:s})}}return n}_setupBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new Bf(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const r=this.feedbackMap[i];e[i]=t.feedbackBuffers[r],n[r]=t.sourceBuffers[i],_l(n[r]instanceof Nl)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new Nl(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function Nf(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}const Vf={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},Uf="transform_uSampler_",Wf="transform_uSize_",Gf="transform_position";function qf(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t;let o=Object.keys(n).length,a=null;const s={};let l=e,c={};if(o>0||i){const t=l.split("\n"),e=t.slice();if(t.forEach(((t,r,l)=>{if(o>0){const i=function(t,e){const n={},i=function(t){return Rf(t,["attribute","in"])}(t);if(!i)return null;const{type:r,name:o}=i;if(o&&e[o]){const e="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:i,sizeName:a,uniformDeclerations:s}=function(t){const e="".concat(Uf).concat(t),n="".concat(Wf).concat(t),i="  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}(o),l=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ta(!1),null}}(r),c="  ".concat(r," ").concat(o," = transform_getInput(").concat(i,", ").concat(a,").").concat(l,";\n");n[i]=o;return{updatedLine:e,inject:{"vs:#decl":s,"vs:#main-start":c},samplerTextureMap:n}}return null}(t,n);if(i){const{updatedLine:t,inject:n}=i;e[r]=t,c=Xa([c,n]),Object.assign(s,i.samplerTextureMap),o--}}i&&!a&&(a=function(t,e){const n=Rf(t,["varying","out"]);if(!n)return null;return n.name===e?n.type:null}(t,i))})),i){_l(r);const t="".concat(Wf).concat(i),e="uniform vec2 ".concat(t,";\n"),n="     vec2 ".concat(Gf," = transform_getPos(").concat(t,");\n     gl_Position = vec4(").concat(Gf,", 0, 1.);\n");c=Xa([c,{"vs:#decl":e,"vs:#main-start":n}])}l=e.join("\n")}return{vs:l,targetTextureType:a,inject:c,samplerTextureMap:s}}const Zf={10241:9728,10240:9728,10242:33071,10243:33071};class Hf{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:r}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),a=Object.assign({},t.uniforms),s=Object.assign({},t.parameters);let l=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const e in this.samplerTextureMap){const t=this.samplerTextureMap[e];a[e]=n[t]}this._setSourceTextureParameters();const t=function(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let o,a;n&&(({width:o,height:a}=i),r["".concat(Wf).concat(n)]=[o,a]);for(const s in e)({width:o,height:a}=e[s]),r["".concat(Wf).concat(s)]=[o,a];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r});Object.assign(a,t)}return this.hasTargetTexture&&(l=!1,s.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:l,parameters:s}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=cc(e);if(!t)return n;const i=n.constructor,r=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ta(!1),null}}(this.targetTextureType),o=new i(n.length*r/4);let a=0;for(let s=0;s<n.length;s+=4)for(let t=0;t<r;t++)o[a++]=n[s+t];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof Xl)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,r=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:r}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!==typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new Nl(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:r}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),r){t.targetTexture=r;const{width:e,height:n}=r,{framebuffer:i}=t;i?(i.update({attachments:{36064:r},resizeAttachments:!1}),i.resize({width:e,height:n})):t.framebuffer=new _c(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:r}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(Zf)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;return{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=sc(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:r,targetTextureType:o,inject:a,samplerTextureMap:s}=qf({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=Xa([t.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=s;return{vs:i,fs:t._fs||Df({version:Nf(i),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Vf].concat(t.modules||[]):t.modules,uniforms:r,inject:l}}}let Xf=null;function Yf(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!Xf||Xf.byteLength<n)&&(Xf=new ArrayBuffer(n)),Xf),0,e)}class Kf extends Al{static isSupported(t){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||(gs(t)||"Chrome"===nf())}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new Kf(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return Kf.MAX_ATTRIBUTES=Kf.MAX_ATTRIBUTES||t.getParameter(34921),Kf.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:Kf._setConstantFloatArray(t,e,n);break;case Int32Array:Kf._setConstantIntArray(t,e,n);break;case Uint32Array:Kf._setConstantUintArray(t,e,n);break;default:_l(!1)}}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Kf.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return _l(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:i,type:r,stride:o,offset:a,normalized:s,integer:l,divisor:c}=n,{gl:u,gl2:h}=this;return t=Number(t),this.bind((()=>{u.bindBuffer(34962,e.handle),l?(_l(gs(u)),h.vertexAttribIPointer(t,i,r,o,a)):u.vertexAttribPointer(t,i,r,s,o,a),u.enableVertexAttribArray(t),h.vertexAttribDivisor(t,c||0)})),this}enable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e&&0===t&&!Kf.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,r=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new Nl(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=Yf(e.constructor,r);!function(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,a=r*o;let s=0;for(let l=i;s<o;s++)e[l++]=n[s];for(;s<a;)s<a-s?(e.copyWithin(i+s,i,i+s),s*=2):(e.copyWithin(i+s,i,i+a-s),s=a)}({target:t,source:n,start:0,count:r}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:_l(!1)}}static _setConstantIntArray(t,e,n){switch(_l(gs(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:_l(!1)}}static _setConstantUintArray(t,e,n){switch(_l(gs(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:_l(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return _l(Number.isFinite(n)),this.bind((()=>34373===t?this.gl.getVertexAttribOffset(n,t):this.gl.getVertexAttrib(n,t)))}}const Jf=/^(.+)__LOCATION_([0-9]+)$/,Qf=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class $f{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Kf(t),Tl(this,"VertexArray","v6.0",Qf),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,n);const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,r)),this}setConstant(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Nl(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof Nl&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof Nl&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),i=n()})),i}_resolveLocationAndAccessor(t,e,n,i){const r={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,hs.once(3,(()=>"unused value ".concat(t," in ").concat(this.id)))(),r;const s=this._getAttributeInfo(a||o);if(!s)return r;const l=this.accessors[o]||{},c=Dl.resolve(s.accessor,l,n,i),{size:u,type:h}=c;return _l(Number.isFinite(u)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=Jf.exec(t),i=n?n[1]:t,r=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+r,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof Nl)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof Nl){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof Nl))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let r=1;r<this.vertexArrayObject.MAX_ATTRIBUTES;r++)i=this.values[r],ArrayBuffer.isView(i)&&this._setConstantAttribute(r,i)}_setConstantAttributeZero(t,e){if(Kf.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){Kf.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:r}=i,o=r>0;if(t.isInstanced=t.isInstanced||o,n instanceof Nl){const e=n;if(o){const n=e.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return hs.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function tg(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let a=0;a<t.length&&a<n;++a)a>0&&(r+=",".concat(a%i===0?" ":"")),r+=eg(t[a],e);const o=t.length>n?"...":"]";return"".concat(r).concat(o)}function eg(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return tg(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2),o=r.indexOf(".0");return o===r.length-2?r.slice(0,-1):r}function ng(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let o,a,s,l="NOT PROVIDED",c=1,u=0,h=0;if(n&&(l=n.type,c=n.size,l=String(l).replace("Array",""),o=-1!==l.indexOf("nt")),e instanceof Nl){const t=e,{data:p,changed:d}=t.getDebugData();let f;if(a=d?"*":"",s=p,h=t.byteLength,u=h/p.BYTES_PER_ELEMENT/c,n){const t=n.divisor>0;f="".concat(t?"I ":"P "," ").concat(u," (x").concat(c,"=").concat(h," bytes ").concat(xl(r,l),")")}else o=!0,f="".concat(h," bytes");return{[i]:"".concat(a).concat(eg(s,{size:c,isInteger:o})),"Format ":f}}return s=e,c=e.length,l=String(e.constructor.name).replace("Array",""),o=-1!==l.indexOf("nt"),{[i]:"".concat(eg(s,{size:c,isInteger:o})," (constant)"),"Format ":"".concat(c,"x").concat(l," (constant)")}}function ig(t,e){const{type:n,size:i}=e,r=Kc(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function rg(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;_l(n);const o=".*Matrix",a=n._uniformSetters,s={},l=Object.keys(a).sort();let c=0;for(const p of l)p.match(".*_.*")||p.match(o)||og({table:s,header:e,uniforms:i,uniformName:p,undefinedOnly:r})&&c++;for(const p of l)p.match(o)&&og({table:s,header:e,uniforms:i,uniformName:p,undefinedOnly:r})&&c++;for(const p of l)s[p]||og({table:s,header:e,uniforms:i,uniformName:p,undefinedOnly:r})&&c++;let u=0;const h={};if(!r)for(const p in i){const t=i[p];s[p]||(u++,h[p]={Type:"NOT USED: ".concat(t),[e]:eg(t)})}return{table:s,count:c,unusedTable:h,unusedCount:u}}function og(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:o}=t;const a=i[r],s=function(t){return void 0!==t&&null!==t}(a);return(!o||!s)&&(e[r]={[n]:s?eg(a):"N/A","Uniform Type":s?a:"NOT PROVIDED"},!0)}function ag(t){const{type:e,size:n}=t.accessor,i=Kc(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const sg={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function lg(t,e){const{attributeMap:n=sg}=e||{};return n&&n[t]||t}function cg(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}_l(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const ug=()=>{},hg={};class pg{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=Sl("model")}=e;_l(fs(t)),this.id=n,this.gl=t,this.id=e.id||Sl("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||eu.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:r,defines:o,inject:a,varyings:s,bufferMode:l,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:a,varyings:s,bufferMode:l,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},_l(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:r,defines:o,inject:a,varyings:s,bufferMode:l,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:a,varyings:s,bufferMode:l,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return _l(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return _l(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const i={};let r=e.indices;for(const o in e.attributes){const a=e.attributes[o],s=lg(o,n);if("indices"===o)r=a;else if(a.constant)i[s]=a.value;else{const e=a.value,n={...a};delete n.value,i[s]=[new Nl(t,e),n],cg(o,n)}}if(r){const e=r.value||r;_l(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new Nl(t,{data:e,target:34963}),n]}return i}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(El(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return ic(this.program.gl,t),this}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:r={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:s=this.vertexArray}=t;let l;this.setAttributes(r),this.updateModuleSettings(e),this.setUniforms(i),hs.priority>=2&&(l=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:u=c.isIndexed,indexType:h=c.indexType,indexOffset:p=c.indexOffset,vertexArrayInstanced:d=c.isInstanced}=this.props;d&&!this.isInstanced&&hs.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:f,instanceCount:g}=this,{onBeforeRender:m=ug,onAfterRender:y=ug}=this.props;m(),this.program.setUniforms(this.uniforms);const v=this.program.draw(Object.assign(hg,t,{logPriority:l,uniforms:null,framebuffer:n,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:s,transformFeedback:o,isIndexed:u,indexType:h,isInstanced:f,instanceCount:g,offset:u?p:0}));return y(),hs.priority>=2&&this._logDrawCallEnd(l,s,n),v}transform(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:r}=t;n&&this._setFeedbackBuffers(n),e&&(r=Object.assign({},r,{35977:e})),i.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:r}))}finally{i.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return hs.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:i,inject:r,defines:o,varyings:a,bufferMode:s,transpileToGLSL100:l}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:i,inject:r,defines:o,varyings:a,bufferMode:s,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}_l(t instanceof tu,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new $f(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof Nl&&e.delete()}}_setAnimationProps(t){this.animated&&_l(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(El(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new Bf(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),hs.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:hs.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(void 0===t)return;const r=function(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=ng(e,e.elements,null,n));const r=e.values;for(const o in r){const t=e._getAttributeInfo(o);if(t){let a="".concat(o,": ").concat(t.name);const s=e.accessors[t.location];s&&(a="".concat(o,": ").concat(ig(t.name,s))),i[a]=ng(e,r[o],s,n)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:s}=rg({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:c}=rg({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&hs.log("MISSING UNIFORMS",Object.keys(l))(),s>0&&hs.log("UNUSED UNIFORMS",Object.keys(a))();const u=function(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const t=ag(i);e["in ".concat(t)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const t=ag(i);e["out ".concat(t)]={[n]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);hs.table(t,r)(),hs.table(t,o)(),hs.table(t+1,u)(),i&&i.log({logLevel:2,message:"Rendered to ".concat(i.id)}),hs.groupEnd(2,">>> DRAWING MODEL ".concat(this.id))()}}class dg{static isSupported(t){return gs(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();_l(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new pg(e,Object.assign({},t,{fs:t.fs||Df({version:Nf(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=i.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){if(!El(t.feedbackBuffers)||!El(t.feedbackMap)||t.varyings&&t.varyings.length>0)return!0;return!1})(e)&&(this.bufferTransform=new jf(t,e)),function(t){if(!El(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)return!0;return!1}(e)&&(this.textureTransform=new Hf(t,e)),_l(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=Object.assign(e,i.getDrawOptions(e));return e}}const fg="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";const gg={interpolation:class{constructor(t){let{gl:e,attribute:n,timeline:i}=t;this.gl=e,this.type="interpolation",this.transition=new Op(i),this.attribute=n,this.attributeInTransition=new If(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=function(t,e){const n=kf(e.size);return new dg(t,{vs:fg,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(e,n);const r={byteLength:0,usage:35050};this.buffers=[new Nl(e,r),new Nl(e,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();const{gl:n,buffers:i,attribute:r}=this;Af(i);const o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const a of i)Mf({buffer:a,...o});this.currentStartIndices=r.startIndices,this.currentLength=Cf(r,e),this.attributeInTransition.update({buffer:i[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:i[0],aTo:Tf(0,r)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{time:t,settings:{duration:e,easing:n}}=this.transition,i=n(t/e);this.transform.run({uniforms:{time:i}})}return t}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor(t){let{gl:e,attribute:n,timeline:i}=t;this.gl=e,this.type="spring",this.transition=new Op(i),this.attribute=n,this.attributeInTransition=new If(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=function(t){return new Xl(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(t,e){return new _c(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(t,e,n){const i=kf(e.size);return new dg(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new Nl(e,r),new Nl(e,r),new Nl(e,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:r}=this,o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const a of i)Mf({buffer:a,...o});this.currentStartIndices=r.startIndices,this.currentLength=Cf(r,e),this.attributeInTransition.update({buffer:i[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:Tf(0,r)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:i.settings.stiffness,damping:i.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Af(t),this.attributeInTransition.update({buffer:t[1],value:this.attribute.value});return cc(n)[0]>0||i.end(),!0}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class mg{constructor(t,e){let{id:n,timeline:i}=e;this.id=n,this.gl=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=dg.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update(t){let{attributes:e,transitions:n,numInstances:i}=t;this.numInstances=i||1;for(const r in e){const t=e[r],i=t.getTransitionSetting(n);i&&this._updateAttribute(r,t,i)}for(const r in this.transitions){const t=e[r];t&&t.getTransitionSetting(n)||this._removeTransition(r)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions){this.transitions[e].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let r=!i||i.type!==n.type;if(r){if(!this.isSupported)return void eo.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();i&&this._removeTransition(t);const o=gg[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(eo.error("unsupported transition type '".concat(n.type,"'"))(),r=!1)}(r||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const yg="attributeManager.invalidate";class vg{constructor(t){let{id:e="attribute-manager",stats:n,timeline:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new mg(t,{id:"".concat(e,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){return this.needsRedraw=!0,this}add(t,e){this._add(t,e)}addInstanced(t,e){this._add(t,e,{instanced:1})}remove(t){for(let e=0;e<t.length;e++){const n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}invalidate(t,e){const n=this._invalidateTrigger(t,e);Gu(yg,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);Gu(yg,this,"all")}update(){let{data:t,numInstances:e,startIndices:n=null,transitions:i,props:r={},buffers:o={},context:a={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=!1;Gu("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const l in this.attributes){const i=this.attributes[l],c=i.settings.accessor;i.startIndices=n,i.numInstances=e,r[l]&&eo.removed("props.".concat(l),"data.attributes.".concat(l))(),i.setExternalBuffer(o[l])||i.setBinaryValue(o[c],t.startIndices)||!o[c]&&i.setConstantValue(r[c])||i.needsUpdate()&&(s=!0,this._updateAttribute({attribute:i,numInstances:e,data:t,props:r,context:a})),this.needsRedraw|=i.needsRedraw()}s&&Gu("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:i})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1};const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in e){const o=e[r];o.needsRedraw(t)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getShaderAttributes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}getAccessors(){return this.updateTriggers}_add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&eo.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const i in t){const e=t[i];this.attributes[i]=this._createAttribute(i,e,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,isIndexed:e.isIndexed||e.elements||!1,constant:e.constant||!1,size:(e.elements?1:e.size)||1,value:e.value||null,divisor:e.instanced||n.instanced?1:e.divisor||0};return new If(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}))}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,r=i[t];return r&&r.forEach((t=>{const i=n[t];i&&i.setNeedsUpdate(i.id,e)})),r}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if(Gu("attribute.updateStart",e),e.constant)return void e.setConstantValue(e.value);e.allocate(n)&&Gu("attribute.allocate",e,n);e.updateBuffer(t)&&(this.needsRedraw=!0,Gu("attribute.updateEnd",e,n))}}const _g=1e-5;function bg(t,e,n,i,r){const o=e-t;return(n-e)*r+-o*i+o+e}function xg(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}const wg={interpolation:class extends Op{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:r}}=this,o=r(t/i);this._value=Mo(e,n,o)}},spring:class extends Op{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:o=t}=this;let a=function(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let a=0;a<n.length;a++)o[a]=bg(t[a],e[a],n[a],i,r);return o}return bg(t,e,n,i,r)}(r,o,e,n,i);const s=xg(a,e),l=xg(a,o);s<_g&&l<_g&&(a=e,this.end()),this._prevValue=o,this._currValue=a}}};class Sg{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:r}=this;if(r.has(t)){const n=r.get(t),{value:i=n.settings.fromValue}=n;e=i,this.remove(t)}if(!(i=Ef(i)))return;const o=wg[i.type];if(!o)return void eo.error("unsupported transition type '".concat(i.type,"'"))();const a=new o(this.timeline);a.start({...i,fromValue:e,toValue:n}),r.set(t,a)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function Pg(t,e){const n=Tg({newProps:t,oldProps:e,propTypes:Mg(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=null;const{dataComparator:i,_dataDiff:r}=t;i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied");n&&r&&(n=r(t.data,e.data)||n);return n}(t,e);let r=!1;return i||(r=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers){if(Cg(t,e,"all"))return{all:!0}}const n={};let i=!1;for(const r in t.updateTriggers)if("all"!==r){Cg(t,e,r)&&(n[r]=!0,i=n)}return i}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:Ag(t,e),transitionsChanged:Eg(t,e)}}function Eg(t,e){if(!t.transitions)return null;const n={},i=Mg(t);for(const r in t.transitions){const o=i[r],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&kg(t[r],e[r],o)&&(n[r]=!0)}return n}function Tg(t){let{newProps:e,oldProps:n,ignoreProps:i={},propTypes:r={},triggerName:o="props"}=t;if(n===e)return null;if("object"!==typeof e||null===e)return"".concat(o," changed shallowly");if("object"!==typeof n||null===n)return"".concat(o," changed shallowly");for(const a of Object.keys(e))if(!(a in i)){if(!(a in n))return"".concat(o,".").concat(a," added");const t=kg(e[a],n[a],r[a]);if(t)return"".concat(o,".").concat(a," ").concat(t)}for(const a of Object.keys(n))if(!(a in i)){if(!(a in e))return"".concat(o,".").concat(a," dropped");if(!Object.hasOwnProperty.call(e,a)){const t=kg(e[a],n[a],r[a]);if(t)return"".concat(o,".").concat(a," ").concat(t)}}return null}function kg(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)?"changed deeply":i||(i=t&&e&&t.equals,!i||i.call(t,e))?i||e===t?null:"changed shallowly":"changed deeply"}function Ag(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function Cg(t,e,n){let i=t.updateTriggers[n];i=void 0===i||null===i?{}:i;let r=e.updateTriggers[n];r=void 0===r||null===r?{}:r;return Tg({oldProps:r,newProps:i,triggerName:n})}function Mg(t){const e=t[ju],n=e&&e.constructor;return n?n._propTypes:{}}function Ig(t){if(null===(e=t)||"object"!==typeof e)throw new Error("count(): argument not an object");var e;if("function"===typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}function Lg(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const t in e.inject)i[t]=(i[t]||"")+e.inject[t];n.inject=i}else n.inject=e.inject;return n}const Og={10241:9987,10240:9729,10242:33071,10243:33071},zg={};const Rg={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||jg(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>Dg(t,e)},accessor:{validate(t,e){const n=Ng(t);return"function"===n||n===Ng(e.value)},equal:(t,e,n)=>"function"===typeof e||Dg(t,e)},array:{validate:(t,e)=>e.optional&&!t||jg(t),equal:(t,e,n)=>n.compare?Dg(t,e):t===e},object:{equal:(t,e,n)=>n.compare?Pp(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"===typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>function(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof Xl)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new Xl(n,{...e,parameters:{...Og,...i,...t.props.textureParameters}});return zg[r.id]=!0,r}(n,t),release:t=>{var e;(e=t)&&e instanceof Xl&&zg[e.id]&&(e.delete(),delete zg[e.id])}}};function Dg(t,e){if(t===e)return!0;if(!jg(t)||!jg(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Fg(t,e){switch(Ng(e)){case"object":return Bg(t,e);case"array":return Bg(t,{type:"array",value:e,compare:!1});case"boolean":return Bg(t,{type:"boolean",value:e});case"number":return Bg(t,{type:"number",value:e});case"function":return Bg(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Bg(t,e){return"type"in e?{name:t,...Rg[e.type],...e}:"value"in e?{name:t,type:Ng(e.value),...e}:{name:t,type:"object",value:e}}function jg(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Ng(t){return jg(t)?"array":null===t?"null":typeof t}function Vg(t){const e=Gg(t,"_mergedDefaultProps");return e||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),n=Vg(e),i=function(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const t=null===o||void 0===o?void 0:o.deprecatedFor;if(t)i[r]=Array.isArray(t)?t:[t];else{const t=Fg(r,o);e[r]=t,n[r]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}(Gg(t,"defaultProps")||{}),r=function(t,e,n){const i=Object.create(null);Object.assign(i,e,t);const r=function(t){const e=Gg(t,"layerName")||Gg(t,"componentName");e||eo.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(n);return delete t.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(i.defaultProps,n,t),o={...e._propTypes,...i.propTypes};!function(t,e){const n={},i={};for(const r in e){const t=e[r],{name:o,value:a}=t;t.async&&(n[o]=a,i[o]=Ug(o))}t[Nu]=n,t[Vu]={},Object.defineProperties(t,i)}(r,o);const a={...e._deprecatedProps,...i.deprecatedProps};(function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const i="".concat(this.id,": ").concat(n);for(const r of e[n])Wg(this,r)||(this[r]=t);eo.deprecated(i,e[n].join("/"))()}})})(r,a),t._mergedDefaultProps=r,t._propTypes=o,t._deprecatedProps=a}(t),t._mergedDefaultProps)}function Ug(t){return{enumerable:!0,set(e){"string"===typeof e||e instanceof Promise||_f(e)?this[Vu][t]=e:this[Uu][t]=e},get(){if(this[Uu]){if(t in this[Uu]){return this[Uu][t]||this[Nu][t]}if(t in this[Vu]){const e=this[ju]&&this[ju].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Nu][t]}}return this[Nu][t]}}}function Wg(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gg(t,e){return Wg(t,e)&&t[e]}const qg=Object.freeze({});class Zg{constructor(t){l(this,"component",void 0),l(this,"onAsyncPropUpdated",void 0),l(this,"asyncProps",void 0),l(this,"oldProps",void 0),l(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||qg}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[Uu]||{},n=t[Vu]||t,i=t[Nu]||{};for(const r in e){const t=e[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,t),e[r]=this.getAsyncProp(r)}for(const r in n){const t=n[r];this._createAsyncPropData(r,i[r]),this._updateAsyncProp(r,t)}}_fetch(t,e){return e}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"===typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):_f(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then((e=>{e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,i),this._onResolve(t,e)})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const a of e){const{dataTransform:e}=this.component.props;r=e?e(a,r):r.concat(a),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}let Hg=0;class Xg{constructor(){l(this,"id",void 0),l(this,"props",void 0),l(this,"count",void 0),l(this,"lifecycle",void 0),l(this,"parent",void 0),l(this,"context",void 0),l(this,"state",void 0),l(this,"internalState",void 0);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.props=function(t,e){const n=Vg(t.constructor),i=Object.create(n);i[ju]=t,i[Vu]={},i[Uu]={};for(let r=0;r<e.length;++r){const t=e[r];for(const e in t)i[e]=t[e]}return Object.freeze(i),i}(this,e),this.id=this.props.id,this.count=Hg++,this.lifecycle=Ou,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}clone(t){const{props:e}=this,n={};for(const i in e[Nu])i in e[Uu]?n[i]=e[Uu][i]:i in e[Vu]&&(n[i]=e[Vu][i]);return new this.constructor({...e,...n,...t})}_initState(){this.internalState=new Zg(this)}}l(Xg,"componentName","Component"),l(Xg,"defaultProps",{});class Yg extends Zg{constructor(t){let{attributeManager:e,layer:n}=t;super(n),l(this,"attributeManager",void 0),l(this,"needsRedraw",void 0),l(this,"subLayers",void 0),l(this,"usesPickingColorCache",void 0),this.attributeManager=e,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}_fetch(t,e){const n=this.component.props.fetch;return n?n(e,{propName:t,layer:this.layer}):super._fetch(t,e)}_onResolve(t,e){const n=this.component.props.onDataLoad;"data"===t&&n&&n(e,{propName:t,layer:this.layer})}_onError(t,e){this.layer.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const Kg=2**24-1,Jg=Object.freeze([]),Qg=fo((t=>{let{oldViewport:e,viewport:n}=t;return e.equals(n)}));let $g=new Uint8ClampedArray(0);const tm={data:{type:"data",value:Jg,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,e)=>{let{propName:n,layer:i,loaders:r,loadOptions:o,signal:a}=e;const{resourceManager:s}=i.context;var l;(o=o||i.getLoadOptions(),r=r||i.props.loaders,a)&&(o={...o,fetch:{...null===(l=o)||void 0===l?void 0:l.fetch,signal:a}});let c=s.contains(t);return c||o||(s.add({resourceId:t,data:mp(t,r),persistent:!1}),c=!0),c?s.subscribe({resourceId:t,onChange:t=>i.internalState.reloadAsyncProp(n,t),consumerId:i.id,requestId:n}):mp(t,r,o)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:ao,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:no.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:t=>{let{layerIndex:e}=t;return[0,100*-e]},compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class em extends Xg{toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}raiseError(t,e){var n,i,r,o;(e&&(t.message="".concat(e,": ").concat(t.message)),null!==(n=(i=this.props).onError)&&void 0!==n&&n.call(i,t))||(null===(r=this.context)||void 0===r||null===(o=r.onError)||void 0===o||o.call(r,t,this))}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:e}=this.context,n=ya(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=Y(n,e.pixelProjectionMatrix);return 2===t.length?[i,r]:[i,r,o]}unproject(t){const{viewport:e}=this.context;return e.unproject(t)}projectPosition(t,e){return va(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===no.DEFAULT||t===no.LNGLAT||t===no.CARTESIAN}onHover(t,e){return!!this.props.onHover&&this.props.onHover(t,e)}onClick(t,e){return!!this.props.onClick&&this.props.onClick(t,e)}nullPickingColor(){return[0,0,0]}encodePickingColor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){Cp(t instanceof Uint8Array);const[e,n,i]=t;return e+256*n+65536*i-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const e of this.props.extensions)t=Lg(t,e.getShaders.call(this,e));return t}getBounds(){var t;const e=this.getAttributeManager();if(!e)return null;const{positions:n,instancePositions:i}=e.attributes;return null===(t=n||i)||void 0===t?void 0:t.getBounds()}shouldUpdateState(t){let{oldProps:e,props:n,context:i,changeFlags:r}=t;return r.propsOrDataChanged}updateState(t){let{oldProps:e,props:n,context:i,changeFlags:r}=t;const o=this.getAttributeManager();if(r.dataChanged&&o){const{dataChanged:t}=r;if(Array.isArray(t))for(const e of t)o.invalidateAll(e);else o.invalidateAll()}const a=Number.isInteger(e.highlightedObjectIndex)||e.pickable,s=Number.isInteger(n.highlightedObjectIndex)||n.pickable;if(a!==s&&o){const{pickingColors:t,instancePickingColors:e}=o.attributes,n=t||e;n&&(s&&n.constant&&(n.constant=!1,o.invalidate(n.id)),n.value||s||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(){for(const e of this.getModels())e.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo(t){let{info:e,mode:n}=t;const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}activateViewport(t){const e=this.internalState.viewport;this.internalState.viewport=t,e&&Qg({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(t){const e=this.getAttributeManager();if(!e)return;const n=this.getNumInstances(t),i=this.getStartIndices(t);e.update({data:t.data,numInstances:n,startIndices:i,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const r=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,e){let{numInstances:n}=e;if(t.constant)return;const i=Math.floor($g.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>Kg&&eo.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),$g=So.allocate($g,n,{size:3,copy:!0,maxCount:Math.max(n,Kg)});const t=Math.floor($g.length/3),e=[];for(let n=i;n<t;n++)this.encodePickingColor(n,e),$g[3*n+0]=e[0],$g[3*n+1]=e[1],$g[3*n+2]=e[2]}t.value=$g.subarray(0,3*n)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},r=n.getShaderAttributes(e,i);t.setAttributes(r)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n,r=i.getVertexOffset(t),o=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(o-r),offset:r})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;this.internalState.usesPickingColorCache&&n.value.buffer!==$g.buffer&&(n.value=$g.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:Ig(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){Gu("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();Gu("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,e=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||e,this.props=n;try{const n=this._getUpdateParams(),r=this.getModels();if(this.context.gl)this.updateState(n);else try{this.updateState(n)}catch(i){}for(const t of this.props.extensions)t.updateState.call(this,n,t);const o=this.getModels()[0]!==r[0];this._updateModules(n,o),this.isComposite?this._renderLayers(n):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=e,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){Gu("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer(t){let{moduleParameters:e=null,uniforms:n={},parameters:i={}}=t;this._updateAttributeTransition();const r=this.props;this.props=this.internalState.propsInTransition||r;const{opacity:o}=this.props;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:t}=this.props,o=t&&t(n)||[0,0];Ks(this.context.gl,{polygonOffset:o}),Js(this.context.gl,i,(()=>{const t={moduleParameters:e,uniforms:n,parameters:i,context:this.context};for(const e of this.props.extensions)e.draw.call(this,t,e);this.draw(t)}))}finally{this.props=r}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:e}=this.internalState;for(const i in t)if(t[i]){let n=!1;"dataChanged"===i&&Array.isArray(e[i])&&(e[i]=Array.isArray(t[i])?e[i].concat(t[i]):t[i],n=!0),e[i]||(e[i]=t[i],n=!0),n&&Gu("layer.changeFlag",this,i,t)}const n=e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged;e.propsOrDataChanged=n,e.somethingChanged=n||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,e){const n=Pg(t,e);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,e[i],t[i],t.transitions[i]);return this.setChangeFlags(n)}validateProps(){!function(t){const e=Mg(t);for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"===typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_updateModules(t,e){let{props:n,oldProps:i}=t;const{autoHighlight:r,highlightedObjectIndex:o,highlightColor:a}=n;if(e||i.autoHighlight!==r||i.highlightedObjectIndex!==o||i.highlightColor!==a){const t={};r||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),Number.isInteger(o)&&(t.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),i=n&&n.getNeedsRedraw(t);return e=e||i,e}_getAttributeManager(){return new vg(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){Cp(!this.internalState&&!this.state),Cp(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Yg({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(eo.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new Sg(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){Gu("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}function nm(e){return e?"function"===typeof e?(0,t.createElement)(Mp,{},e):Array.isArray(e)?e.map(nm):e.type===t.Fragment?nm(e.props.children):(pf(e.type,Mp),e):e}em.layerName="Layer",em.defaultProps=tm;const im={position:"absolute",zIndex:-1};function rm(e,n){return e?"function"===typeof e?e(n):Array.isArray(e)?e.map((t=>rm(t,n))):function(t){const e=t&&t.type,n=e&&e.defaultProps;return n&&n.mapStyle}(e)?(n.style=im,(0,t.cloneElement)(e,n)):function(t){const e=t&&t.type;return e&&e.deckGLViewProps}(e)?(0,t.cloneElement)(e,n):e:e}const om={mixBlendMode:null};function am(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const sm=(0,t.forwardRef)(((e,n)=>{const i=(0,t.useRef)({}).current,[r,o]=(0,t.useState)(0);i.forceUpdate=o;const a=(0,t.useRef)(null),s=(0,t.useRef)(null),l=(0,t.useMemo)((()=>function(e){let{children:n,layers:i,views:r}=e;const o=[],a=[],s={};return t.Children.forEach(nm(n),(t=>{if(t){const e=t.type;if(pf(e,em)){const n=function(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}(e,t.props);a.push(n)}else o.push(t);if(e!==Mp&&pf(e,Mp)&&t.props.id){const n=new e(t.props);s[n.id]=n}}})),Object.keys(s).length>0&&(Array.isArray(r)?r.forEach((t=>{s[t.id]=t})):r&&(s[r.id]=r),r=Object.values(s)),i=a.length>0?[...a,...i]:i,{layers:i,children:o,views:r}}(e)),[e.layers,e.views,e.children]);let c=!0;const u=t=>c&&e.viewState?(i.viewStateUpdateRequested=t,null):(i.viewStateUpdateRequested=null,e.onViewStateChange(t)),h=t=>{c?i.interactionStateUpdateRequested=t:(i.interactionStateUpdateRequested=null,e.onInteractionStateChange(t))},p=(0,t.useMemo)((()=>{const t={...e,style:null,width:"100%",height:"100%",layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:h};return i.deck&&i.deck.setProps(t),t}),[e]);(0,t.useEffect)((()=>(i.deck=function(t,e){const n=new(e.Deck||uf)({...e,style:null,width:"100%",height:"100%",_customRender:e=>{t.redrawReason=e;const i=n.viewManager.getViewports();t.lastRenderedViewports!==i?t.forceUpdate((t=>t+1)):am(t)}});return n}(i,{...p,parent:a.current,canvas:s.current}),()=>i.deck.finalize())),[]),hf((()=>{am(i);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=i;t&&u(t),e&&h(e)})),(0,t.useImperativeHandle)(n,(()=>function(t){const e={pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)};return Object.defineProperty(e,"deck",{get:()=>t.deck}),e}(i)),[]);const{viewManager:d}=i.deck||{},f=d&&d.getViewports(),{ContextProvider:g,width:m,height:y,id:v,style:_}=e,{containerStyle:b,canvasStyle:x}=(0,t.useMemo)((()=>function(t){let{width:e,height:n,style:i}=t;const r={position:"absolute",zIndex:0,left:0,top:0,width:e,height:n},o={left:0,top:0};if(i)for(const a in i)a in om?o[a]=i[a]:r[a]=i[a];return{containerStyle:r,canvasStyle:o}}({width:m,height:y,style:_})),[m,y,_]);if(!i.viewStateUpdateRequested&&i.lastRenderedViewports===f||i.version!==r){i.lastRenderedViewports=f,i.version=r;const e=function(e){let{children:n,deck:i,ContextProvider:r}=e;const{viewManager:o}=i||{};if(!o||!o.views.length)return[];const a={},s=o.views[0].id;for(const t of n){let e=s,n=t;pf(t.type,Mp)&&(e=t.props.id||s,n=t.props.children);const i=o.getViewport(e),r=o.getViewState(e);if(i){const{x:t,y:o,width:s,height:l}=i;n=rm(n,{x:t,y:o,width:s,height:l,viewport:i,viewState:r}),a[e]||(a[e]={viewport:i,children:[]}),a[e].children.push(n)}}return Object.keys(a).map((e=>{const{viewport:n,children:o}=a[e],{x:s,y:l,width:c,height:u}=n,h={position:"absolute",left:s,top:l,width:c,height:u},p="view-".concat(e),d=(0,t.createElement)("div",{key:p,id:p,style:h},...o);if(r){const o={viewport:n,container:i.canvas.offsetParent,eventManager:i.eventManager,onViewStateChange:t=>{t.viewId=e,i._onViewStateChange(t)}};return(0,t.createElement)(r,{key:p,value:o},d)}return d}))}({children:l.children,deck:i.deck,ContextProvider:g}),n=(0,t.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:s,style:x});i.control=(0,t.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:a,style:b},[n,e])}return c=!1,i.control}));sm.propTypes=uf.getPropTypes(u()),sm.defaultProps=uf.defaultProps;const lm=sm;class cm extends em{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo(t){let{info:e}=t;const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?(e.object=n.__source.object,e.index=n.__source.index,e):e}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"===typeof t){const e={data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{opacity:e,pickable:n,visible:i,parameters:r,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:s,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:h,positionFormat:p,modelMatrix:d,extensions:f,fetch:g,operation:m,_subLayerProps:y}=this.props,v={opacity:e,pickable:n,visible:i,parameters:r,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:s,highlightColor:l,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:h,positionFormat:p,modelMatrix:d,extensions:f,fetch:g,operation:m},_=y&&y[t.id],b=_&&_.updateTriggers,x=t.id||"sublayer";if(_){const e=this.constructor._propTypes,n=t.type?t.type._propTypes:{};for(const t in _){const i=n[t]||e[t];i&&"accessor"===i.type&&(_[t]=this.getSubLayerAccessor(_[t]))}}Object.assign(v,t,_),v.id="".concat(this.props.id,"-").concat(x),v.updateTriggers={all:this.props.updateTriggers.all,...t.updateTriggers,...b};for(const w of f){const t=w.getSubLayerProps.call(this,w);t&&Object.assign(v,t,{updateTriggers:Object.assign(v.updateTriggers,t.updateTriggers)})}return v}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=qu(t,Boolean),this.internalState.subLayers=t),Gu("compositeLayer.renderLayers",this,e,t);for(const n of t)n.parent=this}}cm.layerName="CompositeLayer";const um={name:"project32",dependencies:[_u],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},hm="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",pm={lightSources:{}};function dm(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map((t=>t*e/255))}function fm(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return r["lighting_uAmbientLight.color"]=e?dm(e):[0,0,0],n.forEach(((t,e)=>{r["lighting_uPointLight[".concat(e,"].color")]=dm(t),r["lighting_uPointLight[".concat(e,"].position")]=t.position,r["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=n.length,i.forEach(((t,e)=>{r["lighting_uDirectionalLight[".concat(e,"].color")]=dm(t),r["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction})),r.lighting_uDirectionalLightCount=i.length,r}const gm={name:"lights",vs:hm,fs:hm,getUniforms:function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pm;if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:i}=e.lightSources||{};return t||n&&n.length>0||i&&i.length>0?Object.assign({},fm({ambientLight:t,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}},mm="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",ym={};function vm(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map((t=>t/255))}}function _m(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ym;if(!("material"in t))return{};const{material:e}=t;return e?vm(e):{lighting_uEnabled:!1}}const bm={name:"gouraud-lighting",dependencies:[gm],vs:mm,defines:{LIGHTING_VERTEX:1},getUniforms:_m},xm={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};const wm={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xm;const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}},Sm={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...wm},Pm={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Em{static get DRAW_MODE(){return Pm}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=Sl("geometry"),drawMode:n=Pm.TRIANGLES,attributes:i={},indices:r=null,vertexCount:o=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,r),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let e=t[n];e=ArrayBuffer.isView(e)?{value:e}:e,_l(ArrayBuffer.isView(e.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),"POSITION"!==n&&"positions"!==n||e.size||(e.size=3),"indices"===n?(_l(!this.indices),this.indices=e):this.attributes[n]=e}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const i in t){const e=t[i],{value:r,size:o,constant:a}=e;!a&&r&&o>=1&&(n=Math.min(n,r.length/o))}return _l(Number.isFinite(n)),n}}var Tm=n(89),km=n.n(Tm);const Am=1,Cm=-1;function Mm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Im(t,n);return i!==e&&(Om(t,n),!0)}function Im(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(Lm(t,e))}function Lm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{start:n=0,end:i=t.length}=e,r=e.size||2;let o=0;for(let a=n,s=i-r;a<i;a+=r)o+=(t[a]-t[s])*(t[a+1]+t[s+1]),s=a;return o/2}function Om(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,o=(i-n)/r,a=Math.floor(o/2);for(let s=0;s<a;++s){const e=n+s*r,i=n+(o-1-s)*r;for(let n=0;n<r;++n){const r=t[e+n];t[e+n]=t[i+n],t[i+n]=r}}}function zm(t,e,n,i){let r,o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)r=(i[3]-t[1])/(e[1]-t[1]),o=3;else if(4&n)r=(i[1]-t[1])/(e[1]-t[1]),o=1;else if(2&n)r=(i[2]-t[0])/(e[0]-t[0]),o=2;else{if(!(1&n))return null;r=(i[0]-t[0])/(e[0]-t[0]),o=0}for(let s=0;s<t.length;s++)a[s]=(1&o)===s?i[o]:r*(e[s]-t[s])+t[s];return a}function Rm(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Dm(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(t[i-n+o]!==e[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function Fm(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function Bm(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const o=i+e*n;for(let a=0;a<n;a++)r[a]=t[o+a];return r}function jm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:a=0,endIndex:s=t.length}=e,l=(s-a)/n;let c=[];const u=[c],h=Bm(t,0,n,a);let p,d;const f=Wm(h,r,o,[]),g=[];Dm(c,h);for(let m=1;m<l;m++){for(p=Bm(t,m,n,a,p),d=Rm(p,f);d;){zm(h,p,d,f,g);const t=Rm(g,f);t&&(zm(h,g,t,f,g),d=t),Dm(c,g),Fm(h,g),Gm(f,r,d),i&&c.length>n&&(c=[],u.push(c),Dm(c,h)),d=Rm(p,f)}Dm(c,p),Fm(h,p)}return i?u:u[0]}function Nm(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function Vm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:a=!1}=n,s=[],l=[{pos:t,types:a&&new Array(t.length/i).fill(1),holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:t,types:e,holes:n}=l.shift();qm(t,i,n[0]||t.length,c),u=Wm(c[0],r,o,u);const h=Rm(c[1],u);if(h){let r=Um(t,e,i,0,n[0]||t.length,u,h);const o={pos:r[0].pos,types:r[0].types,holes:[]},s={pos:r[1].pos,types:r[1].types,holes:[]};l.push(o,s);for(let l=0;l<n.length;l++)r=Um(t,e,i,n[l],n[l+1]||t.length,u,h),r[0]&&(o.holes.push(o.pos.length),o.pos=Nm(o.pos,r[0].pos),a&&(o.types=Nm(o.types,r[0].types))),r[1]&&(s.holes.push(s.pos.length),s.pos=Nm(s.pos,r[1].pos),a&&(s.types=Nm(s.types,r[1].types)))}else{const i={positions:t};a&&(i.edgeTypes=e),n.length&&(i.holeIndices=n),s.push(i)}}return s}function Um(t,e,n,i,r,o,a){const s=(r-i)/n,l=[],c=[],u=[],h=[],p=[];let d,f,g;const m=Bm(t,s-1,n,i);let y=Math.sign(8&a?m[1]-o[3]:m[0]-o[2]),v=e&&e[s-1],_=0,b=0;for(let x=0;x<s;x++)d=Bm(t,x,n,i,d),f=Math.sign(8&a?d[1]-o[3]:d[0]-o[2]),g=e&&e[i/n+x],f&&y&&y!==f&&(zm(m,d,a,o,p),Dm(l,p)&&u.push(v),Dm(c,p)&&h.push(v)),f<=0?(Dm(l,d)&&u.push(g),_-=f):u.length&&(u[u.length-1]=0),f>=0?(Dm(c,d)&&h.push(g),b+=f):h.length&&(h[h.length-1]=0),Fm(m,d),y=f,v=g;return[_?{pos:l,types:e&&u}:null,b?{pos:c,types:e&&h}:null]}function Wm(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=o,i[2]=r+e,i[3]=o+e,i}function Gm(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function qm(t,e,n,i){let r=1/0,o=-1/0,a=1/0,s=-1/0;for(let l=0;l<n;l+=e){const e=t[l],n=t[l+1];r=e<r?e:r,o=e>o?e:o,a=n<a?n:a,s=n>s?n:s}return i[0][0]=r,i[0][1]=a,i[1][0]=o,i[1][1]=s,i}const Zm=85.051129;function Hm(t,e,n,i){let r=-1,o=-1;for(let a=n+1;a<i;a+=e){const e=Math.abs(t[a]);e>r&&(r=e,o=a-1)}return o}function Xm(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Zm;const o=t[n],a=t[i-e];if(Math.abs(o-a)>180){const i=Bm(t,0,e,n);i[0]+=360*Math.round((a-o)/360),Dm(t,i),i[1]=Math.sign(i[1])*r,Dm(t,i),i[0]=o,Dm(t,i)}}function Ym(t,e,n,i){let r,o=t[0];for(let a=n;a<i;a+=e){r=t[a];const e=r-o;(e>180||e<-180)&&(r-=360*Math.round(e/360)),t[a]=o=r}}function Km(t,e){let n;const i=t.length/e;for(let o=0;o<i&&(n=t[o*e],(n+180)%360===0);o++);const r=360*-Math.round(n/360);if(0!==r)for(let o=0;o<i;o++)t[o*e]+=r}const Jm=Am,Qm=Cm,$m={isClosed:!0};function ty(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function ey(t,e,n,i,r){let o=e;const a=n.length;for(let s=0;s<a;s++)for(let e=0;e<i;e++)t[o++]=n[s][e]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let s=0;s<i;s++)t[o++]=n[0][s]||0;return $m.start=e,$m.end=o,$m.size=i,Mm(t,r,$m),o}function ny(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0;o=o||n.length;const s=o-r;if(s<=0)return e;let l=e;for(let c=0;c<s;c++)t[l++]=n[r+c];if(!ty(n,i,r,o))for(let c=0;c<i;c++)t[l++]=n[r+c];return $m.start=e,$m.end=l,$m.size=i,Mm(t,a,$m),l}function iy(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],i=[];if(t.positions){const{positions:r,holeIndices:o}=t;if(o){let t=0;for(let a=0;a<=o.length;a++)t=ny(n,t,r,e,o[a-1],o[a],0===a?Jm:Qm),i.push(t);return i.pop(),{positions:n,holeIndices:i}}t=r}if(Number.isFinite(t[0]))return ny(n,0,t,e,0,n.length,Jm),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let r=0;for(const[o,a]of t.entries())r=ey(n,r,a,e,0===o?Jm:Qm),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return ey(n,0,t,e,Jm),n}class ry{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{attributes:e={}}=t;this.typedArrayManager=So,this.indexStarts=null,this.vertexStarts=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t),Object.seal(this)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:i,geometryBuffer:r,positionFormat:o,dataChanged:a,normalize:s=!0}=this.opts;if(this.data=e,this.getGeometry=i,this.positionSize=r&&r.size||("XY"===o?2:3),this.buffers=n,this.normalize=s,r&&(Cp(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),s||(n.positions=r)),this.geometryBuffer=n.positions,Array.isArray(a))for(const l of a)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry(t){let{startRow:e,endRow:n}=t;this._rebuildGeometry({startRow:e,endRow:n})}normalizeGeometry(t){return t}updateGeometryAttributes(t,e,n){throw new Error("Not implemented")}getGeometrySize(t){throw new Error("Not implemented")}getGeometryFromBuffer(t){const e=t.value||t;return Cp(ArrayBuffer.isView(e)),bf(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices})}_allocate(t,e){const{attributes:n,buffers:i,_attributeDefs:r,typedArrayManager:o}=this;for(const a in r)if(a in i)o.release(n[a]),n[a]=null;else{const i=r[a];i.copy=e,n[a]=o.allocate(n[a],t,i)}}_forEachGeometry(t,e,n){const{data:i,getGeometry:r}=this,{iterable:o,objectInfo:a}=vf(i,e,n);for(const s of o){a.index++;t(r(s,a),a.index)}}_rebuildGeometry(t){if(!this.data||!this.getGeometry)return;let{indexStarts:e,vertexStarts:n,instanceCount:i}=this;const{data:r,geometryBuffer:o}=this,{startRow:a=0,endRow:s=1/0}=t||{},l={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{t=this.normalizeGeometry(t),l[e]=t,n[e+1]=n[e]+this.getGeometrySize(t)}),a,s),i=n[n.length-1];else if(o.buffer instanceof Nl){const t=o.stride||4*this.positionSize;n=r.startIndices,i=n[r.length]||o.buffer.byteLength/t}else{const t=o.value||o,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;n=r.startIndices,i=n[r.length]||t.length/e}this._allocate(i,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=i;const c={};this._forEachGeometry(((t,r)=>{t=l[r]||t,c.vertexStart=n[r],c.indexStart=e[r];const o=r<n.length-1?n[r+1]:i;c.geometrySize=o-n[r],c.geometryIndex=r,this.updateGeometryAttributes(t,c)}),a,s),this.vertexCount=e[e.length-1]}}class oy extends ry{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;e&&(this.vertexCount=(e.value||e).length)}normalizeGeometry(t){if(this.normalize){if(t=iy(t,this.positionSize),this.opts.resolution)return Vm(t.positions||t,t.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n;e=e||[];const a=[],s=[];let l=0,c=0;for(let h=0;h<=e.length;h++){const r=e[h]||t.length,o=c,u=Hm(t,i,l,r);for(let e=u;e<r;e++)a[c++]=t[e];for(let e=l;e<u;e++)a[c++]=t[e];Ym(a,i,o,c),Xm(a,i,o,c,n.maxLatitude),l=r,s[h]=c}s.pop();const u=Vm(a,s,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const h of u)Km(h.positions,i);return u}(t.positions||t,t.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return t}getGeometrySize(t){if(Array.isArray(t)&&!Number.isFinite(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return(t.positions||t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):()=>null}updateGeometryAttributes(t,e){if(Array.isArray(t)&&!Number.isFinite(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,e){let{geometryIndex:n,vertexStart:i,indexStart:r}=e;const{attributes:o,indexStarts:a,typedArrayManager:s}=this;let l=o.indices;if(!l)return;let c=r;const u=function(t,e,n){let i=null;t.holeIndices&&(i=t.holeIndices.map((t=>t/e)));let r=t.positions||t;if(n){const t=r.length;r=r.slice();const i=[];for(let o=0;o<t;o+=e){i[0]=r[o],i[1]=r[o+1];const t=n(i);r[o]=t[0],r[o+1]=t[1]}}return km()(r,i,e)}(t,this.positionSize,this.opts.preproject);l=s.allocate(l,r+u.length,{copy:!0});for(let h=0;h<u.length;h++)l[c++]=u[h]+i;a[n+1]=r+u.length,o.indices=l}_updatePositions(t,e){let{vertexStart:n,geometrySize:i}=e;const{attributes:{positions:r},positionSize:o}=this;if(!r)return;const a=t.positions||t;for(let s=n,l=0;l<i;s++,l++){const t=a[l*o],e=a[l*o+1],n=o>2?a[l*o+2]:0;r[3*s]=t,r[3*s+1]=e,r[3*s+2]=n}}_updateVertexValid(t,e){let{vertexStart:n,geometrySize:i}=e;const{attributes:{vertexValid:r},positionSize:o}=this,a=t&&t.holeIndices;if(t&&t.edgeTypes?r.set(t.edgeTypes,n):r.fill(1,n,n+i),a)for(let s=0;s<a.length;s++)r[n+a[s]/o-1]=0;r[n+i-1]=0}}const ay="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",sy="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(ay,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),ly="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(ay,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),cy=[0,0,0,255],uy={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:cy},getLineColor:{type:"accessor",value:cy},material:!0},hy={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class py extends em{getShaders(t){return super.getShaders({vs:"top"===t?sy:ly,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[um,bm,Sm]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;e.isGeospatial&&n===no.DEFAULT&&(n=no.LNGLAT),this.setState({numInstances:0,polygonTesselator:new oy({preproject:n===no.LNGLAT&&e.projectFlat,fp64:this.use64bitPositions(),IndexType:!t||mc(t,fc)?Uint32Array:Uint16Array})});const i=this.getAttributeManager(),r=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:r},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:hy,accessor:"getPolygon",update:this.calculatePositions,noAlloc:r,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:r},elevations:{size:1,transition:hy,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:hy,accessor:"getFillColor",defaultValue:cy,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:hy,accessor:"getLineColor",defaultValue:cy,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,e)=>{let{index:n,target:i}=e;return this.encodePickingColor(t&&t.__source?t.__source.index:n,i)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw(t){let{uniforms:e}=t;const{extruded:n,filled:i,wireframe:r,elevationScale:o}=this.props,{topModel:a,sideModel:s,polygonTesselator:l}=this.state,c={...e,extruded:Boolean(n),elevationScale:o};s&&(s.setInstanceCount(l.instanceCount-1),s.setUniforms(c),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),i&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),a&&(a.setVertexCount(l.vertexCount),a.setUniforms(c).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager();var o;(i.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),r.invalidateAll())}updateGeometry(t){let{props:e,oldProps:n,changeFlags:i}=t;if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:t}=this.state,n=e.data.attributes||{};t.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:n.getPolygon,buffers:n,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:i}=this.props;let r,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,r=new pg(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new pg(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new Em({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,r].filter(Boolean),topModel:r,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}function dy(t,e,n,i){let r=t;if(Array.isArray(t[0])){const n=t.length*e;r=new Array(n);for(let i=0;i<t.length;i++)for(let n=0;n<e;n++)r[i*e+n]=t[i][n]||0}return n?jm(r,{size:e,gridResolution:n}):i?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:o=!0}=e,a=t.slice(i,r);Ym(a,n,0,r-i);const s=jm(a,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const l of s)Km(l,n);return s}(r,{size:e}):r}py.layerName="SolidPolygonLayer",py.defaultProps=uy;class fy extends ry{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):()=>null}normalizeGeometry(t){return this.normalize?dy(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}get(t){return this.attributes[t]}getGeometrySize(t){if(Array.isArray(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&Array.isArray(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const{segmentTypes:n}=this.attributes,i=this.isClosed(t),{vertexStart:r,geometrySize:o}=e;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n)return;const{vertexStart:i,geometrySize:r}=e,o=new Array(3);for(let a=i,s=0;s<r;a++,s++)this.getPointOnPath(t,s,o),n[3*a]=o[0],n[3*a+1]=o[1],n[3*a+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const{positionSize:i}=this;e*i>=t.length&&(e+=1-t.length/i);const r=e*i;return n[0]=t[r],n[1]=t[r+1],n[2]=3===i&&t[r+2]||0,n}isClosed(t){if(!this.normalize)return this.opts.loop;const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}const gy=[0,0,0,255],my={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:gy},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},yy={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class vy extends em{getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[um,Sm]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:yy,accessor:"getPath",update:this.calculatePositions,noAlloc:true,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:true},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:yy,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:yy,defaultValue:gy},instancePickingColors:{size:3,type:5121,accessor:(t,e)=>{let{index:n,target:i}=e;return this.encodePickingColor(t&&t.__source?t.__source.index:n,i)}}}),this.setState({pathTesselator:new fy({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&eo.removed("getDashArray","PathStyleExtension")()}updateState(t){let{oldProps:e,props:n,changeFlags:i}=t;super.updateState({props:n,oldProps:e,changeFlags:i});const r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,e=n.data.attributes||{};t.updateGeometry({data:n.data,geometryBuffer:e.getPath,buffers:e,normalize:!n._pathType,loop:"loop"===n._pathType,getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var o;const{gl:t}=this.context;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw(t){let{uniforms:e}=t;const{jointRounded:n,capRounded:i,billboard:r,miterLimit:o,widthUnits:a,widthScale:s,widthMinPixels:l,widthMaxPixels:c}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:ro[a],widthScale:s,miterLimit:o,widthMinPixels:l,widthMaxPixels:c}).draw()}_getModel(t){return new pg(t,{...this.getShaders(),id:this.props.id,geometry:new Em({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}vy.layerName="PathLayer",vy.defaultProps=my;const _y=[0,0,0,255],by={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:_y},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class xy extends cm{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&eo.removed("getLineDashArray","PathStyleExtension")()}updateState(t){let{oldProps:e,props:n,changeFlags:i}=t;const r=i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon);if(r&&Array.isArray(i.dataChanged)){const t=this.state.paths.slice(),e=i.dataChanged.map((e=>function(t){let{data:e,getIndex:n,dataRange:i,replace:r}=t;const{startRow:o=0,endRow:a=1/0}=i,s=e.length;let l=s,c=s;for(let d=0;d<s;d++){const t=n(e[d]);if(l>d&&t>=o&&(l=d),t>=a){c=d;break}}let u=l;const h=c-l!==r.length,p=h&&e.slice(c);for(let d=0;d<r.length;d++)e[u++]=r[d];if(h){for(let t=0;t<p.length;t++)e[u++]=p[t];e.length=u}return{startRow:l,endRow:l+r.length}}({data:t,getIndex:t=>t.__source.index,dataRange:e,replace:this._getPaths(e)})));this.setState({paths:t,pathsDiff:e})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{data:e,getPolygon:n,positionFormat:i,_normalize:r}=this.props,o=[],a="XY"===i?2:3,{startRow:s,endRow:l}=t,{iterable:c,objectInfo:u}=vf(e,s,l);for(const h of c){u.index++;let t=n(h,u);r&&(t=iy(t,a));const{holeIndices:e}=t,i=t.positions||t;if(e)for(let n=0;n<=e.length;n++){const t=i.slice(e[n-1]||0,e[n]||i.length);o.push(this.getSubLayerRow({path:t},h,u.index))}else o.push(this.getSubLayerRow({path:i},h,u.index))}return o}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:i,extruded:r,wireframe:o,_normalize:a,_windingOrder:s,elevationScale:l,transitions:c,positionFormat:u}=this.props,{lineWidthUnits:h,lineWidthScale:p,lineWidthMinPixels:d,lineWidthMaxPixels:f,lineJointRounded:g,lineMiterLimit:m,lineDashJustified:y}=this.props,{getFillColor:v,getLineColor:_,getLineWidth:b,getLineDashArray:x,getElevation:w,getPolygon:S,updateTriggers:P,material:E}=this.props,{paths:T,pathsDiff:k}=this.state,A=this.getSubLayerClass("fill",py),C=this.getSubLayerClass("stroke",vy),M=this.shouldRenderSubLayer("fill",T)&&new A({_dataDiff:e,extruded:r,elevationScale:l,filled:i,wireframe:o,_normalize:a,_windingOrder:s,getElevation:w,getFillColor:v,getLineColor:r&&o?_:_y,material:E,transitions:c},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:P.getPolygon,getElevation:P.getElevation,getFillColor:P.getFillColor,lineColors:r&&o,getLineColor:P.getLineColor}}),{data:t,positionFormat:u,getPolygon:S});return[!r&&M,!r&&n&&this.shouldRenderSubLayer("stroke",T)&&new C({_dataDiff:k&&(()=>k),widthUnits:h,widthScale:p,widthMinPixels:d,widthMaxPixels:f,jointRounded:g,miterLimit:m,dashJustified:y,_pathType:"loop",transitions:c&&{getWidth:c.getLineWidth,getColor:c.getLineColor,getPath:c.getPolygon},getColor:this.getSubLayerAccessor(_),getWidth:this.getSubLayerAccessor(b),getDashArray:this.getSubLayerAccessor(x)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:P.getLineWidth,getColor:P.getLineColor,getDashArray:P.getLineDashArray}}),{data:T,positionFormat:u,getPath:t=>t.path}),r&&M]}}xy.layerName="PolygonLayer",xy.defaultProps=by;const wy=[0,0,0,255],Sy={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:wy},getLineColor:{type:"accessor",value:wy},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Py extends em{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[um,Sm]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){let{props:e,oldProps:n,changeFlags:i}=t;if(super.updateState({props:e,oldProps:n,changeFlags:i}),i.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw(t){let{uniforms:e}=t;const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,stroked:a,filled:s,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:d}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:a?1:0,filled:s,billboard:l,antialiasing:c,radiusUnits:ro[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,lineWidthUnits:ro[u],lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:d}).draw()}_getModel(t){return new pg(t,{...this.getShaders(),id:this.props.id,geometry:new Em({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}Py.layerName="ScatterplotLayer",Py.defaultProps=Sy;const Ey=()=>{},Ty={10241:9987,10240:9729,10242:33071,10243:33071};function ky(t,e,n,i){return n===e.width&&i===e.height?e:(t.canvas.height=i,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,i),t.canvas)}function Ay(t){return t&&(t.id||t.url)}function Cy(t,e,n,i){const r=e.width,o=e.height,a=sc(e,{width:n,height:i});return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:o=0,targetInternalFormat:a=6408}=n;let{targetX:s,targetY:l,targetZ:c,width:u,height:h}=n;const{framebuffer:p,deleteFramebuffer:d}=hc(t);_l(p);const{gl:f,handle:g}=p,m="undefined"!==typeof s||"undefined"!==typeof l||"undefined"!==typeof c;s=s||0,l=l||0,c=c||0;const y=f.bindFramebuffer(36160,g);_l(e);let v=null;if(e instanceof Zl&&(v=e,u=Number.isFinite(u)?u:v.width,h=Number.isFinite(h)?h:v.height,v.bind(0),e=v.target),m)switch(e){case 3553:case 34067:f.copyTexSubImage2D(e,o,s,l,i,r,u,h);break;case 35866:case 32879:ys(f).copyTexSubImage3D(e,o,s,l,c,i,r,u,h)}else f.copyTexImage2D(e,o,a,i,r,u,h,0);v&&v.unbind(),f.bindFramebuffer(36160,y||null),d&&p.delete()}(e,a,{targetY:0,width:r,height:o}),e.delete(),a}function My(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:o}=e[i];t[Ay(r)]={...r,x:o,y:n}}}class Iy{constructor(t,e){let{onUpdate:n=Ey,onError:i=Ey}=e;this.gl=t,this.onUpdate=n,this.onError=i,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?Ay(t):t;return this._mapping[e]||{}}setProps(t){let{loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,data:o,getIcon:a}=t;e&&(this._loadOptions=e),void 0!==n&&(this._autoPacking=n),a&&(this._getIcon=a),r&&(this._mapping=r),i&&this._updateIconAtlas(i),this._autoPacking&&(o||a)&&"undefined"!==typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(o))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(t){var e;null===(e=this._texture)||void 0===e||e.delete(),this._texture=null,this._externalTexture=t,this.onUpdate()}_updateAutoPacking(t){const e=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=vf(t);for(const a of r){o.index++;const t=e(a,o),r=Ay(t);if(!t)throw new Error("Icon is missing.");if(!t.url)throw new Error("Icon url is missing.");i[r]||n[r]&&t.url===n[r].url||(i[r]={...t,source:a,sourceIndex:o.index})}return i}(t,this._getIcon,this._mapping)||{});if(e.length>0){const{mapping:t,xOffset:n,yOffset:i,rowHeight:r,canvasHeight:o}=function(t){let{icons:e,buffer:n,mapping:i={},xOffset:r=0,yOffset:o=0,rowHeight:a=0,canvasWidth:s}=t,l=[];for(let u=0;u<e.length;u++){const t=e[u];if(!i[Ay(t)]){const{height:e,width:c}=t;r+c+n>s&&(My(i,l,o),r=0,o=a+o+n,a=0,l=[]),l.push({icon:t,xOffset:r}),r=r+c+n,a=Math.max(a,e)}}return l.length>0&&My(i,l,o),{mapping:i,rowHeight:a,xOffset:r,yOffset:o,canvasWidth:s,canvasHeight:(c=a+o+n,Math.pow(2,Math.ceil(Math.log2(c))))};var c}({icons:e,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=t,this._xOffset=n,this._yOffset=i,this._canvasHeight=o,this._texture||(this._texture=new Xl(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:Ty})),this._texture.height!==this._canvasHeight&&(this._texture=Cy(this.gl,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(e)}}_loadIcons(t){const e=this._canvas.getContext("2d");for(const n of t)this._pendingCount++,mp(n.url,Kd,this._loadOptions).then((t=>{const i=Ay(n),{x:r,y:o,width:a,height:s}=this._mapping[i],l=ky(e,t,a,s);this._texture.setSubImageData({data:l,x:r,y:o,width:a,height:s}),this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const Ly=[0,0,0,255],Oy={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:Ly},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class zy extends em{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[um,Sm]})}initializeState(){this.state={iconManager:new Iy(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Ly},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){let{oldProps:e,props:n,changeFlags:i}=t;super.updateState({props:n,oldProps:e,changeFlags:i});const r=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:s,getIcon:l}=n,{iconManager:c}=this.state;c.setProps({loadOptions:n.loadOptions});let u=!1;if(o||this.internalState.isAsyncPropLoading("iconAtlas")?(e.iconAtlas!==n.iconAtlas&&c.setProps({iconAtlas:o,autoPacking:!1}),e.iconMapping!==n.iconMapping&&(c.setProps({iconMapping:a}),u=!0)):c.setProps({autoPacking:!0}),(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&c.setProps({data:s,getIcon:l}),u&&(r.invalidate("instanceOffsets"),r.invalidate("instanceIconFrames"),r.invalidate("instanceColorModes")),i.extensionsChanged){var h;const{gl:t}=this.context;null===(h=this.state.model)||void 0===h||h.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw(t){let{uniforms:e}=t;const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:o,billboard:a,alphaCutoff:s}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:ro[o],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:a,alphaCutoff:s}).draw()}_getModel(t){return new pg(t,{...this.getShaders(),id:this.props.id,geometry:new Em({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:e}=this.getCurrentLayer().props;e?e(t):eo.error(t.error)()}getInstanceOffset(t){const e=this.state.iconManager.getIconMapping(t);return[e.width/2-e.anchorX||0,e.height/2-e.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const e=this.state.iconManager.getIconMapping(t);return[e.x||0,e.y||0,e.width||0,e.height||0]}}zy.layerName="IconLayer",zy.defaultProps=Oy;class Ry extends vy{getShaders(){const t=super.getShaders();return t.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform bool fadeTrail;\nuniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"if(fadeTrail) {\n  color.a *= 1.0 - (currentTime - vTime) / trailLength;\n}\n"},t}initializeState(t){super.initializeState(t);this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(t){const{fadeTrail:e,trailLength:n,currentTime:i}=this.props;t.uniforms={...t.uniforms,fadeTrail:e,trailLength:n,currentTime:i},super.draw(t)}}function Dy(t){var e,n,i="";if("string"===typeof t||"number"===typeof t)i+=t;else if("object"===typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Dy(t[e]))&&(i&&(i+=" "),i+=n);else for(e in t)t[e]&&(i&&(i+=" "),i+=e);return i}function Fy(){for(var t,e,n=0,i="";n<arguments.length;)(t=arguments[n++])&&(e=Dy(t))&&(i&&(i+=" "),i+=e);return i}Ry.layerName="TripsLayer",Ry.defaultProps={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:null}};const By=t=>t,jy=(()=>{let t=By;return{configure(e){t=e},generate:e=>t(e),reset(){t=By}}})(),Ny={active:"Mui-active",checked:"Mui-checked",completed:"Mui-completed",disabled:"Mui-disabled",error:"Mui-error",expanded:"Mui-expanded",focused:"Mui-focused",focusVisible:"Mui-focusVisible",required:"Mui-required",selected:"Mui-selected"};function Vy(t,e){return Ny[e]||"".concat(jy.generate(t),"-").concat(e)}function Uy(t,e){const n={};return e.forEach((e=>{n[e]=Vy(t,e)})),n}function Wy(t){return Vy("MuiSlider",t)}const Gy=Uy("MuiSlider",["root","active","focusVisible","disabled","dragging","marked","vertical","trackInverted","trackFalse","rail","track","mark","markActive","markLabel","markLabelActive","thumb","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel"]);var qy=n(184);const Zy=function(e){const{children:n,className:i,value:r,theme:o}=e,a=(t=>{const{open:e}=t;return{offset:Fy(e&&Gy.valueLabelOpen),circle:Gy.valueLabelCircle,label:Gy.valueLabelLabel}})(e);return t.cloneElement(n,{className:Fy(n.props.className)},(0,qy.jsxs)(t.Fragment,{children:[n.props.children,(0,qy.jsx)("span",{className:Fy(a.offset,i),theme:o,"aria-hidden":!0,children:(0,qy.jsx)("span",{className:a.circle,children:(0,qy.jsx)("span",{className:a.label,children:r})})})]}))};const Hy=function(t){return"string"===typeof t};function Xy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Hy(t)?e:r({},e,{ownerState:r({},e.ownerState,n)})}function Yy(t){return t&&t.ownerDocument||document}let Ky,Jy=!0,Qy=!1;const $y={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function tv(t){t.metaKey||t.altKey||t.ctrlKey||(Jy=!0)}function ev(){Jy=!1}function nv(){"hidden"===this.visibilityState&&Qy&&(Jy=!0)}function iv(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch(n){}return Jy||function(t){const{type:e,tagName:n}=t;return!("INPUT"!==n||!$y[e]||t.readOnly)||"TEXTAREA"===n&&!t.readOnly||!!t.isContentEditable}(e)}function rv(){const e=t.useCallback((t=>{var e;null!=t&&((e=t.ownerDocument).addEventListener("keydown",tv,!0),e.addEventListener("mousedown",ev,!0),e.addEventListener("pointerdown",ev,!0),e.addEventListener("touchstart",ev,!0),e.addEventListener("visibilitychange",nv,!0))}),[]),n=t.useRef(!1);return{isFocusVisibleRef:n,onFocus:function(t){return!!iv(t)&&(n.current=!0,!0)},onBlur:function(){return!!n.current&&(Qy=!0,window.clearTimeout(Ky),Ky=window.setTimeout((()=>{Qy=!1}),100),n.current=!1,!0)},ref:e}}function ov(t,e){"function"===typeof t?t(e):t&&(t.current=e)}function av(e,n){return t.useMemo((()=>null==e&&null==n?null:t=>{ov(e,t),ov(n,t)}),[e,n])}const sv="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;function lv(e){const n=t.useRef(e);return sv((()=>{n.current=e})),t.useCallback((function(){return(0,n.current)(...arguments)}),[])}const cv={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:-1,overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function uv(t,e){return t-e}function hv(t,e,n){return null==t?e:Math.min(Math.max(e,t),n)}function pv(t,e){var n;const{index:i}=null!=(n=t.reduce(((t,n,i)=>{const r=Math.abs(e-n);return null===t||r<t.distance||r===t.distance?{distance:r,index:i}:t}),null))?n:{};return i}function dv(t,e){if(void 0!==e.current&&t.changedTouches){const n=t;for(let t=0;t<n.changedTouches.length;t+=1){const i=n.changedTouches[t];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function fv(t,e,n){return 100*(t-e)/(n-e)}function gv(t,e,n){const i=Math.round((t-n)/e)*e+n;return Number(i.toFixed(function(t){if(Math.abs(t)<1){const e=t.toExponential().split("e-"),n=e[0].split(".")[1];return(n?n.length:0)+parseInt(e[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}(e)))}function mv(t){let{values:e,newValue:n,index:i}=t;const r=e.slice();return r[i]=n,r.sort(uv)}function yv(t){let{sliderRef:e,activeIndex:n,setActive:i}=t;var r,o;const a=Yy(e.current);var s;null!=(r=e.current)&&r.contains(a.activeElement)&&Number(null==a||null==(o=a.activeElement)?void 0:o.getAttribute("data-index"))===n||(null==(s=e.current)||s.querySelector('[type="range"][data-index="'.concat(n,'"]')).focus());i&&i(n)}const vv={horizontal:{offset:t=>({left:"".concat(t,"%")}),leap:t=>({width:"".concat(t,"%")})},"horizontal-reverse":{offset:t=>({right:"".concat(t,"%")}),leap:t=>({width:"".concat(t,"%")})},vertical:{offset:t=>({bottom:"".concat(t,"%")}),leap:t=>({height:"".concat(t,"%")})}},_v=t=>t;let bv;function xv(){return void 0===bv&&(bv="undefined"===typeof CSS||"function"!==typeof CSS.supports||CSS.supports("touch-action","none")),bv}function wv(e){const{ref:n,"aria-labelledby":i,defaultValue:o,disableSwap:a=!1,disabled:s=!1,marks:l=!1,max:c=100,min:u=0,name:h,onChange:p,onChangeCommitted:d,orientation:f="horizontal",scale:g=_v,step:m=1,tabIndex:y,value:v,isRtl:_=!1}=e,b=t.useRef(),[x,w]=t.useState(-1),[S,P]=t.useState(-1),[E,T]=t.useState(!1),k=t.useRef(0),[A,C]=function(e){let{controlled:n,default:i,name:r,state:o="value"}=e;const{current:a}=t.useRef(void 0!==n),[s,l]=t.useState(i);return[a?n:s,t.useCallback((t=>{a||l(t)}),[])]}({controlled:v,default:null!=o?o:u,name:"Slider"}),M=p&&((t,e,n)=>{const i=t.nativeEvent||t,r=new i.constructor(i.type,i);Object.defineProperty(r,"target",{writable:!0,value:{value:e,name:h}}),p(r,e,n)}),I=Array.isArray(A);let L=I?A.slice().sort(uv):[A];L=L.map((t=>hv(t,u,c)));const O=!0===l&&null!==m?[...Array(Math.floor((c-u)/m)+1)].map(((t,e)=>({value:u+m*e}))):l||[],z=O.map((t=>t.value)),{isFocusVisibleRef:R,onBlur:D,onFocus:F,ref:B}=rv(),[j,N]=t.useState(-1),V=t.useRef(),U=av(B,V),W=av(n,U),G=t=>e=>{var n;const i=Number(e.currentTarget.getAttribute("data-index"));F(e),!0===R.current&&N(i),P(i),null==t||null==(n=t.onFocus)||n.call(t,e)},q=t=>e=>{var n;D(e),!1===R.current&&N(-1),P(-1),null==t||null==(n=t.onBlur)||n.call(t,e)};sv((()=>{var t;s&&V.current.contains(document.activeElement)&&(null==(t=document.activeElement)||t.blur())}),[s]),s&&-1!==x&&w(-1),s&&-1!==j&&N(-1);const Z=t=>e=>{var n;null==(n=t.onChange)||n.call(t,e);const i=Number(e.currentTarget.getAttribute("data-index")),r=L[i],o=z.indexOf(r);let s=e.target.valueAsNumber;if(O&&null==m&&(s=s<r?z[o-1]:z[o+1]),s=hv(s,u,c),O&&null==m){const t=z.indexOf(L[i]);s=s<L[i]?z[t-1]:z[t+1]}if(I){a&&(s=hv(s,L[i-1]||-1/0,L[i+1]||1/0));const t=s;s=mv({values:L,newValue:s,index:i});let e=i;a||(e=s.indexOf(t)),yv({sliderRef:V,activeIndex:e})}C(s),N(i),M&&M(e,s,i),d&&d(e,s)},H=t.useRef();let X=f;_&&"horizontal"===f&&(X+="-reverse");const Y=t=>{let{finger:e,move:n=!1,values:i}=t;const{current:r}=V,{width:o,height:s,bottom:l,left:h}=r.getBoundingClientRect();let p,d;if(p=0===X.indexOf("vertical")?(l-e.y)/s:(e.x-h)/o,-1!==X.indexOf("-reverse")&&(p=1-p),d=function(t,e,n){return(n-e)*t+e}(p,u,c),m)d=gv(d,m,u);else{const t=pv(z,d);d=z[t]}d=hv(d,u,c);let f=0;if(I){f=n?H.current:pv(i,d),a&&(d=hv(d,i[f-1]||-1/0,i[f+1]||1/0));const t=d;d=mv({values:i,newValue:d,index:f}),a&&n||(f=d.indexOf(t),H.current=f)}return{newValue:d,activeIndex:f}},K=lv((t=>{const e=dv(t,b);if(!e)return;if(k.current+=1,"mousemove"===t.type&&0===t.buttons)return void J(t);const{newValue:n,activeIndex:i}=Y({finger:e,move:!0,values:L});yv({sliderRef:V,activeIndex:i,setActive:w}),C(n),!E&&k.current>2&&T(!0),M&&M(t,n,i)})),J=lv((t=>{const e=dv(t,b);if(T(!1),!e)return;const{newValue:n}=Y({finger:e,values:L});w(-1),"touchend"===t.type&&P(-1),d&&d(t,n),b.current=void 0,$()})),Q=lv((t=>{if(s)return;xv()||t.preventDefault();const e=t.changedTouches[0];null!=e&&(b.current=e.identifier);const n=dv(t,b);if(!1!==n){const{newValue:e,activeIndex:i}=Y({finger:n,values:L});yv({sliderRef:V,activeIndex:i,setActive:w}),C(e),M&&M(t,e,i)}k.current=0;const i=Yy(V.current);i.addEventListener("touchmove",K),i.addEventListener("touchend",J)})),$=t.useCallback((()=>{const t=Yy(V.current);t.removeEventListener("mousemove",K),t.removeEventListener("mouseup",J),t.removeEventListener("touchmove",K),t.removeEventListener("touchend",J)}),[J,K]);t.useEffect((()=>{const{current:t}=V;return t.addEventListener("touchstart",Q,{passive:xv()}),()=>{t.removeEventListener("touchstart",Q,{passive:xv()}),$()}}),[$,Q]),t.useEffect((()=>{s&&$()}),[s,$]);const tt=t=>e=>{var n;if(null==(n=t.onMouseDown)||n.call(t,e),s)return;if(e.defaultPrevented)return;if(0!==e.button)return;e.preventDefault();const i=dv(e,b);if(!1!==i){const{newValue:t,activeIndex:n}=Y({finger:i,values:L});yv({sliderRef:V,activeIndex:n,setActive:w}),C(t),M&&M(e,t,n)}k.current=0;const r=Yy(V.current);r.addEventListener("mousemove",K),r.addEventListener("mouseup",J)},et=fv(I?L[0]:u,u,c),nt=fv(L[L.length-1],u,c)-et,it=t=>e=>{var n;null==(n=t.onMouseOver)||n.call(t,e);const i=Number(e.currentTarget.getAttribute("data-index"));P(i)},rt=t=>e=>{var n;null==(n=t.onMouseLeave)||n.call(t,e),P(-1)};return{axis:X,axisProps:vv,getRootProps:t=>{const e=r({},t,{onMouseDown:tt(t||{})});return r({ref:W},e)},getHiddenInputProps:t=>{const n=r({},t,{onChange:Z(t||{}),onFocus:G(t||{}),onBlur:q(t||{})});return r({tabIndex:y,"aria-labelledby":i,"aria-orientation":f,"aria-valuemax":g(c),"aria-valuemin":g(u),name:h,type:"range",min:e.min,max:e.max,step:e.step,disabled:s},n,{style:r({},cv,{direction:_?"rtl":"ltr",width:"100%",height:"100%"})})},getThumbProps:t=>{const e=r({},t,{onMouseOver:it(t||{}),onMouseLeave:rt(t||{})});return r({},e)},dragging:E,marks:O,values:L,active:x,focusVisible:j,open:S,range:I,trackOffset:et,trackLeap:nt}}const Sv=["aria-label","aria-valuetext","className","component","classes","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","onMouseDown","orientation","scale","step","tabIndex","track","value","valueLabelDisplay","valueLabelFormat","isRtl","components","componentsProps"],Pv=t=>t,Ev=t=>{const{disabled:e,dragging:n,marked:i,orientation:r,track:o,classes:a}=t;return function(t,e,n){const i={};return Object.keys(t).forEach((r=>{i[r]=t[r].reduce(((t,i)=>(i&&(n&&n[i]&&t.push(n[i]),t.push(e(i))),t)),[]).join(" ")})),i}({root:["root",e&&"disabled",n&&"dragging",i&&"marked","vertical"===r&&"vertical","inverted"===o&&"trackInverted",!1===o&&"trackFalse"],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled"],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},Wy,a)},Tv=t=>{let{children:e}=t;return e},kv=t.forwardRef((function(e,n){var i,o,a,s,l,c,u;const{"aria-label":h,"aria-valuetext":p,className:d,component:f,classes:g,disableSwap:m=!1,disabled:y=!1,getAriaLabel:v,getAriaValueText:_,marks:b=!1,max:x=100,min:w=0,onMouseDown:S,orientation:P="horizontal",scale:E=Pv,step:T=1,track:k="normal",valueLabelDisplay:A="off",valueLabelFormat:C=Pv,isRtl:M=!1,components:I={},componentsProps:L={}}=e,O=pi(e,Sv),z=r({},e,{mark:b,classes:g,disabled:y,isRtl:M,max:x,min:w,orientation:P,scale:E,step:T,track:k,valueLabelDisplay:A,valueLabelFormat:C}),{axisProps:R,getRootProps:D,getHiddenInputProps:F,getThumbProps:B,open:j,active:N,axis:V,range:U,focusVisible:W,dragging:G,marks:q,values:Z,trackOffset:H,trackLeap:X}=wv(r({},z,{ref:n}));z.marked=q.length>0&&q.some((t=>t.label)),z.dragging=G;const Y=null!=(i=null!=f?f:I.Root)?i:"span",K=Xy(Y,r({},O,L.root),z),J=null!=(o=I.Rail)?o:"span",Q=Xy(J,L.rail,z),$=null!=(a=I.Track)?a:"span",tt=Xy($,L.track,z),et=r({},R[V].offset(H),R[V].leap(X)),nt=null!=(s=I.Thumb)?s:"span",it=Xy(nt,L.thumb,z),rt=null!=(l=I.ValueLabel)?l:Zy,ot=Xy(rt,L.valueLabel,z),at=null!=(c=I.Mark)?c:"span",st=Xy(at,L.mark,z),lt=null!=(u=I.MarkLabel)?u:"span",ct=Xy(lt,L.markLabel,z),ut=I.Input||"input",ht=Xy(ut,L.input,z),pt=F(),dt=Ev(z);return(0,qy.jsxs)(Y,r({},K,D({onMouseDown:S}),{className:Fy(dt.root,K.className,d),children:[(0,qy.jsx)(J,r({},Q,{className:Fy(dt.rail,Q.className)})),(0,qy.jsx)($,r({},tt,{className:Fy(dt.track,tt.className),style:r({},et,tt.style)})),q.map(((e,n)=>{const i=fv(e.value,w,x),o=R[V].offset(i);let a;return a=!1===k?-1!==Z.indexOf(e.value):"normal"===k&&(U?e.value>=Z[0]&&e.value<=Z[Z.length-1]:e.value<=Z[0])||"inverted"===k&&(U?e.value<=Z[0]||e.value>=Z[Z.length-1]:e.value>=Z[0]),(0,qy.jsxs)(t.Fragment,{children:[(0,qy.jsx)(at,r({"data-index":n},st,!Hy(at)&&{markActive:a},{style:r({},o,st.style),className:Fy(dt.mark,st.className,a&&dt.markActive)})),null!=e.label?(0,qy.jsx)(lt,r({"aria-hidden":!0,"data-index":n},ct,!Hy(lt)&&{markLabelActive:a},{style:r({},o,ct.style),className:Fy(dt.markLabel,ct.className,a&&dt.markLabelActive),children:e.label})):null]},e.value)})),Z.map(((e,n)=>{const i=fv(e,w,x),o=R[V].offset(i),a="off"===A?Tv:rt;return(0,qy.jsx)(t.Fragment,{children:(0,qy.jsx)(a,r({},!Hy(a)&&{valueLabelFormat:C,valueLabelDisplay:A,value:"function"===typeof C?C(E(e),n):C,index:n,open:j===n||N===n||"on"===A,disabled:y},ot,{className:Fy(dt.valueLabel,ot.className),children:(0,qy.jsx)(nt,r({"data-index":n},it,B(),{className:Fy(dt.thumb,it.className,N===n&&dt.active,W===n&&dt.focusVisible)},!Hy(nt)&&{ownerState:r({},z,it.ownerState)},{style:r({},o,{pointerEvents:m&&N!==n?"none":void 0},it.style),children:(0,qy.jsx)(ut,r({},pt,{"data-index":n,"aria-label":v?v(n):h,"aria-valuenow":E(e),"aria-valuetext":_?_(E(e),n):p,value:Z[n]},!Hy(ut)&&{ownerState:r({},z,ht.ownerState)},ht,{style:r({},pt.style,ht.style)}))}))}))},n)}))]}))})),Av=kv;function Cv(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function Mv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(e,t),n)}function Iv(t){if(t.type)return t;if("#"===t.charAt(0))return Iv(function(t){t=t.slice(1);const e=new RegExp(".{1,".concat(t.length>=6?2:1,"}"),"g");let n=t.match(e);return n&&1===n[0].length&&(n=n.map((t=>t+t))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map(((t,e)=>e<3?parseInt(t,16):Math.round(parseInt(t,16)/255*1e3)/1e3)).join(", "),")"):""}(t));const e=t.indexOf("("),n=t.substring(0,e);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(Cv(9,t));let i,r=t.substring(e+1,t.length-1);if("color"===n){if(r=r.split(" "),i=r.shift(),4===r.length&&"/"===r[3].charAt(0)&&(r[3]=r[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i))throw new Error(Cv(10,i))}else r=r.split(",");return r=r.map((t=>parseFloat(t))),{type:n,values:r,colorSpace:i}}function Lv(t){const{type:e,colorSpace:n}=t;let{values:i}=t;return-1!==e.indexOf("rgb")?i=i.map(((t,e)=>e<3?parseInt(t,10):t)):-1!==e.indexOf("hsl")&&(i[1]="".concat(i[1],"%"),i[2]="".concat(i[2],"%")),i=-1!==e.indexOf("color")?"".concat(n," ").concat(i.join(" ")):"".concat(i.join(", ")),"".concat(e,"(").concat(i,")")}function Ov(t){let e="hsl"===(t=Iv(t)).type?Iv(function(t){t=Iv(t);const{values:e}=t,n=e[0],i=e[1]/100,r=e[2]/100,o=i*Math.min(r,1-r),a=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+n/30)%12;return r-o*Math.max(Math.min(e-3,9-e,1),-1)};let s="rgb";const l=[Math.round(255*a(0)),Math.round(255*a(8)),Math.round(255*a(4))];return"hsla"===t.type&&(s+="a",l.push(e[3])),Lv({type:s,values:l})}(t)).values:t.values;return e=e.map((e=>("color"!==t.type&&(e/=255),e<=.03928?e/12.92:((e+.055)/1.055)**2.4))),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function zv(t,e){return t=Iv(t),e=Mv(e),"rgb"!==t.type&&"hsl"!==t.type||(t.type+="a"),"color"===t.type?t.values[3]="/".concat(e):t.values[3]=e,Lv(t)}function Rv(t,e){if(t=Iv(t),e=Mv(e),-1!==t.type.indexOf("hsl"))t.values[2]*=1-e;else if(-1!==t.type.indexOf("rgb")||-1!==t.type.indexOf("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Lv(t)}function Dv(t,e){if(t=Iv(t),e=Mv(e),-1!==t.type.indexOf("hsl"))t.values[2]+=(100-t.values[2])*e;else if(-1!==t.type.indexOf("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(-1!==t.type.indexOf("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Lv(t)}function Fv(t){const{theme:e,name:n,props:i}=t;return e&&e.components&&e.components[n]&&e.components[n].defaultProps?function(t,e){const n=r({},e);return Object.keys(t).forEach((e=>{void 0===n[e]&&(n[e]=t[e])})),n}(e.components[n].defaultProps,i):i}function Bv(t){return null!==t&&"object"===typeof t&&t.constructor===Object}function jv(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const i=n.clone?r({},t):t;return Bv(t)&&Bv(e)&&Object.keys(e).forEach((r=>{"__proto__"!==r&&(Bv(e[r])&&r in t&&Bv(t[r])?i[r]=jv(t[r],e[r],n):i[r]=e[r])})),i}const Nv=["values","unit","step"];function Vv(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:i=5}=t,o=pi(t,Nv),a=(t=>{const e=Object.keys(t).map((e=>({key:e,val:t[e]})))||[];return e.sort(((t,e)=>t.val-e.val)),e.reduce(((t,e)=>r({},t,{[e.key]:e.val})),{})})(e),s=Object.keys(a);function l(t){const i="number"===typeof e[t]?e[t]:t;return"@media (min-width:".concat(i).concat(n,")")}function c(t){const r="number"===typeof e[t]?e[t]:t;return"@media (max-width:".concat(r-i/100).concat(n,")")}function u(t,r){const o=s.indexOf(r);return"@media (min-width:".concat("number"===typeof e[t]?e[t]:t).concat(n,") and ")+"(max-width:".concat((-1!==o&&"number"===typeof e[s[o]]?e[s[o]]:r)-i/100).concat(n,")")}return r({keys:s,values:a,up:l,down:c,between:u,only:function(t){return s.indexOf(t)+1<s.length?u(t,s[s.indexOf(t)+1]):l(t)},not:function(t){const e=s.indexOf(t);return 0===e?l(s[1]):e===s.length-1?c(s[e]):u(t,s[s.indexOf(t)+1]).replace("@media","@media not all and")},unit:n},o)}const Uv={borderRadius:4},Wv={xs:0,sm:600,md:900,lg:1200,xl:1536},Gv={keys:["xs","sm","md","lg","xl"],up:t=>"@media (min-width:".concat(Wv[t],"px)")};function qv(t,e,n){const i=t.theme||{};if(Array.isArray(e)){const t=i.breakpoints||Gv;return e.reduce(((i,r,o)=>(i[t.up(t.keys[o])]=n(e[o]),i)),{})}if("object"===typeof e){const t=i.breakpoints||Gv;return Object.keys(e).reduce(((i,r)=>{if(-1!==Object.keys(t.values||Wv).indexOf(r)){i[t.up(r)]=n(e[r],r)}else{const t=r;i[t]=e[t]}return i}),{})}return n(e)}function Zv(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var e;const n=null==t||null==(e=t.keys)?void 0:e.reduce(((e,n)=>(e[t.up(n)]={},e)),{});return n||{}}function Hv(t,e){return t.reduce(((t,e)=>{const n=t[e];return(!n||0===Object.keys(n).length)&&delete t[e],t}),e)}function Xv(t){if("string"!==typeof t)throw new Error(Cv(7));return t.charAt(0).toUpperCase()+t.slice(1)}function Yv(t,e){if(!e||"string"!==typeof e)return null;if(t&&t.vars){const n="vars.".concat(e).split(".").reduce(((t,e)=>t&&t[e]?t[e]:null),t);if(null!=n)return n}return e.split(".").reduce(((t,e)=>t&&null!=t[e]?t[e]:null),t)}function Kv(t,e,n){let i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return i="function"===typeof t?t(n):Array.isArray(t)?t[n]||r:Yv(t,n)||r,e&&(i=e(i)),i}const Jv=function(t){const{prop:e,cssProperty:n=t.prop,themeKey:i,transform:r}=t,o=t=>{if(null==t[e])return null;const o=t[e],a=Yv(t.theme,i)||{};return qv(t,o,(t=>{let i=Kv(a,r,t);return t===i&&"string"===typeof t&&(i=Kv(a,r,"".concat(e).concat("default"===t?"":Xv(t)),t)),!1===n?i:{[n]:i}}))};return o.propTypes={},o.filterProps=[e],o};const Qv=function(t,e){return e?jv(t,e,{clone:!1}):t};const $v={m:"margin",p:"padding"},t_={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},e_={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},n_=function(t){const e={};return n=>(void 0===e[n]&&(e[n]=t(n)),e[n])}((t=>{if(t.length>2){if(!e_[t])return[t];t=e_[t]}const[e,n]=t.split(""),i=$v[e],r=t_[n]||"";return Array.isArray(r)?r.map((t=>i+t)):[i+r]})),i_=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],r_=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],o_=[...i_,...r_];function a_(t,e,n,i){var r;const o=null!=(r=Yv(t,e))?r:n;return"number"===typeof o?t=>"string"===typeof t?t:o*t:Array.isArray(o)?t=>"string"===typeof t?t:o[t]:"function"===typeof o?o:()=>{}}function s_(t){return a_(t,"spacing",8)}function l_(t,e){if("string"===typeof e||null==e)return e;const n=t(Math.abs(e));return e>=0?n:"number"===typeof n?-n:"-".concat(n)}function c_(t,e,n,i){if(-1===e.indexOf(n))return null;const r=function(t,e){return n=>t.reduce(((t,i)=>(t[i]=l_(e,n),t)),{})}(n_(n),i);return qv(t,t[n],r)}function u_(t,e){const n=s_(t.theme);return Object.keys(t).map((i=>c_(t,e,i,n))).reduce(Qv,{})}function h_(t){return u_(t,i_)}function p_(t){return u_(t,r_)}function d_(t){return u_(t,o_)}h_.propTypes={},h_.filterProps=i_,p_.propTypes={},p_.filterProps=r_,d_.propTypes={},d_.filterProps=o_;const f_=d_;function g_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(t.mui)return t;const e=s_({spacing:t}),n=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];const r=0===n.length?[1]:n;return r.map((t=>{const n=e(t);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}const m_=["breakpoints","palette","spacing","shape"];const y_=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:e={},palette:n={},spacing:i,shape:o={}}=t,a=pi(t,m_),s=Vv(e),l=g_(i);let c=jv({breakpoints:s,direction:"ltr",components:{},palette:r({mode:"light"},n),spacing:l,shape:r({},Uv,o)},a);for(var u=arguments.length,h=new Array(u>1?u-1:0),p=1;p<u;p++)h[p-1]=arguments[p];return c=h.reduce(((t,e)=>jv(t,e)),c),c};const v_=t.createContext(null);function __(){return t.useContext(v_)}function b_(t){return 0===Object.keys(t).length}const x_=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=__();return!e||b_(e)?t:e},w_=y_();const S_=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w_;return x_(t)};function P_(t,e,n){return r({toolbar:{minHeight:56,["".concat(t.up("xs")," and (orientation: landscape)")]:{minHeight:48},[t.up("sm")]:{minHeight:64}}},n)}const E_={black:"#000",white:"#fff"},T_={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},k_={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},A_={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},C_={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},M_={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},I_={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},L_={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},O_=["mode","contrastThreshold","tonalOffset"],z_={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:E_.white,default:E_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},R_={text:{primary:E_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:E_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function D_(t,e,n,i){const r=i.light||i,o=i.dark||1.5*i;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:"light"===e?t.light=Dv(t.main,r):"dark"===e&&(t.dark=Rv(t.main,o)))}function F_(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:i=.2}=t,o=pi(t,O_),a=t.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:M_[200],light:M_[50],dark:M_[400]}:{main:M_[700],light:M_[400],dark:M_[800]}}(e),s=t.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:k_[200],light:k_[50],dark:k_[400]}:{main:k_[500],light:k_[300],dark:k_[700]}}(e),l=t.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:A_[500],light:A_[300],dark:A_[700]}:{main:A_[700],light:A_[400],dark:A_[800]}}(e),c=t.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:I_[400],light:I_[300],dark:I_[700]}:{main:I_[700],light:I_[500],dark:I_[900]}}(e),u=t.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:L_[400],light:L_[300],dark:L_[700]}:{main:L_[800],light:L_[500],dark:L_[900]}}(e),h=t.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:C_[400],light:C_[300],dark:C_[700]}:{main:"#ed6c02",light:C_[500],dark:C_[900]}}(e);function p(t){const e=function(t,e){const n=Ov(t),i=Ov(e);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)}(t,R_.text.primary)>=n?R_.text.primary:z_.text.primary;return e}const d=t=>{let{color:e,name:n,mainShade:o=500,lightShade:a=300,darkShade:s=700}=t;if(e=r({},e),!e.main&&e[o]&&(e.main=e[o]),!e.hasOwnProperty("main"))throw new Error(Cv(11,n?" (".concat(n,")"):"",o));if("string"!==typeof e.main)throw new Error(Cv(12,n?" (".concat(n,")"):"",JSON.stringify(e.main)));return D_(e,"light",a,i),D_(e,"dark",s,i),e.contrastText||(e.contrastText=p(e.main)),e},f={dark:R_,light:z_};return jv(r({common:E_,mode:e,primary:d({color:a,name:"primary"}),secondary:d({color:s,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:d({color:l,name:"error"}),warning:d({color:h,name:"warning"}),info:d({color:c,name:"info"}),success:d({color:u,name:"success"}),grey:T_,contrastThreshold:n,getContrastText:p,augmentColor:d,tonalOffset:i},f[e]),o)}const B_=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const j_={textTransform:"uppercase"},N_='"Roboto", "Helvetica", "Arial", sans-serif';function V_(t,e){const n="function"===typeof e?e(t):e,{fontFamily:i=N_,fontSize:o=14,fontWeightLight:a=300,fontWeightRegular:s=400,fontWeightMedium:l=500,fontWeightBold:c=700,htmlFontSize:u=16,allVariants:h,pxToRem:p}=n,d=pi(n,B_);const f=o/14,g=p||(t=>"".concat(t/u*f,"rem")),m=(t,e,n,o,a)=>{return r({fontFamily:i,fontWeight:t,fontSize:g(e),lineHeight:n},i===N_?{letterSpacing:"".concat((s=o/e,Math.round(1e5*s)/1e5),"em")}:{},a,h);var s},y={h1:m(a,96,1.167,-1.5),h2:m(a,60,1.2,-.5),h3:m(s,48,1.167,0),h4:m(s,34,1.235,.25),h5:m(s,24,1.334,0),h6:m(l,20,1.6,.15),subtitle1:m(s,16,1.75,.15),subtitle2:m(l,14,1.57,.1),body1:m(s,16,1.5,.15),body2:m(s,14,1.43,.15),button:m(l,14,1.75,.4,j_),caption:m(s,12,1.66,.4),overline:m(s,12,2.66,1,j_)};return jv(r({htmlFontSize:u,pxToRem:g,fontFamily:i,fontSize:o,fontWeightLight:a,fontWeightRegular:s,fontWeightMedium:l,fontWeightBold:c},y),d,{clone:!1})}function U_(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const W_=["none",U_(0,2,1,-1,0,1,1,0,0,1,3,0),U_(0,3,1,-2,0,2,2,0,0,1,5,0),U_(0,3,3,-2,0,3,4,0,0,1,8,0),U_(0,2,4,-1,0,4,5,0,0,1,10,0),U_(0,3,5,-1,0,5,8,0,0,1,14,0),U_(0,3,5,-1,0,6,10,0,0,1,18,0),U_(0,4,5,-2,0,7,10,1,0,2,16,1),U_(0,5,5,-3,0,8,10,1,0,3,14,2),U_(0,5,6,-3,0,9,12,1,0,3,16,2),U_(0,6,6,-3,0,10,14,1,0,4,18,3),U_(0,6,7,-4,0,11,15,1,0,4,20,3),U_(0,7,8,-4,0,12,17,2,0,5,22,4),U_(0,7,8,-4,0,13,19,2,0,5,24,4),U_(0,7,9,-4,0,14,21,2,0,5,26,4),U_(0,8,9,-5,0,15,22,2,0,6,28,5),U_(0,8,10,-5,0,16,24,2,0,6,30,5),U_(0,8,11,-5,0,17,26,2,0,6,32,5),U_(0,9,11,-5,0,18,28,2,0,7,34,6),U_(0,9,12,-6,0,19,29,2,0,7,36,6),U_(0,10,13,-6,0,20,31,3,0,8,38,7),U_(0,10,13,-6,0,21,33,3,0,8,40,7),U_(0,10,14,-6,0,22,35,3,0,8,42,7),U_(0,11,14,-7,0,23,36,3,0,9,44,8),U_(0,11,15,-7,0,24,38,3,0,9,46,8)],G_=["duration","easing","delay"],q_={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Z_={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function H_(t){return"".concat(Math.round(t),"ms")}function X_(t){if(!t)return 0;const e=t/36;return Math.round(10*(4+15*e**.25+e/5))}function Y_(t){const e=r({},q_,t.easing),n=r({},Z_,t.duration);return r({getAutoHeightDuration:X_,create:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:r=n.standard,easing:o=e.easeInOut,delay:a=0}=i;pi(i,G_);return(Array.isArray(t)?t:[t]).map((t=>"".concat(t," ").concat("string"===typeof r?r:H_(r)," ").concat(o," ").concat("string"===typeof a?a:H_(a)))).join(",")}},t,{easing:e,duration:n})}const K_={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},J_=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Q_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mixins:e={},palette:n={},transitions:i={},typography:o={}}=t,a=pi(t,J_),s=F_(n),l=y_(t);let c=jv(l,{mixins:P_(l.breakpoints,l.spacing,e),palette:s,shadows:W_.slice(),typography:V_(s,o),transitions:Y_(i),zIndex:r({},K_)});c=jv(c,a);for(var u=arguments.length,h=new Array(u>1?u-1:0),p=1;p<u;p++)h[p-1]=arguments[p];return c=h.reduce(((t,e)=>jv(t,e)),c),c}const $_=Q_();function tb(t){let{props:e,name:n}=t;return function(t){let{props:e,name:n,defaultTheme:i}=t;return Fv({theme:S_(i),name:n,props:e})}({props:e,name:n,defaultTheme:$_})}const eb=function(t){var e=Object.create(null);return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}};var nb=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/;const ib=eb((function(t){return nb.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91}));var rb=function(){function t(t){var e=this;this._insertTag=function(t){var n;n=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,n),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{n.insertRule(t,n.cssRules.length)}catch(i){0}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){return t.parentNode&&t.parentNode.removeChild(t)})),this.tags=[],this.ctr=0},t}(),ob=Math.abs,ab=String.fromCharCode,sb=Object.assign;function lb(t){return t.trim()}function cb(t,e,n){return t.replace(e,n)}function ub(t,e){return t.indexOf(e)}function hb(t,e){return 0|t.charCodeAt(e)}function pb(t,e,n){return t.slice(e,n)}function db(t){return t.length}function fb(t){return t.length}function gb(t,e){return e.push(t),t}var mb=1,yb=1,vb=0,_b=0,bb=0,xb="";function wb(t,e,n,i,r,o,a){return{value:t,root:e,parent:n,type:i,props:r,children:o,line:mb,column:yb,length:a,return:""}}function Sb(t,e){return sb(wb("",null,null,"",null,null,0),t,{length:-t.length},e)}function Pb(){return bb=_b>0?hb(xb,--_b):0,yb--,10===bb&&(yb=1,mb--),bb}function Eb(){return bb=_b<vb?hb(xb,_b++):0,yb++,10===bb&&(yb=1,mb++),bb}function Tb(){return hb(xb,_b)}function kb(){return _b}function Ab(t,e){return pb(xb,t,e)}function Cb(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Mb(t){return mb=yb=1,vb=db(xb=t),_b=0,[]}function Ib(t){return xb="",t}function Lb(t){return lb(Ab(_b-1,Rb(91===t?t+2:40===t?t+1:t)))}function Ob(t){for(;(bb=Tb())&&bb<33;)Eb();return Cb(t)>2||Cb(bb)>3?"":" "}function zb(t,e){for(;--e&&Eb()&&!(bb<48||bb>102||bb>57&&bb<65||bb>70&&bb<97););return Ab(t,kb()+(e<6&&32==Tb()&&32==Eb()))}function Rb(t){for(;Eb();)switch(bb){case t:return _b;case 34:case 39:34!==t&&39!==t&&Rb(bb);break;case 40:41===t&&Rb(t);break;case 92:Eb()}return _b}function Db(t,e){for(;Eb()&&t+bb!==57&&(t+bb!==84||47!==Tb()););return"/*"+Ab(e,_b-1)+"*"+ab(47===t?t:Eb())}function Fb(t){for(;!Cb(Tb());)Eb();return Ab(t,_b)}var Bb="-ms-",jb="-moz-",Nb="-webkit-",Vb="comm",Ub="rule",Wb="decl",Gb="@keyframes";function qb(t,e){for(var n="",i=fb(t),r=0;r<i;r++)n+=e(t[r],r,t,e)||"";return n}function Zb(t,e,n,i){switch(t.type){case"@import":case Wb:return t.return=t.return||t.value;case Vb:return"";case Gb:return t.return=t.value+"{"+qb(t.children,i)+"}";case Ub:t.value=t.props.join(",")}return db(n=qb(t.children,i))?t.return=t.value+"{"+n+"}":""}function Hb(t,e){switch(function(t,e){return(((e<<2^hb(t,0))<<2^hb(t,1))<<2^hb(t,2))<<2^hb(t,3)}(t,e)){case 5103:return Nb+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Nb+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Nb+t+jb+t+Bb+t+t;case 6828:case 4268:return Nb+t+Bb+t+t;case 6165:return Nb+t+Bb+"flex-"+t+t;case 5187:return Nb+t+cb(t,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+t;case 5443:return Nb+t+Bb+"flex-item-"+cb(t,/flex-|-self/,"")+t;case 4675:return Nb+t+Bb+"flex-line-pack"+cb(t,/align-content|flex-|-self/,"")+t;case 5548:return Nb+t+Bb+cb(t,"shrink","negative")+t;case 5292:return Nb+t+Bb+cb(t,"basis","preferred-size")+t;case 6060:return Nb+"box-"+cb(t,"-grow","")+Nb+t+Bb+cb(t,"grow","positive")+t;case 4554:return Nb+cb(t,/([^-])(transform)/g,"$1-webkit-$2")+t;case 6187:return cb(cb(cb(t,/(zoom-|grab)/,Nb+"$1"),/(image-set)/,Nb+"$1"),t,"")+t;case 5495:case 3959:return cb(t,/(image-set\([^]*)/,Nb+"$1$`$1");case 4968:return cb(cb(t,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+Nb+t+t;case 4095:case 3583:case 4068:case 2532:return cb(t,/(.+)-inline(.+)/,Nb+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(db(t)-1-e>6)switch(hb(t,e+1)){case 109:if(45!==hb(t,e+4))break;case 102:return cb(t,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+jb+(108==hb(t,e+3)?"$3":"$2-$3"))+t;case 115:return~ub(t,"stretch")?Hb(cb(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==hb(t,e+1))break;case 6444:switch(hb(t,db(t)-3-(~ub(t,"!important")&&10))){case 107:return cb(t,":",":"+Nb)+t;case 101:return cb(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Nb+(45===hb(t,14)?"inline-":"")+"box$3$1"+Nb+"$2$3$1"+Bb+"$2box$3")+t}break;case 5936:switch(hb(t,e+11)){case 114:return Nb+t+Bb+cb(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Nb+t+Bb+cb(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Nb+t+Bb+cb(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Nb+t+Bb+t+t}return t}function Xb(t){return function(e){e.root||(e=e.return)&&t(e)}}function Yb(t){return Ib(Kb("",null,null,null,[""],t=Mb(t),0,[0],t))}function Kb(t,e,n,i,r,o,a,s,l){for(var c=0,u=0,h=a,p=0,d=0,f=0,g=1,m=1,y=1,v=0,_="",b=r,x=o,w=i,S=_;m;)switch(f=v,v=Eb()){case 40:if(108!=f&&58==S.charCodeAt(h-1)){-1!=ub(S+=cb(Lb(v),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:S+=Lb(v);break;case 9:case 10:case 13:case 32:S+=Ob(f);break;case 92:S+=zb(kb()-1,7);continue;case 47:switch(Tb()){case 42:case 47:gb(Qb(Db(Eb(),kb()),e,n),l);break;default:S+="/"}break;case 123*g:s[c++]=db(S)*y;case 125*g:case 59:case 0:switch(v){case 0:case 125:m=0;case 59+u:d>0&&db(S)-h&&gb(d>32?$b(S+";",i,n,h-1):$b(cb(S," ","")+";",i,n,h-2),l);break;case 59:S+=";";default:if(gb(w=Jb(S,e,n,c,u,r,s,_,b=[],x=[],h),o),123===v)if(0===u)Kb(S,e,w,w,b,o,h,s,x);else switch(p){case 100:case 109:case 115:Kb(t,w,w,i&&gb(Jb(t,w,w,0,0,r,s,_,r,b=[],h),x),r,x,h,s,i?b:x);break;default:Kb(S,w,w,w,[""],x,0,s,x)}}c=u=d=0,g=y=1,_=S="",h=a;break;case 58:h=1+db(S),d=f;default:if(g<1)if(123==v)--g;else if(125==v&&0==g++&&125==Pb())continue;switch(S+=ab(v),v*g){case 38:y=u>0?1:(S+="\f",-1);break;case 44:s[c++]=(db(S)-1)*y,y=1;break;case 64:45===Tb()&&(S+=Lb(Eb())),p=Tb(),u=h=db(_=S+=Fb(kb())),v++;break;case 45:45===f&&2==db(S)&&(g=0)}}return o}function Jb(t,e,n,i,r,o,a,s,l,c,u){for(var h=r-1,p=0===r?o:[""],d=fb(p),f=0,g=0,m=0;f<i;++f)for(var y=0,v=pb(t,h+1,h=ob(g=a[f])),_=t;y<d;++y)(_=lb(g>0?p[y]+" "+v:cb(v,/&\f/g,p[y])))&&(l[m++]=_);return wb(t,e,n,0===r?Ub:s,l,c,u)}function Qb(t,e,n){return wb(t,e,n,Vb,ab(bb),pb(t,2,-2),0)}function $b(t,e,n,i){return wb(t,e,n,Wb,pb(t,0,i),pb(t,i+1,-1),i)}var tx=function(t,e,n){for(var i=0,r=0;i=r,r=Tb(),38===i&&12===r&&(e[n]=1),!Cb(r);)Eb();return Ab(t,_b)},ex=function(t,e){return Ib(function(t,e){var n=-1,i=44;do{switch(Cb(i)){case 0:38===i&&12===Tb()&&(e[n]=1),t[n]+=tx(_b-1,e,n);break;case 2:t[n]+=Lb(i);break;case 4:if(44===i){t[++n]=58===Tb()?"&\f":"",e[n]=t[n].length;break}default:t[n]+=ab(i)}}while(i=Eb());return t}(Mb(t),e))},nx=new WeakMap,ix=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,n=t.parent,i=t.column===n.column&&t.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||nx.get(n))&&!i){nx.set(t,!0);for(var r=[],o=ex(e,r),a=n.props,s=0,l=0;s<o.length;s++)for(var c=0;c<a.length;c++,l++)t.props[l]=r[s]?o[s].replace(/&\f/g,a[c]):a[c]+" "+o[s]}}},rx=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}},ox=[function(t,e,n,i){if(t.length>-1&&!t.return)switch(t.type){case Wb:t.return=Hb(t.value,t.length);break;case Gb:return qb([Sb(t,{value:cb(t.value,"@","@"+Nb)})],i);case Ub:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t,e){return(t=e.exec(t))?t[0]:t}(e,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return qb([Sb(t,{props:[cb(e,/:(read-\w+)/,":-moz-$1")]})],i);case"::placeholder":return qb([Sb(t,{props:[cb(e,/:(plac\w+)/,":-webkit-input-$1")]}),Sb(t,{props:[cb(e,/:(plac\w+)/,":-moz-$1")]}),Sb(t,{props:[cb(e,/:(plac\w+)/,Bb+"input-$1")]})],i)}return""}))}}];const ax=function(t){var e=t.key;if("css"===e){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var i=t.stylisPlugins||ox;var r,o,a={},s=[];r=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),n=1;n<e.length;n++)a[e[n]]=!0;s.push(t)}));var l=[ix,rx];var c,u=[Zb,Xb((function(t){c.insert(t)}))],h=function(t){var e=fb(t);return function(n,i,r,o){for(var a="",s=0;s<e;s++)a+=t[s](n,i,r,o)||"";return a}}(l.concat(i,u));o=function(t,e,n,i){c=n,qb(Yb(t?t+"{"+e.styles+"}":e.styles),h),i&&(p.inserted[e.name]=!0)};var p={key:e,sheet:new rb({key:e,container:r,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:a,registered:{},insert:o};return p.sheet.hydrate(s),p};const sx=function(t){for(var e,n=0,i=0,r=t.length;r>=4;++i,r-=4)e=1540483477*(65535&(e=255&t.charCodeAt(i)|(255&t.charCodeAt(++i))<<8|(255&t.charCodeAt(++i))<<16|(255&t.charCodeAt(++i))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(r){case 3:n^=(255&t.charCodeAt(i+2))<<16;case 2:n^=(255&t.charCodeAt(i+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(i)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)};const lx={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var cx=/[A-Z]|^ms/g,ux=/_EMO_([^_]+?)_([^]*?)_EMO_/g,hx=function(t){return 45===t.charCodeAt(1)},px=function(t){return null!=t&&"boolean"!==typeof t},dx=eb((function(t){return hx(t)?t:t.replace(cx,"-$&").toLowerCase()})),fx=function(t,e){switch(t){case"animation":case"animationName":if("string"===typeof e)return e.replace(ux,(function(t,e,n){return mx={name:e,styles:n,next:mx},e}))}return 1===lx[t]||hx(t)||"number"!==typeof e||0===e?e:e+"px"};function gx(t,e,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return mx={name:n.name,styles:n.styles,next:mx},n.name;if(void 0!==n.styles){var i=n.next;if(void 0!==i)for(;void 0!==i;)mx={name:i.name,styles:i.styles,next:mx},i=i.next;return n.styles+";"}return function(t,e,n){var i="";if(Array.isArray(n))for(var r=0;r<n.length;r++)i+=gx(t,e,n[r])+";";else for(var o in n){var a=n[o];if("object"!==typeof a)null!=e&&void 0!==e[a]?i+=o+"{"+e[a]+"}":px(a)&&(i+=dx(o)+":"+fx(o,a)+";");else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=e&&void 0!==e[a[0]]){var s=gx(t,e,a);switch(o){case"animation":case"animationName":i+=dx(o)+":"+s+";";break;default:i+=o+"{"+s+"}"}}else for(var l=0;l<a.length;l++)px(a[l])&&(i+=dx(o)+":"+fx(o,a[l])+";")}return i}(t,e,n);case"function":if(void 0!==t){var r=mx,o=n(t);return mx=r,gx(t,e,o)}}if(null==e)return n;var a=e[n];return void 0!==a?a:n}var mx,yx=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var vx=function(t,e,n){if(1===t.length&&"object"===typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var i=!0,r="";mx=void 0;var o=t[0];null==o||void 0===o.raw?(i=!1,r+=gx(n,e,o)):r+=o[0];for(var a=1;a<t.length;a++)r+=gx(n,e,t[a]),i&&(r+=o[a]);yx.lastIndex=0;for(var s,l="";null!==(s=yx.exec(r));)l+="-"+s[1];return{name:sx(r)+l,styles:r,next:mx}},_x=(0,t.createContext)("undefined"!==typeof HTMLElement?ax({key:"css"}):null);_x.Provider;var bx=function(e){return(0,t.forwardRef)((function(n,i){var r=(0,t.useContext)(_x);return e(n,r,i)}))},xx=(0,t.createContext)({});e.useInsertionEffect&&e.useInsertionEffect;function wx(t,e,n){var i="";return n.split(" ").forEach((function(n){void 0!==t[n]?e.push(t[n]+";"):i+=n+" "})),i}var Sx=function(t,e,n){var i=t.key+"-"+e.name;!1===n&&void 0===t.registered[i]&&(t.registered[i]=e.styles)},Px=ib,Ex=function(t){return"theme"!==t},Tx=function(t){return"string"===typeof t&&t.charCodeAt(0)>96?Px:Ex},kx=function(t,e,n){var i;if(e){var r=e.shouldForwardProp;i=t.__emotion_forwardProp&&r?function(e){return t.__emotion_forwardProp(e)&&r(e)}:r}return"function"!==typeof i&&n&&(i=t.__emotion_forwardProp),i},Ax=e.useInsertionEffect?e.useInsertionEffect:function(t){t()};var Cx=function(t){var e=t.cache,n=t.serialized,i=t.isStringTag;Sx(e,n,i);!function(t){Ax(t)}((function(){return function(t,e,n){Sx(t,e,n);var i=t.key+"-"+e.name;if(void 0===t.inserted[e.name]){var r=e;do{t.insert(e===r?"."+i:"",r,t.sheet,!0),r=r.next}while(void 0!==r)}}(e,n,i)}));return null};const Mx=function e(n,i){var o,a,s=n.__emotion_real===n,l=s&&n.__emotion_base||n;void 0!==i&&(o=i.label,a=i.target);var c=kx(n,i,s),u=c||Tx(l),h=!u("as");return function(){var p=arguments,d=s&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==o&&d.push("label:"+o+";"),null==p[0]||void 0===p[0].raw)d.push.apply(d,p);else{0,d.push(p[0][0]);for(var f=p.length,g=1;g<f;g++)d.push(p[g],p[0][g])}var m=bx((function(e,n,i){var r=h&&e.as||l,o="",s=[],p=e;if(null==e.theme){for(var f in p={},e)p[f]=e[f];p.theme=(0,t.useContext)(xx)}"string"===typeof e.className?o=wx(n.registered,s,e.className):null!=e.className&&(o=e.className+" ");var g=vx(d.concat(s),n.registered,p);o+=n.key+"-"+g.name,void 0!==a&&(o+=" "+a);var m=h&&void 0===c?Tx(r):u,y={};for(var v in e)h&&"as"===v||m(v)&&(y[v]=e[v]);return y.className=o,y.ref=i,(0,t.createElement)(t.Fragment,null,(0,t.createElement)(Cx,{cache:n,serialized:g,isStringTag:"string"===typeof r}),(0,t.createElement)(r,y))}));return m.displayName=void 0!==o?o:"Styled("+("string"===typeof l?l:l.displayName||l.name||"Component")+")",m.defaultProps=n.defaultProps,m.__emotion_real=m,m.__emotion_base=l,m.__emotion_styles=d,m.__emotion_forwardProp=c,Object.defineProperty(m,"toString",{value:function(){return"."+a}}),m.withComponent=function(t,n){return e(t,r({},i,n,{shouldForwardProp:kx(m,n,!0)})).apply(void 0,d)},m}};var Ix=Mx.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(t){Ix[t]=Ix(t)}));const Lx=Ix;function Ox(t,e){return Lx(t,e)}const zx=["variant"];function Rx(t){return 0===t.length}function Dx(t){const{variant:e}=t,n=pi(t,zx);let i=e||"";return Object.keys(n).sort().forEach((e=>{i+="color"===e?Rx(i)?t[e]:Xv(t[e]):"".concat(Rx(i)?e:Xv(e)).concat(Xv(t[e].toString()))})),i}const Fx=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.reduce(((t,e)=>(e.filterProps.forEach((n=>{t[n]=e})),t)),{}),r=t=>Object.keys(t).reduce(((e,n)=>i[n]?Qv(e,i[n](t)):e),{});return r.propTypes={},r.filterProps=e.reduce(((t,e)=>t.concat(e.filterProps)),[]),r};function Bx(t){return"number"!==typeof t?t:"".concat(t,"px solid")}const jx=Jv({prop:"border",themeKey:"borders",transform:Bx}),Nx=Jv({prop:"borderTop",themeKey:"borders",transform:Bx}),Vx=Jv({prop:"borderRight",themeKey:"borders",transform:Bx}),Ux=Jv({prop:"borderBottom",themeKey:"borders",transform:Bx}),Wx=Jv({prop:"borderLeft",themeKey:"borders",transform:Bx}),Gx=Jv({prop:"borderColor",themeKey:"palette"}),qx=Jv({prop:"borderTopColor",themeKey:"palette"}),Zx=Jv({prop:"borderRightColor",themeKey:"palette"}),Hx=Jv({prop:"borderBottomColor",themeKey:"palette"}),Xx=Jv({prop:"borderLeftColor",themeKey:"palette"}),Yx=t=>{if(void 0!==t.borderRadius&&null!==t.borderRadius){const e=a_(t.theme,"shape.borderRadius",4),n=t=>({borderRadius:l_(e,t)});return qv(t,t.borderRadius,n)}return null};Yx.propTypes={},Yx.filterProps=["borderRadius"];const Kx=Fx(jx,Nx,Vx,Ux,Wx,Gx,qx,Zx,Hx,Xx,Yx),Jx=Fx(Jv({prop:"displayPrint",cssProperty:!1,transform:t=>({"@media print":{display:t}})}),Jv({prop:"display"}),Jv({prop:"overflow"}),Jv({prop:"textOverflow"}),Jv({prop:"visibility"}),Jv({prop:"whiteSpace"})),Qx=Fx(Jv({prop:"flexBasis"}),Jv({prop:"flexDirection"}),Jv({prop:"flexWrap"}),Jv({prop:"justifyContent"}),Jv({prop:"alignItems"}),Jv({prop:"alignContent"}),Jv({prop:"order"}),Jv({prop:"flex"}),Jv({prop:"flexGrow"}),Jv({prop:"flexShrink"}),Jv({prop:"alignSelf"}),Jv({prop:"justifyItems"}),Jv({prop:"justifySelf"})),$x=t=>{if(void 0!==t.gap&&null!==t.gap){const e=a_(t.theme,"spacing",8),n=t=>({gap:l_(e,t)});return qv(t,t.gap,n)}return null};$x.propTypes={},$x.filterProps=["gap"];const tw=t=>{if(void 0!==t.columnGap&&null!==t.columnGap){const e=a_(t.theme,"spacing",8),n=t=>({columnGap:l_(e,t)});return qv(t,t.columnGap,n)}return null};tw.propTypes={},tw.filterProps=["columnGap"];const ew=t=>{if(void 0!==t.rowGap&&null!==t.rowGap){const e=a_(t.theme,"spacing",8),n=t=>({rowGap:l_(e,t)});return qv(t,t.rowGap,n)}return null};ew.propTypes={},ew.filterProps=["rowGap"];const nw=Fx($x,tw,ew,Jv({prop:"gridColumn"}),Jv({prop:"gridRow"}),Jv({prop:"gridAutoFlow"}),Jv({prop:"gridAutoColumns"}),Jv({prop:"gridAutoRows"}),Jv({prop:"gridTemplateColumns"}),Jv({prop:"gridTemplateRows"}),Jv({prop:"gridTemplateAreas"}),Jv({prop:"gridArea"})),iw=Fx(Jv({prop:"position"}),Jv({prop:"zIndex",themeKey:"zIndex"}),Jv({prop:"top"}),Jv({prop:"right"}),Jv({prop:"bottom"}),Jv({prop:"left"})),rw=Fx(Jv({prop:"color",themeKey:"palette"}),Jv({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),Jv({prop:"backgroundColor",themeKey:"palette"})),ow=Jv({prop:"boxShadow",themeKey:"shadows"});function aw(t){return t<=1&&0!==t?"".concat(100*t,"%"):t}const sw=Jv({prop:"width",transform:aw}),lw=t=>{if(void 0!==t.maxWidth&&null!==t.maxWidth){const e=e=>{var n,i,r;return{maxWidth:(null==(n=t.theme)||null==(i=n.breakpoints)||null==(r=i.values)?void 0:r[e])||Wv[e]||aw(e)}};return qv(t,t.maxWidth,e)}return null};lw.filterProps=["maxWidth"];const cw=Jv({prop:"minWidth",transform:aw}),uw=Jv({prop:"height",transform:aw}),hw=Jv({prop:"maxHeight",transform:aw}),pw=Jv({prop:"minHeight",transform:aw}),dw=(Jv({prop:"size",cssProperty:"width",transform:aw}),Jv({prop:"size",cssProperty:"height",transform:aw}),Fx(sw,lw,cw,uw,hw,pw,Jv({prop:"boxSizing"}))),fw=Jv({prop:"fontFamily",themeKey:"typography"}),gw=Jv({prop:"fontSize",themeKey:"typography"}),mw=Jv({prop:"fontStyle",themeKey:"typography"}),yw=Jv({prop:"fontWeight",themeKey:"typography"}),vw=Jv({prop:"letterSpacing"}),_w=Jv({prop:"textTransform"}),bw=Jv({prop:"lineHeight"}),xw=Jv({prop:"textAlign"}),ww=Fx(Jv({prop:"typography",cssProperty:!1,themeKey:"typography"}),fw,gw,mw,yw,vw,bw,xw,_w),Sw={borders:Kx.filterProps,display:Jx.filterProps,flexbox:Qx.filterProps,grid:nw.filterProps,positions:iw.filterProps,palette:rw.filterProps,shadows:ow.filterProps,sizing:dw.filterProps,spacing:f_.filterProps,typography:ww.filterProps},Pw={borders:Kx,display:Jx,flexbox:Qx,grid:nw,positions:iw,palette:rw,shadows:ow,sizing:dw,spacing:f_,typography:ww};Object.keys(Sw).reduce(((t,e)=>(Sw[e].forEach((n=>{t[n]=Pw[e]})),t)),{});function Ew(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.reduce(((t,e)=>t.concat(Object.keys(e))),[]),r=new Set(i);return e.every((t=>r.size===Object.keys(t).length))}function Tw(t,e){return"function"===typeof t?t(e):t}const kw=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pw;const e=Object.keys(t).reduce(((e,n)=>(t[n].filterProps.forEach((i=>{e[i]=t[n]})),e)),{});function n(t,n,i){const r={[t]:n,theme:i},o=e[t];return o?o(r):{[t]:n}}function i(t){const{sx:r,theme:o={}}=t||{};if(!r)return null;function a(t){let r=t;if("function"===typeof t)r=t(o);else if("object"!==typeof t)return t;if(!r)return null;const a=Zv(o.breakpoints),s=Object.keys(a);let l=a;return Object.keys(r).forEach((t=>{const a=Tw(r[t],o);if(null!==a&&void 0!==a)if("object"===typeof a)if(e[t])l=Qv(l,n(t,a,o));else{const e=qv({theme:o},a,(e=>({[t]:e})));Ew(e,a)?l[t]=i({sx:a,theme:o}):l=Qv(l,e)}else l=Qv(l,n(t,a,o))})),Hv(s,l)}return Array.isArray(r)?r.map(a):a(r)}return i}();kw.filterProps=["sx"];const Aw=kw,Cw=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],Mw=["theme"],Iw=["theme"];function Lw(t){return 0===Object.keys(t).length}const Ow=(t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null,zw=(t,e)=>{let n=[];e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants);const i={};return n.forEach((t=>{const e=Dx(t.props);i[e]=t.style})),i},Rw=(t,e,n,i)=>{var r,o;const{ownerState:a={}}=t,s=[],l=null==n||null==(r=n.components)||null==(o=r[i])?void 0:o.variants;return l&&l.forEach((n=>{let i=!0;Object.keys(n.props).forEach((e=>{a[e]!==n.props[e]&&t[e]!==n.props[e]&&(i=!1)})),i&&s.push(e[Dx(n.props)])})),s};function Dw(t){return"ownerState"!==t&&"theme"!==t&&"sx"!==t&&"as"!==t}const Fw=y_();const Bw=Dw,jw=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{defaultTheme:e=Fw,rootShouldForwardProp:n=Dw,slotShouldForwardProp:i=Dw,styleFunctionSx:o=Aw}=t;return function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{name:s,slot:l,skipVariantsResolver:c,skipSx:u,overridesResolver:h}=a,p=pi(a,Cw),d=void 0!==c?c:l&&"Root"!==l||!1,f=u||!1;let g;let m=Dw;"Root"===l?m=n:l&&(m=i);const y=Ox(t,r({shouldForwardProp:m,label:g},p)),v=function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];const l=i?i.map((t=>"function"===typeof t&&t.__emotion_real!==t?n=>{let{theme:i}=n,o=pi(n,Mw);return t(r({theme:Lw(i)?e:i},o))}:t)):[];let c=t;s&&h&&l.push((t=>{const n=Lw(t.theme)?e:t.theme,i=Ow(s,n);if(i){const e={};return Object.entries(i).forEach((i=>{let[o,a]=i;e[o]="function"===typeof a?a(r({},t,{theme:n})):a})),h(t,e)}return null})),s&&!d&&l.push((t=>{const n=Lw(t.theme)?e:t.theme;return Rw(t,zw(s,n),n,s)})),f||l.push((t=>{const n=Lw(t.theme)?e:t.theme;return o(r({},t,{theme:n}))}));const u=l.length-i.length;if(Array.isArray(t)&&u>0){const e=new Array(u).fill("");c=[...t,...e],c.raw=[...t.raw,...e]}else"function"===typeof t&&t.__emotion_real!==t&&(c=n=>{let{theme:i}=n,o=pi(n,Iw);return t(r({theme:Lw(i)?e:i},o))});const p=y(c,...l);return p};return y.withConfig&&(v.withConfig=y.withConfig),v}}({defaultTheme:$_,rootShouldForwardProp:t=>Dw(t)&&"classes"!==t}),Nw=jw;const Vw=t=>!t||!Hy(t),Uw=Xv,Ww=["component","components","componentsProps","color","size"],Gw=r({},Gy,Uy("MuiSlider",["colorPrimary","colorSecondary","thumbColorPrimary","thumbColorSecondary","sizeSmall","thumbSizeSmall"])),qw=Nw("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t,i=!0===n.marksProp&&null!==n.step?[...Array(Math.floor((n.max-n.min)/n.step)+1)].map(((t,e)=>({value:n.min+n.step*e}))):n.marksProp||[],r=i.length>0&&i.some((t=>t.label));return[e.root,e["color".concat(Uw(n.color))],"medium"!==n.size&&e["size".concat(Uw(n.size))],r&&e.marked,"vertical"===n.orientation&&e.vertical,"inverted"===n.track&&e.trackInverted,!1===n.track&&e.trackFalse]}})((t=>{let{theme:e,ownerState:n}=t;return r({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:e.palette[n.color].main,WebkitTapHighlightColor:"transparent"},"horizontal"===n.orientation&&r({height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}},"small"===n.size&&{height:2},n.marked&&{marginBottom:20}),"vertical"===n.orientation&&r({height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}},"small"===n.size&&{width:2},n.marked&&{marginRight:44}),{"@media print":{colorAdjust:"exact"},["&.".concat(Gw.disabled)]:{pointerEvents:"none",cursor:"default",color:e.palette.grey[400]},["&.".concat(Gw.dragging)]:{["& .".concat(Gw.thumb,", & .").concat(Gw.track)]:{transition:"none"}}})})),Zw=Nw("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})((t=>{let{ownerState:e}=t;return r({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38},"horizontal"===e.orientation&&{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"},"vertical"===e.orientation&&{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"},"inverted"===e.track&&{opacity:1})})),Hw=Nw("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})((t=>{let{theme:e,ownerState:n}=t;const i="light"===e.palette.mode?Dv(e.palette[n.color].main,.62):Rv(e.palette[n.color].main,.5);return r({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:e.transitions.create(["left","width","bottom","height"],{duration:e.transitions.duration.shortest})},"small"===n.size&&{border:"none"},"horizontal"===n.orientation&&{height:"inherit",top:"50%",transform:"translateY(-50%)"},"vertical"===n.orientation&&{width:"inherit",left:"50%",transform:"translateX(-50%)"},!1===n.track&&{display:"none"},"inverted"===n.track&&{backgroundColor:i,borderColor:i})})),Xw=Nw("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e["thumbColor".concat(Uw(n.color))],"medium"!==n.size&&e["thumbSize".concat(Uw(n.size))]]}})((t=>{let{theme:e,ownerState:n}=t;return r({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:e.transitions.create(["box-shadow","left","bottom"],{duration:e.transitions.duration.shortest})},"small"===n.size&&{width:12,height:12},"horizontal"===n.orientation&&{top:"50%",transform:"translate(-50%, -50%)"},"vertical"===n.orientation&&{left:"50%",transform:"translate(-50%, 50%)"},{"&:before":r({position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:e.shadows[2]},"small"===n.size&&{boxShadow:"none"}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},["&:hover, &.".concat(Gw.focusVisible)]:{boxShadow:"0px 0px 0px 8px ".concat(zv(e.palette[n.color].main,.16)),"@media (hover: none)":{boxShadow:"none"}},["&.".concat(Gw.active)]:{boxShadow:"0px 0px 0px 14px ".concat(zv(e.palette[n.color].main,.16))},["&.".concat(Gw.disabled)]:{"&:hover":{boxShadow:"none"}}})})),Yw=Nw(Zy,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})((t=>{let{theme:e,ownerState:n}=t;return r({["&.".concat(Gw.valueLabelOpen)]:{transform:"translateY(-100%) scale(1)"},zIndex:1,whiteSpace:"nowrap"},e.typography.body2,{fontWeight:500,transition:e.transitions.create(["transform"],{duration:e.transitions.duration.shortest}),top:-10,transformOrigin:"bottom center",transform:"translateY(-100%) scale(0)",position:"absolute",backgroundColor:e.palette.grey[600],borderRadius:2,color:e.palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem"},"small"===n.size&&{fontSize:e.typography.pxToRem(12),padding:"0.25rem 0.5rem"},{"&:before":{position:"absolute",content:'""',width:8,height:8,bottom:0,left:"50%",transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit"}})})),Kw=Nw("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>Bw(t)&&"markActive"!==t,overridesResolver:(t,e)=>e.mark})((t=>{let{theme:e,ownerState:n,markActive:i}=t;return r({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},"horizontal"===n.orientation&&{top:"50%",transform:"translate(-1px, -50%)"},"vertical"===n.orientation&&{left:"50%",transform:"translate(-50%, 1px)"},i&&{backgroundColor:e.palette.background.paper,opacity:.8})})),Jw=Nw("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>Bw(t)&&"markLabelActive"!==t,overridesResolver:(t,e)=>e.markLabel})((t=>{let{theme:e,ownerState:n,markLabelActive:i}=t;return r({},e.typography.body2,{color:e.palette.text.secondary,position:"absolute",whiteSpace:"nowrap"},"horizontal"===n.orientation&&{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}},"vertical"===n.orientation&&{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}},i&&{color:e.palette.text.primary})})),Qw=t.forwardRef((function(t,e){var n,i,o,a;const s=tb({props:t,name:"MuiSlider"}),l="rtl"===S_($_).direction,{component:c="span",components:u={},componentsProps:h={},color:p="primary",size:d="medium"}=s,f=pi(s,Ww),g=(t=>{const{color:e,size:n,classes:i={}}=t;return r({},i,{root:Fy(i.root,Wy("color".concat(Uw(e))),i["color".concat(Uw(e))],n&&[Wy("size".concat(Uw(n))),i["size".concat(Uw(n))]]),thumb:Fy(i.thumb,Wy("thumbColor".concat(Uw(e))),i["thumbColor".concat(Uw(e))],n&&[Wy("thumbSize".concat(Uw(n))),i["thumbSize".concat(Uw(n))]])})})(r({},s,{color:p,size:d}));return(0,qy.jsx)(Av,r({},f,{isRtl:l,components:r({Root:qw,Rail:Zw,Track:Hw,Thumb:Xw,ValueLabel:Yw,Mark:Kw,MarkLabel:Jw},u),componentsProps:r({},h,{root:r({},h.root,Vw(u.Root)&&{as:c,ownerState:r({},null==(n=h.root)?void 0:n.ownerState,{color:p,size:d})}),thumb:r({},h.thumb,Vw(u.Thumb)&&{ownerState:r({},null==(i=h.thumb)?void 0:i.ownerState,{color:p,size:d})}),track:r({},h.track,Vw(u.Track)&&{ownerState:r({},null==(o=h.track)?void 0:o.ownerState,{color:p,size:d})}),valueLabel:r({},h.valueLabel,Vw(u.ValueLabel)&&{ownerState:r({},null==(a=h.valueLabel)?void 0:a.ownerState,{color:p,size:d})})}),classes:g,ref:e}))})),$w=Qw,tS=new Lr({color:[255,255,255],intensity:1}),eS=new class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e=_a}=t,{intensity:n=ba}=t,{position:i=wa}=t;this.id=t.id||"point-".concat(Sa++),this.color=e,this.intensity=n,this.type="point",this.position=i,this.attenuation=function(t){if("attenuation"in t)return t.attenuation;if("intensity"in t)return[0,0,t.intensity];return xa}(t),this.projectedLight={...this}}getProjectedLight(t){let{layer:e}=t;const{projectedLight:n}=this,i=e.context.viewport,{coordinateSystem:r,coordinateOrigin:o}=e.props,a=va(this.position,{viewport:i,coordinateSystem:r,coordinateOrigin:o,fromCoordinateSystem:i.isGeospatial?no.LNGLAT:no.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=a,n}}({color:[255,255,255],intensity:2,position:[-74.05,40.7,8e3]}),nS={buildingColor:[74,80,87],trailColor0:[253,128,93],trailColor1:[23,184,190],material:{ambient:.1,diffuse:.6,shininess:32,specularColor:[60,64,70]},effects:[new Cu({ambientLight:tS,pointLight:eS})]},iS={longitude:126.97799,latitude:37.566535,zoom:10.9,minZoom:5,maxZoom:16,pitch:50,bearing:0},rS=[[[-74,40.7],[-74.02,40.7],[-74.02,40.72],[-74,40.72]]],oS={marker:{x:0,y:0,width:128,height:128,mask:!0}};function aS(t){const e=nS,n=t.time,i=t.trip,r=t.empty,o=t.ps,a=t.range,s=t.maxWaitTime,l=function(t,e){const n=[];return Object.values(e).forEach((e=>{const i=e.path,r=e.timestamp,[o,a]=2===r.length?r:[r[0],r[0]];t>=o&&t<=a&&n.push(i)})),n}(n,r),c=function(t,e,n,i){const r=parseInt(i/n),o=[];return Object.values(e).forEach((e=>{const i=e.path,a=e.timestamp,[s,l]=2===a.length?a:[a[0],a[0]];if(t>=s&&t<=l){const a=parseInt((t-s)/n),l=Number(255-255/r*a),c=l>=0&&l<=255?l:0,u=1===e.fail?[255,2*c,0]:[255,c,0];o.push({path:i,color:u})}})),o}(n,o,a,s);return[new xy({id:"ground",data:rS,getPolygon:t=>t,stroked:!1,getFillColor:[0,0,0,0]}),new Ry({id:"trips",data:i,getPath:t=>t.path,getTimestamps:t=>t.timestamps,getColor:t=>0===t.vendor?e.trailColor0:e.trailColor1,opacity:.3,widthMinPixels:5,lineJointRounded:!1,trailLength:.5,currentTime:n,shadowEnabled:!1}),new Py({id:"scatterplot",data:l,getPosition:t=>[t[0],t[1]],getFillColor:t=>[255,255,255],getRadius:t=>50,opacity:.9,pickable:!1,radiusMinPixels:3,radiusMaxPixels:30}),new zy({id:"icon-layer",data:c,sizeScale:15,iconAtlas:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/icon-atlas.png",iconMapping:oS,getIcon:t=>"marker",getSize:t=>1,getPosition:t=>t.path,getColor:t=>t.color,opacity:.9,pickable:!1,radiusMinPixels:3,radiusMaxPixels:30})]}function sS(e){const n=e.minTime,i=e.maxTime,r=e.range,o=e.maxWaitTime,a=e.time,s=e.trip,l=e.empty,c=e.ps,u=e.driveTaxiNum,h=e.emptyTaxiNum,p=e.successPsCumsum,d=e.failPsCumsum,f=e.waitPsNum,g=e.meanWaitTime,[m,y]=(0,t.useState)("");function v(){e.setTime((t=>t>i?n:t+.02));const t=window.requestAnimationFrame(v);y(t)}return(0,t.useEffect)((()=>{e.setTime(a)}),[a]),(0,t.useEffect)((()=>(v(),()=>window.cancelAnimationFrame(m))),[]),(0,qy.jsxs)("div",{className:"trip-container",style:{position:"relative"},children:[(0,qy.jsx)(lm,{layers:aS({trip:s,empty:l,ps:c,time:a,range:r,maxWaitTime:o}),effects:nS.effects,viewState:undefined,controller:!0,initialViewState:iS,children:(0,qy.jsx)(_e,{mapStyle:"mapbox://styles/spear5306/ckzcz5m8w002814o2coz02sjc",preventStyleDiffing:!0,mapboxApiAccessToken:"pk.eyJ1Ijoic3BlYXI1MzA2IiwiYSI6ImNremN5Z2FrOTI0ZGgycm45Mzh3dDV6OWQifQ.kXGWHPRjnVAEHgVgLzXn2g"})}),(0,qy.jsxs)("h1",{className:"time",children:["TIME : ",2===String(parseInt(Math.round(a)/60)%24).length?parseInt(Math.round(a)/60)%24:"0"+String(parseInt(Math.round(a)/60)%24)," : ",2===String(Math.round(a)%60).length?Math.round(a)%60:"0"+String(Math.round(a)%60)]}),(0,qy.jsxs)("div",{className:"subtext",children:[(0,qy.jsxs)("div",{children:["- \ud604\uc7ac \uc6b4\ud589\uc911\uc778 \ud0dd\uc2dc\xa0\xa0\xa0\xa0\xa0\xa0\xa0: ",u,"\ub300"]}),(0,qy.jsxs)("div",{children:["- \ud604\uc7ac \ube44\uc5b4\uc788\ub294 \ud0dd\uc2dc\xa0\xa0\xa0\xa0\xa0\xa0\xa0: ",h,"\ub300"]}),(0,qy.jsxs)("div",{children:["- \ubc30\ucc28 \uc131\uacf5 \ub204\uc801 \uc2b9\uac1d \uc218\xa0: ",p,"\uba85"]}),(0,qy.jsxs)("div",{children:["- \ubc30\ucc28 \uc2e4\ud328 \ub204\uc801 \uc2b9\uac1d \uc218\xa0: ",d,"\uba85"]}),(0,qy.jsxs)("div",{children:["- \ud0d1\uc2b9 \ub300\uae30 \uc2b9\uac1d \uc218\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0: ",f,"\uba85"]}),(0,qy.jsxs)("div",{children:["- \ud3c9\uade0 \ub300\uae30 \uc2dc\uac04\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0: ",g,"\ubd84"]})]}),(0,qy.jsx)($w,{id:"slider",value:a,min:n,max:i,onChange:function(t){e.setTime(t.target.value)},track:"inverted"})]})}const lS="undefined"===typeof window?function(t){return t()}:window.requestAnimationFrame;function cS(t,e,n){const i=n||(t=>Array.prototype.slice.call(t));let r=!1,o=[];return function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];o=i(a),r||(r=!0,lS.call(window,(()=>{r=!1,t.apply(e,o)})))}}const uS=t=>"start"===t?"left":"end"===t?"right":"center",hS=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2;function pS(){}const dS=function(){let t=0;return function(){return t++}}();function fS(t){return null===t||"undefined"===typeof t}function gS(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)}function mS(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}const yS=t=>("number"===typeof t||t instanceof Number)&&isFinite(+t);function vS(t,e){return yS(t)?t:e}function _S(t,e){return"undefined"===typeof t?e:t}const bS=(t,e)=>"string"===typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function xS(t,e,n){if(t&&"function"===typeof t.call)return t.apply(n,e)}function wS(t,e,n,i){let r,o,a;if(gS(t))if(o=t.length,i)for(r=o-1;r>=0;r--)e.call(n,t[r],r);else for(r=0;r<o;r++)e.call(n,t[r],r);else if(mS(t))for(a=Object.keys(t),o=a.length,r=0;r<o;r++)e.call(n,t[a[r]],a[r])}function SS(t,e){let n,i,r,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(r=t[n],o=e[n],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function PS(t){if(gS(t))return t.map(PS);if(mS(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let r=0;for(;r<i;++r)e[n[r]]=PS(t[n[r]]);return e}return t}function ES(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function TS(t,e,n,i){if(!ES(t))return;const r=e[t],o=n[t];mS(r)&&mS(o)?kS(r,o,i):e[t]=PS(o)}function kS(t,e,n){const i=gS(e)?e:[e],r=i.length;if(!mS(t))return t;const o=(n=n||{}).merger||TS;for(let a=0;a<r;++a){if(!mS(e=i[a]))continue;const r=Object.keys(e);for(let i=0,a=r.length;i<a;++i)o(r[i],t,e,n)}return t}function AS(t,e){return kS(t,e,{merger:CS})}function CS(t,e,n){if(!ES(t))return;const i=e[t],r=n[t];mS(i)&&mS(r)?AS(i,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=PS(r))}function MS(t,e){const n=t.indexOf(".",e);return-1===n?t.length:n}function IS(t,e){if(""===e)return t;let n=0,i=MS(e,n);for(;t&&i>n;)t=t[e.substr(n,i-n)],n=i+1,i=MS(e,n);return t}function LS(t){return t.charAt(0).toUpperCase()+t.slice(1)}const OS=t=>"undefined"!==typeof t,zS=t=>"function"===typeof t,RS=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};const DS=Math.PI,FS=2*DS,BS=FS+DS,jS=Number.POSITIVE_INFINITY,NS=DS/180,VS=DS/2,US=DS/4,WS=2*DS/3,GS=Math.log10,qS=Math.sign;function ZS(t){const e=Math.round(t);t=XS(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(GS(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function HS(t){return!isNaN(parseFloat(t))&&isFinite(t)}function XS(t,e,n){return Math.abs(t-e)<n}function YS(t,e,n){let i,r,o;for(i=0,r=t.length;i<r;i++)o=t[i][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function KS(t){return t*(DS/180)}function JS(t){return t*(180/DS)}function QS(t){if(!yS(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function $S(t,e){const n=e.x-t.x,i=e.y-t.y,r=Math.sqrt(n*n+i*i);let o=Math.atan2(i,n);return o<-.5*DS&&(o+=FS),{angle:o,distance:r}}function tP(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function eP(t,e){return(t-e+BS)%FS-DS}function nP(t){return(t%FS+FS)%FS}function iP(t,e,n,i){const r=nP(t),o=nP(e),a=nP(n),s=nP(o-r),l=nP(a-r),c=nP(r-o),u=nP(r-a);return r===o||r===a||i&&o===a||s>l&&c<u}function rP(t,e,n){return Math.max(e,Math.min(n,t))}function oP(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}const aP=t=>0===t||1===t,sP=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*FS/n),lP=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*FS/n)+1,cP={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*VS),easeOutSine:t=>Math.sin(t*VS),easeInOutSine:t=>-.5*(Math.cos(DS*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>aP(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>aP(t)?t:sP(t,.075,.3),easeOutElastic:t=>aP(t)?t:lP(t,.075,.3),easeInOutElastic(t){const e=.1125;return aP(t)?t:t<.5?.5*sP(2*t,e,.45):.5+.5*lP(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-cP.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*cP.easeInBounce(2*t):.5*cP.easeOutBounce(2*t-1)+.5},uP={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hP="0123456789ABCDEF",pP=t=>hP[15&t],dP=t=>hP[(240&t)>>4]+hP[15&t],fP=t=>(240&t)>>4===(15&t);function gP(t){var e=function(t){return fP(t.r)&&fP(t.g)&&fP(t.b)&&fP(t.a)}(t)?pP:dP;return t?"#"+e(t.r)+e(t.g)+e(t.b)+(t.a<255?e(t.a):""):t}function mP(t){return t+.5|0}const yP=(t,e,n)=>Math.max(Math.min(t,n),e);function vP(t){return yP(mP(2.55*t),0,255)}function _P(t){return yP(mP(255*t),0,255)}function bP(t){return yP(mP(t/2.55)/100,0,1)}function xP(t){return yP(mP(100*t),0,100)}const wP=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const SP=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function PP(t,e,n){const i=e*Math.min(n,1-n),r=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+t/30)%12;return n-i*Math.max(Math.min(r-3,9-r,1),-1)};return[r(0),r(8),r(4)]}function EP(t,e,n){const i=function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(i+t/60)%6;return n-n*e*Math.max(Math.min(r,4-r,1),0)};return[i(5),i(3),i(1)]}function TP(t,e,n){const i=PP(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)i[r]*=1-e-n,i[r]+=e;return i}function kP(t){const e=t.r/255,n=t.g/255,i=t.b/255,r=Math.max(e,n,i),o=Math.min(e,n,i),a=(r+o)/2;let s,l,c;return r!==o&&(c=r-o,l=a>.5?c/(2-r-o):c/(r+o),s=r===e?(n-i)/c+(n<i?6:0):r===n?(i-e)/c+2:(e-n)/c+4,s=60*s+.5),[0|s,l||0,a]}function AP(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(_P)}function CP(t,e,n){return AP(PP,t,e,n)}function MP(t){return(t%360+360)%360}function IP(t){const e=SP.exec(t);let n,i=255;if(!e)return;e[5]!==n&&(i=e[6]?vP(+e[5]):_P(+e[5]));const r=MP(+e[2]),o=+e[3]/100,a=+e[4]/100;return n="hwb"===e[1]?function(t,e,n){return AP(TP,t,e,n)}(r,o,a):"hsv"===e[1]?function(t,e,n){return AP(EP,t,e,n)}(r,o,a):CP(r,o,a),{r:n[0],g:n[1],b:n[2],a:i}}const LP={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},OP={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let zP;function RP(t){zP||(zP=function(){const t={},e=Object.keys(OP),n=Object.keys(LP);let i,r,o,a,s;for(i=0;i<e.length;i++){for(a=s=e[i],r=0;r<n.length;r++)o=n[r],s=s.replace(o,LP[o]);o=parseInt(OP[a],16),t[s]=[o>>16&255,o>>8&255,255&o]}return t}(),zP.transparent=[0,0,0,0]);const e=zP[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}function DP(t,e,n){if(t){let i=kP(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,0===e?360:1)),i=CP(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function FP(t,e){return t?Object.assign(e||{},t):t}function BP(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=_P(t[3]))):(e=FP(t,{r:0,g:0,b:0,a:1})).a=_P(e.a),e}function jP(t){return"r"===t.charAt(0)?function(t){const e=wP.exec(t);let n,i,r,o=255;if(e){if(e[7]!==n){const t=+e[7];o=255&(e[8]?vP(t):255*t)}return n=+e[1],i=+e[3],r=+e[5],n=255&(e[2]?vP(n):n),i=255&(e[4]?vP(i):i),r=255&(e[6]?vP(r):r),{r:n,g:i,b:r,a:o}}}(t):IP(t)}class NP{constructor(t){if(t instanceof NP)return t;const e=typeof t;let n;"object"===e?n=BP(t):"string"===e&&(n=function(t){var e,n=t.length;return"#"===t[0]&&(4===n||5===n?e={r:255&17*uP[t[1]],g:255&17*uP[t[2]],b:255&17*uP[t[3]],a:5===n?17*uP[t[4]]:255}:7!==n&&9!==n||(e={r:uP[t[1]]<<4|uP[t[2]],g:uP[t[3]]<<4|uP[t[4]],b:uP[t[5]]<<4|uP[t[6]],a:9===n?uP[t[7]]<<4|uP[t[8]]:255})),e}(t)||RP(t)||jP(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=FP(this._rgb);return t&&(t.a=bP(t.a)),t}set rgb(t){this._rgb=BP(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(bP(t.a),")"):"rgb(".concat(t.r,", ").concat(t.g,", ").concat(t.b,")")):this._rgb;var t}hexString(){return this._valid?gP(this._rgb):this._rgb}hslString(){return this._valid?function(t){if(!t)return;const e=kP(t),n=e[0],i=xP(e[1]),r=xP(e[2]);return t.a<255?"hsla(".concat(n,", ").concat(i,"%, ").concat(r,"%, ").concat(bP(t.a),")"):"hsl(".concat(n,", ").concat(i,"%, ").concat(r,"%)")}(this._rgb):this._rgb}mix(t,e){const n=this;if(t){const i=n.rgb,r=t.rgb;let o;const a=e===o?.5:e,s=2*a-1,l=i.a-r.a,c=((s*l===-1?s:(s+l)/(1+s*l))+1)/2;o=1-c,i.r=255&c*i.r+o*r.r+.5,i.g=255&c*i.g+o*r.g+.5,i.b=255&c*i.b+o*r.b+.5,i.a=a*i.a+(1-a)*r.a,n.rgb=i}return n}clone(){return new NP(this.rgb)}alpha(t){return this._rgb.a=_P(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=mP(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return DP(this._rgb,2,t),this}darken(t){return DP(this._rgb,2,-t),this}saturate(t){return DP(this._rgb,1,t),this}desaturate(t){return DP(this._rgb,1,-t),this}rotate(t){return function(t,e){var n=kP(t);n[0]=MP(n[0]+e),n=CP(n),t.r=n[0],t.g=n[1],t.b=n[2]}(this._rgb,t),this}}function VP(t){return new NP(t)}const UP=t=>t instanceof CanvasGradient||t instanceof CanvasPattern;function WP(t){return UP(t)?t:VP(t)}function GP(t){return UP(t)?t:VP(t).saturate(.5).darken(.1).hexString()}const qP=Object.create(null),ZP=Object.create(null);function HP(t,e){if(!e)return t;const n=e.split(".");for(let i=0,r=n.length;i<r;++i){const e=n[i];t=t[e]||(t[e]=Object.create(null))}return t}function XP(t,e,n){return"string"===typeof e?kS(HP(t,e),n):kS(HP(t,""),e)}var YP=new class{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>GP(e.backgroundColor),this.hoverBorderColor=(t,e)=>GP(e.borderColor),this.hoverColor=(t,e)=>GP(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t)}set(t,e){return XP(this,t,e)}get(t){return HP(this,t)}describe(t,e){return XP(ZP,t,e)}override(t,e){return XP(qP,t,e)}route(t,e,n,i){const r=HP(this,t),o=HP(this,n),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[a],e=o[i];return mS(t)?Object.assign({},e,t):_S(t,e)},set(t){this[a]=t}}})}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function KP(t,e,n,i,r){let o=e[r];return o||(o=e[r]=t.measureText(r).width,n.push(r)),o>i&&(i=o),i}function JP(t,e,n,i){let r=(i=i||{}).data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},o=i.garbageCollect=[],i.font=e),t.save(),t.font=e;let a=0;const s=n.length;let l,c,u,h,p;for(l=0;l<s;l++)if(h=n[l],void 0!==h&&null!==h&&!0!==gS(h))a=KP(t,r,o,a,h);else if(gS(h))for(c=0,u=h.length;c<u;c++)p=h[c],void 0===p||null===p||gS(p)||(a=KP(t,r,o,a,p));t.restore();const d=o.length/2;if(d>n.length){for(l=0;l<d;l++)delete r[o[l]];o.splice(0,d)}return a}function QP(t,e,n){const i=t.currentDevicePixelRatio,r=0!==n?Math.max(n/2,.5):0;return Math.round((e-r)*i)/i+r}function $P(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function tE(t,e,n,i){let r,o,a,s,l;const c=e.pointStyle,u=e.rotation,h=e.radius;let p=(u||0)*NS;if(c&&"object"===typeof c&&(r=c.toString(),"[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r))return t.save(),t.translate(n,i),t.rotate(p),t.drawImage(c,-c.width/2,-c.height/2,c.width,c.height),void t.restore();if(!(isNaN(h)||h<=0)){switch(t.beginPath(),c){default:t.arc(n,i,h,0,FS),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(p)*h,i-Math.cos(p)*h),p+=WS,t.lineTo(n+Math.sin(p)*h,i-Math.cos(p)*h),p+=WS,t.lineTo(n+Math.sin(p)*h,i-Math.cos(p)*h),t.closePath();break;case"rectRounded":l=.516*h,s=h-l,o=Math.cos(p+US)*s,a=Math.sin(p+US)*s,t.arc(n-o,i-a,l,p-DS,p-VS),t.arc(n+a,i-o,l,p-VS,p),t.arc(n+o,i+a,l,p,p+VS),t.arc(n-a,i+o,l,p+VS,p+DS),t.closePath();break;case"rect":if(!u){s=Math.SQRT1_2*h,t.rect(n-s,i-s,2*s,2*s);break}p+=US;case"rectRot":o=Math.cos(p)*h,a=Math.sin(p)*h,t.moveTo(n-o,i-a),t.lineTo(n+a,i-o),t.lineTo(n+o,i+a),t.lineTo(n-a,i+o),t.closePath();break;case"crossRot":p+=US;case"cross":o=Math.cos(p)*h,a=Math.sin(p)*h,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a),t.moveTo(n+a,i-o),t.lineTo(n-a,i+o);break;case"star":o=Math.cos(p)*h,a=Math.sin(p)*h,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a),t.moveTo(n+a,i-o),t.lineTo(n-a,i+o),p+=US,o=Math.cos(p)*h,a=Math.sin(p)*h,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a),t.moveTo(n+a,i-o),t.lineTo(n-a,i+o);break;case"line":o=Math.cos(p)*h,a=Math.sin(p)*h,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(p)*h,i+Math.sin(p)*h)}t.fill(),e.borderWidth>0&&t.stroke()}}function eE(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function nE(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function iE(t){t.restore()}function rE(t,e,n,i,r){if(!e)return t.lineTo(n.x,n.y);if("middle"===r){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else"after"===r!==!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function oE(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function aE(t,e,n,i,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=gS(e)?e:[e],s=o.strokeWidth>0&&""!==o.strokeColor;let l,c;for(t.save(),t.font=r.string,sE(t,o),l=0;l<a.length;++l)c=a[l],s&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),fS(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(c,n,i,o.maxWidth)),t.fillText(c,n,i,o.maxWidth),lE(t,n,i,c,o),i+=r.lineHeight;t.restore()}function sE(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),fS(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function lE(t,e,n,i,r){if(r.strikethrough||r.underline){const o=t.measureText(i),a=e-o.actualBoundingBoxLeft,s=e+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,c=n+o.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(a,u),t.lineTo(s,u),t.stroke()}}function cE(t,e){const{x:n,y:i,w:r,h:o,radius:a}=e;t.arc(n+a.topLeft,i+a.topLeft,a.topLeft,-VS,DS,!0),t.lineTo(n,i+o-a.bottomLeft),t.arc(n+a.bottomLeft,i+o-a.bottomLeft,a.bottomLeft,DS,VS,!0),t.lineTo(n+r-a.bottomRight,i+o),t.arc(n+r-a.bottomRight,i+o-a.bottomRight,a.bottomRight,VS,0,!0),t.lineTo(n+r,i+a.topRight),t.arc(n+r-a.topRight,i+a.topRight,a.topRight,0,-VS,!0),t.lineTo(n+a.topLeft,i)}const uE=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),hE=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function pE(t,e){const n=(""+t).match(uE);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t}function dE(t,e){const n={},i=mS(e),r=i?Object.keys(e):e,o=mS(t)?i?n=>_S(t[n],t[e[n]]):e=>t[e]:()=>t;for(const a of r)n[a]=+o(a)||0;return n}function fE(t){return dE(t,{top:"y",right:"x",bottom:"y",left:"x"})}function gE(t){return dE(t,["topLeft","topRight","bottomLeft","bottomRight"])}function mE(t){const e=fE(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function yE(t,e){t=t||{},e=e||YP.font;let n=_S(t.size,e.size);"string"===typeof n&&(n=parseInt(n,10));let i=_S(t.style,e.style);i&&!(""+i).match(hE)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const r={family:_S(t.family,e.family),lineHeight:pE(_S(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:_S(t.weight,e.weight),string:""};return r.string=function(t){return!t||fS(t.size)||fS(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(r),r}function vE(t,e,n,i){let r,o,a,s=!0;for(r=0,o=t.length;r<o;++r)if(a=t[r],void 0!==a&&(void 0!==e&&"function"===typeof a&&(a=a(e),s=!1),void 0!==n&&gS(a)&&(a=a[n%a.length],s=!1),void 0!==a))return i&&!s&&(i.cacheable=!1),a}function _E(t,e){return Object.assign(Object.create(t),e)}function bE(t,e,n){n=n||(n=>t[n]<e);let i,r=t.length-1,o=0;for(;r-o>1;)i=o+r>>1,n(i)?o=i:r=i;return{lo:o,hi:r}}const xE=(t,e,n)=>bE(t,n,(i=>t[i][e]<n)),wE=(t,e,n)=>bE(t,n,(i=>t[i][e]>=n));const SE=["push","pop","shift","splice","unshift"];function PE(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(e);-1!==r&&i.splice(r,1),i.length>0||(SE.forEach((e=>{delete t[e]})),delete t._chartjs)}function EE(t){const e=new Set;let n,i;for(n=0,i=t.length;n<i;++n)e.add(t[n]);return e.size===i?t:Array.from(e)}function TE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>t[0];OS(i)||(i=BE("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:n,_fallback:i,_getTarget:r,override:r=>TE([r,...t],e,n,i)};return new Proxy(o,{deleteProperty:(e,n)=>(delete e[n],delete e._keys,delete t[0][n],!0),get:(n,i)=>IE(n,i,(()=>FE(i,e,t,n))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>jE(t).includes(e),ownKeys:t=>jE(t),set(t,e,n){const i=t._storage||(t._storage=r());return t[e]=i[e]=n,delete t._keys,!0}})}function kE(t,e,n,i){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:AE(t,i),setContext:e=>kE(t,e,n,i),override:r=>kE(t.override(r),e,n,i)};return new Proxy(r,{deleteProperty:(e,n)=>(delete e[n],delete t[n],!0),get:(t,e,n)=>IE(t,e,(()=>function(t,e,n){const{_proxy:i,_context:r,_subProxy:o,_descriptors:a}=t;let s=i[e];zS(s)&&a.isScriptable(e)&&(s=function(t,e,n,i){const{_proxy:r,_context:o,_subProxy:a,_stack:s}=n;if(s.has(t))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+t);s.add(t),e=e(o,a||i),s.delete(t),ME(t,e)&&(e=RE(r._scopes,r,t,e));return e}(e,s,t,n));gS(s)&&s.length&&(s=function(t,e,n,i){const{_proxy:r,_context:o,_subProxy:a,_descriptors:s}=n;if(OS(o.index)&&i(t))e=e[o.index%e.length];else if(mS(e[0])){const n=e,i=r._scopes.filter((t=>t!==n));e=[];for(const l of n){const n=RE(i,r,t,l);e.push(kE(n,o,a&&a[t],s))}}return e}(e,s,t,a.isIndexable));ME(e,s)&&(s=kE(s,r,o&&o[e],a));return s}(t,e,n))),getOwnPropertyDescriptor:(e,n)=>e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,n)=>Reflect.has(t,n),ownKeys:()=>Reflect.ownKeys(t),set:(e,n,i)=>(t[n]=i,delete e[n],!0)})}function AE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:i,isScriptable:zS(n)?n:()=>n,isIndexable:zS(i)?i:()=>i}}const CE=(t,e)=>t?t+LS(e):e,ME=(t,e)=>mS(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function IE(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const i=n();return t[e]=i,i}function LE(t,e,n){return zS(t)?t(e,n):t}const OE=(t,e)=>!0===t?e:"string"===typeof t?IS(e,t):void 0;function zE(t,e,n,i,r){for(const o of e){const e=OE(n,o);if(e){t.add(e);const o=LE(e._fallback,n,r);if(OS(o)&&o!==n&&o!==i)return o}else if(!1===e&&OS(i)&&n!==i)return null}return!1}function RE(t,e,n,i){const r=e._rootScopes,o=LE(e._fallback,n,i),a=[...t,...r],s=new Set;s.add(i);let l=DE(s,a,n,o||n,i);return null!==l&&((!OS(o)||o===n||(l=DE(s,a,o,l,i),null!==l))&&TE(Array.from(s),[""],r,o,(()=>function(t,e,n){const i=t._getTarget();e in i||(i[e]={});const r=i[e];if(gS(r)&&mS(n))return n;return r}(e,n,i))))}function DE(t,e,n,i,r){for(;n;)n=zE(t,e,n,i,r);return n}function FE(t,e,n,i){let r;for(const o of e)if(r=BE(CE(o,t),n),OS(r))return ME(t,r)?RE(n,i,t,r):r}function BE(t,e){for(const n of e){if(!n)continue;const e=n[t];if(OS(e))return e}}function jE(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}const NE=Number.EPSILON||1e-14,VE=(t,e)=>e<t.length&&!t[e].skip&&t[e],UE=t=>"x"===t?"y":"x";function WE(t,e,n,i){const r=t.skip?e:t,o=e,a=n.skip?e:n,s=tP(o,r),l=tP(a,o);let c=s/(s+l),u=l/(s+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=i*c,p=i*u;return{previous:{x:o.x-h*(a.x-r.x),y:o.y-h*(a.y-r.y)},next:{x:o.x+p*(a.x-r.x),y:o.y+p*(a.y-r.y)}}}function GE(t,e,n){const i=t.length;let r,o,a,s,l,c=VE(t,0);for(let u=0;u<i-1;++u)l=c,c=VE(t,u+1),l&&c&&(XS(e[u],0,NE)?n[u]=n[u+1]=0:(r=n[u]/e[u],o=n[u+1]/e[u],s=Math.pow(r,2)+Math.pow(o,2),s<=9||(a=3/Math.sqrt(s),n[u]=r*a*e[u],n[u+1]=o*a*e[u])))}function qE(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const i=UE(n),r=t.length;let o,a,s,l=VE(t,0);for(let c=0;c<r;++c){if(a=s,s=l,l=VE(t,c+1),!s)continue;const r=s[n],u=s[i];a&&(o=(r-a[n])/3,s["cp1".concat(n)]=r-o,s["cp1".concat(i)]=u-o*e[c]),l&&(o=(l[n]-r)/3,s["cp2".concat(n)]=r+o,s["cp2".concat(i)]=u+o*e[c])}}function ZE(t,e,n){return Math.max(Math.min(t,n),e)}function HE(t,e,n,i,r){let o,a,s,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)!function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=UE(e),i=t.length,r=Array(i).fill(0),o=Array(i);let a,s,l,c=VE(t,0);for(a=0;a<i;++a)if(s=l,l=c,c=VE(t,a+1),l){if(c){const t=c[e]-l[e];r[a]=0!==t?(c[n]-l[n])/t:0}o[a]=s?c?qS(r[a-1])!==qS(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}GE(t,r,o),qE(t,o,e)}(t,r);else{let n=i?t[t.length-1]:t[0];for(o=0,a=t.length;o<a;++o)s=t[o],l=WE(n,s,t[Math.min(o+1,a-(i?0:1))%a],e.tension),s.cp1x=l.previous.x,s.cp1y=l.previous.y,s.cp2x=l.next.x,s.cp2y=l.next.y,n=s}e.capBezierPoints&&function(t,e){let n,i,r,o,a,s=eE(t[0],e);for(n=0,i=t.length;n<i;++n)a=o,o=s,s=n<i-1&&eE(t[n+1],e),o&&(r=t[n],a&&(r.cp1x=ZE(r.cp1x,e.left,e.right),r.cp1y=ZE(r.cp1y,e.top,e.bottom)),s&&(r.cp2x=ZE(r.cp2x,e.left,e.right),r.cp2y=ZE(r.cp2y,e.top,e.bottom)))}(t,n)}function XE(){return"undefined"!==typeof window&&"undefined"!==typeof document}function YE(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function KE(t,e,n){let i;return"string"===typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[n])):i=t,i}const JE=t=>window.getComputedStyle(t,null);const QE=["top","right","bottom","left"];function $E(t,e,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const o=QE[r];i[o]=parseFloat(t[e+"-"+o+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function tT(t,e){const{canvas:n,currentDevicePixelRatio:i}=e,r=JE(n),o="border-box"===r.boxSizing,a=$E(r,"padding"),s=$E(r,"border","width"),{x:l,y:c,box:u}=function(t,e){const n=t.native||t,i=n.touches,r=i&&i.length?i[0]:n,{offsetX:o,offsetY:a}=r;let s,l,c=!1;if(((t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot))(o,a,n.target))s=o,l=a;else{const t=e.getBoundingClientRect();s=r.clientX-t.left,l=r.clientY-t.top,c=!0}return{x:s,y:l,box:c}}(t,n),h=a.left+(u&&s.left),p=a.top+(u&&s.top);let{width:d,height:f}=e;return o&&(d-=a.width+s.width,f-=a.height+s.height),{x:Math.round((l-h)/d*n.width/i),y:Math.round((c-p)/f*n.height/i)}}const eT=t=>Math.round(10*t)/10;function nT(t,e,n,i){const r=JE(t),o=$E(r,"margin"),a=KE(r.maxWidth,t,"clientWidth")||jS,s=KE(r.maxHeight,t,"clientHeight")||jS,l=function(t,e,n){let i,r;if(void 0===e||void 0===n){const o=YE(t);if(o){const t=o.getBoundingClientRect(),a=JE(o),s=$E(a,"border","width"),l=$E(a,"padding");e=t.width-l.width-s.width,n=t.height-l.height-s.height,i=KE(a.maxWidth,o,"clientWidth"),r=KE(a.maxHeight,o,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:i||jS,maxHeight:r||jS}}(t,e,n);let{width:c,height:u}=l;if("content-box"===r.boxSizing){const t=$E(r,"border","width"),e=$E(r,"padding");c-=e.width+t.width,u-=e.height+t.height}return c=Math.max(0,c-o.width),u=Math.max(0,i?Math.floor(c/i):u-o.height),c=eT(Math.min(c,a,l.maxWidth)),u=eT(Math.min(u,s,l.maxHeight)),c&&!u&&(u=eT(c/2)),{width:c,height:u}}function iT(t,e,n){const i=e||1,r=Math.floor(t.height*i),o=Math.floor(t.width*i);t.height=r/i,t.width=o/i;const a=t.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height="".concat(t.height,"px"),a.style.width="".concat(t.width,"px")),(t.currentDevicePixelRatio!==i||a.height!==r||a.width!==o)&&(t.currentDevicePixelRatio=i,a.height=r,a.width=o,t.ctx.setTransform(i,0,0,i,0,0),!0)}const rT=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}return t}();function oT(t,e){const n=function(t,e){return JE(t).getPropertyValue(e)}(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function aT(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function sT(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:"middle"===i?n<.5?t.y:e.y:"after"===i?n<1?t.y:e.y:n>0?e.y:t.y}}function lT(t,e,n,i){const r={x:t.cp2x,y:t.cp2y},o={x:e.cp1x,y:e.cp1y},a=aT(t,r,n),s=aT(r,o,n),l=aT(o,e,n),c=aT(a,s,n),u=aT(s,l,n);return aT(c,u,n)}const cT=new Map;function uT(t,e,n){return function(t,e){e=e||{};const n=t+JSON.stringify(e);let i=cT.get(n);return i||(i=new Intl.NumberFormat(t,e),cT.set(n,i)),i}(e,n).format(t)}function hT(t,e,n){return t?function(t,e){return{x:n=>t+t+e-n,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,n):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function pT(t,e){let n,i;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function dT(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function fT(t){return"angle"===t?{between:iP,compare:eP,normalize:nP}:{between:oP,compare:(t,e)=>t-e,normalize:t=>t}}function gT(t){let{start:e,end:n,count:i,loop:r,style:o}=t;return{start:e%i,end:n%i,loop:r&&(n-e+1)%i===0,style:o}}function mT(t,e,n){if(!n)return[t];const{property:i,start:r,end:o}=n,a=e.length,{compare:s,between:l,normalize:c}=fT(i),{start:u,end:h,loop:p,style:d}=function(t,e,n){const{property:i,start:r,end:o}=n,{between:a,normalize:s}=fT(i),l=e.length;let c,u,{start:h,end:p,loop:d}=t;if(d){for(h+=l,p+=l,c=0,u=l;c<u&&a(s(e[h%l][i]),r,o);++c)h--,p--;h%=l,p%=l}return p<h&&(p+=l),{start:h,end:p,loop:d,style:t.style}}(t,e,n),f=[];let g,m,y,v=!1,_=null;const b=()=>v||l(r,y,g)&&0!==s(r,y),x=()=>!v||0===s(o,g)||l(o,y,g);for(let w=u,S=u;w<=h;++w)m=e[w%a],m.skip||(g=c(m[i]),g!==y&&(v=l(g,r,o),null===_&&b()&&(_=0===s(g,r)?w:S),null!==_&&x()&&(f.push(gT({start:_,end:w,loop:p,count:a,style:d})),_=null),S=w,y=g));return null!==_&&f.push(gT({start:_,end:h,loop:p,count:a,style:d})),f}function yT(t,e){const n=[],i=t.segments;for(let r=0;r<i.length;r++){const o=mT(i[r],t.points,e);o.length&&n.push(...o)}return n}function vT(t,e,n,i){return i&&i.setContext&&n?function(t,e,n,i){const r=t._chart.getContext(),o=_T(t.options),{_datasetIndex:a,options:{spanGaps:s}}=t,l=n.length,c=[];let u=o,h=e[0].start,p=h;function d(t,e,i,r){const o=s?-1:1;if(t!==e){for(t+=l;n[t%l].skip;)t-=o;for(;n[e%l].skip;)e+=o;t%l!==e%l&&(c.push({start:t%l,end:e%l,loop:i,style:r}),u=r,h=e%l)}}for(const f of e){h=s?h:f.start;let t,e=n[h%l];for(p=h+1;p<=f.end;p++){const o=n[p%l];t=_T(i.setContext(_E(r,{type:"segment",p0:e,p1:o,p0DataIndex:(p-1)%l,p1DataIndex:p%l,datasetIndex:a}))),bT(t,u)&&d(h,p-1,f.loop,u),e=o,u=t}h<p-1&&d(h,p-1,f.loop,u)}return c}(t,e,n,i):e}function _T(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function bT(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}var xT=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,i){const r=e.listeners[i],o=e.duration;r.forEach((i=>i({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(n-e.start,o)})))}_refresh(){this._request||(this._running=!0,this._request=lS.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),e=0;this._charts.forEach(((n,i)=>{if(!n.running||!n.items.length)return;const r=n.items;let o,a=r.length-1,s=!1;for(;a>=0;--a)o=r[a],o._active?(o._total>n.duration&&(n.duration=o._total),o.tick(t),s=!0):(r[a]=r[r.length-1],r.pop());s&&(i.draw(),this._notify(i,n,t,"progress")),r.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),e+=r.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};const wT="transparent",ST={boolean:(t,e,n)=>n>.5?e:t,color(t,e,n){const i=WP(t||wT),r=i.valid&&WP(e||wT);return r&&r.valid?r.mix(i,n).hexString():e},number:(t,e,n)=>t+(e-t)*n};class PT{constructor(t,e,n,i){const r=e[n];i=vE([t.to,i,r,t.from]);const o=vE([t.from,r,i]);this._active=!0,this._fn=t.fn||ST[t.type||typeof o],this._easing=cP[t.easing]||cP.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const i=this._target[this._prop],r=n-this._start,o=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=vE([t.to,e,i,t.from]),this._from=vE([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,i=this._prop,r=this._from,o=this._loop,a=this._to;let s;if(this._active=r!==a&&(o||e<n),!this._active)return this._target[i]=a,void this._notify(!0);e<0?this._target[i]=r:(s=e/n%2,s=o&&s>1?2-s:s,s=this._easing(Math.min(1,Math.max(0,s))),this._target[i]=this._fn(r,a,s))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,n)=>{t.push({res:e,rej:n})}))}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][e]()}}YP.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const ET=Object.keys(YP.animation);YP.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),YP.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),YP.describe("animations",{_fallback:"animation"}),YP.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}});class TT{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!mS(t))return;const e=this._properties;Object.getOwnPropertyNames(t).forEach((n=>{const i=t[n];if(!mS(i))return;const r={};for(const t of ET)r[t]=i[t];(gS(i.properties)&&i.properties||[n]).forEach((t=>{t!==n&&e.has(t)||e.set(t,r)}))}))}_animateOptions(t,e){const n=e.options,i=function(t,e){if(!e)return;let n=t.options;if(!n)return void(t.options=e);n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(t,n);if(!i)return[];const r=this._createAnimations(i,n);return n.$shared&&function(t,e){const n=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const e=t[i[r]];e&&e.active()&&n.push(e.wait())}return Promise.all(n)}(t.options.$animations,n).then((()=>{t.options=n}),(()=>{})),r}_createAnimations(t,e){const n=this._properties,i=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let s;for(s=o.length-1;s>=0;--s){const l=o[s];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(t,e));continue}const c=e[l];let u=r[l];const h=n.get(l);if(u){if(h&&u.active()){u.update(h,c,a);continue}u.cancel()}h&&h.duration?(r[l]=u=new PT(h,t,l,c),i.push(u)):t[l]=c}return i}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(xT.add(this._chart,n),!0):void 0}}function kT(t,e){const n=t&&t.options||{},i=n.reverse,r=void 0===n.min?e:0,o=void 0===n.max?e:0;return{start:i?o:r,end:i?r:o}}function AT(t,e){const n=[],i=t._getSortedDatasetMetas(e);let r,o;for(r=0,o=i.length;r<o;++r)n.push(i[r].index);return n}function CT(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=t.keys,o="single"===i.mode;let a,s,l,c;if(null!==e){for(a=0,s=r.length;a<s;++a){if(l=+r[a],l===n){if(i.all)continue;break}c=t.values[l],yS(c)&&(o||0===e||qS(e)===qS(c))&&(e+=c)}return e}}function MT(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function IT(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function LT(t,e,n,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const e=t[r.index];if(n&&e>0||!n&&e<0)return r.index}return null}function OT(t,e){const{chart:n,_cachedMeta:i}=t,r=n._stacks||(n._stacks={}),{iScale:o,vScale:a,index:s}=i,l=o.axis,c=a.axis,u=function(t,e,n){return"".concat(t.id,".").concat(e.id,".").concat(n.stack||n.type)}(o,a,i),h=e.length;let p;for(let d=0;d<h;++d){const t=e[d],{[l]:n,[c]:o}=t;p=(t._stacks||(t._stacks={}))[c]=IT(r,u,n),p[s]=o,p._top=LT(p,a,!0,i.type),p._bottom=LT(p,a,!1,i.type)}}function zT(t,e){const n=t.scales;return Object.keys(n).filter((t=>n[t].axis===e)).shift()}function RT(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[i]||void 0===e[i][n])return;delete e[i][n]}}}const DT=t=>"reset"===t||"none"===t,FT=(t,e)=>e?t:Object.assign({},t);class BT{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=MT(t.vScale,t),this.addElements()}updateIndex(t){this.index!==t&&RT(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),i=(t,e,n,i)=>"x"===t?e:"r"===t?i:n,r=e.xAxisID=_S(n.xAxisID,zT(t,"x")),o=e.yAxisID=_S(n.yAxisID,zT(t,"y")),a=e.rAxisID=_S(n.rAxisID,zT(t,"r")),s=e.indexAxis,l=e.iAxisID=i(s,r,o,a),c=e.vAxisID=i(s,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&PE(this._data,this),t._stacked&&RT(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(mS(e))this._data=function(t){const e=Object.keys(t),n=new Array(e.length);let i,r,o;for(i=0,r=e.length;i<r;++i)o=e[i],n[i]={x:o,y:t[o]};return n}(e);else if(n!==e){if(n){PE(n,this);const t=this._cachedMeta;RT(t),t._parsed=[]}e&&Object.isExtensible(e)&&(r=this,(i=e)._chartjs?i._chartjs.listeners.push(r):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),SE.forEach((t=>{const e="_onData"+LS(t),n=i[t];Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];const a=n.apply(this,r);return i._chartjs.listeners.forEach((t=>{"function"===typeof t[e]&&t[e](...r)})),a}})})))),this._syncList=[],this._data=e}var i,r}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const r=e._stacked;e._stacked=MT(e.vScale,e),e.stack!==n.stack&&(i=!0,RT(e),e.stack=n.stack),this._resyncElements(t),(i||r!==e._stacked)&&OT(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:i}=this,{iScale:r,_stacked:o}=n,a=r.axis;let s,l,c,u=0===t&&e===i.length||n._sorted,h=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,c=i;else{c=gS(i[t])?this.parseArrayData(n,i,t,e):mS(i[t])?this.parseObjectData(n,i,t,e):this.parsePrimitiveData(n,i,t,e);const r=()=>null===l[a]||h&&l[a]<h[a];for(s=0;s<e;++s)n._parsed[s+t]=l=c[s],u&&(r()&&(u=!1),h=l);n._sorted=u}o&&OT(this,c)}parsePrimitiveData(t,e,n,i){const{iScale:r,vScale:o}=t,a=r.axis,s=o.axis,l=r.getLabels(),c=r===o,u=new Array(i);let h,p,d;for(h=0,p=i;h<p;++h)d=h+n,u[h]={[a]:c||r.parse(l[d],d),[s]:o.parse(e[d],d)};return u}parseArrayData(t,e,n,i){const{xScale:r,yScale:o}=t,a=new Array(i);let s,l,c,u;for(s=0,l=i;s<l;++s)c=s+n,u=e[c],a[s]={x:r.parse(u[0],c),y:o.parse(u[1],c)};return a}parseObjectData(t,e,n,i){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:s="y"}=this._parsing,l=new Array(i);let c,u,h,p;for(c=0,u=i;c<u;++c)h=c+n,p=e[h],l[c]={x:r.parse(IS(p,a),h),y:o.parse(IS(p,s),h)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const i=this.chart,r=this._cachedMeta,o=e[t.axis];return CT({keys:AT(i,!0),values:e._stacks[t.axis]},o,r.index,{mode:n})}updateRangeFromParsed(t,e,n,i){const r=n[e.axis];let o=null===r?NaN:r;const a=i&&n._stacks[e.axis];i&&a&&(i.values=a,o=CT(i,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const n=this._cachedMeta,i=n._parsed,r=n._sorted&&t===n.iScale,o=i.length,a=this._getOtherScale(t),s=((t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:AT(n,!0),values:null})(e,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(t){const{min:e,max:n,minDefined:i,maxDefined:r}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}(a);let h,p;function d(){p=i[h];const e=p[a.axis];return!yS(p[t.axis])||c>e||u<e}for(h=0;h<o&&(d()||(this.updateRangeFromParsed(l,t,p,s),!r));++h);if(r)for(h=o-1;h>=0;--h)if(!d()){this.updateRangeFromParsed(l,t,p,s);break}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let i,r,o;for(i=0,r=e.length;i<r;++i)o=e[i][t.axis],yS(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,i=e.vScale,r=this.getParsed(t);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,n,i,r;return mS(t)?(e=t.top,n=t.right,i=t.bottom,r=t.left):e=n=i=r=t,{top:e,right:n,bottom:i,left:r,disabled:!1===t}}(_S(this.options.clip,function(t,e,n){if(!1===n)return!1;const i=kT(t,n),r=kT(e,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,i=n.data||[],r=e.chartArea,o=[],a=this._drawStart||0,s=this._drawCount||i.length-a,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(t,r,a,s),c=a;c<a+s;++c){const e=i[c];e.hidden||(e.active&&l?o.push(e):e.draw(t,r))}for(c=0;c<o.length;++c)o[c].draw(t,r)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const i=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];r=e.$context||(e.$context=function(t,e,n){return _E(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),r.parsed=this.getParsed(t),r.raw=i.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=function(t,e){return _E(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=n,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const i="active"===e,r=this._cachedDataOpts,o=t+"-"+e,a=r[o],s=this.enableOptionSharing&&OS(n);if(a)return FT(a,s);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),u=i?["".concat(t,"Hover"),"hover",t,""]:[t,""],h=l.getOptionScopes(this.getDataset(),c),p=Object.keys(YP.elements[t]),d=l.resolveNamedOptions(h,p,(()=>this.getContext(n,i)),u);return d.$shared&&(d.$shared=s,r[o]=Object.freeze(FT(d,s))),d}_resolveAnimations(t,e,n){const i=this.chart,r=this._cachedDataOpts,o="animation-".concat(e),a=r[o];if(a)return a;let s;if(!1!==i.options.animation){const i=this.chart.config,r=i.datasetAnimationScopeKeys(this._type,e),o=i.getOptionScopes(this.getDataset(),r);s=i.createResolver(o,this.getContext(t,n,e))}const l=new TT(i,s&&s.animations);return s&&s._cacheable&&(r[o]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||DT(t)||this.chart._animationsDisabled}updateElement(t,e,n,i){DT(i)?Object.assign(t,n):this._resolveAnimations(e,i).update(t,n)}updateSharedOptions(t,e,n){t&&!DT(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,i){t.active=i;const r=this.getStyle(e,i);this._resolveAnimations(e,n,i).update(t,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[a,s,l]of this._syncList)this[a](s,l);this._syncList=[];const i=n.length,r=e.length,o=Math.min(r,i);o&&this.parse(0,o),r>i?this._insertElements(i,r-i,t):r<i&&this._removeElements(r,i-r)}_insertElements(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this._cachedMeta,r=i.data,o=t+e;let a;const s=t=>{for(t.length+=e,a=t.length-1;a>=o;a--)t[a]=t[a-e]};for(s(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&s(i._parsed),this.parse(t,e),n&&this.updateElements(r,t,e,"reset")}updateElements(t,e,n,i){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,e);n._stacked&&RT(n,i)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,i]=t;this[e](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function jT(t){const e=t.iScale,n=function(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let e=0,r=n.length;e<r;e++)i=i.concat(n[e].controller.getAllParsedValues(t));t._cache.$bar=EE(i.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let i,r,o,a,s=e._length;const l=()=>{32767!==o&&-32768!==o&&(OS(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(i=0,r=n.length;i<r;++i)o=e.getPixelForValue(n[i]),l();for(a=void 0,i=0,r=e.ticks.length;i<r;++i)o=e.getPixelForTick(i),l();return s}function NT(t,e,n,i){return gS(t)?function(t,e,n,i){const r=n.parse(t[0],i),o=n.parse(t[1],i),a=Math.min(r,o),s=Math.max(r,o);let l=a,c=s;Math.abs(a)>Math.abs(s)&&(l=s,c=a),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:o,min:a,max:s}}(t,e,n,i):e[n.axis]=n.parse(t,i),e}function VT(t,e,n,i){const r=t.iScale,o=t.vScale,a=r.getLabels(),s=r===o,l=[];let c,u,h,p;for(c=n,u=n+i;c<u;++c)p=e[c],h={},h[r.axis]=s||r.parse(a[c],c),l.push(NT(p,h,o,c));return l}function UT(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function WT(t,e,n,i){let r=e.borderSkipped;const o={};if(!r)return void(t.borderSkipped=o);const{start:a,end:s,reverse:l,top:c,bottom:u}=function(t){let e,n,i,r,o;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(r="end",o="start"):(r="start",o="end"),{start:n,end:i,reverse:e,top:r,bottom:o}}(t);"middle"===r&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?r=c:(n._bottom||0)===i?r=u:(o[GT(u,a,s,l)]=!0,r=c)),o[GT(r,a,s,l)]=!0,t.borderSkipped=o}function GT(t,e,n,i){var r,o,a;return i?(a=n,t=qT(t=(r=t)===(o=e)?a:r===a?o:r,n,e)):t=qT(t,e,n),t}function qT(t,e,n){return"start"===t?e:"end"===t?n:t}function ZT(t,e,n){let{inflateAmount:i}=e;t.inflateAmount="auto"===i?1===n?.33:0:i}BT.defaults={},BT.prototype.datasetElementType=null,BT.prototype.dataElementType=null;class HT extends BT{parsePrimitiveData(t,e,n,i){return VT(t,e,n,i)}parseArrayData(t,e,n,i){return VT(t,e,n,i)}parseObjectData(t,e,n,i){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:s="y"}=this._parsing,l="x"===r.axis?a:s,c="x"===o.axis?a:s,u=[];let h,p,d,f;for(h=n,p=n+i;h<p;++h)f=e[h],d={},d[r.axis]=r.parse(IS(f,l),h),u.push(NT(IS(f,c),d,o,h));return u}updateRangeFromParsed(t,e,n,i){super.updateRangeFromParsed(t,e,n,i);const r=n._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:i}=e,r=this.getParsed(t),o=r._custom,a=UT(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,i){const r="reset"===i,{index:o,_cachedMeta:{vScale:a}}=this,s=a.getBasePixel(),l=a.isHorizontal(),c=this._getRuler(),u=this.resolveDataElementOptions(e,i),h=this.getSharedOptions(u),p=this.includeOptions(i,h);this.updateSharedOptions(h,i,u);for(let d=e;d<e+n;d++){const e=this.getParsed(d),n=r||fS(e[a.axis])?{base:s,head:s}:this._calculateBarValuePixels(d),u=this._calculateBarIndexPixels(d,c),f=(e._stacks||{})[a.axis],g={horizontal:l,base:n.base,enableBorderRadius:!f||UT(e._custom)||o===f._top||o===f._bottom,x:l?n.head:u.center,y:l?u.center:n.head,height:l?u.size:Math.abs(n.size),width:l?Math.abs(n.size):u.size};p&&(g.options=h||this.resolveDataElementOptions(d,t[d].active?"active":i));const m=g.options||t[d].options;WT(g,m,f,o),ZT(g,m,c.ratio),this.updateElement(t[d],d,g,i)}}_getStacks(t,e){const n=this._cachedMeta.iScale,i=n.getMatchingVisibleMetas(this._type),r=n.options.stacked,o=i.length,a=[];let s,l;for(s=0;s<o;++s)if(l=i[s],l.controller.options.grouped){if("undefined"!==typeof e){const t=l.controller.getParsed(e)[l.controller._cachedMeta.vScale.axis];if(fS(t)||isNaN(t))continue}if((!1===r||-1===a.indexOf(l.stack)||void 0===r&&void 0===l.stack)&&a.push(l.stack),l.index===t)break}return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const i=this._getStacks(t,n),r=void 0!==e?i.indexOf(e):-1;return-1===r?i.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,i=[];let r,o;for(r=0,o=e.data.length;r<o;++r)i.push(n.getPixelForValue(this.getParsed(r)[n.axis],r));const a=t.barThickness;return{min:a||jT(e),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n},options:{base:i,minBarLength:r}}=this,o=i||0,a=this.getParsed(t),s=a._custom,l=UT(s);let c,u,h=a[e.axis],p=0,d=n?this.applyStack(e,a,n):h;d!==h&&(p=d-h,d=h),l&&(h=s.barStart,d=s.barEnd-s.barStart,0!==h&&qS(h)!==qS(s.barEnd)&&(p=0),p+=h);const f=fS(i)||l?p:i;let g=e.getPixelForValue(f);if(c=this.chart.getDataVisibility(t)?e.getPixelForValue(p+d):g,u=c-g,Math.abs(u)<r&&(u=function(t,e,n){return 0!==t?qS(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}(u,e,o)*r,h===o&&(g-=u/2),c=g+u),g===e.getPixelForValue(o)){const t=qS(u)*e.getLineWidthForValue(o)/2;g+=t,u-=t}return{size:u,base:g,head:c,center:c+u/2}}_calculateBarIndexPixels(t,e){const n=e.scale,i=this.options,r=i.skipNull,o=_S(i.maxBarThickness,1/0);let a,s;if(e.grouped){const n=r?this._getStackCount(t):e.stackCount,l="flex"===i.barThickness?function(t,e,n,i){const r=e.pixels,o=r[t];let a=t>0?r[t-1]:null,s=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;null===a&&(a=o-(null===s?e.end-e.start:s-o)),null===s&&(s=o+o-a);const c=o-(o-Math.min(a,s))/2*l;return{chunk:Math.abs(s-a)/2*l/i,ratio:n.barPercentage,start:c}}(t,e,i,n):function(t,e,n,i){const r=n.barThickness;let o,a;return fS(r)?(o=e.min*n.categoryPercentage,a=n.barPercentage):(o=r*i,a=1),{chunk:o/i,ratio:a,start:e.pixels[t]-o/2}}(t,e,i,n),c=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0);a=l.start+l.chunk*c+l.chunk/2,s=Math.min(o,l.chunk*l.ratio)}else a=n.getPixelForValue(this.getParsed(t)[n.axis],t),s=Math.min(o,e.min*e.ratio);return{base:a-s/2,head:a+s/2,center:a,size:s}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,i=n.length;let r=0;for(;r<i;++r)null!==this.getParsed(r)[e.axis]&&n[r].draw(this._ctx)}}HT.id="bar",HT.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},HT.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class XT extends BT{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,n,i){const r=super.parsePrimitiveData(t,e,n,i);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+n).radius;return r}parseArrayData(t,e,n,i){const r=super.parseArrayData(t,e,n,i);for(let o=0;o<r.length;o++){const t=e[n+o];r[o]._custom=_S(t[2],this.resolveDataElementOptions(o+n).radius)}return r}parseObjectData(t,e,n,i){const r=super.parseObjectData(t,e,n,i);for(let o=0;o<r.length;o++){const t=e[n+o];r[o]._custom=_S(t&&t.r&&+t.r,this.resolveDataElementOptions(o+n).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,{xScale:n,yScale:i}=e,r=this.getParsed(t),o=n.getLabelForValue(r.x),a=i.getLabelForValue(r.y),s=r._custom;return{label:e.label,value:"("+o+", "+a+(s?", "+s:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,n,i){const r="reset"===i,{iScale:o,vScale:a}=this._cachedMeta,s=this.resolveDataElementOptions(e,i),l=this.getSharedOptions(s),c=this.includeOptions(i,l),u=o.axis,h=a.axis;for(let p=e;p<e+n;p++){const e=t[p],n=!r&&this.getParsed(p),s={},l=s[u]=r?o.getPixelForDecimal(.5):o.getPixelForValue(n[u]),d=s[h]=r?a.getBasePixel():a.getPixelForValue(n[h]);s.skip=isNaN(l)||isNaN(d),c&&(s.options=this.resolveDataElementOptions(p,e.active?"active":i),r&&(s.options.radius=0)),this.updateElement(e,p,s,i)}this.updateSharedOptions(l,i,s)}resolveDataElementOptions(t,e){const n=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return"active"!==e&&(i.radius=0),i.radius+=_S(n&&n._custom,r),i}}XT.id="bubble",XT.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},XT.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}};class YT extends BT{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{let r,o,a=t=>+n[t];if(mS(n[t])){const{key:t="value"}=this._parsing;a=e=>+IS(n[e],t)}for(r=t,o=t+e;r<o;++r)i._parsed[r]=a(r)}}_getRotation(){return KS(this.options.rotation-90)}_getCircumference(){return KS(this.options.circumference)}_getRotationExtents(){let t=FS,e=-FS;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)){const i=this.chart.getDatasetMeta(n).controller,r=i._getRotation(),o=i._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,i=this._cachedMeta,r=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(n.width,n.height)-o)/2,0),s=Math.min((l=this.options.cutout,c=a,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:l/c),1);var l,c;const u=this._getRingWeight(this.index),{circumference:h,rotation:p}=this._getRotationExtents(),{ratioX:d,ratioY:f,offsetX:g,offsetY:m}=function(t,e,n){let i=1,r=1,o=0,a=0;if(e<FS){const s=t,l=s+e,c=Math.cos(s),u=Math.sin(s),h=Math.cos(l),p=Math.sin(l),d=(t,e,i)=>iP(t,s,l,!0)?1:Math.max(e,e*n,i,i*n),f=(t,e,i)=>iP(t,s,l,!0)?-1:Math.min(e,e*n,i,i*n),g=d(0,c,h),m=d(VS,u,p),y=f(DS,c,h),v=f(DS+VS,u,p);i=(g-y)/2,r=(m-v)/2,o=-(g+y)/2,a=-(m+v)/2}return{ratioX:i,ratioY:r,offsetX:o,offsetY:a}}(p,h,s),y=(n.width-o)/d,v=(n.height-o)/f,_=Math.max(Math.min(y,v)/2,0),b=bS(this.options.radius,_),x=(b-Math.max(b*s,0))/this._getVisibleDatasetWeightTotal();this.offsetX=g*b,this.offsetY=m*b,i.total=this.calculateTotal(),this.outerRadius=b-x*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-x*u,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const n=this.options,i=this._cachedMeta,r=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||null===i._parsed[t]||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*r/FS)}updateElements(t,e,n,i){const r="reset"===i,o=this.chart,a=o.chartArea,s=o.options.animation,l=(a.left+a.right)/2,c=(a.top+a.bottom)/2,u=r&&s.animateScale,h=u?0:this.innerRadius,p=u?0:this.outerRadius,d=this.resolveDataElementOptions(e,i),f=this.getSharedOptions(d),g=this.includeOptions(i,f);let m,y=this._getRotation();for(m=0;m<e;++m)y+=this._circumference(m,r);for(m=e;m<e+n;++m){const e=this._circumference(m,r),n=t[m],o={x:l+this.offsetX,y:c+this.offsetY,startAngle:y,endAngle:y+e,circumference:e,outerRadius:p,innerRadius:h};g&&(o.options=f||this.resolveDataElementOptions(m,n.active?"active":i)),y+=e,this.updateElement(n,m,o,i)}this.updateSharedOptions(f,i,d)}calculateTotal(){const t=this._cachedMeta,e=t.data;let n,i=0;for(n=0;n<e.length;n++){const r=t._parsed[n];null===r||isNaN(r)||!this.chart.getDataVisibility(n)||e[n].hidden||(i+=Math.abs(r))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?FS*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=uT(e._parsed[t],n.options.locale);return{label:i[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const n=this.chart;let i,r,o,a,s;if(!t)for(i=0,r=n.data.datasets.length;i<r;++i)if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i),t=o.data,a=o.controller;break}if(!t)return 0;for(i=0,r=t.length;i<r;++i)s=a.resolveDataElementOptions(i),"inner"!==s.borderAlign&&(e=Math.max(e,s.borderWidth||0,s.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,i=t.length;n<i;++n){const t=this.resolveDataElementOptions(n);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(_S(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}YT.id="doughnut",YT.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},YT.descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t},YT.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map(((e,i)=>{const r=t.getDatasetMeta(0).controller.getStyle(i);return{text:e,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label(t){let e=t.label;const n=": "+t.formattedValue;return gS(e)?(e=e.slice(),e[0]+=n):e+=n,e}}}}};class KT extends BT{initialize(){this.enableOptionSharing=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:n,data:i=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:s}=function(t,e,n){const i=e.length;let r=0,o=i;if(t._sorted){const{iScale:a,_parsed:s}=t,l=a.axis,{min:c,max:u,minDefined:h,maxDefined:p}=a.getUserBounds();h&&(r=rP(Math.min(xE(s,a.axis,c).lo,n?i:xE(e,l,a.getPixelForValue(c)).lo),0,i-1)),o=p?rP(Math.max(xE(s,a.axis,u).hi+1,n?0:xE(e,l,a.getPixelForValue(u)).hi+1),r,i)-r:i-r}return{start:r,count:o}}(e,i,o);this._drawStart=a,this._drawCount=s,function(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=r,!0;const o=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),o}(e)&&(a=0,s=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=i;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:l},t),this.updateElements(i,a,s,t)}updateElements(t,e,n,i){const r="reset"===i,{iScale:o,vScale:a,_stacked:s,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(e,i),u=this.getSharedOptions(c),h=this.includeOptions(i,u),p=o.axis,d=a.axis,{spanGaps:f,segment:g}=this.options,m=HS(f)?f:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||r||"none"===i;let v=e>0&&this.getParsed(e-1);for(let _=e;_<e+n;++_){const e=t[_],n=this.getParsed(_),c=y?e:{},f=fS(n[d]),b=c[p]=o.getPixelForValue(n[p],_),x=c[d]=r||f?a.getBasePixel():a.getPixelForValue(s?this.applyStack(a,n,s):n[d],_);c.skip=isNaN(b)||isNaN(x)||f,c.stop=_>0&&n[p]-v[p]>m,g&&(c.parsed=n,c.raw=l.data[_]),h&&(c.options=u||this.resolveDataElementOptions(_,e.active?"active":i)),y||this.updateElement(e,_,c,i),v=n}this.updateSharedOptions(u,i,c)}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,n=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const r=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}KT.id="line",KT.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},KT.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class JT extends BT{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=uT(e._parsed[t].r,n.options.locale);return{label:i[t]||"",value:r}}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}_updateRadius(){const t=this.chart,e=t.chartArea,n=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(i/2,0),o=(r-Math.max(n.cutoutPercentage?r/100*n.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=r-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,e,n,i){const r="reset"===i,o=this.chart,a=this.getDataset(),s=o.options.animation,l=this._cachedMeta.rScale,c=l.xCenter,u=l.yCenter,h=l.getIndexAngle(0)-.5*DS;let p,d=h;const f=360/this.countVisibleElements();for(p=0;p<e;++p)d+=this._computeAngle(p,i,f);for(p=e;p<e+n;p++){const e=t[p];let n=d,g=d+this._computeAngle(p,i,f),m=o.getDataVisibility(p)?l.getDistanceFromCenterForValue(a.data[p]):0;d=g,r&&(s.animateScale&&(m=0),s.animateRotate&&(n=g=h));const y={x:c,y:u,innerRadius:0,outerRadius:m,startAngle:n,endAngle:g,options:this.resolveDataElementOptions(p,e.active?"active":i)};this.updateElement(e,p,y,i)}}countVisibleElements(){const t=this.getDataset(),e=this._cachedMeta;let n=0;return e.data.forEach(((e,i)=>{!isNaN(t.data[i])&&this.chart.getDataVisibility(i)&&n++})),n}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?KS(this.resolveDataElementOptions(t,e).angle||n):0}}JT.id="polarArea",JT.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},JT.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map(((e,i)=>{const r=t.getDatasetMeta(0).controller.getStyle(i);return{text:e,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label:t=>t.chart.data.labels[t.dataIndex]+": "+t.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class QT extends YT{}QT.id="pie",QT.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class $T extends BT{getLabelAndValue(t){const e=this._cachedMeta.vScale,n=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(n[e.axis])}}update(t){const e=this._cachedMeta,n=e.dataset,i=e.data||[],r=e.iScale.getLabels();if(n.points=i,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const o={_loop:!0,_fullLoop:r.length===i.length,options:e};this.updateElement(n,void 0,o,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,n,i){const r=this.getDataset(),o=this._cachedMeta.rScale,a="reset"===i;for(let s=e;s<e+n;s++){const e=t[s],n=this.resolveDataElementOptions(s,e.active?"active":i),l=o.getPointPositionForValue(s,r.data[s]),c=a?o.xCenter:l.x,u=a?o.yCenter:l.y,h={x:c,y:u,angle:l.angle,skip:isNaN(c)||isNaN(u),options:n};this.updateElement(e,s,h,i)}}}$T.id="radar",$T.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},$T.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class tk extends KT{}tk.id="scatter",tk.defaults={showLine:!1,fill:!1},tk.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:t=>"("+t.label+", "+t.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var ek=Object.freeze({__proto__:null,BarController:HT,BubbleController:XT,DoughnutController:YT,LineController:KT,PolarAreaController:JT,PieController:QT,RadarController:$T,ScatterController:tk});function nk(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class ik{constructor(t){this.options=t||{}}formats(){return nk()}parse(t,e){return nk()}format(t,e){return nk()}add(t,e,n){return nk()}diff(t,e,n){return nk()}startOf(t,e,n){return nk()}endOf(t,e){return nk()}}ik.override=function(t){Object.assign(ik.prototype,t)};var rk={_date:ik};function ok(t,e){return"native"in t?{x:t.x,y:t.y}:tT(t,e)}function ak(t,e,n,i){const{controller:r,data:o,_sorted:a}=t,s=r._cachedMeta.iScale;if(s&&e===s.axis&&"r"!==e&&a&&o.length){const t=s._reversePixels?wE:xE;if(!i)return t(o,e,n);if(r._sharedOptions){const i=o[0],r="function"===typeof i.getRange&&i.getRange(e);if(r){const i=t(o,e,n-r),a=t(o,e,n+r);return{lo:i.lo,hi:a.hi}}}}return{lo:0,hi:o.length-1}}function sk(t,e,n,i,r){const o=t.getSortedVisibleDatasetMetas(),a=n[e];for(let s=0,l=o.length;s<l;++s){const{index:t,data:n}=o[s],{lo:l,hi:c}=ak(o[s],e,a,r);for(let e=l;e<=c;++e){const r=n[e];r.skip||i(r,t,e)}}}function lk(t,e,n,i){const r=[];if(!eE(e,t.chartArea,t._minPadding))return r;return sk(t,n,e,(function(t,n,o){t.inRange(e.x,e.y,i)&&r.push({element:t,datasetIndex:n,index:o})}),!0),r}function ck(t,e,n,i,r){let o=[];const a=function(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,i){const r=e?Math.abs(t.x-i.x):0,o=n?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}(n);let s=Number.POSITIVE_INFINITY;return sk(t,n,e,(function(n,l,c){const u=n.inRange(e.x,e.y,r);if(i&&!u)return;const h=n.getCenterPoint(r);if(!eE(h,t.chartArea,t._minPadding)&&!u)return;const p=a(e,h);p<s?(o=[{element:n,datasetIndex:l,index:c}],s=p):p===s&&o.push({element:n,datasetIndex:l,index:c})})),o}function uk(t,e,n,i,r){return eE(e,t.chartArea,t._minPadding)?"r"!==n||i?ck(t,e,n,i,r):function(t,e,n,i){let r=[];return sk(t,n,e,(function(t,n,o){const{startAngle:a,endAngle:s}=t.getProps(["startAngle","endAngle"],i),{angle:l}=$S(t,{x:e.x,y:e.y});iP(l,a,s)&&r.push({element:t,datasetIndex:n,index:o})})),r}(t,e,n,r):[]}function hk(t,e,n,i){const r=ok(e,t),o=[],a=n.axis,s="x"===a?"inXRange":"inYRange";let l=!1;return function(t,e){const n=t.getSortedVisibleDatasetMetas();let i,r,o;for(let a=0,s=n.length;a<s;++a){({index:i,data:r}=n[a]);for(let t=0,n=r.length;t<n;++t)o=r[t],o.skip||e(o,i,t)}}(t,((t,e,n)=>{t[s](r[a],i)&&o.push({element:t,datasetIndex:e,index:n}),t.inRange(r.x,r.y,i)&&(l=!0)})),n.intersect&&!l?[]:o}var pk={modes:{index(t,e,n,i){const r=ok(e,t),o=n.axis||"x",a=n.intersect?lk(t,r,o,i):uk(t,r,o,!1,i),s=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=a[0].index,n=t.data[e];n&&!n.skip&&s.push({element:n,datasetIndex:t.index,index:e})})),s):[]},dataset(t,e,n,i){const r=ok(e,t),o=n.axis||"xy";let a=n.intersect?lk(t,r,o,i):uk(t,r,o,!1,i);if(a.length>0){const e=a[0].datasetIndex,n=t.getDatasetMeta(e).data;a=[];for(let t=0;t<n.length;++t)a.push({element:n[t],datasetIndex:e,index:t})}return a},point:(t,e,n,i)=>lk(t,ok(e,t),n.axis||"xy",i),nearest:(t,e,n,i)=>uk(t,ok(e,t),n.axis||"xy",n.intersect,i),x:(t,e,n,i)=>hk(t,e,{axis:"x",intersect:n.intersect},i),y:(t,e,n,i)=>hk(t,e,{axis:"y",intersect:n.intersect},i)}};const dk=["left","top","right","bottom"];function fk(t,e){return t.filter((t=>t.pos===e))}function gk(t,e){return t.filter((t=>-1===dk.indexOf(t.pos)&&t.box.axis===e))}function mk(t,e){return t.sort(((t,n)=>{const i=e?n:t,r=e?t:n;return i.weight===r.weight?i.index-r.index:i.weight-r.weight}))}function yk(t,e){const n=function(t){const e={};for(const n of t){const{stack:t,pos:i,stackWeight:r}=n;if(!t||!dk.includes(i))continue;const o=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return e}(t),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let o,a,s;for(o=0,a=t.length;o<a;++o){s=t[o];const{fullSize:a}=s.box,l=n[s.stack],c=l&&s.stackWeight/l.weight;s.horizontal?(s.width=c?c*i:a&&e.availableWidth,s.height=r):(s.width=i,s.height=c?c*r:a&&e.availableHeight)}return n}function vk(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function _k(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function bk(t,e,n,i){const{pos:r,box:o}=n,a=t.maxPadding;if(!mS(r)){n.size&&(t[r]-=n.size);const e=i[n.stack]||{size:0,count:1};e.size=Math.max(e.size,n.horizontal?o.height:o.width),n.size=e.size/e.count,t[r]+=n.size}o.getPadding&&_k(a,o.getPadding());const s=Math.max(0,e.outerWidth-vk(a,t,"left","right")),l=Math.max(0,e.outerHeight-vk(a,t,"top","bottom")),c=s!==t.w,u=l!==t.h;return t.w=s,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function xk(t,e){const n=e.maxPadding;function i(t){const i={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{i[t]=Math.max(e[t],n[t])})),i}return i(t?["left","right"]:["top","bottom"])}function wk(t,e,n,i){const r=[];let o,a,s,l,c,u;for(o=0,a=t.length,c=0;o<a;++o){s=t[o],l=s.box,l.update(s.width||e.w,s.height||e.h,xk(s.horizontal,e));const{same:a,other:h}=bk(e,n,s,i);c|=a&&r.length,u=u||h,l.fullSize||r.push(s)}return c&&wk(r,e,n,i)||u}function Sk(t,e,n,i,r){t.top=n,t.left=e,t.right=e+i,t.bottom=n+r,t.width=i,t.height=r}function Pk(t,e,n,i){const r=n.padding;let{x:o,y:a}=e;for(const s of t){const t=s.box,l=i[s.stack]||{count:1,placed:0,weight:1},c=s.stackWeight/l.weight||1;if(s.horizontal){const i=e.w*c,o=l.size||t.height;OS(l.start)&&(a=l.start),t.fullSize?Sk(t,r.left,a,n.outerWidth-r.right-r.left,o):Sk(t,e.left+l.placed,a,i,o),l.start=a,l.placed+=i,a=t.bottom}else{const i=e.h*c,a=l.size||t.width;OS(l.start)&&(o=l.start),t.fullSize?Sk(t,o,r.top,a,n.outerHeight-r.bottom-r.top):Sk(t,o,e.top+l.placed,a,i),l.start=o,l.placed+=i,o=t.right}}e.x=o,e.y=a}YP.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var Ek={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const r=mE(t.options.layout.padding),o=Math.max(e-r.width,0),a=Math.max(n-r.height,0),s=function(t){const e=function(t){const e=[];let n,i,r,o,a,s;for(n=0,i=(t||[]).length;n<i;++n)r=t[n],({position:o,options:{stack:a,stackWeight:s=1}}=r),e.push({index:n,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&o+a,stackWeight:s});return e}(t),n=mk(e.filter((t=>t.box.fullSize)),!0),i=mk(fk(e,"left"),!0),r=mk(fk(e,"right")),o=mk(fk(e,"top"),!0),a=mk(fk(e,"bottom")),s=gk(e,"x"),l=gk(e,"y");return{fullSize:n,leftAndTop:i.concat(o),rightAndBottom:r.concat(l).concat(a).concat(s),chartArea:fk(e,"chartArea"),vertical:i.concat(r).concat(l),horizontal:o.concat(a).concat(s)}}(t.boxes),l=s.vertical,c=s.horizontal;wS(t.boxes,(t=>{"function"===typeof t.beforeLayout&&t.beforeLayout()}));const u=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:o,availableHeight:a,vBoxMaxWidth:o/2/u,hBoxMaxHeight:a/2}),p=Object.assign({},r);_k(p,mE(i));const d=Object.assign({maxPadding:p,w:o,h:a,x:r.left,y:r.top},r),f=yk(l.concat(c),h);wk(s.fullSize,d,h,f),wk(l,d,h,f),wk(c,d,h,f)&&wk(l,d,h,f),function(t){const e=t.maxPadding;function n(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(d),Pk(s.leftAndTop,d,h,f),d.x+=d.w,d.y+=d.h,Pk(s.rightAndBottom,d,h,f),t.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},wS(s.chartArea,(e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})}))}};class Tk{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,i){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):n)}}isAttached(t){return!0}updateConfig(t){}}class kk extends Tk{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Ak={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ck=t=>null===t||""===t;const Mk=!!rT&&{passive:!0};function Ik(t,e,n){t.canvas.removeEventListener(e,n,Mk)}function Lk(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function Ok(t,e,n){const i=t.canvas,r=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||Lk(n.addedNodes,i),e=e&&!Lk(n.removedNodes,i);e&&n()}));return r.observe(document,{childList:!0,subtree:!0}),r}function zk(t,e,n){const i=t.canvas,r=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||Lk(n.removedNodes,i),e=e&&!Lk(n.addedNodes,i);e&&n()}));return r.observe(document,{childList:!0,subtree:!0}),r}const Rk=new Map;let Dk=0;function Fk(){const t=window.devicePixelRatio;t!==Dk&&(Dk=t,Rk.forEach(((e,n)=>{n.currentDevicePixelRatio!==t&&e()})))}function Bk(t,e,n){const i=t.canvas,r=i&&YE(i);if(!r)return;const o=cS(((t,e)=>{const i=r.clientWidth;n(t,e),i<r.clientWidth&&n()}),window),a=new ResizeObserver((t=>{const e=t[0],n=e.contentRect.width,i=e.contentRect.height;0===n&&0===i||o(n,i)}));return a.observe(r),function(t,e){Rk.size||window.addEventListener("resize",Fk),Rk.set(t,e)}(t,o),a}function jk(t,e,n){n&&n.disconnect(),"resize"===e&&function(t){Rk.delete(t),Rk.size||window.removeEventListener("resize",Fk)}(t)}function Nk(t,e,n){const i=t.canvas,r=cS((e=>{null!==t.ctx&&n(function(t,e){const n=Ak[t.type]||t.type,{x:i,y:r}=tT(t,e);return{type:n,chart:e,native:t,x:void 0!==i?i:null,y:void 0!==r?r:null}}(e,t))}),t,(t=>{const e=t[0];return[e,e.offsetX,e.offsetY]}));return function(t,e,n){t.addEventListener(e,n,Mk)}(i,e,r),r}class Vk extends Tk{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(function(t,e){const n=t.style,i=t.getAttribute("height"),r=t.getAttribute("width");if(t.$chartjs={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ck(r)){const e=oT(t,"width");void 0!==e&&(t.width=e)}if(Ck(i))if(""===t.style.height)t.height=t.width/(e||2);else{const e=oT(t,"height");void 0!==e&&(t.height=e)}}(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e.$chartjs)return!1;const n=e.$chartjs.initial;["height","width"].forEach((t=>{const i=n[t];fS(i)?e.removeAttribute(t):e.setAttribute(t,i)}));const i=n.style||{};return Object.keys(i).forEach((t=>{e.style[t]=i[t]})),e.width=e.width,delete e.$chartjs,!0}addEventListener(t,e,n){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),r={attach:Ok,detach:zk,resize:Bk}[e]||Nk;i[e]=r(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),i=n[e];if(!i)return;({attach:jk,detach:jk,resize:jk}[e]||Ik)(t,e,i),n[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,i){return nT(t,e,n,i)}isAttached(t){const e=YE(t);return!(!e||!e.isConnected)}}class Uk{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return HS(this.x)&&HS(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const i={};return t.forEach((t=>{i[t]=n[t]&&n[t].active()?n[t]._to:this[t]})),i}}Uk.defaults={},Uk.defaultRoutes=void 0;const Wk={values:t=>gS(t)?t:""+t,numeric(t,e,n){if(0===t)return"0";const i=this.chart.options.locale;let r,o=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(r="scientific"),o=function(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t));return n}(t,n)}const a=GS(Math.abs(o)),s=Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:r,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(l,this.options.ticks.format),uT(t,i,l)},logarithmic(t,e,n){if(0===t)return"0";const i=t/Math.pow(10,Math.floor(GS(t)));return 1===i||2===i||5===i?Wk.numeric.call(this,t,e,n):""}};var Gk={formatters:Wk};function qk(t,e){const n=t.options.ticks,i=n.maxTicksLimit||function(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(i,r))}(t),r=n.major.enabled?function(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}(e):[],o=r.length,a=r[0],s=r[o-1],l=[];if(o>i)return function(t,e,n,i){let r,o=0,a=n[0];for(i=Math.ceil(i),r=0;r<t.length;r++)r===a&&(e.push(t[r]),o++,a=n[o*i])}(e,l,r,o/i),l;const c=function(t,e,n){const i=function(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}(t),r=e.length/n;if(!i)return Math.max(r,1);const o=function(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i===0&&(e.push(i),e.push(t/i));return n===(0|n)&&e.push(n),e.sort(((t,e)=>t-e)).pop(),e}(i);for(let a=0,s=o.length-1;a<s;a++){const t=o[a];if(t>r)return t}return Math.max(r,1)}(r,e,i);if(o>0){let t,n;const i=o>1?Math.round((s-a)/(o-1)):null;for(Zk(e,l,c,fS(i)?0:a-i,a),t=0,n=o-1;t<n;t++)Zk(e,l,c,r[t],r[t+1]);return Zk(e,l,c,s,fS(i)?e.length:s+i),l}return Zk(e,l,c),l}function Zk(t,e,n,i,r){const o=_S(i,0),a=Math.min(_S(r,t.length),t.length);let s,l,c,u=0;for(n=Math.ceil(n),r&&(s=r-i,n=s/Math.floor(s/n)),c=o;c<0;)u++,c=Math.round(o+u*n);for(l=Math.max(o,0);l<a;l++)l===c&&(e.push(t[l]),u++,c=Math.round(o+u*n))}YP.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Gk.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),YP.route("scale.ticks","color","","color"),YP.route("scale.grid","color","","borderColor"),YP.route("scale.grid","borderColor","","borderColor"),YP.route("scale.title","color","","color"),YP.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t}),YP.describe("scales",{_fallback:"scale"}),YP.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t});const Hk=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n;function Xk(t,e){const n=[],i=t.length/e,r=t.length;let o=0;for(;o<r;o+=i)n.push(t[Math.floor(o)]);return n}function Yk(t,e,n){const i=t.ticks.length,r=Math.min(e,i-1),o=t._startPixel,a=t._endPixel,s=1e-6;let l,c=t.getPixelForTick(r);if(!(n&&(l=1===i?Math.max(c-o,a-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(r-1))/2,c+=r<e?l:-l,c<o-s||c>a+s)))return c}function Kk(t){return t.drawTicks?t.tickLength:0}function Jk(t,e){if(!t.display)return 0;const n=yE(t.font,e),i=mE(t.padding);return(gS(t.text)?t.text.length:1)*n.lineHeight+i.height}function Qk(t,e,n){let i=uS(t);return(n&&"right"!==e||!n&&"right"===e)&&(i=(t=>"left"===t?"right":"right"===t?"left":t)(i)),i}class $k extends Uk{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:i}=this;return t=vS(t,Number.POSITIVE_INFINITY),e=vS(e,Number.NEGATIVE_INFINITY),n=vS(n,Number.POSITIVE_INFINITY),i=vS(i,Number.NEGATIVE_INFINITY),{min:vS(t,n),max:vS(e,i),minDefined:yS(t),maxDefined:yS(e)}}getMinMax(t){let e,{min:n,max:i,minDefined:r,maxDefined:o}=this.getUserBounds();if(r&&o)return{min:n,max:i};const a=this.getMatchingVisibleMetas();for(let s=0,l=a.length;s<l;++s)e=a[s].controller.getMinMax(this,t),r||(n=Math.min(n,e.min)),o||(i=Math.max(i,e.max));return n=o&&n>i?i:n,i=r&&n>i?n:i,{min:vS(n,vS(i,n)),max:vS(i,vS(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){xS(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:i,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(t,e,n){const{min:i,max:r}=t,o=bS(e,(r-i)/2),a=(t,e)=>n&&0===t?0:t+e;return{min:a(i,-Math.abs(o)),max:a(r,o)}}(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const s=a<this.ticks.length;this._convertTicksToLabels(s?Xk(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=qk(this,this.ticks),this._labelSizes=null),s&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,n=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,n=!n),this._startPixel=t,this._endPixel=e,this._reversePixels=n,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){xS(this.options.afterUpdate,[this])}beforeSetDimensions(){xS(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){xS(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),xS(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){xS(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,i,r;for(n=0,i=t.length;n<i;n++)r=t[n],r.label=xS(e.callback,[r.value,n,t],this)}afterTickToLabelConversion(){xS(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){xS(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=this.ticks.length,i=e.minRotation||0,r=e.maxRotation;let o,a,s,l=i;if(!this._isVisible()||!e.display||i>=r||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const c=this._getLabelSizes(),u=c.widest.width,h=c.highest.height,p=rP(this.chart.width-u,0,this.maxWidth);o=t.offset?this.maxWidth/n:p/(n-1),u+6>o&&(o=p/(n-(t.offset?.5:1)),a=this.maxHeight-Kk(t.grid)-e.padding-Jk(t.title,this.chart.options.font),s=Math.sqrt(u*u+h*h),l=JS(Math.min(Math.asin(rP((c.highest.height+6)/o,-1,1)),Math.asin(rP(a/s,-1,1))-Math.asin(rP(h/s,-1,1)))),l=Math.max(i,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){xS(this.options.afterCalculateLabelRotation,[this])}beforeFit(){xS(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:i,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const o=Jk(i,e.options.font);if(a?(t.width=this.maxWidth,t.height=Kk(r)+o):(t.height=this.maxHeight,t.width=Kk(r)+o),n.display&&this.ticks.length){const{first:e,last:i,widest:r,highest:o}=this._getLabelSizes(),s=2*n.padding,l=KS(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(a){const e=n.mirror?0:u*r.width+c*o.height;t.height=Math.min(this.maxHeight,t.height+e+s)}else{const e=n.mirror?0:c*r.width+u*o.height;t.width=Math.min(this.maxWidth,t.width+e+s)}this._calculatePadding(e,i,u,c)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,i){const{ticks:{align:r,padding:o},position:a}=this.options,s=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const a=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,h=0;s?l?(u=i*t.width,h=n*e.height):(u=n*t.height,h=i*e.width):"start"===r?h=e.width:"end"===r?u=t.width:(u=t.width/2,h=e.width/2),this.paddingLeft=Math.max((u-a+o)*this.width/(this.width-a),0),this.paddingRight=Math.max((h-c+o)*this.width/(this.width-c),0)}else{let n=e.height/2,i=t.height/2;"start"===r?(n=0,i=t.height):"end"===r&&(n=e.height,i=0),this.paddingTop=n+o,this.paddingBottom=i+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){xS(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,n=t.length;e<n;e++)fS(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=Xk(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length)}return t}_computeLabelSizes(t,e){const{ctx:n,_longestTextCache:i}=this,r=[],o=[];let a,s,l,c,u,h,p,d,f,g,m,y=0,v=0;for(a=0;a<e;++a){if(c=t[a].label,u=this._resolveTickFontOptions(a),n.font=h=u.string,p=i[h]=i[h]||{data:{},gc:[]},d=u.lineHeight,f=g=0,fS(c)||gS(c)){if(gS(c))for(s=0,l=c.length;s<l;++s)m=c[s],fS(m)||gS(m)||(f=KP(n,p.data,p.gc,f,m),g+=d)}else f=KP(n,p.data,p.gc,f,c),g=d;r.push(f),o.push(g),y=Math.max(f,y),v=Math.max(g,v)}!function(t,e){wS(t,(t=>{const n=t.gc,i=n.length/2;let r;if(i>e){for(r=0;r<i;++r)delete t.data[n[r]];n.splice(0,i)}}))}(i,e);const _=r.indexOf(y),b=o.indexOf(v),x=t=>({width:r[t]||0,height:o[t]||0});return{first:x(0),last:x(e-1),widest:x(_),highest:x(b),widths:r,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return rP(this._alignToPixels?QP(this.chart,e,0):e,-32768,32767)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=function(t,e,n){return _E(t,{tick:n,index:e,type:"tick"})}(this.getContext(),t,n))}return this.$context||(this.$context=function(t,e){return _E(t,{scale:e,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=KS(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,s=r?r.highest.height+o:0;return this.isHorizontal()?s*n>a*i?a/n:s/i:s*i<a*n?s/n:a/i}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,i=this.options,{grid:r,position:o}=i,a=r.offset,s=this.isHorizontal(),l=this.ticks.length+(a?1:0),c=Kk(r),u=[],h=r.setContext(this.getContext()),p=h.drawBorder?h.borderWidth:0,d=p/2,f=function(t){return QP(n,t,p)};let g,m,y,v,_,b,x,w,S,P,E,T;if("top"===o)g=f(this.bottom),b=this.bottom-c,w=g-d,P=f(t.top)+d,T=t.bottom;else if("bottom"===o)g=f(this.top),P=t.top,T=f(t.bottom)-d,b=g+d,w=this.top+c;else if("left"===o)g=f(this.right),_=this.right-c,x=g-d,S=f(t.left)+d,E=t.right;else if("right"===o)g=f(this.left),S=t.left,E=f(t.right)-d,_=g+d,x=this.left+c;else if("x"===e){if("center"===o)g=f((t.top+t.bottom)/2+.5);else if(mS(o)){const t=Object.keys(o)[0],e=o[t];g=f(this.chart.scales[t].getPixelForValue(e))}P=t.top,T=t.bottom,b=g+d,w=b+c}else if("y"===e){if("center"===o)g=f((t.left+t.right)/2);else if(mS(o)){const t=Object.keys(o)[0],e=o[t];g=f(this.chart.scales[t].getPixelForValue(e))}_=g-d,x=_-c,S=t.left,E=t.right}const k=_S(i.ticks.maxTicksLimit,l),A=Math.max(1,Math.ceil(l/k));for(m=0;m<l;m+=A){const t=r.setContext(this.getContext(m)),e=t.lineWidth,i=t.color,o=r.borderDash||[],l=t.borderDashOffset,c=t.tickWidth,h=t.tickColor,p=t.tickBorderDash||[],d=t.tickBorderDashOffset;y=Yk(this,m,a),void 0!==y&&(v=QP(n,y,e),s?_=x=S=E=v:b=w=P=T=v,u.push({tx1:_,ty1:b,tx2:x,ty2:w,x1:S,y1:P,x2:E,y2:T,width:e,color:i,borderDash:o,borderDashOffset:l,tickWidth:c,tickColor:h,tickBorderDash:p,tickBorderDashOffset:d}))}return this._ticksLength=l,this._borderValue=g,u}_computeLabelItems(t){const e=this.axis,n=this.options,{position:i,ticks:r}=n,o=this.isHorizontal(),a=this.ticks,{align:s,crossAlign:l,padding:c,mirror:u}=r,h=Kk(n.grid),p=h+c,d=u?-c:p,f=-KS(this.labelRotation),g=[];let m,y,v,_,b,x,w,S,P,E,T,k,A="middle";if("top"===i)x=this.bottom-d,w=this._getXAxisLabelAlignment();else if("bottom"===i)x=this.top+d,w=this._getXAxisLabelAlignment();else if("left"===i){const t=this._getYAxisLabelAlignment(h);w=t.textAlign,b=t.x}else if("right"===i){const t=this._getYAxisLabelAlignment(h);w=t.textAlign,b=t.x}else if("x"===e){if("center"===i)x=(t.top+t.bottom)/2+p;else if(mS(i)){const t=Object.keys(i)[0],e=i[t];x=this.chart.scales[t].getPixelForValue(e)+p}w=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===i)b=(t.left+t.right)/2-p;else if(mS(i)){const t=Object.keys(i)[0],e=i[t];b=this.chart.scales[t].getPixelForValue(e)}w=this._getYAxisLabelAlignment(h).textAlign}"y"===e&&("start"===s?A="top":"end"===s&&(A="bottom"));const C=this._getLabelSizes();for(m=0,y=a.length;m<y;++m){v=a[m],_=v.label;const t=r.setContext(this.getContext(m));S=this.getPixelForTick(m)+r.labelOffset,P=this._resolveTickFontOptions(m),E=P.lineHeight,T=gS(_)?_.length:1;const e=T/2,n=t.color,s=t.textStrokeColor,c=t.textStrokeWidth;let h;if(o?(b=S,k="top"===i?"near"===l||0!==f?-T*E+E/2:"center"===l?-C.highest.height/2-e*E+E:-C.highest.height+E/2:"near"===l||0!==f?E/2:"center"===l?C.highest.height/2-e*E:C.highest.height-T*E,u&&(k*=-1)):(x=S,k=(1-T)*E/2),t.showLabelBackdrop){const e=mE(t.backdropPadding),n=C.heights[m],i=C.widths[m];let r=x+k-e.top,o=b-e.left;switch(A){case"middle":r-=n/2;break;case"bottom":r-=n}switch(w){case"center":o-=i/2;break;case"right":o-=i}h={left:o,top:r,width:i+e.width,height:n+e.height,color:t.backdropColor}}g.push({rotation:f,label:_,font:P,color:n,strokeColor:s,strokeWidth:c,textOffset:k,textAlign:w,textBaseline:A,translation:[b,x],backdrop:h})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-KS(this.labelRotation))return"top"===t?"left":"right";let n="center";return"start"===e.align?n="left":"end"===e.align&&(n="right"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:i,padding:r}}=this.options,o=t+r,a=this._getLabelSizes().widest.width;let s,l;return"left"===e?i?(l=this.right+r,"near"===n?s="left":"center"===n?(s="center",l+=a/2):(s="right",l+=a)):(l=this.right-o,"near"===n?s="right":"center"===n?(s="center",l-=a/2):(s="left",l=this.left)):"right"===e?i?(l=this.left+r,"near"===n?s="right":"center"===n?(s="center",l-=a/2):(s="left",l-=a)):(l=this.left+o,"near"===n?s="left":"center"===n?(s="center",l+=a/2):(s="right",l=this.right)):s="right",{textAlign:s,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:i,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,i,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex((e=>e.value===t));if(n>=0){return e.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(t){const e=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(t,e,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.restore())};if(e.display)for(r=0,o=i.length;r<o;++r){const t=i[r];e.drawOnChartArea&&a({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&a({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{grid:n}}=this,i=n.setContext(this.getContext()),r=n.drawBorder?i.borderWidth:0;if(!r)return;const o=n.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let s,l,c,u;this.isHorizontal()?(s=QP(t,this.left,r)-r/2,l=QP(t,this.right,o)+o/2,c=u=a):(c=QP(t,this.top,r)-r/2,u=QP(t,this.bottom,o)+o/2,s=l=a),e.save(),e.lineWidth=i.borderWidth,e.strokeStyle=i.borderColor,e.beginPath(),e.moveTo(s,c),e.lineTo(l,u),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,n=this._computeLabelArea();n&&nE(e,n);const i=this._labelItems||(this._labelItems=this._computeLabelItems(t));let r,o;for(r=0,o=i.length;r<o;++r){const t=i[r],n=t.font,o=t.label;t.backdrop&&(e.fillStyle=t.backdrop.color,e.fillRect(t.backdrop.left,t.backdrop.top,t.backdrop.width,t.backdrop.height)),aE(e,o,0,t.textOffset,n,t)}n&&iE(e)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:i}}=this;if(!n.display)return;const r=yE(n.font),o=mE(n.padding),a=n.align;let s=r.lineHeight/2;"bottom"===e||"center"===e||mS(e)?(s+=o.bottom,gS(n.text)&&(s+=r.lineHeight*(n.text.length-1))):s+=o.top;const{titleX:l,titleY:c,maxWidth:u,rotation:h}=function(t,e,n,i){const{top:r,left:o,bottom:a,right:s,chart:l}=t,{chartArea:c,scales:u}=l;let h,p,d,f=0;const g=a-r,m=s-o;if(t.isHorizontal()){if(p=hS(i,o,s),mS(n)){const t=Object.keys(n)[0],i=n[t];d=u[t].getPixelForValue(i)+g-e}else d="center"===n?(c.bottom+c.top)/2+g-e:Hk(t,n,e);h=s-o}else{if(mS(n)){const t=Object.keys(n)[0],i=n[t];p=u[t].getPixelForValue(i)-m+e}else p="center"===n?(c.left+c.right)/2-m+e:Hk(t,n,e);d=hS(i,a,r),f="left"===n?-VS:VS}return{titleX:p,titleY:d,maxWidth:h,rotation:f}}(this,s,e,a);aE(t,n.text,0,0,r,{color:n.color,maxWidth:u,rotation:h,textAlign:Qk(a,e,i),textBaseline:"middle",translation:[l,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=_S(t.grid&&t.grid.z,-1);return this._isVisible()&&this.draw===$k.prototype.draw?[{z:n,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:n+1,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let r,o;for(r=0,o=e.length;r<o;++r){const o=e[r];o[n]!==this.id||t&&o.type!==t||i.push(o)}return i}_resolveTickFontOptions(t){return yE(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class tA{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;(function(t){return"id"in t&&"defaults"in t})(e)&&(n=this.register(e));const i=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in i||(i[r]=t,function(t,e,n){const i=kS(Object.create(null),[n?YP.get(n):{},YP.get(e),t.defaults]);YP.set(e,i),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((n=>{const i=n.split("."),r=i.pop(),o=[t].concat(i).join("."),a=e[n].split("."),s=a.pop(),l=a.join(".");YP.route(o,r,l,s)}))}(e,t.defaultRoutes);t.descriptors&&YP.describe(e,t.descriptors)}(t,o,n),this.override&&YP.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,i=this.scope;n in e&&delete e[n],i&&n in YP[i]&&(delete YP[i][n],this.override&&delete qP[n])}}var eA=new class{constructor(){this.controllers=new tA(BT,"datasets",!0),this.elements=new tA(Uk,"elements"),this.plugins=new tA(Object,"plugins"),this.scales=new tA($k,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("register",e)}remove(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("unregister",e)}addControllers(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("register",e,this.controllers)}addElements(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("register",e,this.elements)}addPlugins(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("register",e,this.plugins)}addScales(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("register",e,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("unregister",e,this.controllers)}removeElements(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("unregister",e,this.elements)}removePlugins(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("unregister",e,this.plugins)}removeScales(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._each("unregister",e,this.scales)}_each(t,e,n){[...e].forEach((e=>{const i=n||this._getRegistryForType(e);n||i.isForType(e)||i===this.plugins&&e.id?this._exec(t,i,e):wS(e,(e=>{const i=n||this._getRegistryForType(e);this._exec(t,i,e)}))}))}_exec(t,e,n){const i=LS(t);xS(n["before"+i],[],n),e[t](n),xS(n["after"+i],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const i=e.get(t);if(void 0===i)throw new Error('"'+t+'" is not a registered '+n+".");return i}};class nA{constructor(){this._init=[]}notify(t,e,n,i){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=i?this._descriptors(t).filter(i):this._descriptors(t),o=this._notify(r,t,e,n);return"afterDestroy"===e&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,n,i){i=i||{};for(const r of t){const t=r.plugin;if(!1===xS(t[n],[e,i,r.options],t)&&i.cancelable)return!1}return!0}invalidate(){fS(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,i=_S(n.options&&n.options.plugins,{}),r=function(t){const e=[],n=Object.keys(eA.plugins.items);for(let r=0;r<n.length;r++)e.push(eA.getPlugin(n[r]));const i=t.plugins||[];for(let r=0;r<i.length;r++){const t=i[r];-1===e.indexOf(t)&&e.push(t)}return e}(n);return!1!==i||e?function(t,e,n,i){const r=[],o=t.getContext();for(let a=0;a<e.length;a++){const s=e[a],l=iA(n[s.id],i);null!==l&&r.push({plugin:s,options:rA(t.config,s,l,o)})}return r}(t,r,i,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,i=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(i(e,n),t,"stop"),this._notify(i(n,e),t,"start")}}function iA(t,e){return e||!1!==t?!0===t?{}:t:null}function rA(t,e,n,i){const r=t.pluginScopeKeys(e),o=t.getOptionScopes(n,r);return t.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function oA(t,e){const n=YP.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function aA(t,e){return"x"===t||"y"===t?t:e.axis||function(t){return"top"===t||"bottom"===t?"x":"left"===t||"right"===t?"y":void 0}(e.position)||t.charAt(0).toLowerCase()}function sA(t){const e=t.options||(t.options={});e.plugins=_S(e.plugins,{}),e.scales=function(t,e){const n=qP[t.type]||{scales:{}},i=e.scales||{},r=oA(t.type,e),o=Object.create(null),a=Object.create(null);return Object.keys(i).forEach((t=>{const e=i[t];if(!mS(e))return console.error("Invalid scale configuration for scale: ".concat(t));if(e._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));const s=aA(t,e),l=function(t,e){return t===e?"_index_":"_value_"}(s,r),c=n.scales||{};o[s]=o[s]||t,a[t]=AS(Object.create(null),[{axis:s},e,c[s],c[l]])})),t.data.datasets.forEach((n=>{const r=n.type||t.type,s=n.indexAxis||oA(r,e),l=(qP[r]||{}).scales||{};Object.keys(l).forEach((t=>{const e=function(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}(t,s),r=n[e+"AxisID"]||o[e]||e;a[r]=a[r]||Object.create(null),AS(a[r],[{axis:e},i[r],l[t]])}))})),Object.keys(a).forEach((t=>{const e=a[t];AS(e,[YP.scales[e.type],YP.scale])})),a}(t,e)}function lA(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const cA=new Map,uA=new Set;function hA(t,e){let n=cA.get(t);return n||(n=e(),cA.set(t,n),uA.add(n)),n}const pA=(t,e,n)=>{const i=IS(e,n);void 0!==i&&t.add(i)};class dA{constructor(t){this._config=function(t){return(t=t||{}).data=lA(t.data),sA(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=lA(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),sA(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return hA(t,(()=>[["datasets.".concat(t),""]]))}datasetAnimationScopeKeys(t,e){return hA("".concat(t,".transition.").concat(e),(()=>[["datasets.".concat(t,".transitions.").concat(e),"transitions.".concat(e)],["datasets.".concat(t),""]]))}datasetElementScopeKeys(t,e){return hA("".concat(t,"-").concat(e),(()=>[["datasets.".concat(t,".elements.").concat(e),"datasets.".concat(t),"elements.".concat(e),""]]))}pluginScopeKeys(t){const e=t.id,n=this.type;return hA("".concat(n,"-plugin-").concat(e),(()=>[["plugins.".concat(e),...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const n=this._scopeCache;let i=n.get(t);return i&&!e||(i=new Map,n.set(t,i)),i}getOptionScopes(t,e,n){const{options:i,type:r}=this,o=this._cachedScopes(t,n),a=o.get(e);if(a)return a;const s=new Set;e.forEach((e=>{t&&(s.add(t),e.forEach((e=>pA(s,t,e)))),e.forEach((t=>pA(s,i,t))),e.forEach((t=>pA(s,qP[r]||{},t))),e.forEach((t=>pA(s,YP,t))),e.forEach((t=>pA(s,ZP,t)))}));const l=Array.from(s);return 0===l.length&&l.push(Object.create(null)),uA.has(e)&&o.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,qP[e]||{},YP.datasets[e]||{},{type:e},YP,ZP]}resolveNamedOptions(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const r={$shared:!0},{resolver:o,subPrefixes:a}=fA(this._resolverCache,t,i);let s=o;if(function(t,e){const{isScriptable:n,isIndexable:i}=AE(t);for(const r of e){const e=n(r),o=i(r),a=(o||e)&&t[r];if(e&&(zS(a)||gA(a))||o&&gS(a))return!0}return!1}(o,e)){r.$shared=!1;s=kE(o,n=zS(n)?n():n,this.createResolver(t,n,a))}for(const l of e)r[l]=s[l];return r}createResolver(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],i=arguments.length>3?arguments[3]:void 0;const{resolver:r}=fA(this._resolverCache,t,n);return mS(e)?kE(r,e,void 0,i):r}}function fA(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const r=n.join();let o=i.get(r);if(!o){o={resolver:TE(e,n),subPrefixes:n.filter((t=>!t.toLowerCase().includes("hover")))},i.set(r,o)}return o}const gA=t=>mS(t)&&Object.getOwnPropertyNames(t).reduce(((e,n)=>e||zS(t[n])),!1);const mA=["top","bottom","left","right","chartArea"];function yA(t,e){return"top"===t||"bottom"===t||-1===mA.indexOf(t)&&"x"===e}function vA(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function _A(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),xS(n&&n.onComplete,[t],e)}function bA(t){const e=t.chart,n=e.options.animation;xS(n&&n.onProgress,[t],e)}function xA(t){return XE()&&"string"===typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const wA={},SA=t=>{const e=xA(t);return Object.values(wA).filter((t=>t.canvas===e)).pop()};function PA(t,e,n){const i=Object.keys(t);for(const r of i){const i=+r;if(i>=e){const o=t[r];delete t[r],(n>0||i>e)&&(t[i+n]=o)}}}class EA{constructor(t,e){const n=this.config=new dA(e),i=xA(t),r=SA(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(t){return!XE()||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas?kk:Vk}(i)),this.platform.updateConfig(n);const a=this.platform.acquireContext(i,o.aspectRatio),s=a&&a.canvas,l=s&&s.height,c=s&&s.width;this.id=dS(),this.ctx=a,this.canvas=s,this.width=c,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new nA,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(t,e){let n;return function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}((t=>this.update(t)),o.resizeDelay||0),this._dataChanges=[],wA[this.id]=this,a&&s?(xT.listen(this,"complete",_A),xT.listen(this,"progress",bA),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:i,_aspectRatio:r}=this;return fS(t)?e&&r?r:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():iT(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return $P(this.canvas,this.ctx),this}stop(){return xT.stop(this),this}resize(t,e){xT.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,i=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,t,e,r),a=n.devicePixelRatio||this.platform.getDevicePixelRatio(),s=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,iT(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),xS(n.onResize,[this,o],this),this.attached&&this._doResize(s)&&this.render())}ensureScalesHaveIDs(){wS(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,i=Object.keys(n).reduce(((t,e)=>(t[e]=!1,t)),{});let r=[];e&&(r=r.concat(Object.keys(e).map((t=>{const n=e[t],i=aA(t,n),r="r"===i,o="x"===i;return{options:n,dposition:r?"chartArea":o?"bottom":"left",dtype:r?"radialLinear":o?"category":"linear"}})))),wS(r,(e=>{const r=e.options,o=r.id,a=aA(o,r),s=_S(r.type,e.dtype);void 0!==r.position&&yA(r.position,a)===yA(e.dposition)||(r.position=e.dposition),i[o]=!0;let l=null;if(o in n&&n[o].type===s)l=n[o];else{l=new(eA.getScale(s))({id:o,type:s,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(r,t)})),wS(i,((t,e)=>{t||delete n[e]})),wS(n,(t=>{Ek.configure(this,t,t.options),Ek.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort(((t,e)=>t.index-e.index)),n>e){for(let t=e;t<n;++t)this._destroyDatasetMeta(t);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(vA("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,n)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=e.length;n<i;n++){const i=e[n];let r=this.getDatasetMeta(n);const o=i.type||this.config.type;if(r.type&&r.type!==o&&(this._destroyDatasetMeta(n),r=this.getDatasetMeta(n)),r.type=o,r.indexAxis=i.indexAxis||oA(o,this.options),r.order=i.order||0,r.index=n,r.label=""+i.label,r.visible=this.isDatasetVisible(n),r.controller)r.controller.updateIndex(n),r.controller.linkScales();else{const e=eA.getController(o),{datasetElementType:i,dataElementType:a}=YP.datasets[o];Object.assign(e.prototype,{dataElementType:eA.getElement(a),datasetElementType:i&&eA.getElement(i)}),r.controller=new e(this,n),t.push(r.controller)}}return this._updateMetasets(),t}_resetElements(){wS(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:t}=this.getDatasetMeta(l),e=!i&&-1===r.indexOf(t);t.buildOrUpdateElements(e),o=Math.max(+t.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),i||wS(r,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(vA("z","_idx"));const{_active:a,_lastEvent:s}=this;s?this._eventHandler(s,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){wS(this.scales,(t=>{Ek.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);RS(e,n)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:r}of e){PA(t,i,"_removeElements"===n?-r:r)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),i=n(0);for(let r=1;r<e;r++)if(!RS(i,n(r)))return;return Array.from(i).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Ek.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],wS(this.boxes,(t=>{n&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,zS(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(xT.has(this)?this.attached&&!xT.running(this)&&xT.start(this):(this.draw(),_A({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let i,r;for(i=0,r=e.length;i<r;++i){const r=e[i];t&&!r.visible||n.push(r)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n=t._clip,i=!n.disabled,r=this.chartArea,o={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",o)&&(i&&nE(e,{left:!1===n.left?0:r.left-n.left,right:!1===n.right?this.width:r.right+n.right,top:!1===n.top?0:r.top-n.top,bottom:!1===n.bottom?this.height:r.bottom+n.bottom}),t.controller.draw(),i&&iE(e),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}getElementsAtEventForMode(t,e,n,i){const r=pk.modes[e];return"function"===typeof r?r(this,t,n,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let i=n.filter((t=>t&&t._dataset===e)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=_E(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"===typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const i=n?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,i);OS(e)?(r.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),o.update(r,{visible:n}),this.update((e=>e.datasetIndex===t?i:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),xT.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),$P(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete wA[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(t,e,n)=>{t.offsetX=e,t.offsetY=n,this._eventHandler(t)};wS(this.options.events,(t=>n(t,i)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(n,i)=>{t[n]&&(e.removeEventListener(this,n,i),delete t[n])},r=(t,e)=>{this.canvas&&this.resize(t,e)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),n("resize",r),n("detach",o)};o=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),n("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){wS(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},wS(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const i=n?"set":"remove";let r,o,a,s;for("dataset"===e&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),a=0,s=t.length;a<s;++a){o=t[a];const e=o&&this.getDatasetMeta(o.datasetIndex).controller;e&&e[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map((t=>{let{datasetIndex:e,index:n}=t;const i=this.getDatasetMeta(e);if(!i)throw new Error("No dataset found at index "+e);return{datasetIndex:e,element:i.data[n],index:n}}));!SS(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}_updateHoverStyles(t,e,n){const i=this.options.hover,r=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),o=r(e,t),a=n?t:r(t,e);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:eE(t,this.chartArea,this._minPadding)},i=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const r=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(r||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:i=[],options:r}=this,o=e,a=this._getActiveElements(t,i,n,o),s=function(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(t),l=function(t,e,n,i){return n&&"mouseout"!==t.type?i?e:t:null}(t,this._lastEvent,n,s);n&&(this._lastEvent=null,xS(r.onHover,[t,a,this],this),s&&xS(r.onClick,[t,a,this],this));const c=!SS(a,i);return(c||e)&&(this._active=a,this._updateHoverStyles(a,i,e)),this._lastEvent=l,c}_getActiveElements(t,e,n,i){if("mouseout"===t.type)return[];if(!n)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,i)}}const TA=()=>wS(EA.instances,(t=>t._plugins.invalidate())),kA=!0;function AA(t,e,n){const{startAngle:i,pixelMargin:r,x:o,y:a,outerRadius:s,innerRadius:l}=e;let c=r/s;t.beginPath(),t.arc(o,a,s,i-c,n+c),l>r?(c=r/l,t.arc(o,a,l,n+c,i-c,!0)):t.arc(o,a,r,n+VS,i-VS),t.closePath(),t.clip()}function CA(t,e,n,i){const r=dE(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const o=(n-e)/2,a=Math.min(o,i*e/2),s=t=>{const e=(n-Math.min(o,t))*i/2;return rP(t,0,Math.min(o,e))};return{outerStart:s(r.outerStart),outerEnd:s(r.outerEnd),innerStart:rP(r.innerStart,0,a),innerEnd:rP(r.innerEnd,0,a)}}function MA(t,e,n,i){return{x:n+t*Math.cos(e),y:i+t*Math.sin(e)}}function IA(t,e,n,i,r){const{x:o,y:a,startAngle:s,pixelMargin:l,innerRadius:c}=e,u=Math.max(e.outerRadius+i+n-l,0),h=c>0?c+i+n+l:0;let p=0;const d=r-s;if(i){const t=((c>0?c-i:0)+(u>0?u-i:0))/2;p=(d-(0!==t?d*t/(t+i):d))/2}const f=(d-Math.max(.001,d*u-n/DS)/u)/2,g=s+f+p,m=r-f-p,{outerStart:y,outerEnd:v,innerStart:_,innerEnd:b}=CA(e,h,u,m-g),x=u-y,w=u-v,S=g+y/x,P=m-v/w,E=h+_,T=h+b,k=g+_/E,A=m-b/T;if(t.beginPath(),t.arc(o,a,u,S,P),v>0){const e=MA(w,P,o,a);t.arc(e.x,e.y,v,P,m+VS)}const C=MA(T,m,o,a);if(t.lineTo(C.x,C.y),b>0){const e=MA(T,A,o,a);t.arc(e.x,e.y,b,m+VS,A+Math.PI)}if(t.arc(o,a,h,m-b/h,g+_/h,!0),_>0){const e=MA(E,k,o,a);t.arc(e.x,e.y,_,k+Math.PI,g-VS)}const M=MA(x,g,o,a);if(t.lineTo(M.x,M.y),y>0){const e=MA(x,S,o,a);t.arc(e.x,e.y,y,g-VS,S)}t.closePath()}function LA(t,e,n,i,r){const{options:o}=e,{borderWidth:a,borderJoinStyle:s}=o,l="inner"===o.borderAlign;a&&(l?(t.lineWidth=2*a,t.lineJoin=s||"round"):(t.lineWidth=a,t.lineJoin=s||"bevel"),e.fullCircles&&function(t,e,n){const{x:i,y:r,startAngle:o,pixelMargin:a,fullCircles:s}=e,l=Math.max(e.outerRadius-a,0),c=e.innerRadius+a;let u;for(n&&AA(t,e,o+FS),t.beginPath(),t.arc(i,r,c,o+FS,o,!0),u=0;u<s;++u)t.stroke();for(t.beginPath(),t.arc(i,r,l,o,o+FS),u=0;u<s;++u)t.stroke()}(t,e,l),l&&AA(t,e,r),IA(t,e,n,i,r),t.stroke())}Object.defineProperties(EA,{defaults:{enumerable:kA,value:YP},instances:{enumerable:kA,value:wA},overrides:{enumerable:kA,value:qP},registry:{enumerable:kA,value:eA},version:{enumerable:kA,value:"3.7.1"},getChart:{enumerable:kA,value:SA},register:{enumerable:kA,value:function(){eA.add(...arguments),TA()}},unregister:{enumerable:kA,value:function(){eA.remove(...arguments),TA()}}});class OA extends Uk{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.getProps(["x","y"],n),{angle:r,distance:o}=$S(i,{x:t,y:e}),{startAngle:a,endAngle:s,innerRadius:l,outerRadius:c,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=this.options.spacing/2,p=_S(u,s-a)>=FS||iP(r,a,s),d=oP(o,l+h,c+h);return p&&d}getCenterPoint(t){const{x:e,y:n,startAngle:i,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:s,spacing:l}=this.options,c=(i+r)/2,u=(o+a+l+s)/2;return{x:e+Math.cos(c)*u,y:n+Math.sin(c)*u}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:n}=this,i=(e.offset||0)/2,r=(e.spacing||0)/2;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=n>FS?Math.floor(n/FS):0,0===n||this.innerRadius<0||this.outerRadius<0)return;t.save();let o=0;if(i){o=i/2;const e=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(e)*o,Math.sin(e)*o),this.circumference>=DS&&(o=i)}t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor;const a=function(t,e,n,i){const{fullCircles:r,startAngle:o,circumference:a}=e;let s=e.endAngle;if(r){IA(t,e,n,i,o+FS);for(let e=0;e<r;++e)t.fill();isNaN(a)||(s=o+a%FS,a%FS===0&&(s+=FS))}return IA(t,e,n,i,s),t.fill(),s}(t,this,o,r);LA(t,this,o,r,a),t.restore()}}function zA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;t.lineCap=_S(n.borderCapStyle,e.borderCapStyle),t.setLineDash(_S(n.borderDash,e.borderDash)),t.lineDashOffset=_S(n.borderDashOffset,e.borderDashOffset),t.lineJoin=_S(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=_S(n.borderWidth,e.borderWidth),t.strokeStyle=_S(n.borderColor,e.borderColor)}function RA(t,e,n){t.lineTo(n.x,n.y)}function DA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=t.length,{start:r=0,end:o=i-1}=n,{start:a,end:s}=e,l=Math.max(r,a),c=Math.min(o,s),u=r<a&&o<a||r>s&&o>s;return{count:i,start:l,loop:e.loop,ilen:c<l&&!u?i+c-l:c-l}}function FA(t,e,n,i){const{points:r,options:o}=e,{count:a,start:s,loop:l,ilen:c}=DA(r,n,i),u=function(t){return t.stepped?rE:t.tension||"monotone"===t.cubicInterpolationMode?oE:RA}(o);let h,p,d,{move:f=!0,reverse:g}=i||{};for(h=0;h<=c;++h)p=r[(s+(g?c-h:h))%a],p.skip||(f?(t.moveTo(p.x,p.y),f=!1):u(t,d,p,g,o.stepped),d=p);return l&&(p=r[(s+(g?c:0))%a],u(t,d,p,g,o.stepped)),!!l}function BA(t,e,n,i){const r=e.points,{count:o,start:a,ilen:s}=DA(r,n,i),{move:l=!0,reverse:c}=i||{};let u,h,p,d,f,g,m=0,y=0;const v=t=>(a+(c?s-t:t))%o,_=()=>{d!==f&&(t.lineTo(m,f),t.lineTo(m,d),t.lineTo(m,g))};for(l&&(h=r[v(0)],t.moveTo(h.x,h.y)),u=0;u<=s;++u){if(h=r[v(u)],h.skip)continue;const e=h.x,n=h.y,i=0|e;i===p?(n<d?d=n:n>f&&(f=n),m=(y*m+e)/++y):(_(),t.lineTo(e,n),p=i,y=0,d=f=n),g=n}_()}function jA(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&"monotone"!==e.cubicInterpolationMode&&!e.stepped&&!n?BA:FA}OA.id="arc",OA.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},OA.defaultRoutes={backgroundColor:"backgroundColor"};const NA="function"===typeof Path2D;function VA(t,e,n,i){NA&&!e.options.segment?function(t,e,n,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,i)&&r.closePath()),zA(t,e.options),t.stroke(r)}(t,e,n,i):function(t,e,n,i){const{segments:r,options:o}=e,a=jA(e);for(const s of r)zA(t,o,s.style),t.beginPath(),a(t,e,s,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}(t,e,n,i)}class UA extends Uk{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;HE(this._points,n,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(t,e){const n=t.points,i=t.options.spanGaps,r=n.length;if(!r)return[];const o=!!t._loop,{start:a,end:s}=function(t,e,n,i){let r=0,o=e-1;if(n&&!i)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(o+=r);o>r&&t[o%e].skip;)o--;return o%=e,{start:r,end:o}}(n,r,o,i);return vT(t,!0===i?[{start:a,end:s,loop:o}]:function(t,e,n,i){const r=t.length,o=[];let a,s=e,l=t[e];for(a=e+1;a<=n;++a){const n=t[a%r];n.skip||n.stop?l.skip||(i=!1,o.push({start:e%r,end:(a-1)%r,loop:i}),e=s=n.stop?a:null):(s=a,l.skip&&(e=a)),l=n}return null!==s&&o.push({start:e%r,end:s%r,loop:i}),o}(n,a,s<a?s+r:s,!!t._fullLoop&&0===a&&s===r-1),n,e)}(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,i=t[e],r=this.points,o=yT(this,{property:e,start:i,end:i});if(!o.length)return;const a=[],s=function(t){return t.stepped?sT:t.tension||"monotone"===t.cubicInterpolationMode?lT:aT}(n);let l,c;for(l=0,c=o.length;l<c;++l){const{start:c,end:u}=o[l],h=r[c],p=r[u];if(h===p){a.push(h);continue}const d=s(h,p,Math.abs((i-h[e])/(p[e]-h[e])),n.stepped);d[e]=t[e],a.push(d)}return 1===a.length?a[0]:a}pathSegment(t,e,n){return jA(this)(t,this,e,n)}path(t,e,n){const i=this.segments,r=jA(this);let o=this._loop;e=e||0,n=n||this.points.length-e;for(const a of i)o&=r(t,this,a,{start:e,end:e+n-1});return!!o}draw(t,e,n,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),VA(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function WA(t,e,n,i){const r=t.options,{[n]:o}=t.getProps([n],i);return Math.abs(e-o)<r.radius+r.hitRadius}UA.id="line",UA.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},UA.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},UA.descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};class GA extends Uk{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.options,{x:r,y:o}=this.getProps(["x","y"],n);return Math.pow(t-r,2)+Math.pow(e-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return WA(this,t,"x",e)}inYRange(t,e){return WA(this,t,"y",e)}getCenterPoint(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}size(t){let e=(t=t||this.options||{}).radius||0;e=Math.max(e,e&&t.hoverRadius||0);return 2*(e+(e&&t.borderWidth||0))}draw(t,e){const n=this.options;this.skip||n.radius<.1||!eE(this,e,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,tE(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function qA(t,e){const{x:n,y:i,base:r,width:o,height:a}=t.getProps(["x","y","base","width","height"],e);let s,l,c,u,h;return t.horizontal?(h=a/2,s=Math.min(n,r),l=Math.max(n,r),c=i-h,u=i+h):(h=o/2,s=n-h,l=n+h,c=Math.min(i,r),u=Math.max(i,r)),{left:s,top:c,right:l,bottom:u}}function ZA(t,e,n,i){return t?0:rP(e,n,i)}function HA(t){const e=qA(t),n=e.right-e.left,i=e.bottom-e.top,r=function(t,e,n){const i=t.options.borderWidth,r=t.borderSkipped,o=fE(i);return{t:ZA(r.top,o.top,0,n),r:ZA(r.right,o.right,0,e),b:ZA(r.bottom,o.bottom,0,n),l:ZA(r.left,o.left,0,e)}}(t,n/2,i/2),o=function(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,o=gE(r),a=Math.min(e,n),s=t.borderSkipped,l=i||mS(r);return{topLeft:ZA(!l||s.top||s.left,o.topLeft,0,a),topRight:ZA(!l||s.top||s.right,o.topRight,0,a),bottomLeft:ZA(!l||s.bottom||s.left,o.bottomLeft,0,a),bottomRight:ZA(!l||s.bottom||s.right,o.bottomRight,0,a)}}(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:o},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function XA(t,e,n,i){const r=null===e,o=null===n,a=t&&!(r&&o)&&qA(t,i);return a&&(r||oP(e,a.left,a.right))&&(o||oP(n,a.top,a.bottom))}function YA(t,e){t.rect(e.x,e.y,e.w,e.h)}function KA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,o=(t.x+t.w!==n.x+n.w?e:0)-i,a=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+i,y:t.y+r,w:t.w+o,h:t.h+a,radius:t.radius}}GA.id="point",GA.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},GA.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};class JA extends Uk{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:i}}=this,{inner:r,outer:o}=HA(this),a=(s=o.radius).topLeft||s.topRight||s.bottomLeft||s.bottomRight?cE:YA;var s;t.save(),o.w===r.w&&o.h===r.h||(t.beginPath(),a(t,KA(o,e,r)),t.clip(),a(t,KA(r,-e,o)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),a(t,KA(r,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,n){return XA(this,t,e,n)}inXRange(t,e){return XA(this,t,null,e)}inYRange(t,e){return XA(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+i)/2:e,y:r?n:(n+i)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}JA.id="bar",JA.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},JA.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var QA=Object.freeze({__proto__:null,ArcElement:OA,LineElement:UA,PointElement:GA,BarElement:JA});function $A(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{value:e})}}function tC(t){t.data.datasets.forEach((t=>{$A(t)}))}var eC={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled)return void tC(t);const i=t.width;t.data.datasets.forEach(((e,r)=>{const{_data:o,indexAxis:a}=e,s=t.getDatasetMeta(r),l=o||e.data;if("y"===vE([a,t.options.indexAxis]))return;if("line"!==s.type)return;const c=t.scales[s.xAxisID];if("linear"!==c.type&&"time"!==c.type)return;if(t.options.parsing)return;let{start:u,count:h}=function(t,e){const n=e.length;let i,r=0;const{iScale:o}=t,{min:a,max:s,minDefined:l,maxDefined:c}=o.getUserBounds();return l&&(r=rP(xE(e,o.axis,a).lo,0,n-1)),i=c?rP(xE(e,o.axis,s).hi+1,r,n)-r:n-r,{start:r,count:i}}(s,l);if(h<=(n.threshold||4*i))return void $A(e);let p;switch(fS(o)&&(e._data=l,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),n.algorithm){case"lttb":p=function(t,e,n,i,r){const o=r.samples||i;if(o>=n)return t.slice(e,e+n);const a=[],s=(n-2)/(o-2);let l=0;const c=e+n-1;let u,h,p,d,f,g=e;for(a[l++]=t[g],u=0;u<o-2;u++){let i,r=0,o=0;const c=Math.floor((u+1)*s)+1+e,m=Math.min(Math.floor((u+2)*s)+1,n)+e,y=m-c;for(i=c;i<m;i++)r+=t[i].x,o+=t[i].y;r/=y,o/=y;const v=Math.floor(u*s)+1+e,_=Math.min(Math.floor((u+1)*s)+1,n)+e,{x:b,y:x}=t[g];for(p=d=-1,i=v;i<_;i++)d=.5*Math.abs((b-r)*(t[i].y-x)-(b-t[i].x)*(o-x)),d>p&&(p=d,h=t[i],f=i);a[l++]=h,g=f}return a[l++]=t[c],a}(l,u,h,i,n);break;case"min-max":p=function(t,e,n,i){let r,o,a,s,l,c,u,h,p,d,f=0,g=0;const m=[],y=e+n-1,v=t[e].x,_=t[y].x-v;for(r=e;r<e+n;++r){o=t[r],a=(o.x-v)/_*i,s=o.y;const e=0|a;if(e===l)s<p?(p=s,c=r):s>d&&(d=s,u=r),f=(g*f+o.x)/++g;else{const n=r-1;if(!fS(c)&&!fS(u)){const e=Math.min(c,u),i=Math.max(c,u);e!==h&&e!==n&&m.push({...t[e],x:f}),i!==h&&i!==n&&m.push({...t[i],x:f})}r>0&&n!==h&&m.push(t[n]),m.push(o),l=e,g=0,p=d=s,c=u=h=r}}return m}(l,u,h,i);break;default:throw new Error("Unsupported decimation algorithm '".concat(n.algorithm,"'"))}e._decimated=p}))},destroy(t){tC(t)}};function nC(t,e,n){const i=function(t){const e=t.options,n=e.fill;let i=_S(n&&n.target,n);return void 0===i&&(i=!!e.backgroundColor),!1!==i&&null!==i&&(!0===i?"origin":i)}(t);if(mS(i))return!isNaN(i.value)&&i;let r=parseFloat(i);return yS(r)&&Math.floor(r)===r?("-"!==i[0]&&"+"!==i[0]||(r=e+r),!(r===e||r<0||r>=n)&&r):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}class iC{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:i,y:r,radius:o}=this;return e=e||{start:0,end:FS},t.arc(i,r,o,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:i}=this,r=t.angle;return{x:e+Math.cos(r)*i,y:n+Math.sin(r)*i,angle:r}}}function rC(t){return(t.scale||{}).getPointPositionForValue?function(t){const{scale:e,fill:n}=t,i=e.options,r=e.getLabels().length,o=[],a=i.reverse?e.max:e.min,s=i.reverse?e.min:e.max;let l,c,u;if(u="start"===n?a:"end"===n?s:mS(n)?n.value:e.getBaseValue(),i.grid.circular)return c=e.getPointPositionForValue(0,a),new iC({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(u)});for(l=0;l<r;++l)o.push(e.getPointPositionForValue(l,u));return o}(t):function(t){const{scale:e={},fill:n}=t;let i,r=null;return"start"===n?r=e.bottom:"end"===n?r=e.top:mS(n)?r=e.getPixelForValue(n.value):e.getBasePixel&&(r=e.getBasePixel()),yS(r)?(i=e.isHorizontal(),{x:i?r:null,y:i?null:r}):null}(t)}function oC(t,e,n){for(;e>t;e--){const t=n[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function aC(t,e,n){const i=[];for(let r=0;r<n.length;r++){const o=n[r],{first:a,last:s,point:l}=sC(o,e,"x");if(!(!l||a&&s))if(a)i.unshift(l);else if(t.push(l),!s)break}t.push(...i)}function sC(t,e,n){const i=t.interpolate(e,n);if(!i)return{};const r=i[n],o=t.segments,a=t.points;let s=!1,l=!1;for(let c=0;c<o.length;c++){const t=o[c],e=a[t.start][n],i=a[t.end][n];if(oP(r,e,i)){s=r===e,l=r===i;break}}return{first:s,last:l,point:i}}function lC(t){const{chart:e,fill:n,line:i}=t;if(yS(n))return function(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}(e,n);if("stack"===n)return function(t){const{scale:e,index:n,line:i}=t,r=[],o=i.segments,a=i.points,s=function(t,e){const n=[],i=t.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const t=i[r];if(t.index===e)break;t.hidden||n.unshift(t.dataset)}return n}(e,n);s.push(cC({x:null,y:e.bottom},i));for(let l=0;l<o.length;l++){const t=o[l];for(let e=t.start;e<=t.end;e++)aC(r,a[e],s)}return new UA({points:r,options:{}})}(t);if("shape"===n)return!0;const r=rC(t);return r instanceof iC?r:cC(r,i)}function cC(t,e){let n=[],i=!1;return gS(t)?(i=!0,n=t):n=function(t,e){const{x:n=null,y:i=null}=t||{},r=e.points,o=[];return e.segments.forEach((t=>{let{start:e,end:a}=t;a=oC(e,a,r);const s=r[e],l=r[a];null!==i?(o.push({x:s.x,y:i}),o.push({x:l.x,y:i})):null!==n&&(o.push({x:n,y:s.y}),o.push({x:n,y:l.y}))})),o}(t,e),n.length?new UA({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function uC(t,e,n){let i=t[e].fill;const r=[e];let o;if(!n)return i;for(;!1!==i&&-1===r.indexOf(i);){if(!yS(i))return i;if(o=t[i],!o)return!1;if(o.visible)return i;r.push(i),i=o.fill}return!1}function hC(t,e,n){const{segments:i,points:r}=e;let o=!0,a=!1;t.beginPath();for(const s of i){const{start:i,end:l}=s,c=r[i],u=r[oC(i,l,r)];o?(t.moveTo(c.x,c.y),o=!1):(t.lineTo(c.x,n),t.lineTo(c.x,c.y)),a=!!e.pathSegment(t,s,{move:a}),a?t.closePath():t.lineTo(u.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function pC(t,e,n,i){if(i)return;let r=e[t],o=n[t];return"angle"===t&&(r=nP(r),o=nP(o)),{property:t,start:r,end:o}}function dC(t,e,n,i){return t&&e?i(t[n],e[n]):t?t[n]:e?e[n]:0}function fC(t,e,n){const{top:i,bottom:r}=e.chart.chartArea,{property:o,start:a,end:s}=n||{};"x"===o&&(t.beginPath(),t.rect(a,i,s-a,r-i),t.clip())}function gC(t,e,n,i){const r=e.interpolate(n,i);r&&t.lineTo(r.x,r.y)}function mC(t,e){const{line:n,target:i,property:r,color:o,scale:a}=e,s=function(t,e,n){const i=t.segments,r=t.points,o=e.points,a=[];for(const s of i){let{start:t,end:i}=s;i=oC(t,i,r);const l=pC(n,r[t],r[i],s.loop);if(!e.segments){a.push({source:s,target:l,start:r[t],end:r[i]});continue}const c=yT(e,l);for(const e of c){const t=pC(n,o[e.start],o[e.end],e.loop),i=mT(s,r,t);for(const r of i)a.push({source:r,target:e,start:{[n]:dC(l,t,"start",Math.max)},end:{[n]:dC(l,t,"end",Math.min)}})}}return a}(n,i,r);for(const{source:l,target:c,start:u,end:h}of s){const{style:{backgroundColor:e=o}={}}=l,s=!0!==i;t.save(),t.fillStyle=e,fC(t,a,s&&pC(r,u,h)),t.beginPath();const p=!!n.pathSegment(t,l);let d;if(s){p?t.closePath():gC(t,i,h,r);const e=!!i.pathSegment(t,c,{move:p,reverse:!0});d=p&&e,d||gC(t,i,u,r)}t.closePath(),t.fill(d?"evenodd":"nonzero"),t.restore()}}function yC(t,e,n){const i=lC(e),{line:r,scale:o,axis:a}=e,s=r.options,l=s.fill,c=s.backgroundColor,{above:u=c,below:h=c}=l||{};i&&r.points.length&&(nE(t,n),function(t,e){const{line:n,target:i,above:r,below:o,area:a,scale:s}=e,l=n._loop?"angle":e.axis;t.save(),"x"===l&&o!==r&&(hC(t,i,a.top),mC(t,{line:n,target:i,color:r,scale:s,property:l}),t.restore(),t.save(),hC(t,i,a.bottom)),mC(t,{line:n,target:i,color:o,scale:s,property:l}),t.restore()}(t,{line:r,target:i,above:u,below:h,area:n,scale:o,axis:a}),iE(t))}var vC={id:"filler",afterDatasetsUpdate(t,e,n){const i=(t.data.datasets||[]).length,r=[];let o,a,s,l;for(a=0;a<i;++a)o=t.getDatasetMeta(a),s=o.dataset,l=null,s&&s.options&&s instanceof UA&&(l={visible:t.isDatasetVisible(a),index:a,fill:nC(s,a,i),chart:t,axis:o.controller.options.indexAxis,scale:o.vScale,line:s}),o.$filler=l,r.push(l);for(a=0;a<i;++a)l=r[a],l&&!1!==l.fill&&(l.fill=uC(r,a,n.propagate))},beforeDraw(t,e,n){const i="beforeDraw"===n.drawTime,r=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let a=r.length-1;a>=0;--a){const e=r[a].$filler;e&&(e.line.updateControlPoints(o,e.axis),i&&yC(t.ctx,e,o))}},beforeDatasetsDraw(t,e,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=t.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const e=i[r].$filler;e&&yC(t.ctx,e,t.chartArea)}},beforeDatasetDraw(t,e,n){const i=e.meta.$filler;i&&!1!==i.fill&&"beforeDatasetDraw"===n.drawTime&&yC(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const _C=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}};class bC extends Uk{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=xS(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,n)=>t.sort(e,n,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const n=t.labels,i=yE(n.font),r=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:s}=_C(n,r);let l,c;e.font=i.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(o,r,a,s)+10):(c=this.maxHeight,l=this._fitCols(o,r,a,s)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,i){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,s=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+a;let u=t;r.textAlign="left",r.textBaseline="middle";let h=-1,p=-c;return this.legendItems.forEach(((t,d)=>{const f=n+e/2+r.measureText(t.text).width;(0===d||l[l.length-1]+f+2*a>o)&&(u+=c,l[l.length-(d>0?0:1)]=0,p+=c,h++),s[d]={left:0,top:p,row:h,width:f,height:i},l[l.length-1]+=f+a})),u}_fitCols(t,e,n,i){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,s=this.legendHitBoxes=[],l=this.columnSizes=[],c=o-t;let u=a,h=0,p=0,d=0,f=0;return this.legendItems.forEach(((t,o)=>{const g=n+e/2+r.measureText(t.text).width;o>0&&p+i+2*a>c&&(u+=h+a,l.push({width:h,height:p}),d+=h+a,f++,h=p=0),s[o]={left:d,top:p,col:f,width:g,height:i},h=Math.max(h,g),p+=i+a})),u+=h,l.push({width:h,height:p}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:i},rtl:r}}=this,o=hT(r,this.left,this.width);if(this.isHorizontal()){let r=0,a=hS(n,this.left+i,this.right-this.lineWidths[r]);for(const s of e)r!==s.row&&(r=s.row,a=hS(n,this.left+i,this.right-this.lineWidths[r])),s.top+=this.top+t+i,s.left=o.leftForLtr(o.x(a),s.width),a+=s.width+i}else{let r=0,a=hS(n,this.top+t+i,this.bottom-this.columnSizes[r].height);for(const s of e)s.col!==r&&(r=s.col,a=hS(n,this.top+t+i,this.bottom-this.columnSizes[r].height)),s.top=a,s.left+=this.left+i,s.left=o.leftForLtr(o.x(s.left),s.width),a+=s.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;nE(t,this),this._draw(),iE(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:i}=this,{align:r,labels:o}=t,a=YP.color,s=hT(t.rtl,this.left,this.width),l=yE(o.font),{color:c,padding:u}=o,h=l.size,p=h/2;let d;this.drawTitle(),i.textAlign=s.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;const{boxWidth:f,boxHeight:g,itemHeight:m}=_C(o,h),y=this.isHorizontal(),v=this._computeTitleHeight();d=y?{x:hS(r,this.left+u,this.right-n[0]),y:this.top+u+v,line:0}:{x:this.left+u,y:hS(r,this.top+v+u,this.bottom-e[0].height),line:0},pT(this.ctx,t.textDirection);const _=m+u;this.legendItems.forEach(((b,x)=>{i.strokeStyle=b.fontColor||c,i.fillStyle=b.fontColor||c;const w=i.measureText(b.text).width,S=s.textAlign(b.textAlign||(b.textAlign=o.textAlign)),P=f+p+w;let E=d.x,T=d.y;s.setWidth(this.width),y?x>0&&E+P+u>this.right&&(T=d.y+=_,d.line++,E=d.x=hS(r,this.left+u,this.right-n[d.line])):x>0&&T+_>this.bottom&&(E=d.x=E+e[d.line].width+u,d.line++,T=d.y=hS(r,this.top+v+u,this.bottom-e[d.line].height));!function(t,e,n){if(isNaN(f)||f<=0||isNaN(g)||g<0)return;i.save();const r=_S(n.lineWidth,1);if(i.fillStyle=_S(n.fillStyle,a),i.lineCap=_S(n.lineCap,"butt"),i.lineDashOffset=_S(n.lineDashOffset,0),i.lineJoin=_S(n.lineJoin,"miter"),i.lineWidth=r,i.strokeStyle=_S(n.strokeStyle,a),i.setLineDash(_S(n.lineDash,[])),o.usePointStyle){const o={radius:f*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},a=s.xPlus(t,f/2);tE(i,o,a,e+p)}else{const o=e+Math.max((h-g)/2,0),a=s.leftForLtr(t,f),l=gE(n.borderRadius);i.beginPath(),Object.values(l).some((t=>0!==t))?cE(i,{x:a,y:o,w:f,h:g,radius:l}):i.rect(a,o,f,g),i.fill(),0!==r&&i.stroke()}i.restore()}(s.x(E),T,b),E=((t,e,n,i)=>t===(i?"left":"right")?n:"center"===t?(e+n)/2:e)(S,E+f+p,y?E+P:this.right,t.rtl),function(t,e,n){aE(i,n.text,t,e+m/2,l,{strikethrough:n.hidden,textAlign:s.textAlign(n.textAlign)})}(s.x(E),T,b),y?d.x+=P+u:d.y+=_})),dT(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=yE(e.font),i=mE(e.padding);if(!e.display)return;const r=hT(t.rtl,this.left,this.width),o=this.ctx,a=e.position,s=n.size/2,l=i.top+s;let c,u=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),c=this.top+l,u=hS(t.align,u,this.right-h);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);c=l+hS(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const p=hS(a,u,u+h);o.textAlign=r.textAlign(uS(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=n.string,aE(o,e.text,p,c,n)}_computeTitleHeight(){const t=this.options.title,e=yE(t.font),n=mE(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,i,r;if(oP(t,this.left,this.right)&&oP(e,this.top,this.bottom))for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(i=r[n],oP(t,i.left,i.left+i.width)&&oP(e,i.top,i.top+i.height))return this.legendItems[n];return null}handleEvent(t){const e=this.options;if(!function(t,e){if("mousemove"===t&&(e.onHover||e.onLeave))return!0;if(e.onClick&&("click"===t||"mouseup"===t))return!0;return!1}(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type){const o=this._hoveredItem,a=(r=n,null!==(i=o)&&null!==r&&i.datasetIndex===r.datasetIndex&&i.index===r.index);o&&!a&&xS(e.onLeave,[t,o,this],this),this._hoveredItem=n,n&&!a&&xS(e.onHover,[t,n,this],this)}else n&&xS(e.onClick,[t,n,this],this);var i,r}}var xC={id:"legend",_element:bC,start(t,e,n){const i=t.legend=new bC({ctx:t.ctx,options:n,chart:t});Ek.configure(t,i,n),Ek.addBox(t,i)},stop(t){Ek.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;Ek.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:o}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const a=t.controller.getStyle(n?0:void 0),s=mE(a.borderWidth);return{text:e[t.index].label,fillStyle:a.backgroundColor,fontColor:o,hidden:!t.visible,lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:(s.width+s.height)/4,strokeStyle:a.borderColor,pointStyle:i||a.pointStyle,rotation:a.rotation,textAlign:r||a.textAlign,borderRadius:0,datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class wC extends Uk{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const i=gS(n.text)?n.text.length:1;this._padding=mE(n.padding);const r=i*yE(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:i,right:r,options:o}=this,a=o.align;let s,l,c,u=0;return this.isHorizontal()?(l=hS(a,n,r),c=e+t,s=r-n):("left"===o.position?(l=n+t,c=hS(a,i,e),u=-.5*DS):(l=r-t,c=hS(a,e,i),u=.5*DS),s=i-e),{titleX:l,titleY:c,maxWidth:s,rotation:u}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=yE(e.font),i=n.lineHeight/2+this._padding.top,{titleX:r,titleY:o,maxWidth:a,rotation:s}=this._drawArgs(i);aE(t,e.text,0,0,n,{color:e.color,maxWidth:a,rotation:s,textAlign:uS(e.align),textBaseline:"middle",translation:[r,o]})}}var SC={id:"title",_element:wC,start(t,e,n){!function(t,e){const n=new wC({ctx:t.ctx,options:e,chart:t});Ek.configure(t,n,e),Ek.addBox(t,n),t.titleBlock=n}(t,n)},stop(t){const e=t.titleBlock;Ek.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;Ek.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const PC=new WeakMap;var EC={id:"subtitle",start(t,e,n){const i=new wC({ctx:t.ctx,options:n,chart:t});Ek.configure(t,i,n),Ek.addBox(t,i),PC.set(t,i)},stop(t){Ek.removeBox(t,PC.get(t)),PC.delete(t)},beforeUpdate(t,e,n){const i=PC.get(t);Ek.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const TC={average(t){if(!t.length)return!1;let e,n,i=0,r=0,o=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();i+=t.x,r+=t.y,++o}}return{x:i/o,y:r/o}},nearest(t,e){if(!t.length)return!1;let n,i,r,o=e.x,a=e.y,s=Number.POSITIVE_INFINITY;for(n=0,i=t.length;n<i;++n){const i=t[n].element;if(i&&i.hasValue()){const t=tP(e,i.getCenterPoint());t<s&&(s=t,r=i)}}if(r){const t=r.tooltipPosition();o=t.x,a=t.y}return{x:o,y:a}}};function kC(t,e){return e&&(gS(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function AC(t){return("string"===typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function CC(t,e){const{element:n,datasetIndex:i,index:r}=e,o=t.getDatasetMeta(i).controller,{label:a,value:s}=o.getLabelAndValue(r);return{chart:t,label:a,parsed:o.getParsed(r),raw:t.data.datasets[i].data[r],formattedValue:s,dataset:o.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function MC(t,e){const n=t.chart.ctx,{body:i,footer:r,title:o}=t,{boxWidth:a,boxHeight:s}=e,l=yE(e.bodyFont),c=yE(e.titleFont),u=yE(e.footerFont),h=o.length,p=r.length,d=i.length,f=mE(e.padding);let g=f.height,m=0,y=i.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);if(y+=t.beforeBody.length+t.afterBody.length,h&&(g+=h*c.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),y){g+=d*(e.displayColors?Math.max(s,l.lineHeight):l.lineHeight)+(y-d)*l.lineHeight+(y-1)*e.bodySpacing}p&&(g+=e.footerMarginTop+p*u.lineHeight+(p-1)*e.footerSpacing);let v=0;const _=function(t){m=Math.max(m,n.measureText(t).width+v)};return n.save(),n.font=c.string,wS(t.title,_),n.font=l.string,wS(t.beforeBody.concat(t.afterBody),_),v=e.displayColors?a+2+e.boxPadding:0,wS(i,(t=>{wS(t.before,_),wS(t.lines,_),wS(t.after,_)})),v=0,n.font=u.string,wS(t.footer,_),n.restore(),m+=f.width,{width:m,height:g}}function IC(t,e,n,i){const{x:r,width:o}=n,{width:a,chartArea:{left:s,right:l}}=t;let c="center";return"center"===i?c=r<=(s+l)/2?"left":"right":r<=o/2?c="left":r>=a-o/2&&(c="right"),function(t,e,n,i){const{x:r,width:o}=i,a=n.caretSize+n.caretPadding;return"left"===t&&r+o+a>e.width||"right"===t&&r-o-a<0||void 0}(c,t,e,n)&&(c="center"),c}function LC(t,e,n){const i=n.yAlign||e.yAlign||function(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}(t,n);return{xAlign:n.xAlign||e.xAlign||IC(t,e,n,i),yAlign:i}}function OC(t,e,n,i){const{caretSize:r,caretPadding:o,cornerRadius:a}=t,{xAlign:s,yAlign:l}=n,c=r+o,{topLeft:u,topRight:h,bottomLeft:p,bottomRight:d}=gE(a);let f=function(t,e){let{x:n,width:i}=t;return"right"===e?n-=i:"center"===e&&(n-=i/2),n}(e,s);const g=function(t,e,n){let{y:i,height:r}=t;return"top"===e?i+=n:i-="bottom"===e?r+n:r/2,i}(e,l,c);return"center"===l?"left"===s?f+=c:"right"===s&&(f-=c):"left"===s?f-=Math.max(u,p)+r:"right"===s&&(f+=Math.max(h,d)+r),{x:rP(f,0,i.width-e.width),y:rP(g,0,i.height-e.height)}}function zC(t,e,n){const i=mE(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-i.right:t.x+i.left}function RC(t){return kC([],AC(t))}function DC(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}class FC extends Uk{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart||t._chart,this._chart=this.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&e.options.animation&&n.animations,r=new TT(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(t=this.chart.getContext(),e=this,n=this._tooltipItems,_E(t,{tooltip:e,tooltipItems:n,type:"tooltip"})));var t,e,n}getTitle(t,e){const{callbacks:n}=e,i=n.beforeTitle.apply(this,[t]),r=n.title.apply(this,[t]),o=n.afterTitle.apply(this,[t]);let a=[];return a=kC(a,AC(i)),a=kC(a,AC(r)),a=kC(a,AC(o)),a}getBeforeBody(t,e){return RC(e.callbacks.beforeBody.apply(this,[t]))}getBody(t,e){const{callbacks:n}=e,i=[];return wS(t,(t=>{const e={before:[],lines:[],after:[]},r=DC(n,t);kC(e.before,AC(r.beforeLabel.call(this,t))),kC(e.lines,r.label.call(this,t)),kC(e.after,AC(r.afterLabel.call(this,t))),i.push(e)})),i}getAfterBody(t,e){return RC(e.callbacks.afterBody.apply(this,[t]))}getFooter(t,e){const{callbacks:n}=e,i=n.beforeFooter.apply(this,[t]),r=n.footer.apply(this,[t]),o=n.afterFooter.apply(this,[t]);let a=[];return a=kC(a,AC(i)),a=kC(a,AC(r)),a=kC(a,AC(o)),a}_createItems(t){const e=this._active,n=this.chart.data,i=[],r=[],o=[];let a,s,l=[];for(a=0,s=e.length;a<s;++a)l.push(CC(this.chart,e[a]));return t.filter&&(l=l.filter(((e,i,r)=>t.filter(e,i,r,n)))),t.itemSort&&(l=l.sort(((e,i)=>t.itemSort(e,i,n)))),wS(l,(e=>{const n=DC(t.callbacks,e);i.push(n.labelColor.call(this,e)),r.push(n.labelPointStyle.call(this,e)),o.push(n.labelTextColor.call(this,e))})),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=l,l}update(t,e){const n=this.options.setContext(this.getContext()),i=this._active;let r,o=[];if(i.length){const t=TC[n.position].call(this,i,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const e=this._size=MC(this,n),a=Object.assign({},t,e),s=LC(this.chart,n,a),l=OC(n,a,s,this.chart);this.xAlign=s.xAlign,this.yAlign=s.yAlign,r={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(r={opacity:0});this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,i){const r=this.getCaretPosition(t,n,i);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,n){const{xAlign:i,yAlign:r}=this,{caretSize:o,cornerRadius:a}=n,{topLeft:s,topRight:l,bottomLeft:c,bottomRight:u}=gE(a),{x:h,y:p}=t,{width:d,height:f}=e;let g,m,y,v,_,b;return"center"===r?(_=p+f/2,"left"===i?(g=h,m=g-o,v=_+o,b=_-o):(g=h+d,m=g+o,v=_-o,b=_+o),y=g):(m="left"===i?h+Math.max(s,c)+o:"right"===i?h+d-Math.max(l,u)-o:this.caretX,"top"===r?(v=p,_=v-o,g=m-o,y=m+o):(v=p+f,_=v+o,g=m+o,y=m-o),b=v),{x1:g,x2:m,x3:y,y1:v,y2:_,y3:b}}drawTitle(t,e,n){const i=this.title,r=i.length;let o,a,s;if(r){const l=hT(n.rtl,this.x,this.width);for(t.x=zC(this,n.titleAlign,n),e.textAlign=l.textAlign(n.titleAlign),e.textBaseline="middle",o=yE(n.titleFont),a=n.titleSpacing,e.fillStyle=n.titleColor,e.font=o.string,s=0;s<r;++s)e.fillText(i[s],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,s+1===r&&(t.y+=n.titleMarginBottom-a)}}_drawColorBox(t,e,n,i,r){const o=this.labelColors[n],a=this.labelPointStyles[n],{boxHeight:s,boxWidth:l,boxPadding:c}=r,u=yE(r.bodyFont),h=zC(this,"left",r),p=i.x(h),d=s<u.lineHeight?(u.lineHeight-s)/2:0,f=e.y+d;if(r.usePointStyle){const e={radius:Math.min(l,s)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},n=i.leftForLtr(p,l)+l/2,c=f+s/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,tE(t,e,n,c),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,tE(t,e,n,c)}else{t.lineWidth=o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const e=i.leftForLtr(p,l-c),n=i.leftForLtr(i.xPlus(p,1),l-c-2),a=gE(o.borderRadius);Object.values(a).some((t=>0!==t))?(t.beginPath(),t.fillStyle=r.multiKeyBackground,cE(t,{x:e,y:f,w:l,h:s,radius:a}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),cE(t,{x:n,y:f+1,w:l-2,h:s-2,radius:a}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(e,f,l,s),t.strokeRect(e,f,l,s),t.fillStyle=o.backgroundColor,t.fillRect(n,f+1,l-2,s-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:i}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:s,boxWidth:l,boxPadding:c}=n,u=yE(n.bodyFont);let h=u.lineHeight,p=0;const d=hT(n.rtl,this.x,this.width),f=function(n){e.fillText(n,d.x(t.x+p),t.y+h/2),t.y+=h+r},g=d.textAlign(o);let m,y,v,_,b,x,w;for(e.textAlign=o,e.textBaseline="middle",e.font=u.string,t.x=zC(this,g,n),e.fillStyle=n.bodyColor,wS(this.beforeBody,f),p=a&&"right"!==g?"center"===o?l/2+c:l+2+c:0,_=0,x=i.length;_<x;++_){for(m=i[_],y=this.labelTextColors[_],e.fillStyle=y,wS(m.before,f),v=m.lines,a&&v.length&&(this._drawColorBox(e,t,_,d,n),h=Math.max(u.lineHeight,s)),b=0,w=v.length;b<w;++b)f(v[b]),h=u.lineHeight;wS(m.after,f)}p=0,h=u.lineHeight,wS(this.afterBody,f),t.y-=r}drawFooter(t,e,n){const i=this.footer,r=i.length;let o,a;if(r){const s=hT(n.rtl,this.x,this.width);for(t.x=zC(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=s.textAlign(n.footerAlign),e.textBaseline="middle",o=yE(n.footerFont),e.fillStyle=n.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(i[a],s.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(t,e,n,i){const{xAlign:r,yAlign:o}=this,{x:a,y:s}=t,{width:l,height:c}=n,{topLeft:u,topRight:h,bottomLeft:p,bottomRight:d}=gE(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(a+u,s),"top"===o&&this.drawCaret(t,e,n,i),e.lineTo(a+l-h,s),e.quadraticCurveTo(a+l,s,a+l,s+h),"center"===o&&"right"===r&&this.drawCaret(t,e,n,i),e.lineTo(a+l,s+c-d),e.quadraticCurveTo(a+l,s+c,a+l-d,s+c),"bottom"===o&&this.drawCaret(t,e,n,i),e.lineTo(a+p,s+c),e.quadraticCurveTo(a,s+c,a,s+c-p),"center"===o&&"left"===r&&this.drawCaret(t,e,n,i),e.lineTo(a,s+u),e.quadraticCurveTo(a,s,a+u,s),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,i=n&&n.x,r=n&&n.y;if(i||r){const n=TC[t.position].call(this,this._active,this._eventPosition);if(!n)return;const o=this._size=MC(this,t),a=Object.assign({},n,this._size),s=LC(e,t,a),l=OC(t,a,s,e);i._to===l.x&&r._to===l.y||(this.xAlign=s.xAlign,this.yAlign=s.yAlign,this.width=o.width,this.height=o.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=mE(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=n,this.drawBackground(r,t,i,e),pT(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),dT(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,i=t.map((t=>{let{datasetIndex:e,index:n}=t;const i=this.chart.getDatasetMeta(e);if(!i)throw new Error("Cannot find a dataset at index "+e);return{datasetIndex:e,element:i.data[n],index:n}})),r=!SS(n,i),o=this._positionChanged(i,e);(r||o)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,n),a=this._positionChanged(o,t),s=e||!SS(o,r)||a;return s&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),s}_getActiveElements(t,e,n,i){const r=this.options;if("mouseout"===t.type)return[];if(!i)return e;const o=this.chart.getElementsAtEventForMode(t,r.mode,r,n);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:n,caretY:i,options:r}=this,o=TC[r.position].call(this,t,e);return!1!==o&&(n!==o.x||i!==o.y)}}FC.positioners=TC;var BC={id:"tooltip",_element:FC,positioners:TC,afterInit(t,e,n){n&&(t.tooltip=new FC({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip,n={tooltip:e};!1!==t.notifyPlugins("beforeTooltipDraw",n)&&(e&&e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n))},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:pS,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:pS,beforeBody:pS,beforeLabel:pS,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return fS(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:pS,afterBody:pS,beforeFooter:pS,footer:pS,afterFooter:pS}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},jC=Object.freeze({__proto__:null,Decimation:eC,Filler:vC,Legend:xC,SubTitle:EC,Title:SC,Tooltip:BC});function NC(t,e,n,i){const r=t.indexOf(e);if(-1===r)return((t,e,n,i)=>("string"===typeof e?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n))(t,e,n,i);return r!==t.lastIndexOf(e)?n:r}class VC extends $k{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:n,label:i}of e)t[n]===i&&t.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(fS(t))return null;const n=this.getLabels();return((t,e)=>null===t?null:rP(Math.round(t),0,e))(e=isFinite(e)&&n[e]===t?e:NC(n,t,_S(e,t),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(n=0),e||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,i=[];let r=this.getLabels();r=0===t&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=t;o<=e;o++)i.push({value:o});return i}getLabelForValue(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!==typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function UC(t,e){const n=[],{bounds:i,step:r,min:o,max:a,precision:s,count:l,maxTicks:c,maxDigits:u,includeBounds:h}=t,p=r||1,d=c-1,{min:f,max:g}=e,m=!fS(o),y=!fS(a),v=!fS(l),_=(g-f)/(u+1);let b,x,w,S,P=ZS((g-f)/d/p)*p;if(P<1e-14&&!m&&!y)return[{value:f},{value:g}];S=Math.ceil(g/P)-Math.floor(f/P),S>d&&(P=ZS(S*P/d/p)*p),fS(s)||(b=Math.pow(10,s),P=Math.ceil(P*b)/b),"ticks"===i?(x=Math.floor(f/P)*P,w=Math.ceil(g/P)*P):(x=f,w=g),m&&y&&r&&function(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}((a-o)/r,P/1e3)?(S=Math.round(Math.min((a-o)/P,c)),P=(a-o)/S,x=o,w=a):v?(x=m?o:x,w=y?a:w,S=l-1,P=(w-x)/S):(S=(w-x)/P,S=XS(S,Math.round(S),P/1e3)?Math.round(S):Math.ceil(S));const E=Math.max(QS(P),QS(x));b=Math.pow(10,fS(s)?E:s),x=Math.round(x*b)/b,w=Math.round(w*b)/b;let T=0;for(m&&(h&&x!==o?(n.push({value:o}),x<o&&T++,XS(Math.round((x+T*P)*b)/b,o,WC(o,_,t))&&T++):x<o&&T++);T<S;++T)n.push({value:Math.round((x+T*P)*b)/b});return y&&h&&w!==a?n.length&&XS(n[n.length-1].value,a,WC(a,_,t))?n[n.length-1].value=a:n.push({value:a}):y&&w!==a||n.push({value:w}),n}function WC(t,e,n){let{horizontal:i,minRotation:r}=n;const o=KS(r),a=(i?Math.sin(o):Math.cos(o))||.001,s=.75*e*(""+t).length;return Math.min(e/a,s)}VC.id="category",VC.defaults={ticks:{callback:VC.prototype.getLabelForValue}};class GC extends $k{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return fS(t)||("number"===typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this;const o=t=>i=e?i:t,a=t=>r=n?r:t;if(t){const t=qS(i),e=qS(r);t<0&&e<0?a(0):t>0&&e>0&&o(0)}if(i===r){let e=1;(r>=Number.MAX_SAFE_INTEGER||i<=Number.MIN_SAFE_INTEGER)&&(e=Math.abs(.05*r)),a(r+e),t||o(i-e)}this.min=i,this.max=r}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:n,stepSize:i}=t;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,e>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(i," would result generating up to ").concat(e," ticks. Limiting to 1000.")),e=1e3)):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i=UC({maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&YS(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-e)/Math.max(t.length-1,1)/2;e-=i,n+=i}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return uT(t,this.chart.options.locale,this.options.ticks.format)}}class qC extends GC{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=yS(t)?t:0,this.max=yS(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=KS(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/i))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}function ZC(t){return 1===t/Math.pow(10,Math.floor(GS(t)))}qC.id="linear",qC.defaults={ticks:{callback:Gk.formatters.numeric}};class HC extends $k{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=GC.prototype.parse.apply(this,[t,e]);if(0!==n)return yS(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=yS(t)?Math.max(0,t):null,this.max=yS(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let n=this.min,i=this.max;const r=e=>n=t?n:e,o=t=>i=e?i:t,a=(t,e)=>Math.pow(10,Math.floor(GS(t))+e);n===i&&(n<=0?(r(1),o(10)):(r(a(n,-1)),o(a(i,1)))),n<=0&&r(a(i,-1)),i<=0&&o(a(n,1)),this._zero&&this.min!==this._suggestedMin&&n===a(this.min,0)&&r(a(n,-1)),this.min=n,this.max=i}buildTicks(){const t=this.options,e=function(t,e){const n=Math.floor(GS(e.max)),i=Math.ceil(e.max/Math.pow(10,n)),r=[];let o=vS(t.min,Math.pow(10,Math.floor(GS(e.min)))),a=Math.floor(GS(o)),s=Math.floor(o/Math.pow(10,a)),l=a<0?Math.pow(10,Math.abs(a)):1;do{r.push({value:o,major:ZC(o)}),++s,10===s&&(s=1,++a,l=a>=0?1:l),o=Math.round(s*Math.pow(10,a)*l)/l}while(a<n||a===n&&s<i);const c=vS(t.max,o);return r.push({value:c,major:ZC(o)}),r}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&YS(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":uT(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=GS(t),this._valueRange=GS(this.max)-GS(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(GS(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function XC(t){const e=t.ticks;if(e.display&&t.display){const t=mE(e.backdropPadding);return _S(e.font&&e.font.size,YP.font.size)+t.height}return 0}function YC(t,e,n,i,r){return t===i||t===r?{start:e-n/2,end:e+n/2}:t<i||t>r?{start:e-n,end:e}:{start:e,end:e+n}}function KC(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),i=[],r=[],o=t._pointLabels.length,a=t.options.pointLabels,s=a.centerPointLabels?DS/o:0;for(let h=0;h<o;h++){const o=a.setContext(t.getPointLabelContext(h));r[h]=o.padding;const p=t.getPointPosition(h,t.drawingArea+r[h],s),d=yE(o.font),f=(l=t.ctx,c=d,u=gS(u=t._pointLabels[h])?u:[u],{w:JP(l,c.string,u),h:u.length*c.lineHeight});i[h]=f;const g=nP(t.getIndexAngle(h)+s),m=Math.round(JS(g));JC(n,e,g,YC(m,p.x,f.w,0,180),YC(m,p.y,f.h,90,270))}var l,c,u;t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=function(t,e,n){const i=[],r=t._pointLabels.length,o=t.options,a=XC(o)/2,s=t.drawingArea,l=o.pointLabels.centerPointLabels?DS/r:0;for(let c=0;c<r;c++){const r=t.getPointPosition(c,s+a+n[c],l),o=Math.round(JS(nP(r.angle+VS))),u=e[c],h=tM(r.y,u.h,o),p=QC(o),d=$C(r.x,u.w,p);i.push({x:r.x,y:h,textAlign:p,left:d,top:h,right:d+u.w,bottom:h+u.h})}return i}(t,i,r)}function JC(t,e,n,i,r){const o=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));let s=0,l=0;i.start<e.l?(s=(e.l-i.start)/o,t.l=Math.min(t.l,e.l-s)):i.end>e.r&&(s=(i.end-e.r)/o,t.r=Math.max(t.r,e.r+s)),r.start<e.t?(l=(e.t-r.start)/a,t.t=Math.min(t.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/a,t.b=Math.max(t.b,e.b+l))}function QC(t){return 0===t||180===t?"center":t<180?"left":"right"}function $C(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function tM(t,e,n){return 90===n||270===n?t-=e/2:(n>270||n<90)&&(t-=e),t}function eM(t,e,n,i){const{ctx:r}=t;if(n)r.arc(t.xCenter,t.yCenter,e,0,FS);else{let n=t.getPointPosition(0,e);r.moveTo(n.x,n.y);for(let o=1;o<i;o++)n=t.getPointPosition(o,e),r.lineTo(n.x,n.y)}}HC.id="logarithmic",HC.defaults={ticks:{callback:Gk.formatters.logarithmic,major:{enabled:!0}}};class nM extends GC{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=mE(XC(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=yS(t)&&!isNaN(t)?t:0,this.max=yS(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/XC(this.options))}generateTickLabels(t){GC.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const n=xS(this.options.pointLabels.callback,[t,e],this);return n||0===n?n:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?KC(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,i))}getIndexAngle(t){return nP(t*(FS/(this._pointLabels.length||1))+KS(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(fS(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(fS(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const n=e[t];return function(t,e,n){return _E(t,{label:n,index:e,type:"pointLabel"})}(this.getContext(),t,n)}}getPointPosition(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.getIndexAngle(t)-VS+n;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:i,bottom:r}=this._pointLabelItems[t];return{left:e,top:n,right:i,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),eM(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:n,grid:i}=e,r=this._pointLabels.length;let o,a,s;if(e.pointLabels.display&&function(t,e){const{ctx:n,options:{pointLabels:i}}=t;for(let r=e-1;r>=0;r--){const e=i.setContext(t.getPointLabelContext(r)),o=yE(e.font),{x:a,y:s,textAlign:l,left:c,top:u,right:h,bottom:p}=t._pointLabelItems[r],{backdropColor:d}=e;if(!fS(d)){const t=mE(e.backdropPadding);n.fillStyle=d,n.fillRect(c-t.left,u-t.top,h-c+t.width,p-u+t.height)}aE(n,t._pointLabels[r],a,s+o.lineHeight/2,o,{color:e.color,textAlign:l,textBaseline:"middle"})}}(this,r),i.display&&this.ticks.forEach(((t,e)=>{if(0!==e){a=this.getDistanceFromCenterForValue(t.value);!function(t,e,n,i){const r=t.ctx,o=e.circular,{color:a,lineWidth:s}=e;!o&&!i||!a||!s||n<0||(r.save(),r.strokeStyle=a,r.lineWidth=s,r.setLineDash(e.borderDash),r.lineDashOffset=e.borderDashOffset,r.beginPath(),eM(t,n,o,i),r.closePath(),r.stroke(),r.restore())}(this,i.setContext(this.getContext(e-1)),a,r)}})),n.display){for(t.save(),o=r-1;o>=0;o--){const i=n.setContext(this.getPointLabelContext(o)),{color:r,lineWidth:l}=i;l&&r&&(t.lineWidth=l,t.strokeStyle=r,t.setLineDash(i.borderDash),t.lineDashOffset=i.borderDashOffset,a=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),s=this.getPointPosition(o,a),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(s.x,s.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((i,a)=>{if(0===a&&!e.reverse)return;const s=n.setContext(this.getContext(a)),l=yE(s.font);if(r=this.getDistanceFromCenterForValue(this.ticks[a].value),s.showLabelBackdrop){t.font=l.string,o=t.measureText(i.label).width,t.fillStyle=s.backdropColor;const e=mE(s.backdropPadding);t.fillRect(-o/2-e.left,-r-l.size/2-e.top,o+e.width,l.size+e.height)}aE(t,i.label,0,-r,l,{color:s.color})})),t.restore()}drawTitle(){}}nM.id="radialLinear",nM.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Gk.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}},nM.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},nM.descriptors={angleLines:{_fallback:"grid"}};const iM={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},rM=Object.keys(iM);function oM(t,e){return t-e}function aM(t,e){if(fS(e))return null;const n=t._adapter,{parser:i,round:r,isoWeekday:o}=t._parseOpts;let a=e;return"function"===typeof i&&(a=i(a)),yS(a)||(a="string"===typeof i?n.parse(a,i):n.parse(a)),null===a?null:(r&&(a="week"!==r||!HS(o)&&!0!==o?n.startOf(a,r):n.startOf(a,"isoWeek",o)),+a)}function sM(t,e,n,i){const r=rM.length;for(let o=rM.indexOf(t);o<r-1;++o){const t=iM[rM[o]],r=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(r*t.size))<=i)return rM[o]}return rM[r-1]}function lM(t,e,n){if(n){if(n.length){const{lo:i,hi:r}=bE(n,e);t[n[i]>=e?n[i]:n[r]]=!0}}else t[e]=!0}function cM(t,e,n){const i=[],r={},o=e.length;let a,s;for(a=0;a<o;++a)s=e[a],r[s]=a,i.push({value:s,major:!1});return 0!==o&&n?function(t,e,n,i){const r=t._adapter,o=+r.startOf(e[0].value,i),a=e[e.length-1].value;let s,l;for(s=o;s<=a;s=+r.add(s,1,i))l=n[s],l>=0&&(e[l].major=!0);return e}(t,i,r,n):i}class uM extends $k{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e){const n=t.time||(t.time={}),i=this._adapter=new rk._date(t.adapters.date);AS(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:aM(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:i,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function s(t){o||isNaN(t.min)||(i=Math.min(i,t.min)),a||isNaN(t.max)||(r=Math.max(r,t.max))}o&&a||(s(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||s(this.getMinMax(!1))),i=yS(i)&&!isNaN(i)?i:+e.startOf(Date.now(),n),r=yS(r)&&!isNaN(r)?r:+e.endOf(Date.now(),n)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,o=function(t,e,n){let i=0,r=t.length;for(;i<r&&t[i]<e;)i++;for(;r>i&&t[r-1]>n;)r--;return i>0||r<t.length?t.slice(i,r):t}(i,r,this.max);return this._unit=e.unit||(n.autoSkip?sM(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(t,e,n,i,r){for(let o=rM.length-1;o>=rM.indexOf(n);o--){const n=rM[o];if(iM[n].common&&t._adapter.diff(r,i,n)>=e-1)return n}return rM[n?rM.indexOf(n):0]}(this,o.length,e.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(t){for(let e=rM.indexOf(t)+1,n=rM.length;e<n;++e)if(iM[rM[e]].common)return rM[e]}(this._unit):void 0,this.initOffsets(i),t.reverse&&o.reverse(),cM(this,o,this._majorUnit)}initOffsets(t){let e,n,i=0,r=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),i=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,n=this.getDecimalForValue(t[t.length-1]),r=1===t.length?n:(n-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;i=rP(i,0,o),r=rP(r,0,o),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){const t=this._adapter,e=this.min,n=this.max,i=this.options,r=i.time,o=r.unit||sM(r.minUnit,e,n,this._getLabelCapacity(e)),a=_S(r.stepSize,1),s="week"===o&&r.isoWeekday,l=HS(s)||!0===s,c={};let u,h,p=e;if(l&&(p=+t.startOf(p,"isoWeek",s)),p=+t.startOf(p,l?"day":o),t.diff(n,e,o)>1e5*a)throw new Error(e+" and "+n+" are too far apart with stepSize of "+a+" "+o);const d="data"===i.ticks.source&&this.getDataTimestamps();for(u=p,h=0;u<n;u=+t.add(u,a,o),h++)lM(c,u,d);return u!==n&&"ticks"!==i.bounds&&1!==h||lM(c,u,d),Object.keys(c).sort(((t,e)=>t-e)).map((t=>+t))}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}_tickFormatFunction(t,e,n,i){const r=this.options,o=r.time.displayFormats,a=this._unit,s=this._majorUnit,l=a&&o[a],c=s&&o[s],u=n[e],h=s&&c&&u&&u.major,p=this._adapter.format(t,i||(h?c:l)),d=r.ticks.callback;return d?xS(d,[p,e,n],this):p}generateTickLabels(t){let e,n,i;for(e=0,n=t.length;e<n;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,i=KS(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:n*r+a*o,h:n*o+a*r}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,i=n[e.unit]||n.millisecond,r=this._tickFormatFunction(t,0,cM(this,[t],this._majorUnit),i),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t,e,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,e=i.length;t<e;++t)n=n.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const i=this.getLabels();for(e=0,n=i.length;e<n;++e)t.push(aM(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return EE(t.sort(oM))}}function hM(t,e,n){let i,r,o,a,s=0,l=t.length-1;n?(e>=t[s].pos&&e<=t[l].pos&&({lo:s,hi:l}=xE(t,"pos",e)),({pos:i,time:o}=t[s]),({pos:r,time:a}=t[l])):(e>=t[s].time&&e<=t[l].time&&({lo:s,hi:l}=xE(t,"time",e)),({time:i,pos:o}=t[s]),({time:r,pos:a}=t[l]));const c=r-i;return c?o+(a-o)*(e-i)/c:o}uM.id="time",uM.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};class pM extends uM{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=hM(e,this.min),this._tableRange=hM(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,i=[],r=[];let o,a,s,l,c;for(o=0,a=t.length;o<a;++o)l=t[o],l>=e&&l<=n&&i.push(l);if(i.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(o=0,a=i.length;o<a;++o)c=i[o+1],s=i[o-1],l=i[o],Math.round((c+s)/2)!==l&&r.push({time:l,pos:o/(a-1)});return r}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return t=e.length&&n.length?this.normalize(e.concat(n)):e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(hM(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return hM(this._table,n*this._tableRange+this._minPos,!0)}}pM.id="timeseries",pM.defaults=uM.defaults;const dM=[ek,QA,jC,Object.freeze({__proto__:null,CategoryScale:VC,LinearScale:qC,LogarithmicScale:HC,RadialLinearScale:nM,TimeScale:uM,TimeSeriesScale:pM})],fM="label";function gM(t,e){"function"===typeof t?t(e):t&&(t.current=e)}function mM(t,e){t.labels=e}function yM(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fM;const i=[];t.datasets=e.map((e=>{const r=t.datasets.find((t=>t[n]===e[n]));return r&&e.data&&!i.includes(r)?(i.push(r),Object.assign(r,e),r):{...e}}))}function vM(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fM;const n={labels:[],datasets:[]};return mM(n,t.labels),yM(n,t.datasets,e),n}function _M(e,n){let{height:i=150,width:r=300,redraw:o=!1,datasetIdKey:a,type:s,data:l,options:c,plugins:u=[],fallbackContent:h,...p}=e;const d=(0,t.useRef)(null),f=(0,t.useRef)(),g=()=>{d.current&&(f.current=new EA(d.current,{type:s,data:vM(l,a),options:c,plugins:u}),gM(n,f.current))},m=()=>{gM(n,null),f.current&&(f.current.destroy(),f.current=null)};return(0,t.useEffect)((()=>{var t,e;!o&&f.current&&c&&(t=f.current,e=c,t.options={...e})}),[o,c]),(0,t.useEffect)((()=>{!o&&f.current&&mM(f.current.config.data,l.labels)}),[o,l.labels]),(0,t.useEffect)((()=>{!o&&f.current&&l.datasets&&yM(f.current.config.data,l.datasets,a)}),[o,l.datasets]),(0,t.useEffect)((()=>{f.current&&(o?(m(),setTimeout(g)):f.current.update())}),[o,c,l.labels,l.datasets]),(0,t.useEffect)((()=>(g(),()=>m())),[]),t.createElement("canvas",Object.assign({ref:d,role:"img",height:i,width:r},p),h)}const bM=(0,t.forwardRef)(_M);function xM(e,n){return EA.register(n),(0,t.forwardRef)(((n,i)=>t.createElement(bM,Object.assign({},n,{ref:i,type:e}))))}const wM=xM("bar",HT),SM=xM("pie",QT),PM=n.p+"static/media/legend.0f949a3258ec26dcb593.png";function EM(e){e.result;const n=e.time,i=2*e.range,r=2*e.maxWaitTime,o=parseInt(r/i),a=e.ps,[s,l]=(0,t.useState)(),c=(t,e)=>t+e,[u,h]=(0,t.useState)();(0,t.useEffect)((()=>{const t=function(t,e,n,i){const r=new Array(n).fill(0);return Object.values(t).forEach((t=>{const n=t.timestamp,[o,a]=2===n.length?n:[n[0],n[0]];if(e>=o&&e<=a){const t=parseInt((e-o)/i)||0;r.splice(t,1,r[t]+1)}})),r}(a,n,o,i);if(s!==t){l(t);const e=t.reduce(c),n=[];for(let i of t)n.push(i/e*100);h(n)}}),[n]);const p={labels:["\ud604\uc7ac \uc6b4\ud589\uc911\uc778 \ud0dd\uc2dc","\ud604\uc7ac \ube44\uc5b4\uc788\ub294 \ud0dd\uc2dc"],datasets:[{label:"taxi",data:[e.driveTaxiNum,e.emptyTaxiNum],backgroundColor:["rgba(253, 231, 37, 0.5)","rgba(94, 201, 98, 0.5)"],borderColor:["rgba(253, 231, 37, 0.5)","rgba(94, 201, 98, 0.5)"],borderWidth:0}]},d={labels:Array.apply(null,Array(o+1)).map((function(t,e){return String(e*i)})),datasets:[{label:"passenger (%)",data:u,borderColor:"blue",Color:"blue",fill:!0,borderWidth:0,barPercentage:1,categoryPercentage:1,hoverBackgroundColor:"darkgray",barThickness:"flex",backgroundColor:["rgba(0, 0, 255, 0.5)"]}]};return(0,qy.jsxs)("div",{className:"report-container",children:[(0,qy.jsx)("h1",{className:"report-header",children:"REPORT"}),(0,qy.jsxs)("div",{className:"chart-container",children:[(0,qy.jsx)("div",{children:(0,qy.jsx)(SM,{className:"chart1",data:p,options:{maintainAspectRatio:!1,responsive:!0,plugins:{legend:{display:!0,labels:{color:"rgb(255, 255, 255)"}}}}})}),(0,qy.jsx)("div",{children:(0,qy.jsx)(wM,{className:"chart2",data:d,options:{maintainAspectRatio:!1,responsive:!0,plugins:{legend:{display:!0,labels:{color:"rgb(255, 255, 255)"}}},scales:{x:{ticks:{color:"white"},title:{display:!0,align:"center",text:"\ub300\uae30\uc2dc\uac04(\ubd84)",color:"rgb(255, 255, 255)"}},y:{suggestedMin:0,suggestedMax:100,ticks:{stepSize:20,color:"white"}}}}})})]}),(0,qy.jsxs)("div",{className:"legend-container",children:[(0,qy.jsx)("img",{className:"legend",src:PM}),(0,qy.jsxs)("div",{className:"color-scale-bar",children:[(0,qy.jsx)("p",{className:"color-scale-bar-title",children:"\ud638\ucd9c \uc2b9\uac1d \ub300\uae30 \uc2dc\uac04"}),(0,qy.jsx)("div",{className:"bar"}),(0,qy.jsxs)("div",{className:"label",children:[(0,qy.jsx)("p",{children:"0\ubd84"}),(0,qy.jsxs)("p",{children:[r,"\ubd84"]})]})]})]})]})}function TM(t,e){return t[Math.floor(e-360)]}function kM(e){const[n,i]=(0,t.useState)(420),r=e.trip,o=e.empty,a=e.ps,s=e.result,[l,c]=(0,t.useState)(0),[u,h]=(0,t.useState)(0),[p,d]=(0,t.useState)(0),[f,g]=(0,t.useState)(0),[m,y]=(0,t.useState)(0),[v,_]=(0,t.useState)(0);return(0,t.useEffect)((()=>{c(TM(s.driving_taxi_num,n)),h(TM(s.empty_taxi_num,n)),d(TM(s.success_passenger_cumsum,n)),g(TM(s.fail_passenger_cumsum,n)),y(TM(s.waiting_passenger_num,n)),_(function(t,e){let n=0,i=0;Object.values(t).forEach((t=>{const r=t.timestamp,[o,a]=2===r.length?r:[r[0],r[0]];e>=o&&e<=a&&(n+=e-o,i+=1)}));return Math.round(n/i)||0}(a,n))}),[n]),(0,qy.jsxs)("div",{className:"container",children:[(0,qy.jsx)(sS,{trip:r,empty:o,ps:a,time:n,setTime:i,minTime:420,maxTime:1440,meanWaitTime:v,range:5,maxWaitTime:30,driveTaxiNum:l,emptyTaxiNum:u,successPsCumsum:p,failPsCumsum:f,waitPsNum:m}),(0,qy.jsx)(EM,{time:n,ps:a,result:s,range:5,maxWaitTime:30,driveTaxiNum:l,emptyTaxiNum:u,failPsCumsum:f,waitPsNum:m})]})}EA.register(OA,BC,xC,VC,...dM);function AM(){return(0,qy.jsx)("div",{className:"splash",children:(0,qy.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAawAAAGsCAMAAAC2FmOeAAADAFBMVEVHcExqampoaGjFxcXl5eXf399hYWHMzMzi4uLg4OBjY2PGxsZTU1NWVlbNzc3KysrOzs7CwsLOzs5aWlrOzs729vbNzc329vbPz89WVlbDw8PNzc3Q0NDNzc329vZcXFzz8/PNzc1VVVXKysr6+vrPz8/Ly8vHx8f39/dUVFT6+vr39/fKysrHx8ejo6P39/f29vZeXl5UVFRPT0/Ozs719fV8fHzLy8vKysrLy8tXV1f09PRtbW329vb6+vpwcHBjY2PIyMiqqqrJycn29vZYWFiGhobw8PDx8fH09PRaWlry8vLKysr5+flRUVHz8/PIyMj39/f29vZcXFzx8fH8/PyHh4ePj4/Nzc36+vr7+/ucnJykpKRsbGyRkZGhoaGPj49nZ2d5eXlnZ2eysrKBgYFQUFD4+PiDg4OysrK5ubmKioq5ublnZ2d2dnZ8fHywsLBPT09ubm5wcHDn5+f5+fmjo6ORkZHl5eV8fHzQ0NCTk5OhoaHY2Niqqqq9vb2ZmZnk5OTc3Ny2trazs7PDw8OHh4fAwMDd3d16enqZmZnn5+eqqqrW1ta/v79SUlJWVlZOTk5PT09TU1NZWVlgYGBVVVVkZGRRUVFUVFRQUFBsbGxxcXFYWFhdXV1iYmJbW1tnZ2dqampvb290dHR2dnby8vJ4eHjt7e18fHy3t7fCwsJ+fn6AgIC0tLSEhISxsbGHh4eqqqqmpqaJiYmOjo6dnZ2jo6OTk5Oenp5cXFxfX1/BwcHm5ua7u7uwsLCYmJiNjY309PTi4uKVlZVoaGje3t7w8PC/v7+9vb26urp6enrV1dWCgoLR0dGurq6bm5vPz8+QkJCLi4ugoKDr6+vg4OCXl5fKysr39/fZ2dnExMT29vbu7u5paWnj4+PJycl5eXnHx8d7e3u5ubmysrKsrKyDg4OIiIioqKihoaGRkZHW1tanp6fY2Nifn5/p6en6+vrNzc3l5eXFxcXc3NzT09P8/Pxubm6zs7Orq6uioqKSkpLn5+f5+fnb29ti+xsdAAAAj3RSTlMABRXwDhUgAQQIC/t9TCfoHw1CKk0ibBpWl/phN3csbPmBWbnxL9r1NtDnUsTjHZ+SQcGri2E3sPXMNXSrhtx955I7qKvzR930zLDqnNPfSdX6QOy/+W9eoLLBe5LxK16T0uPCe4rzfdS1aMHHj82WTupiUV9os9/VsJSs3uTJ6cuW0Jfm0PKFtPPysu7w+9I0WXEAAB6iSURBVHja7J17SFRpH8fPeDszjk2OinhJxMREyAHdMBVBndA/RCQQNPBuF9Qu2gqJGSq0FkWs91s2jlYSWlpbvfWuhr3BClmE0Qb9sRC8bttuuyz7j3+02/vH+zznnPEy1HPOjLffGX/fbv/m8+Hze37P7zlzhuPUHp3JXFNSUFjYcKq5+cyZixdfkvyH5s3Fi3V1zc0NDaWlBfn55mIjh9mk8CYzQXTqzKdPv//++vXr7//6nuTBSwGVBOvND29+IPk3yf/++OPVq1d1RxtK8zKLNbh6GxajuaTwVOM9mof3Hj4UYf1FYT148FLCJcGysZJg/YvmyZMndUcJMxOPS7me0RhqCisvffjw4c8/JVIP7WGtNOvzsH6kuX//HEGW4I2rug4x1RQ2/vPP3bt3P9yVYN37HCwlZv1Icd2nv3777buKhrwErItrF635UOWl93Nz799TWHfXyiwSAuu72+R3xeFMN1znNQE193hujqKyg+WEWa9WmCXCorhuk1RU5yOwVcRQVfn4zmMSymru/fqYRWkJ+fXFC2IYlkRnjk81Z7/5+5df7twRWQlirZNZIqxfCawX4+Pj9XleuPoOdRNVlX9PTEysgLVuZt1eCWt8/FbF4QTs65WSOjY2NjGxHNbjDTOL4rpFUl6dibwUkRqbsIO1sWZRWuOjo+XV6BdrNlF17N3YuzGazTbr1uitUcLrcDFS+eywr6by2bN3EqpNN4uiGh39+efnJ/KwobeP7/mm6elpCguKWRKs58//W4/b1/KTb8Cx2elnEixgZhFYN26Up6JeUk9xvml2dnZ6GqxZhNaNG/UJSIo37/t2dnY5LHhmUVgjIyMnvt7a0w1tUMvTp09nn8I3a4TmwhauhsbA2EdPKSx1mDUycv369eqtOYvyPO9+85EISy1mXadJ2Xqbl2e6+00S1Zm1BXF5pof8dHMJlmrMknBd2UK4PNOjF35aDktVZl0hv7YMLo+I6IWFlbBUZtYVEoLL3/U7wDB3/YI9LNWZdUVIims38nxo7Pz8woILmEVzrSjVhZ9k80uan58nYuldwqxr1wguV51qGPYmJuoT9fP69TTr5caZdY3mY1mcK25WEdsTEykq/ZrvWZ/ONJ86VVhQUFJiNhcXF5tMJqPRSP4uLjZn5ufnFZQ2NDTXrYdZNAMDKa421OCDkrZTWNGJelGtNTHrDEFUYjbpOJ7nxD8a8g+9fOLtbqB4jjcV5+eVNtQtwlojswYGBopSXakW8r4Hdm0niaZlUMgqzbrUWFhQI30ahHfwZtCUmVd69NxamUVgfRxwpVqoC0zav4vSImJFR1NUeufNIpxKTLzDiD6D7Oi5NTGLuvVxwFXa+KgDu5OSdu0S3YqmqJzqBkkaC2tMYlFbfTQ8JXb46Dn7hzwdNkvI1aKvXeIeZG/kboFWLGUlmKV3dM8iaTxUY+SkHWnNQohpqGKrM0sAdvXqQdU3GlF7DuwjtJKkQkjVEuRyxKw7jYfMunXcUQmwwxWrNYvQKgpX9YM1uqA9pw8c2CvRImq5i2o5YNbjyioTp+XXfRnc8uvPrcKsqzRv1SyXITBij0ArMtJWCG2VMESRWd+cNWs37r9LBCsfl718/IJZAqy3qt25tH6BYRECrX3CtiUUQkktvQKzCCl+bZoJ5RVRm0B4OW/W2+EZdbaFHgGhgQKt06eFQrh7qRBGU7NCGGaNjQmkNmML4PmE6gtOmzUzM5OmvjMX7xsQFBQaGCbQompFCmrFbncntPQhMmZV1my0UytwaTLrnTSLwJoZPq6ygYbW4BcQEETVCrMVQoFWbKw7pRUS8uU9692xKgCvF3HLq3DSrOHh4TJV9Rk6w44dfoJaAq3T2VKPsT+W0oqmtJaXwWVmNZ2NWuvDlLMh5dAZswis4aJa9ZRAD19D1A4/Gy1bIaS7FqG1nbqlJ27dDLE361lLFaB39vC8W165U2b19vaqpRTyHp4EFqFFC2GoWAizF4/GolohklorzBJ2KmA/S229M2YRXOo4cvE6D09PSa1FWunZ+wRa+8VC6E5phazYs5rOGkD+NFxCvcNmUVjDaugKeZ3OuERL6ghtau22wXIPEeugzaymQ4DfWeZWfcFxs0jCwbPSanVGI4VlWFEIT4tq2dGSYDVV6Ti4YzXS7rilXnDQLAFXCuznaXgKa1GtHct6jOxlPQZlRWg9Ir8Jq6YqLQd9Asp7U1wOmtVrBd3D8xSWSEtUa6kQpks9xn4bLSGPBFQqKO48xeWoWb3WtGQV0PLwWFkIIyLSs7Olk7GtEH5LYDUF6jiVhHTy1Q6a1Wu19m6DT8uuEEpq0RFhiwSL1kH38yp7FapbiuSWUrNIUoHvWnaFUFSLtu9UrRapDrqHpHuqbuLJJZxwzCyrtTtYA52WUSiEglrijHD5riWoFWngVHmxWlvugFm0EPZmeatArcXDltS+i7tWi6BWSwCn1jtwTep1R8yydlvL3KCrZVzeYwSKPYagFoG1Xz19xefileKAWdbu7u40L5UUwqWBbrpNrWxfTuUhtVC5Wd3W7jS4H+Za6jF8F9USG8LsfZGRe/049cc71RGzpqy5ybBpLesxCKzQMEmtMNf45gLe/4Ris0is1jjItOzVonUwPTs9inON8KTRUGiWiKt7G2i1xDlGVNTiWWtPeqiOc6F4nVBsFimFcGlx0hzDppYAK8zAuVR4PvWaYrOmprp3gi+EtrNWYGCQjnO5JJTZHnWXNYtkJ3C1PMWzFqmDBs4Vozmu2KypQci0bLsWheXnol9fxfO1RUrNGhwchLpv8dKuZTCQOmhw3TeX8m4HlZo1ODgFl9aiWp6cC79mlvQZis2CS2tRLR3n0uG52iKFZg1OZUCdZYgthucWeHmzV5lCswYHc/3B0vLw0HFbIZoUZWYNTk7mAp3B8zqjltsiSVVm1iShBfR+i99C76+PK1Jm1uRgDH7V5KbHv0yZWUNDWfidagBOXIrMGpocDMZvzADQZigza2jSBxdr83NciVkE1tBOXKvNT7gis4a6hpJxrTY/tTMKzBrq6srFLwKF0MLPKDGrqwsbeAhNYXKaErOGurKwJQRAyz9NiVldXdgSAoCllWixzBJwbcPFAoDLK02JWV0Z2GQAgCXSkjXLgk0GGLdkzbJYgnGpgHQZ8mZZunCSAYSWArMsGf64VACiTRY/p8o0y4JnYyizjF55syxtuG3ByLZeWbMsbW142oKxb4UrMKsNT1tAclzeLIslHoeEMBIsb5alLRzXCUQh1Bzsltuz2nqwfwcStzQ5s0ji8XEnGPHKldmzKC28LYFy3JI3q60NCyGQhMub1YMdIaCWUMasnh7sCIHE+6CsWf14NAbTZKTJmtXzFS4TlCZDzqyeth682oISH1mzenLwsgRItFkyZvX09ONlCZxJhpxZ/T142AISPm5Kzqz+eFwmKDkuZ1Z/P/YYUKIpkzOrH3sMMPGfkjOrEwe6YBIuZ1b/ETdcJShNRpacWZ3YvoOB5ZXLNquzsx/bdziFUM6sThwRwnErXs6s1jhcJSjxypAxqxVPxmDM4nzYZnW2tuITunCOxjEyZrXG4A0/lGiT5cxCtQAlWMYsVAtQ3HJlzEK1IB22ZMxqjcE1gtMSxsiYhWoBSpyMWXjWgpQsGbNa8QV3cOI/xDarFSeEkNr3LrZZfTh8B9S+Z7DN6sN7LUANoY+MWXhlDCjeuWyz+vBpDEgnY7ZZfTn4yVVYarHM6sNnCGGpxTLrMh6MYanFNOsydu+g1GKZ1deB3TsotdhmncRnqQHFh2nW5cvYYoAaYzDNwhYDVILZZmGLASleXUyzLuMUA1Ky2Gbl4JMzgJLMNqsDH6UGFD6eaVYH3kFCyk62WUdwmgvILE0u06wOPGqBOhgzzcI6CCr+FiasIzhygpR4Jiysg7BaDDYsrIOQ4p3BhIX9IKgEM2F14GPvoKYYbFh4BQnqrBXDhHUS54PQjlpfhtWBn1EAddRiwmrHexJQiWGahR+DhFYHGWa14wvfIcWLaVY7DjGA1UEWLBxiAKuDLFgncYFg9YMsWO34kBOo5DBh4RcAgUowExZuWqCyjQkLNy1Q0WSwYOGmBStfMWHhpgXKrHAmLNy0YDXvTFg5uECQwuewYLXjSzFAJYsJC+/2QSWcCQvvtKBtWgxY+BlIWMlgwcJjMbSTFgMWXkDCig8TFnYYoBLHhIUdBqh4t7Fg4QwDVmJYsHCGASvBLFjt+PkEWMdiJix8LhdUkpmw8Hk0WB0GExa2g+A6jC/DwnYQVrJYsPCJd2AzDBasI7g+oLKTBQvvH2Hl/+ydz08b6RnHY+of2MJttq7rWu3alkVX/FjJYMJ2CzFJVCMbWPASQGqQcogixaekSgoSqsSBnCJFq6YVDtoSMJAq4m8AcQGFXCIkDiCgEK84RwhCgL0AnfHY2Ab7eV7jmWGwn68JuXh+6P3wmfd53/llAmFR7a60chCARbW7stIGwaLaXVlxQ7Dorn1lxQrBooGW0mp3ABYNtJRWuwOw6DIMZaUagkUnSZQVLQiLrplRVFQgLBoVKyuPIVh0gZOyUg7BoikMhY2KIVg0haGsNBOsSzSFAcGi+SaFTWFAsGi+SVmxE6zLEycEi+7RUlaMECyayVVWqiFYdLm7slJHsC5PTBAsOkeirGghWHTloLJSBMH6F7UPwaIQrLyPimBdohAsgkUhWASLYF2SGAgWle4UglXYobnBfIFFs+7KCp3Pyh9YOh29Blc5qYavwdDFQy2lgCBXN+lSckVgJqAjfrIHuW5QV6zLHGo9ZcEqjoZoKSKqEvha9+KkEKyLjhW+i6RYr9cXZwrBkjk1CCy1PpZ0tKj55I0bvvNRr+ajP0EWxRYFpydYsqcNvqdYr9GoNWoh+lRmXKj55M0D+G59vcVi0XBRnw4HTq2m5pM1RchzMIrNZkssaktCsliowpA1JuQJMzqbzWxOALNouA+nWtQ2jYY6LVljxJ7dZONjjhIzW/hPcqjTkncCA3sqWtntsrIyW5lNgBajFg91WnJGV4I9b7AsELh9mwcWRxbjFo2FWlDWMTH2JM+yysrKAAeMR8ZTE7jFYqMGlDPl2DNyy2praysra3lkPLRAAhz3fxk1oKzDLOzp07b6+t7e3lohlanpqaTaXdZhFvZcd0swGKyPAuOZJbj1RH9ThSFjqtE3JqirqjyeoCcYTX08vbH/zdSEclbu6LtIXFyq+HiiCcbIcf95BjzUackYK/6WH4/X63J5Xa4TaEIGqjwDVVU91ITyxY2/Pyt4h4+Xi8sbh8bnOf/joSaUL4/xN9P1dnd33+E/QrwCuOde4TeVg7JFy/DOx0Bra3c8nd2d/E9SaA5DthgZ3qZqa2htaI2mqYn76W5KpK+pKUCNKFdKGN5TrG+IpjUpTb4m7of7+Hz11IhypZnlDeDdFRUN3If/1dDSyn98ibioEeVKGwQr/hhPV2lFIi0NLVyiv6LxUYUhV33xEoIVf/R0sFSIQMvP/2vxn9CiOQyZ4gRhxV+XECjt4j58HKUOR6nf4fBX+Lm0+A85aDQslmv+AoQVf2uMpYtLaVe7wMsRReZ3+KNZ8ldRM8o0fwHBStyiWiHAEhJlJYSDteFvomaUJYYXEKzEk6fvdAlZbV9tb5/lgDlmo6w2Njb8k5Maakg5Uv0SgpV4tUXw4KCra+dolaO1zss1+4aLw/Fuw8HhmqRhsTxDYhBW4nVMgYODg52drlU+7evr7bOz7W8cb968exfFRXO5MnVZEKzEu9o1nFk7OztHR6tHnFnr67OzglvvNjhck9RpydRlAbCSn6rQwJt1xMFaXV1fP4H1LprJDeq0ZIjxJQQr+TUkLh7WTlpYXK9FIy1ZRlkQLHvii7raM7Bmk2DRSEuGlIOwTEnfNHOwDjKa5aOmlDzalxCslKc26SoEs47SmjVJ1+VKHjsIK/XNWV7IrEk6pyV5mkFY9pTv9oJmdVJjSl24j4CwTClfNoNm0YyT5IX7CwjW6QcNVkBmTVLxLm10VgjWv0+/7NEFjLMmJ59Te0oaVSNo1ulXf9dCZm1s0/0JEh8FQVhFp76uAc1aouOgtNMXIKyzL+bshvosOg5KfRQEYKV5TXsQNIuOgxIfBSGz6s7UIzbIrKWlWmpSCUfEIKzHaS4GrIDMWqJxsYQj4kYQljXNIlWgWUt0g4Jkcb4AYRnTLBIAzVqi+UHJ4gZhPVClG0WXZjqfxcPapvMkUkU7AsKqSbuQCzRrie4uliglL0BYzrQLVUJmLS1VUbNKEl0bCOuBIe1S+lLQrEMaakk0yBqEYNVkWMwFmkVDLekGWQAsZ4bFAqBZS33UsNKUF1CBkbYW5FNcAZpFJYYUPVbJCGTWf2oyLlkFmrVNs7kSzF50wGZVZ1yyDDbrkGYxRI99BDSrDbhJuBU0a3uAGlfso2D5CGhWCbBsPWjWdoSqd7Hr9hHYLBOwrKUdNGubqneR4x4BzXKDC98Bzdr20XPeRU3dCGyWE1w6AJt1SNdiiDsgHgHNemwAly5uyGwWB2u7jx5hImJMg7BZVmT5IGzWId1gLGKsg7BZJmR5Szto1iGpJV7Zrh2EzXKjq/DCZpFaYooFm+VE13AbNovUElMs0Kw2Fb6SJtisGVJLrFJwEDarhGEdtbBZM6SWOGKZxkCz/vmgiGEt+hbYrBkaa4kmFmSWlWktQdisXR+9AU2EVA8Own2WiWk1Ggds1i7NEIpwFHQPwmbVMK6oCjRrZmaZ7lrNmZVzcAw2q45xTWbYrJkZOq+Vawwdg7BZbuZVuWCzZiL03NzcorKPIWYZmddlQ8zapasxcou2cQw2qzyLlXlhs3YjNDLOrWwfQ8wyZrEyG2JWpI/K91zK9rEx2KzyrCYevG9As3Z36Q6gHHqs8jHELGNW67MhZkWWqcY4d+xjU7BZ5VnO6HlhsyIRqjFyqC4Qs4xZrtGMmBWJ0BTheauLqTG4z3JnvUoXYlbkmC4iPFecU1OIWdVZr9PiQMyao3mM86SoYwoxqyb7leo8iFlzyzTYOtdBEDHrR9M51qpuQcxa7qMDYdYxjk4hZlnPs1pdL2JWJEIHwuwPgqOwWT8ynSA+G70PMWtujg6E2R4ERzGzSs655kqkz5pbPqYzW1kdrJyjo4hZbYbzrrwTNouj9YyunslmONwxipnlPPfKzRuQWTytORoas0flHsXMcuegrQc2i8veHwkCax6OhhCzXppygMWV75BZHK/5vi+IAluqp0cxs6w5baAHM2t+nup3xqr9ZiqsNGadv7qI1RiYWcvz1G0xdVj3p1GzjDluw+zHzJqnboupw5qexsxqznloEITN4mn107QT2ozG0DRmVqM2583omzCz5udptIXF1BFCzbKLcKwtm8TM2pu/RjjAGG6GULPcovzFezCz9vb2fkdAoINgcyiEmfXCJMqW9D7MrL29NSoyoOIiFELNKhFpW7dxs/b6aUo3Y56EQqBZfNwqsSz2oGbt7T2lyz4zzVyEQ6hZjSbRNqfvQ83aO6aSMH20HSHcLLt42yu2baNmHR//g8CknWUKoWaNuEX9Q6/HzTpe+5LQnC3a7wmoQLNEGA6njLY6cbPWjqmAP5P74TBullHkjVpacLPWtn5NdFJLs+vhMG6WVezNqgK4WWtr7/9AgFIGWOEwatZguUH8DQ/gZq1t/UCD46TcCIdxs0Ss2pPrd9ysra3+XxKj+DHQPhQews1ySrJx8y5u1tZHohWPfWiIwSyrRFsPMJj18WP/VeIUY4WbJUmHFeu2GMza+viUaMVY4WaJPMJKOQp3Mpi19Z6OhDFWuFlGCXdB42Mw6yP1WxyrcRazSqTcB5VtFzWLy35/gVfwN4aGULO4NEs8993DYtb7/f6CHh0/HBfEQsySrrg4KTIYzHr/fv+Hwp15Uj0cH2cxq0Mr+a7onrOYtb+/UKizuqrr4+MsZjXWybAzX/SxmMXltwU5bWG4Pz7OYtaYU5b9sfhYzOLculaA546198bHmcwqkclz21yExayF/b8U2kuBdKabb8dZzJqyyvaHHGAza3/h6wK75unvd9++ZTKrWSXfTvUwmbWwsP+rQhoe6+wf3r5lMWtU+qI9OfVsZi0sfPubAirZPyRggWZ1FMm7YwNMZi0sLC5+WSBlRtH9iQ9sZskwwEpN8TMmsxYXFz/9qSBuZK27OzHBZlaHSfad0z9fZjBrkc9XBdBxPRmemGAza7TuAnZP/5TRrE+L3+b7bIbh+sQpWBnNmq6+kD1Ux2khZn3iciufR1w67T0eFZNZ08YL2klNH6NZHK0/X83jQ+Dd4TOwMpllvLC9jNFiMOvTp7w9FBquDw8PM5o17bzAHdX0sZq1srLy17ysCr+5N5wOVlqzLpTVlStXn7KaxdH6Kv/Ocalu/Dz8M6tZIecF763mKZtZPKyVlVt5dsed9lGUFJtZIeNF766Oo8Vg1ooA66fv8+p0/427rzlYjGZdPKtoBc9u1k+bm/kjl/bR69evmc0KVytip9XP2M3a3Nz8Pj96LtWNV68FWKhZPKqOOoXst/5ZFmZtbn7+Lg/Ocn3zKMqK1aybJuX8lQ1kYdbm58+/+P0ln4kv+turVyewcLPCN7UK2nndtWzM4vL1Zb4KVPfk7qskWLhZ94oUtf/FPVmYxeP63y3NJT4C/vdVFmaFmw3/b9/sQto6wzj+nrjmNCnrohvDrd1KKetu2kChpLsIpJ5BrntlBolJmp5AEjMVHQlpMg3TaSv2uhcbyCAhaL78rApSK/TCD0KKFTrwSkxrP2gLZYzZ9mLvOSf1Y+o878kxOW9y/iEX3nnO7/ye93kej1J72mpfoZj118pK1edYLncVepYUgllfENK7iq9vIZm1Eo9f+Qy7o0ttiEQinFi8zOrvv31KitdBHv8Fyaw4zDm8ZmSi1cGwQjHr9sdAmk/kRzfQzIpPT8+dwafTINoYVGhmSahl39VmXEc0Kz49N/c9Hn/0J9uaopE8LN5mwTZQwpX+JySzWFjz8xjgYlBFox+84mlWv14t7as6+TOiWRyubyReAJuiMQZWlLdZTE5J/hnU3EA0i4E1P++V7sZQ3eqIrUajiGb9cfkCkH5U19HOLA7W/F2vR5Jzl8LgWI3FYhwsBLOuKQEOIWtv/Y1mFovr7kIHLbmthq755uLqFiz+Zv1IADwCJy4BZjHJdVKSOqoCa4tr22HxNetyG0bTo+oHZLNYWAu5Ba9HIu/VKJ2OgbW1xUUBZl1VAqwCS2EeFopZC7lcbjDVSZV8OCFMgcTAwC5Y/MzCpgRudYXnBJmVG2Q+XbSmlGUcnlQMqgFBZmHRBe5aZ5wWZNYgl5SX1pbm97Y6HYlEcm9YPMzSKwCWOXlWgFksrdRgaiO1UQJeOqcrmUwmYISZ1dAKcI3qonCzYDYeP/bSxWsPCSMklcmzEmbWNQXAODVnhZqVpzU01NXZUoT+UGEKdGcy60k2As1qaMX81RLVxTebr0+jmsXBmsnOZNtp6hDXG2qoVDq9vp7JZAoxS68EmIeEJ1dhZs3AZLPZJ26aUh0KqMbhNBMOllCzfsP4tNrZFv5ZkFksq+wTmLftFptWtFJDWk121zBMehssoWbpFaBMojnzpnCzWFojI2/7IDFrgY6pdSZ7Y/fY2NOnw5u0CjDrn6sXQBml9pOCzcpysEZGnsG8DPksNgq9sye1RojJ/5DNXrCEmNVgIEBZpfr0d+KYxcJ6CTM6OjrxDjIz2yjrQbWRVFiNJjOkND4+PjubJzWWh5Uu0Cz8G4vd90tzSTyzWFSjE2zePX++vLwcCoV9QYvFbDbbmJiYL/zBbg8Gw37/5PsXL5aWlsaXtsF6OCaKWeVVAbf6wpor4pk1ukmLg/X69dTU1J07D7jcY/Lo0X0mk+8n73+ANS62WQ2tBCjTHD1xXkyzeMJishPWrEhmNRjUoIyj+qpKNLMm9oDF0rp3ECxxzPq9fNr1/XKk7tvSmbUkoln6T0EF5EjdMczNYlDpQIVEU3cMb7MqBxWH60tczYpEKgsVWwx7qvAzqzJRwbGLrO45j5tZ0UizElRoiBO/YmXWTYMCVHDImkvYmNVUvtsK3ksoTU8HBmbFAjoASFDxIVUer8TNclR2/ftPjvd0SNesgJGUpdrRGx5tcS9I0aymelmqPXCBao9XYmY5nFaZzH64gJb2SsYsR7NOLn4HbaJYXqU2y9FslEnxitbjLqVZCZdTdgol1S2dXaUwK5kM1Cvl2y+gn6fdQ8U1y+U0EvJ9F9x0ULQ7WxyzXM0mBZC3FAUD87i7DtEsCAsaJU9TIvYcLbS7T1Sz8rBcwXodwc0NckQbwgiShMR8of816wGCWd2N9nqdWq58hzg2AxVlo33tfQW8Nzjrh5iMWnbhJ4MqSm9P2cwWX3sIxSx/YxBSssoNX8ls01opG+Rm8fnC4VCot3fLrN5evz8cDgbtdrPJRFnz/+wqu1RqYmD/klZGrcO/6hciqVtnVr0AAAAASUVORK5CYII=",className:"App-logo",alt:"logo"})})}function CM(t){return fetch("http://20.200.205.8:5000/data/".concat(t)).then((t=>t.json()))}function MM(){const[e,n]=(0,t.useState)(!1),[i,r]=(0,t.useState)(),[o,a]=(0,t.useState)(),[s,l]=(0,t.useState)(),[c,u]=(0,t.useState)();return(0,t.useEffect)((()=>{!async function(){const t=await CM("trip"),e=await CM("empty"),i=await CM("ps"),o=await CM("result");t&&e&&i&&o&&(r(t),a(e),l(i),u(o),n(!0))}()}),[]),(0,qy.jsx)("div",{className:"App",children:e?(0,qy.jsx)(kM,{trip:i,empty:o,ps:s,result:c}):(0,qy.jsx)(AM,{})})}const IM=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function LM(t,e){navigator.serviceWorker.register(t).then((t=>{t.onupdatefound=()=>{const n=t.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((t=>{console.error("Error during service worker registration:",t)}))}const OM=t=>{t&&t instanceof Function&&n.e(787).then(n.bind(n,787)).then((e=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:o,getTTFB:a}=e;n(t),i(t),r(t),o(t),a(t)}))},zM=document.getElementById("root");i.createRoot(zM).render((0,qy.jsx)(t.StrictMode,{children:(0,qy.jsx)(MM,{})})),function(t){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const e="".concat("","/service-worker.js");IM?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((n=>{const i=n.headers.get("content-type");404===n.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((t=>{t.unregister().then((()=>{window.location.reload()}))})):LM(t,e)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):LM(e,t)}))}}(),OM()})()})();
//# sourceMappingURL=main.b9120668.js.map